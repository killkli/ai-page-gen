import{r as d,j as e}from"./react-vendor-CKBOTALK.js";import{N as b}from"./app-services-2y2dLhqm.js";const H=({turn:s,isCurrentTurn:l,isStudentTurn:t,onPlayComplete:m,showTranslation:p=!1,showHints:y=!1,voiceSettings:h={}})=>{const[a,o]=d.useState(!1),[g,j]=d.useState(!1),[c,f]=d.useState(p),[n,v]=d.useState(y),u=d.useCallback(async()=>{if(a){b.stopSpeaking();return}try{o(!0),await b.speak(s.text,{lang:"en-US",rate:.9,...h},void 0,()=>{o(!1),m?.()},r=>{console.error("Speech playback error:",r),o(!1)})}catch(r){console.error("Failed to play speech:",r),o(!1)}},[s.text,a,h,m]),N=r=>{switch(r){case"easy":return"text-green-600 bg-green-50 border-green-200";case"normal":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"hard":return"text-red-600 bg-red-50 border-red-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},w=(r,i)=>{let x=r;return i.forEach(k=>{const C=new RegExp(`\\b(${k.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})\\b`,"gi");x=x.replace(C,'<mark class="bg-yellow-200 px-1 rounded">$1</mark>')}),x};return e.jsxs("div",{className:`
      relative rounded-lg border-2 transition-all duration-300 mb-4
      ${l?"border-blue-400 shadow-lg bg-blue-50":"border-gray-200 bg-white"}
      ${t&&l?"border-green-400 bg-green-50":""}
    `,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`
            w-10 h-10 rounded-full flex items-center justify-center text-white font-medium
            ${t?"bg-green-500":s.speaker==="Teacher"||s.speaker==="è€å¸«"?"bg-blue-500":"bg-gray-500"}
          `,children:s.speaker.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-gray-900",children:[s.speaker,t&&e.jsx("span",{className:"ml-2 text-sm text-green-600 font-normal",children:"(Your turn)"})]}),l&&e.jsx("div",{className:"text-sm text-blue-600",children:"Current conversation turn"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`
            px-2 py-1 text-xs font-medium rounded-full border
            ${N(s.difficulty)}
          `,children:s.difficulty}),e.jsx("button",{onClick:u,disabled:t,className:`
              p-2 rounded-full transition-colors
              ${t?"bg-gray-100 text-gray-400 cursor-not-allowed":a?"bg-red-500 text-white hover:bg-red-600":"bg-blue-500 text-white hover:bg-blue-600"}
            `,title:t?"It's your turn to speak":a?"Stop":"Play audio",children:a?e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M6 19h4V5H6v14zm8-14v14h4V5h-4z"})}):e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M8 5v14l11-7z"})})}),e.jsx("button",{onClick:()=>j(!g),className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-full",title:"Show/hide details",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})})})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"text-lg text-gray-900 leading-relaxed mb-3",children:s.keyWords?.length>0?e.jsx("div",{dangerouslySetInnerHTML:{__html:w(s.text,s.keyWords)}}):s.text}),e.jsx("div",{className:"flex items-center space-x-2 mb-3",children:e.jsx("button",{onClick:()=>f(!c),className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:c?"éš±è—ç¿»è­¯":"é¡¯ç¤ºç¿»è­¯"})}),c&&e.jsx("div",{className:"text-gray-600 bg-gray-50 p-3 rounded-lg mb-3 border border-gray-200",children:s.translation}),t&&s.expectedResponseHints&&s.expectedResponseHints.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("button",{onClick:()=>v(!n),className:"text-sm text-green-600 hover:text-green-800 font-medium mb-2",children:n?"éš±è—æç¤º":"éœ€è¦æç¤ºï¼Ÿ"}),n&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[e.jsx("div",{className:"text-sm font-medium text-green-800 mb-2",children:"ðŸ’¡ Response hints:"}),e.jsx("ul",{className:"text-sm text-green-700 space-y-1",children:s.expectedResponseHints.map((r,i)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"text-green-500 mr-2",children:"â€¢"}),e.jsx("span",{children:r})]},i))})]})]}),g&&e.jsxs("div",{className:"border-t border-gray-200 pt-3 mt-3 space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"ðŸ“š Practice Point:"}),e.jsx("div",{className:"text-sm text-gray-600 bg-blue-50 p-2 rounded border border-blue-200",children:s.practicePoint})]}),s.keyWords?.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"ðŸ”‘ Key Words:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.keyWords.map((r,i)=>e.jsx("span",{className:"px-2 py-1 text-sm bg-yellow-100 text-yellow-800 rounded-full border border-yellow-300",children:r},i))})]}),s.pronunciation&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"ðŸ”Š Pronunciation:"}),e.jsx("div",{className:"text-sm text-gray-600 font-mono bg-gray-50 p-2 rounded border border-gray-200",children:s.pronunciation})]})]})]}),l&&e.jsx("div",{className:"absolute -left-1 top-1/2 transform -translate-y-1/2",children:e.jsx("div",{className:"w-2 h-8 bg-blue-400 rounded-r"})}),t&&l&&e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx("div",{className:"w-3 h-3 bg-green-400 rounded-full animate-pulse"})})]})};export{H as C};
