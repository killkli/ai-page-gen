import{j as e,u as K,r as c}from"./react-vendor-dvagwoNb.js";import{af as L}from"./app-services-CTwpurZm.js";import{L as P}from"./index-DoFWawh9.js";import{d as w,X as A,L as $,A as y,H as T,k as D,j as f}from"./interactive-components-zRH6ZME2.js";import"./vendor-D6m3ha6S.js";import"./ai-vendor-ClgCF3w8.js";import"./gemini-service-DqzV0kEP.js";import"./ui-utilities-BDplZrpA.js";import"./teacher-components-DjWz5uXN.js";const E=({responses:u,quizContent:d})=>{const t=(s,i)=>{if(!d)return null;const r=s.questionType,a=d[r];if(!a||!Array.isArray(a))return null;let m=i;if(s.questionId&&typeof s.questionId=="string"){const x=s.questionId.match(/\d+$/);x&&(m=parseInt(x[0]))}return a[m]||null},g=(s,i)=>{if(!s)return e.jsx("div",{className:"text-gray-400 italic",children:"æ‰¾ä¸åˆ°åŸå§‹é¡Œç›®"});switch(i){case"trueFalse":return e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-medium",children:"ğŸ“ é¡Œç›®é™³è¿°:"}),e.jsx("div",{className:"bg-blue-50 p-3 rounded text-gray-800",children:s.statement}),s.explanation&&e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("div",{className:"font-medium",children:"èªªæ˜: "}),e.jsx("div",{children:s.explanation})]})]});case"multipleChoice":return e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-medium",children:"â“ é¡Œç›®:"}),e.jsx("div",{className:"bg-blue-50 p-3 rounded text-gray-800",children:s.question}),e.jsx("div",{className:"font-medium",children:"é¸é …:"}),e.jsx("div",{className:"space-y-1",children:s.options?.map((r,a)=>e.jsxs("div",{className:`p-2 rounded text-sm ${a===s.correctAnswerIndex?"bg-green-100 border border-green-300":"bg-gray-50"}`,children:[String.fromCharCode(65+a),". ",r,a===s.correctAnswerIndex&&e.jsx("span",{className:"ml-2 text-green-600",children:"âœ“ æ­£ç¢ºç­”æ¡ˆ"})]},a))})]});case"fillInTheBlanks":return e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-medium",children:"âœï¸ å¡«ç©ºé¡Œ:"}),e.jsx("div",{className:"bg-blue-50 p-3 rounded text-gray-800",children:s.sentence}),e.jsxs("div",{className:"text-sm text-green-700",children:[e.jsx("span",{className:"font-medium",children:"æ­£ç¢ºç­”æ¡ˆ: "}),Array.isArray(s.correctAnswers)?s.correctAnswers.join(", "):s.correctAnswers]})]});case"sentenceScramble":return e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-medium",children:"ğŸ”€ å¥å­é‡çµ„:"}),e.jsx("div",{className:"text-sm text-gray-600",children:"æ‰“äº‚çš„è©çµ„:"}),e.jsx("div",{className:"bg-yellow-50 p-2 rounded text-sm",children:Array.isArray(s.scrambledWords)?s.scrambledWords.join(" | "):"ç„¡è©çµ„è³‡æ–™"}),e.jsxs("div",{className:"text-sm text-green-700",children:[e.jsx("span",{className:"font-medium",children:"æ­£ç¢ºé †åº: "}),s.correctSentence]})]});case"memoryCardGame":return e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-medium",children:"ğŸƒ è¨˜æ†¶å¡éŠæˆ²:"}),s.instructions&&e.jsx("div",{className:"text-sm text-sky-700 bg-sky-50 p-2 rounded",children:s.instructions}),e.jsx("div",{className:"space-y-1",children:s.pairs?.map((r,a)=>e.jsxs("div",{className:"flex items-center justify-between bg-purple-50 p-2 rounded text-sm",children:[e.jsxs("span",{children:["ğŸƒ ",r.question]}),e.jsx("span",{className:"text-purple-600",children:"â†”ï¸"}),e.jsxs("span",{children:["ğŸƒŠ ",r.answer]})]},a))})]});default:return e.jsx("pre",{className:"text-xs bg-gray-100 p-2 rounded",children:JSON.stringify(s,null,2)})}},p=(s,i)=>i==="memoryCardGame"&&typeof s=="number"?`å®ŒæˆéŠæˆ²ï¼Œç¸½å˜—è©¦æ¬¡æ•¸: ${s}`:i==="multipleChoice"&&typeof s=="number"?`é¸é … ${String.fromCharCode(65+s)} (${s})`:typeof s=="object"?JSON.stringify(s,null,2):String(s),o={trueFalse:"æ˜¯éé¡Œ",multipleChoice:"é¸æ“‡é¡Œ",fillInTheBlanks:"å¡«ç©ºé¡Œ",sentenceScramble:"å¥å­é‡çµ„",memoryCardGame:"ç¿½å¡é…å°éŠæˆ²"};return e.jsx("div",{className:"space-y-6",children:u.map((s,i)=>{const r=t(s,i);return e.jsxs("div",{className:`p-6 rounded-lg border-2 ${s.isCorrect?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[s.isCorrect?e.jsx(w,{className:"w-5 h-5 text-green-600"}):e.jsx(A,{className:"w-5 h-5 text-red-600"}),e.jsxs("span",{className:"font-bold text-lg text-gray-800",children:["ç¬¬ ",i+1," é¡Œ - ",o[s.questionType]||s.questionType]})]}),e.jsx("div",{className:"text-sm text-gray-500",children:s.attempts&&s.attempts>1&&`å˜—è©¦ ${s.attempts} æ¬¡`})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"ğŸ“– åŸå§‹é¡Œç›®å…§å®¹:"}),e.jsx("div",{className:"border-l-4 border-blue-300 pl-4",children:g(r,s.questionType)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 pt-4 border-t border-gray-200",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"ğŸ‘¨â€ğŸ“ å­¸ç”Ÿä½œç­”:"}),e.jsx("div",{className:"bg-white p-3 rounded border",children:p(s.userAnswer,s.questionType)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:s.isCorrect?"âœ… ç­”é¡Œæ­£ç¢º":"âŒ ç­”é¡ŒéŒ¯èª¤"}),e.jsx("div",{className:`p-3 rounded border ${s.isCorrect?"bg-green-100 border-green-300":"bg-red-100 border-red-300"}`,children:s.isCorrect?"å­¸ç”Ÿç­”æ¡ˆæ­£ç¢ºï¼":"éœ€è¦é€²ä¸€æ­¥æŒ‡å°"})]})]})]},s.questionId||i)})})},Z=()=>{const[u]=K(),d=u.get("binId"),[t,g]=c.useState(null),[p,o]=c.useState(!0),[s,i]=c.useState(null),[r,a]=c.useState(""),[m,x]=c.useState(!1),[I,j]=c.useState(!1),[C,h]=c.useState(!1);c.useEffect(()=>{(async()=>{if(!d){i("ç¼ºå°‘å­¸ç”Ÿä½œç­”çµæœIDåƒæ•¸"),o(!1);return}try{o(!0);const n=await L(d);g(n),x(!!n.diagnosticReport)}catch(n){console.error("è¼‰å…¥å­¸ç”Ÿä½œç­”çµæœå¤±æ•—:",n),i(n instanceof Error?n.message:"è¼‰å…¥å­¸ç”Ÿä½œç­”çµæœå¤±æ•—")}finally{o(!1)}})()},[d]),c.useEffect(()=>{const l=localStorage.getItem("gemini_api_key");l?(a(l),console.log("å·²å¾ localStorage è®€å– API Key")):console.log("æœªæ‰¾åˆ°å·²å­˜å„²çš„ API Key")},[]);const S=l=>{l.preventDefault();const n=r.trim();n&&(localStorage.setItem("gemini_api_key",n),a(n),h(!1))},N=()=>{if(!r){h(!0);return}j(!0)},k=()=>{t?.diagnosticReport&&j(!0)};if(p)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-100 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx($,{}),e.jsx("p",{className:"mt-4 text-gray-600",children:"è¼‰å…¥å­¸ç”Ÿä½œç­”çµæœä¸­..."})]})});if(s)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-50 to-pink-100 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full text-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-16 h-16 text-red-500 mx-auto mb-4",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:"è¼‰å…¥å¤±æ•—"}),e.jsx("p",{className:"text-gray-600 mb-6",children:s}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"é‡æ–°è¼‰å…¥"})]})});if(I&&t)return e.jsx(P,{topic:`${t.topic} (${t.difficulty}é›£åº¦) - ${t.studentName}`,apiKey:r,mode:"teacher",initialResponses:t.responses,existingReport:t.diagnosticReport,resultsBinId:d??void 0,onClose:()=>j(!1),onReportSaved:l=>{g(n=>n?{...n,diagnosticReport:l}:null),x(!0)}});if(!t)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full text-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-16 h-16 text-gray-400 mx-auto mb-4",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:"æ‰¾ä¸åˆ°å­¸ç”Ÿä½œç­”çµæœ"}),e.jsx("p",{className:"text-gray-600",children:"è«‹æª¢æŸ¥é€£çµæ˜¯å¦æ­£ç¢º"})]})});const b=t.responses.filter(l=>l.isCorrect).length,v=t.responses.length,R=new Date(t.completedAt).toLocaleString("zh-TW");return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-100",children:[e.jsx("div",{className:"bg-white shadow-sm border-b",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(y,{className:"w-8 h-8 text-blue-600"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"å­¸ç”Ÿä½œç­”çµæœæª¢è¦–"})]}),e.jsxs("a",{href:"/ai-page-gen/",className:"flex items-center gap-2 px-4 py-2 text-indigo-600 bg-indigo-50 border border-indigo-200 rounded-lg hover:bg-indigo-100 transition-colors",children:[e.jsx(T,{className:"w-4 h-4"}),"è¿”å›é¦–é "]})]}),e.jsx("div",{className:"flex items-center gap-2 text-gray-600",children:e.jsx("span",{className:"text-lg font-medium",children:"æ•™å¸«ç‰ˆåˆ†æå·¥å…·"})})]})}),e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:["ğŸ“ ",t.studentName||"åŒ¿åå­¸ç”Ÿ"," çš„ä½œç­”çµæœ"]}),e.jsxs("div",{className:"flex items-center gap-4 text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(y,{className:"w-4 h-4"}),e.jsxs("span",{children:["ä¸»é¡Œï¼š",t.topic]})]}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("span",{children:["é›£åº¦ï¼š",t.difficulty]})}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(D,{className:"w-4 h-4"}),e.jsxs("span",{children:["å®Œæˆæ™‚é–“ï¼š",R]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-3xl font-bold text-blue-600 mb-1",children:[t.overallScore,"%"]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[b,"/",v," ç­”å°"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(w,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-green-700",children:b}),e.jsx("div",{className:"text-sm text-green-600",children:"ç­”å°é¡Œæ•¸"})]})]})}),e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(A,{className:"w-8 h-8 text-red-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-red-700",children:v-b}),e.jsx("div",{className:"text-sm text-red-600",children:"ç­”éŒ¯é¡Œæ•¸"})]})]})}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(f,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-700",children:[t.overallScore,"%"]}),e.jsx("div",{className:"text-sm text-blue-600",children:"ç¸½é«”æ­£ç¢ºç‡"})]})]})})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex gap-4 items-center",children:[m?e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:k,className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-lg hover:from-green-700 hover:to-emerald-700 transition-all font-medium",children:[e.jsx(f,{className:"w-5 h-5"}),"æŸ¥çœ‹ AI è¨ºæ–·å ±å‘Š"]}),e.jsx("button",{onClick:N,className:"flex items-center gap-2 px-4 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-lg hover:from-indigo-700 hover:to-purple-700 transition-all font-medium text-sm",children:"ğŸ”„ é‡æ–°ç”Ÿæˆ"})]}):e.jsxs("button",{onClick:N,className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-lg hover:from-indigo-700 hover:to-purple-700 transition-all font-medium",children:[e.jsx(f,{className:"w-5 h-5"}),"ç”Ÿæˆ AI å­¸ç¿’è¨ºæ–·å ±å‘Š"]}),r?e.jsx("div",{className:"text-sm text-green-600 flex items-center gap-1",children:"âœ… API Key å·²è¨­å®šï¼Œå¯ä½¿ç”¨ AI è¨ºæ–·åŠŸèƒ½"}):e.jsx("div",{className:"text-sm text-amber-600 flex items-center gap-1",children:"âš ï¸ éœ€è¦è¨­å®š API Key æ‰èƒ½ä½¿ç”¨ AI è¨ºæ–·åŠŸèƒ½"})]}),e.jsx("div",{className:"text-xs text-gray-500",children:m?e.jsx("span",{children:"ğŸ“Š å·²å„²å­˜è¨ºæ–·å ±å‘Šï¼Œå¯éš¨æ™‚æŸ¥çœ‹æˆ–é‡æ–°ç”Ÿæˆæ–°çš„åˆ†æ"}):r?e.jsx("span",{children:"ğŸ’¡ å°æç¤ºï¼šå¦‚éœ€æ›´æ›´æ› API Keyï¼Œè«‹é»æ“Šä¸Šæ–¹æŒ‰éˆ•å¾Œåœ¨å½ˆå‡ºè¦–çª—ä¸­é‡æ–°è¨­å®š"}):null})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"ğŸ“‹ è©³ç´°ä½œç­”è¨˜éŒ„ (å«åŸå§‹é¡Œç›®)"}),e.jsx(E,{responses:t.responses,quizContent:t.quizContent})]})]}),C&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:l=>{l.target===l.currentTarget&&h(!1)},children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"è¨­å®š API Key"}),e.jsx("button",{onClick:()=>h(!1),className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"é—œé–‰",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("p",{className:"text-gray-600 mb-4",children:["è¦ä½¿ç”¨ AI å­¸ç¿’è¨ºæ–·åŠŸèƒ½ï¼Œè«‹è¼¸å…¥æ‚¨çš„ Google Gemini API Keyã€‚",e.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"underline text-blue-600 ml-1",children:"é»æ­¤å–å¾— API Key"})]}),e.jsxs("form",{onSubmit:S,children:[e.jsx("input",{type:"password",value:r,onChange:l=>a(l.target.value),placeholder:"è«‹è¼¸å…¥æ‚¨çš„ Gemini API Key",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent mb-4"}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{type:"button",onClick:()=>h(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"å–æ¶ˆ"}),e.jsx("button",{type:"submit",disabled:!r.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"è¨­å®š"})]})]})]})})]})};export{Z as default};
