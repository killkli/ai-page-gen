import{i as u,g as v,a as f,b as y,c as L,d as h,h as S,e as s,t as C,f as b,j as I,k as P,l as p,m as w,n as F,o as A,p as O,q as E,r as j,s as _,u as k,v as $,w as G,x as T,y as x,z as B,A as V,B as z,C as W,D as N,E as Q,F as U,G as M,H as R}from"./app-services-ADGa5PDV.js";import{G as J}from"./ai-vendor-U8uTsjnZ.js";const D=s,H=async(e,a)=>await I(e,a,s),q=async(e,a)=>await b(e,a,s),Y=async(e,a)=>await C(e,a,s),Z=async(e,a)=>await v(e,a,s),K=e=>u(e),X=async(e,a)=>await L(e,a,s),ee=async(e,a,o)=>await y(e,a,o,s),ne=async(e,a,o,d)=>await f(e,a,o,d,s),ae=async()=>await S(),re=async e=>await P(e),te=async()=>await h(),ce=Object.freeze(Object.defineProperty({__proto__:null,addProvider:re,callGemini:D,generateClassroomActivities:A,generateClassroomActivitiesForLevel:$,generateClassroomActivitiesForLevelAndVocabulary:z,generateConfusingPoints:F,generateConfusingPointsForLevel:k,generateConfusingPointsForLevelAndVocabulary:V,generateContentBreakdown:w,generateContentBreakdownForLevel:_,generateContentBreakdownForLevelAndVocabulary:B,generateEnglishConversation:E,generateEnglishConversationForLevel:T,generateEnglishConversationForLevelAndVocabulary:N,generateLearningLevelSuggestions:Z,generateLearningObjectives:p,generateLearningObjectivesForLevel:j,generateLearningObjectivesForLevelAndVocabulary:x,generateLearningPlan:X,generateLearningPlanWithLevel:ee,generateLearningPlanWithVocabularyLevel:ne,generateOnlineInteractiveQuiz:O,generateOnlineInteractiveQuizForLevel:G,generateOnlineInteractiveQuizForLevelAndVocabulary:W,generateStepQuiz:M,generateWritingPractice:Q,getAIFeedback:R,hasConfiguredProviders:ae,initializeProviderSystem:te,isEnglishRelatedTopic:K,regenerateQuizWithConfig:U,transformConfusingPointForStudent:Y,transformContentBreakdownForStudent:q,transformLearningObjectiveForStudent:H},Symbol.toStringTag,{value:"Module"}));var se=(e=>(e.Easy="easy",e.Normal="normal",e.Hard="hard",e))(se||{});const ge={easy:{trueFalse:5,multipleChoice:5,fillInTheBlanks:5,sentenceScramble:5,memoryCardGame:1},normal:{trueFalse:5,multipleChoice:5,fillInTheBlanks:5,sentenceScramble:5,memoryCardGame:1},hard:{trueFalse:5,multipleChoice:5,fillInTheBlanks:5,sentenceScramble:5,memoryCardGame:1}},de={trueFalse:10,multipleChoice:10,fillInTheBlanks:10,sentenceScramble:10,memoryCardGame:2},oe=async(e,a)=>{const o=new J({apiKey:a}),d="gemini-2.5-flash";try{const r=await o.models.generateContent({model:d,contents:e,config:{responseMimeType:"application/json"}});if(!r.text)throw new Error("AI 回傳內容為空，請重試或檢查 API 金鑰。");let n=r.text.trim();const t=/^```(\w*)?\s*\n?(.*?)\n?\s*```$/s,m=n.match(t);if(m&&m[2]&&(n=m[2].trim()),!n.startsWith("{")&&!n.startsWith("[")&&(n.includes("{")||n.includes("["))){const c=n.indexOf("{"),g=n.indexOf("[");let i=-1,l=-1;c!==-1&&(g===-1||c<g)?(i=c,l=n.lastIndexOf("}")):g!==-1&&(i=g,l=n.lastIndexOf("]")),i!==-1&&l!==-1&&l>i&&(n=n.substring(i,l+1))}try{return JSON.parse(n)}catch{throw console.error("AI 回傳原始內容 (JSON parse 失敗):",r.text),new Error("AI 模型傳回的資料格式無法解析 (可能不是有效的 JSON)。請嘗試修改您的主題或重試。")}}catch(r){let n="無法產生內容。";if(r instanceof Error&&(n+=` 詳細資料： ${r.message}`),r&&typeof r=="object"&&"message"in r){const t=r;t.message.includes("API key not valid")||t.message.includes("API_KEY_INVALID")?n="Gemini API 金鑰無效。請檢查您的設定。":t.message.includes("quota")||t.message.includes("RESOURCE_EXHAUSTED")?n="已超出 API 配額。請稍後再試。":(t.message.toLowerCase().includes("json")||t.message.includes("Unexpected token"))&&(n="AI 模型傳回的資料格式無法解析 (可能不是有效的 JSON)。請嘗試修改您的主題或重試。")}throw new Error(n)}},me=Object.freeze(Object.defineProperty({__proto__:null,callGemini:oe},Symbol.toStringTag,{value:"Module"}));export{ge as D,se as Q,q as a,H as b,D as c,de as d,re as e,ne as f,Z as g,ee as h,K as i,X as j,te as k,ae as l,ce as m,me as n,Y as t};
