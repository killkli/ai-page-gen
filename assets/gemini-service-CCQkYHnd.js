import{i as m,g as v,a as f,b as h,c as y,d as C,h as L,e as r,t as b,f as S,j as w,k as I,l as p,m as P,n as F,o as O,p as A,q as E,r as j,s as $,u as _,v as k,w as G,x as T,y as x,z as B,A as M,B as V,C as z,D as W,E as N,F as Q,G as U,H as J,I as R,J as q,K as D,L as H}from"./app-services-DUD7S_NP.js";import{G as K}from"./ai-vendor-CzdzQo8W.js";const Y=r,Z=async(e,n)=>await w(e,n,r),X=async(e,n)=>await S(e,n,r),ee=async(e,n)=>await b(e,n,r),ne=async(e,n)=>await v(e,n,r),ae=e=>m(e),te=async(e,n)=>await y(e,n,r),re=async(e,n,s)=>await h(e,n,s,r),se=async(e,n,s,u)=>await f(e,n,s,u,r),oe=async(e,n)=>await p(e,n),ie=async(e,n,s)=>await I(e,n,s,r),le=async(e,n)=>await F(e,n),ce=async(e,n,s)=>await P(e,n,s,r),ge=async()=>await L(),ue=async e=>await O(e),de=async()=>await C(),ye=Object.freeze(Object.defineProperty({__proto__:null,addProvider:ue,callGemini:Y,generateClassroomActivities:$,generateClassroomActivitiesForLevel:B,generateClassroomActivitiesForLevelAndVocabulary:Q,generateConfusingPoints:j,generateConfusingPointsForLevel:x,generateConfusingPointsForLevelAndVocabulary:N,generateContentBreakdown:E,generateContentBreakdownForLevel:T,generateContentBreakdownForLevelAndVocabulary:W,generateEnglishContent:ce,generateEnglishConversation:k,generateEnglishConversationForLevel:V,generateEnglishConversationForLevelAndVocabulary:J,generateEnglishObjectives:le,generateLearningLevelSuggestions:ne,generateLearningObjectives:A,generateLearningObjectivesForLevel:G,generateLearningObjectivesForLevelAndVocabulary:z,generateLearningPlan:te,generateLearningPlanWithLevel:re,generateLearningPlanWithVocabularyLevel:se,generateMathContent:ie,generateMathObjectives:oe,generateOnlineInteractiveQuiz:_,generateOnlineInteractiveQuizForLevel:M,generateOnlineInteractiveQuizForLevelAndVocabulary:U,generateStepQuiz:D,generateWritingPractice:R,getAIFeedback:H,hasConfiguredProviders:ge,initializeProviderSystem:de,isEnglishRelatedTopic:ae,regenerateQuizWithConfig:q,transformConfusingPointForStudent:ee,transformContentBreakdownForStudent:X,transformLearningObjectiveForStudent:Z},Symbol.toStringTag,{value:"Module"}));var me=(e=>(e.Easy="easy",e.Normal="normal",e.Hard="hard",e))(me||{});const Ce={easy:{trueFalse:5,multipleChoice:5,fillInTheBlanks:5,sentenceScramble:5,memoryCardGame:1},normal:{trueFalse:5,multipleChoice:5,fillInTheBlanks:5,sentenceScramble:5,memoryCardGame:1},hard:{trueFalse:5,multipleChoice:5,fillInTheBlanks:5,sentenceScramble:5,memoryCardGame:1}},Le={trueFalse:10,multipleChoice:10,fillInTheBlanks:10,sentenceScramble:10,memoryCardGame:2},ve=async(e,n)=>{const s=new K({apiKey:n}),u="gemini-2.5-flash";try{const t=await s.models.generateContent({model:u,contents:e,config:{responseMimeType:"application/json"}});if(!t.text)throw new Error("AI 回傳內容為空，請重試或檢查 API 金鑰。");let a=t.text.trim();const o=/^```(\w*)?\s*\n?(.*?)\n?\s*```$/s,d=a.match(o);if(d&&d[2]&&(a=d[2].trim()),!a.startsWith("{")&&!a.startsWith("[")&&(a.includes("{")||a.includes("["))){const c=a.indexOf("{"),g=a.indexOf("[");let i=-1,l=-1;c!==-1&&(g===-1||c<g)?(i=c,l=a.lastIndexOf("}")):g!==-1&&(i=g,l=a.lastIndexOf("]")),i!==-1&&l!==-1&&l>i&&(a=a.substring(i,l+1))}try{return JSON.parse(a)}catch{throw console.error("AI 回傳原始內容 (JSON parse 失敗):",t.text),new Error("AI 模型傳回的資料格式無法解析 (可能不是有效的 JSON)。請嘗試修改您的主題或重試。")}}catch(t){let a="無法產生內容。";if(t instanceof Error&&(a+=` 詳細資料： ${t.message}`),t&&typeof t=="object"&&"message"in t){const o=t;o.message.includes("API key not valid")||o.message.includes("API_KEY_INVALID")?a="Gemini API 金鑰無效。請檢查您的設定。":o.message.includes("quota")||o.message.includes("RESOURCE_EXHAUSTED")?a="已超出 API 配額。請稍後再試。":(o.message.toLowerCase().includes("json")||o.message.includes("Unexpected token"))&&(a="AI 模型傳回的資料格式無法解析 (可能不是有效的 JSON)。請嘗試修改您的主題或重試。")}throw new Error(a)}},be=Object.freeze(Object.defineProperty({__proto__:null,callGemini:ve},Symbol.toStringTag,{value:"Module"}));export{Ce as D,me as Q,X as a,Z as b,Y as c,Le as d,ue as e,oe as f,ie as g,ge as h,ce as i,le as j,ae as k,ne as l,se as m,re as n,te as o,de as p,ye as q,be as r,ee as t};
