(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function n(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerPolicy&&(o.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?o.credentials="include":l.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(l){if(l.ep)return;l.ep=!0;const o=n(l);fetch(l.href,o)}})();function tl(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Sd={exports:{}},Da={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var w0;function _w(){if(w0)return Da;w0=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(i,l,o){var u=null;if(o!==void 0&&(u=""+o),l.key!==void 0&&(u=""+l.key),"key"in l){o={};for(var f in l)f!=="key"&&(o[f]=l[f])}else o=l;return l=o.ref,{$$typeof:t,type:i,key:u,ref:l!==void 0?l:null,props:o}}return Da.Fragment=e,Da.jsx=n,Da.jsxs=n,Da}var N0;function Mw(){return N0||(N0=1,Sd.exports=_w()),Sd.exports}var a=Mw(),Cd={exports:{}},Pe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var S0;function Rw(){if(S0)return Pe;S0=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),u=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),v=Symbol.iterator;function N(S){return S===null||typeof S!="object"?null:(S=v&&S[v]||S["@@iterator"],typeof S=="function"?S:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,j={};function k(S,V,ie){this.props=S,this.context=V,this.refs=j,this.updater=ie||w}k.prototype.isReactComponent={},k.prototype.setState=function(S,V){if(typeof S!="object"&&typeof S!="function"&&S!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,S,V,"setState")},k.prototype.forceUpdate=function(S){this.updater.enqueueForceUpdate(this,S,"forceUpdate")};function E(){}E.prototype=k.prototype;function L(S,V,ie){this.props=S,this.context=V,this.refs=j,this.updater=ie||w}var D=L.prototype=new E;D.constructor=L,C(D,k.prototype),D.isPureReactComponent=!0;var O=Array.isArray,H={H:null,A:null,T:null,S:null,V:null},I=Object.prototype.hasOwnProperty;function R(S,V,ie,_,ve,Se){return ie=Se.ref,{$$typeof:t,type:S,key:V,ref:ie!==void 0?ie:null,props:Se}}function q(S,V){return R(S.type,V,void 0,void 0,void 0,S.props)}function B(S){return typeof S=="object"&&S!==null&&S.$$typeof===t}function ee(S){var V={"=":"=0",":":"=2"};return"$"+S.replace(/[=:]/g,function(ie){return V[ie]})}var G=/\/+/g;function Y(S,V){return typeof S=="object"&&S!==null&&S.key!=null?ee(""+S.key):V.toString(36)}function z(){}function $(S){switch(S.status){case"fulfilled":return S.value;case"rejected":throw S.reason;default:switch(typeof S.status=="string"?S.then(z,z):(S.status="pending",S.then(function(V){S.status==="pending"&&(S.status="fulfilled",S.value=V)},function(V){S.status==="pending"&&(S.status="rejected",S.reason=V)})),S.status){case"fulfilled":return S.value;case"rejected":throw S.reason}}throw S}function Q(S,V,ie,_,ve){var Se=typeof S;(Se==="undefined"||Se==="boolean")&&(S=null);var se=!1;if(S===null)se=!0;else switch(Se){case"bigint":case"string":case"number":se=!0;break;case"object":switch(S.$$typeof){case t:case e:se=!0;break;case x:return se=S._init,Q(se(S._payload),V,ie,_,ve)}}if(se)return ve=ve(S),se=_===""?"."+Y(S,0):_,O(ve)?(ie="",se!=null&&(ie=se.replace(G,"$&/")+"/"),Q(ve,V,ie,"",function(be){return be})):ve!=null&&(B(ve)&&(ve=q(ve,ie+(ve.key==null||S&&S.key===ve.key?"":(""+ve.key).replace(G,"$&/")+"/")+se)),V.push(ve)),1;se=0;var he=_===""?".":_+":";if(O(S))for(var de=0;de<S.length;de++)_=S[de],Se=he+Y(_,de),se+=Q(_,V,ie,Se,ve);else if(de=N(S),typeof de=="function")for(S=de.call(S),de=0;!(_=S.next()).done;)_=_.value,Se=he+Y(_,de++),se+=Q(_,V,ie,Se,ve);else if(Se==="object"){if(typeof S.then=="function")return Q($(S),V,ie,_,ve);throw V=String(S),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(S).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.")}return se}function P(S,V,ie){if(S==null)return S;var _=[],ve=0;return Q(S,_,"","",function(Se){return V.call(ie,Se,ve++)}),_}function K(S){if(S._status===-1){var V=S._result;V=V(),V.then(function(ie){(S._status===0||S._status===-1)&&(S._status=1,S._result=ie)},function(ie){(S._status===0||S._status===-1)&&(S._status=2,S._result=ie)}),S._status===-1&&(S._status=0,S._result=V)}if(S._status===1)return S._result.default;throw S._result}var pe=typeof reportError=="function"?reportError:function(S){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var V=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof S=="object"&&S!==null&&typeof S.message=="string"?String(S.message):String(S),error:S});if(!window.dispatchEvent(V))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",S);return}console.error(S)};function X(){}return Pe.Children={map:P,forEach:function(S,V,ie){P(S,function(){V.apply(this,arguments)},ie)},count:function(S){var V=0;return P(S,function(){V++}),V},toArray:function(S){return P(S,function(V){return V})||[]},only:function(S){if(!B(S))throw Error("React.Children.only expected to receive a single React element child.");return S}},Pe.Component=k,Pe.Fragment=n,Pe.Profiler=l,Pe.PureComponent=L,Pe.StrictMode=i,Pe.Suspense=g,Pe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=H,Pe.__COMPILER_RUNTIME={__proto__:null,c:function(S){return H.H.useMemoCache(S)}},Pe.cache=function(S){return function(){return S.apply(null,arguments)}},Pe.cloneElement=function(S,V,ie){if(S==null)throw Error("The argument must be a React element, but you passed "+S+".");var _=C({},S.props),ve=S.key,Se=void 0;if(V!=null)for(se in V.ref!==void 0&&(Se=void 0),V.key!==void 0&&(ve=""+V.key),V)!I.call(V,se)||se==="key"||se==="__self"||se==="__source"||se==="ref"&&V.ref===void 0||(_[se]=V[se]);var se=arguments.length-2;if(se===1)_.children=ie;else if(1<se){for(var he=Array(se),de=0;de<se;de++)he[de]=arguments[de+2];_.children=he}return R(S.type,ve,void 0,void 0,Se,_)},Pe.createContext=function(S){return S={$$typeof:u,_currentValue:S,_currentValue2:S,_threadCount:0,Provider:null,Consumer:null},S.Provider=S,S.Consumer={$$typeof:o,_context:S},S},Pe.createElement=function(S,V,ie){var _,ve={},Se=null;if(V!=null)for(_ in V.key!==void 0&&(Se=""+V.key),V)I.call(V,_)&&_!=="key"&&_!=="__self"&&_!=="__source"&&(ve[_]=V[_]);var se=arguments.length-2;if(se===1)ve.children=ie;else if(1<se){for(var he=Array(se),de=0;de<se;de++)he[de]=arguments[de+2];ve.children=he}if(S&&S.defaultProps)for(_ in se=S.defaultProps,se)ve[_]===void 0&&(ve[_]=se[_]);return R(S,Se,void 0,void 0,null,ve)},Pe.createRef=function(){return{current:null}},Pe.forwardRef=function(S){return{$$typeof:f,render:S}},Pe.isValidElement=B,Pe.lazy=function(S){return{$$typeof:x,_payload:{_status:-1,_result:S},_init:K}},Pe.memo=function(S,V){return{$$typeof:h,type:S,compare:V===void 0?null:V}},Pe.startTransition=function(S){var V=H.T,ie={};H.T=ie;try{var _=S(),ve=H.S;ve!==null&&ve(ie,_),typeof _=="object"&&_!==null&&typeof _.then=="function"&&_.then(X,pe)}catch(Se){pe(Se)}finally{H.T=V}},Pe.unstable_useCacheRefresh=function(){return H.H.useCacheRefresh()},Pe.use=function(S){return H.H.use(S)},Pe.useActionState=function(S,V,ie){return H.H.useActionState(S,V,ie)},Pe.useCallback=function(S,V){return H.H.useCallback(S,V)},Pe.useContext=function(S){return H.H.useContext(S)},Pe.useDebugValue=function(){},Pe.useDeferredValue=function(S,V){return H.H.useDeferredValue(S,V)},Pe.useEffect=function(S,V,ie){var _=H.H;if(typeof ie=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return _.useEffect(S,V)},Pe.useId=function(){return H.H.useId()},Pe.useImperativeHandle=function(S,V,ie){return H.H.useImperativeHandle(S,V,ie)},Pe.useInsertionEffect=function(S,V){return H.H.useInsertionEffect(S,V)},Pe.useLayoutEffect=function(S,V){return H.H.useLayoutEffect(S,V)},Pe.useMemo=function(S,V){return H.H.useMemo(S,V)},Pe.useOptimistic=function(S,V){return H.H.useOptimistic(S,V)},Pe.useReducer=function(S,V,ie){return H.H.useReducer(S,V,ie)},Pe.useRef=function(S){return H.H.useRef(S)},Pe.useState=function(S){return H.H.useState(S)},Pe.useSyncExternalStore=function(S,V,ie){return H.H.useSyncExternalStore(S,V,ie)},Pe.useTransition=function(){return H.H.useTransition()},Pe.version="19.1.0",Pe}var C0;function Kf(){return C0||(C0=1,Cd.exports=Rw()),Cd.exports}var M=Kf();const Be=tl(M);var Td={exports:{}},La={},jd={exports:{}},kd={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T0;function Iw(){return T0||(T0=1,function(t){function e(P,K){var pe=P.length;P.push(K);e:for(;0<pe;){var X=pe-1>>>1,S=P[X];if(0<l(S,K))P[X]=K,P[pe]=S,pe=X;else break e}}function n(P){return P.length===0?null:P[0]}function i(P){if(P.length===0)return null;var K=P[0],pe=P.pop();if(pe!==K){P[0]=pe;e:for(var X=0,S=P.length,V=S>>>1;X<V;){var ie=2*(X+1)-1,_=P[ie],ve=ie+1,Se=P[ve];if(0>l(_,pe))ve<S&&0>l(Se,_)?(P[X]=Se,P[ve]=pe,X=ve):(P[X]=_,P[ie]=pe,X=ie);else if(ve<S&&0>l(Se,pe))P[X]=Se,P[ve]=pe,X=ve;else break e}}return K}function l(P,K){var pe=P.sortIndex-K.sortIndex;return pe!==0?pe:P.id-K.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var u=Date,f=u.now();t.unstable_now=function(){return u.now()-f}}var g=[],h=[],x=1,v=null,N=3,w=!1,C=!1,j=!1,k=!1,E=typeof setTimeout=="function"?setTimeout:null,L=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;function O(P){for(var K=n(h);K!==null;){if(K.callback===null)i(h);else if(K.startTime<=P)i(h),K.sortIndex=K.expirationTime,e(g,K);else break;K=n(h)}}function H(P){if(j=!1,O(P),!C)if(n(g)!==null)C=!0,I||(I=!0,Y());else{var K=n(h);K!==null&&Q(H,K.startTime-P)}}var I=!1,R=-1,q=5,B=-1;function ee(){return k?!0:!(t.unstable_now()-B<q)}function G(){if(k=!1,I){var P=t.unstable_now();B=P;var K=!0;try{e:{C=!1,j&&(j=!1,L(R),R=-1),w=!0;var pe=N;try{t:{for(O(P),v=n(g);v!==null&&!(v.expirationTime>P&&ee());){var X=v.callback;if(typeof X=="function"){v.callback=null,N=v.priorityLevel;var S=X(v.expirationTime<=P);if(P=t.unstable_now(),typeof S=="function"){v.callback=S,O(P),K=!0;break t}v===n(g)&&i(g),O(P)}else i(g);v=n(g)}if(v!==null)K=!0;else{var V=n(h);V!==null&&Q(H,V.startTime-P),K=!1}}break e}finally{v=null,N=pe,w=!1}K=void 0}}finally{K?Y():I=!1}}}var Y;if(typeof D=="function")Y=function(){D(G)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,$=z.port2;z.port1.onmessage=G,Y=function(){$.postMessage(null)}}else Y=function(){E(G,0)};function Q(P,K){R=E(function(){P(t.unstable_now())},K)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(P){P.callback=null},t.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):q=0<P?Math.floor(1e3/P):5},t.unstable_getCurrentPriorityLevel=function(){return N},t.unstable_next=function(P){switch(N){case 1:case 2:case 3:var K=3;break;default:K=N}var pe=N;N=K;try{return P()}finally{N=pe}},t.unstable_requestPaint=function(){k=!0},t.unstable_runWithPriority=function(P,K){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var pe=N;N=P;try{return K()}finally{N=pe}},t.unstable_scheduleCallback=function(P,K,pe){var X=t.unstable_now();switch(typeof pe=="object"&&pe!==null?(pe=pe.delay,pe=typeof pe=="number"&&0<pe?X+pe:X):pe=X,P){case 1:var S=-1;break;case 2:S=250;break;case 5:S=1073741823;break;case 4:S=1e4;break;default:S=5e3}return S=pe+S,P={id:x++,callback:K,priorityLevel:P,startTime:pe,expirationTime:S,sortIndex:-1},pe>X?(P.sortIndex=pe,e(h,P),n(g)===null&&P===n(h)&&(j?(L(R),R=-1):j=!0,Q(H,pe-X))):(P.sortIndex=S,e(g,P),C||w||(C=!0,I||(I=!0,Y()))),P},t.unstable_shouldYield=ee,t.unstable_wrapCallback=function(P){var K=N;return function(){var pe=N;N=K;try{return P.apply(this,arguments)}finally{N=pe}}}}(kd)),kd}var j0;function Dw(){return j0||(j0=1,jd.exports=Iw()),jd.exports}var Ed={exports:{}},Ft={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var k0;function Lw(){if(k0)return Ft;k0=1;var t=Kf();function e(g){var h="https://react.dev/errors/"+g;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)h+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+g+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},l=Symbol.for("react.portal");function o(g,h,x){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:v==null?null:""+v,children:g,containerInfo:h,implementation:x}}var u=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(g,h){if(g==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return Ft.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Ft.createPortal=function(g,h){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return o(g,h,null,x)},Ft.flushSync=function(g){var h=u.T,x=i.p;try{if(u.T=null,i.p=2,g)return g()}finally{u.T=h,i.p=x,i.d.f()}},Ft.preconnect=function(g,h){typeof g=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,i.d.C(g,h))},Ft.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},Ft.preinit=function(g,h){if(typeof g=="string"&&h&&typeof h.as=="string"){var x=h.as,v=f(x,h.crossOrigin),N=typeof h.integrity=="string"?h.integrity:void 0,w=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;x==="style"?i.d.S(g,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:v,integrity:N,fetchPriority:w}):x==="script"&&i.d.X(g,{crossOrigin:v,integrity:N,fetchPriority:w,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},Ft.preinitModule=function(g,h){if(typeof g=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var x=f(h.as,h.crossOrigin);i.d.M(g,{crossOrigin:x,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&i.d.M(g)},Ft.preload=function(g,h){if(typeof g=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var x=h.as,v=f(x,h.crossOrigin);i.d.L(g,x,{crossOrigin:v,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},Ft.preloadModule=function(g,h){if(typeof g=="string")if(h){var x=f(h.as,h.crossOrigin);i.d.m(g,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:x,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else i.d.m(g)},Ft.requestFormReset=function(g){i.d.r(g)},Ft.unstable_batchedUpdates=function(g,h){return g(h)},Ft.useFormState=function(g,h,x){return u.H.useFormState(g,h,x)},Ft.useFormStatus=function(){return u.H.useHostTransitionStatus()},Ft.version="19.1.0",Ft}var E0;function Pw(){if(E0)return Ed.exports;E0=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Ed.exports=Lw(),Ed.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var A0;function Ow(){if(A0)return La;A0=1;var t=Dw(),e=Kf(),n=Pw();function i(r){var s="https://react.dev/errors/"+r;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)s+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+r+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function o(r){var s=r,c=r;if(r.alternate)for(;s.return;)s=s.return;else{r=s;do s=r,(s.flags&4098)!==0&&(c=s.return),r=s.return;while(r)}return s.tag===3?c:null}function u(r){if(r.tag===13){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function f(r){if(o(r)!==r)throw Error(i(188))}function g(r){var s=r.alternate;if(!s){if(s=o(r),s===null)throw Error(i(188));return s!==r?null:r}for(var c=r,d=s;;){var y=c.return;if(y===null)break;var b=y.alternate;if(b===null){if(d=y.return,d!==null){c=d;continue}break}if(y.child===b.child){for(b=y.child;b;){if(b===c)return f(y),r;if(b===d)return f(y),s;b=b.sibling}throw Error(i(188))}if(c.return!==d.return)c=y,d=b;else{for(var T=!1,A=y.child;A;){if(A===c){T=!0,c=y,d=b;break}if(A===d){T=!0,d=y,c=b;break}A=A.sibling}if(!T){for(A=b.child;A;){if(A===c){T=!0,c=b,d=y;break}if(A===d){T=!0,d=b,c=y;break}A=A.sibling}if(!T)throw Error(i(189))}}if(c.alternate!==d)throw Error(i(190))}if(c.tag!==3)throw Error(i(188));return c.stateNode.current===c?r:s}function h(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r;for(r=r.child;r!==null;){if(s=h(r),s!==null)return s;r=r.sibling}return null}var x=Object.assign,v=Symbol.for("react.element"),N=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),j=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),L=Symbol.for("react.consumer"),D=Symbol.for("react.context"),O=Symbol.for("react.forward_ref"),H=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),B=Symbol.for("react.activity"),ee=Symbol.for("react.memo_cache_sentinel"),G=Symbol.iterator;function Y(r){return r===null||typeof r!="object"?null:(r=G&&r[G]||r["@@iterator"],typeof r=="function"?r:null)}var z=Symbol.for("react.client.reference");function $(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===z?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case C:return"Fragment";case k:return"Profiler";case j:return"StrictMode";case H:return"Suspense";case I:return"SuspenseList";case B:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case w:return"Portal";case D:return(r.displayName||"Context")+".Provider";case L:return(r._context.displayName||"Context")+".Consumer";case O:var s=r.render;return r=r.displayName,r||(r=s.displayName||s.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case R:return s=r.displayName||null,s!==null?s:$(r.type)||"Memo";case q:s=r._payload,r=r._init;try{return $(r(s))}catch{}}return null}var Q=Array.isArray,P=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,pe={pending:!1,data:null,method:null,action:null},X=[],S=-1;function V(r){return{current:r}}function ie(r){0>S||(r.current=X[S],X[S]=null,S--)}function _(r,s){S++,X[S]=r.current,r.current=s}var ve=V(null),Se=V(null),se=V(null),he=V(null);function de(r,s){switch(_(se,s),_(Se,r),_(ve,null),s.nodeType){case 9:case 11:r=(r=s.documentElement)&&(r=r.namespaceURI)?Zg(r):0;break;default:if(r=s.tagName,s=s.namespaceURI)s=Zg(s),r=Qg(s,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}ie(ve),_(ve,r)}function be(){ie(ve),ie(Se),ie(se)}function Ve(r){r.memoizedState!==null&&_(he,r);var s=ve.current,c=Qg(s,r.type);s!==c&&(_(Se,r),_(ve,c))}function Ze(r){Se.current===r&&(ie(ve),ie(Se)),he.current===r&&(ie(he),Aa._currentValue=pe)}var ut=Object.prototype.hasOwnProperty,gt=t.unstable_scheduleCallback,Je=t.unstable_cancelCallback,Gt=t.unstable_shouldYield,xn=t.unstable_requestPaint,Rt=t.unstable_now,wi=t.unstable_getCurrentPriorityLevel,$e=t.unstable_ImmediatePriority,ei=t.unstable_UserBlockingPriority,Qe=t.unstable_NormalPriority,Bn=t.unstable_LowPriority,ln=t.unstable_IdlePriority,Ni=t.log,fe=t.unstable_setDisableYieldValue,Z=null,te=null;function J(r){if(typeof Ni=="function"&&fe(r),te&&typeof te.setStrictMode=="function")try{te.setStrictMode(Z,r)}catch{}}var oe=Math.clz32?Math.clz32:Ee,ge=Math.log,Ne=Math.LN2;function Ee(r){return r>>>=0,r===0?32:31-(ge(r)/Ne|0)|0}var Ke=256,ot=4194304;function Vt(r){var s=r&42;if(s!==0)return s;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Nt(r,s,c){var d=r.pendingLanes;if(d===0)return 0;var y=0,b=r.suspendedLanes,T=r.pingedLanes;r=r.warmLanes;var A=d&134217727;return A!==0?(d=A&~b,d!==0?y=Vt(d):(T&=A,T!==0?y=Vt(T):c||(c=A&~r,c!==0&&(y=Vt(c))))):(A=d&~b,A!==0?y=Vt(A):T!==0?y=Vt(T):c||(c=d&~r,c!==0&&(y=Vt(c)))),y===0?0:s!==0&&s!==y&&(s&b)===0&&(b=y&-y,c=s&-s,b>=c||b===32&&(c&4194048)!==0)?s:y}function Jt(r,s){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&s)===0}function _n(r,s){switch(r){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Rm(){var r=Ke;return Ke<<=1,(Ke&4194048)===0&&(Ke=256),r}function Im(){var r=ot;return ot<<=1,(ot&62914560)===0&&(ot=4194304),r}function fc(r){for(var s=[],c=0;31>c;c++)s.push(r);return s}function Us(r,s){r.pendingLanes|=s,s!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function yb(r,s,c,d,y,b){var T=r.pendingLanes;r.pendingLanes=c,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=c,r.entangledLanes&=c,r.errorRecoveryDisabledLanes&=c,r.shellSuspendCounter=0;var A=r.entanglements,U=r.expirationTimes,re=r.hiddenUpdates;for(c=T&~c;0<c;){var ce=31-oe(c),me=1<<ce;A[ce]=0,U[ce]=-1;var ae=re[ce];if(ae!==null)for(re[ce]=null,ce=0;ce<ae.length;ce++){var le=ae[ce];le!==null&&(le.lane&=-536870913)}c&=~me}d!==0&&Dm(r,d,0),b!==0&&y===0&&r.tag!==0&&(r.suspendedLanes|=b&~(T&~s))}function Dm(r,s,c){r.pendingLanes|=s,r.suspendedLanes&=~s;var d=31-oe(s);r.entangledLanes|=s,r.entanglements[d]=r.entanglements[d]|1073741824|c&4194090}function Lm(r,s){var c=r.entangledLanes|=s;for(r=r.entanglements;c;){var d=31-oe(c),y=1<<d;y&s|r[d]&s&&(r[d]|=s),c&=~y}}function mc(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function hc(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Pm(){var r=K.p;return r!==0?r:(r=window.event,r===void 0?32:p0(r.type))}function vb(r,s){var c=K.p;try{return K.p=r,s()}finally{K.p=c}}var Si=Math.random().toString(36).slice(2),$t="__reactFiber$"+Si,Kt="__reactProps$"+Si,Er="__reactContainer$"+Si,pc="__reactEvents$"+Si,bb="__reactListeners$"+Si,wb="__reactHandles$"+Si,Om="__reactResources$"+Si,zs="__reactMarker$"+Si;function gc(r){delete r[$t],delete r[Kt],delete r[pc],delete r[bb],delete r[wb]}function Ar(r){var s=r[$t];if(s)return s;for(var c=r.parentNode;c;){if(s=c[Er]||c[$t]){if(c=s.alternate,s.child!==null||c!==null&&c.child!==null)for(r=e0(r);r!==null;){if(c=r[$t])return c;r=e0(r)}return s}r=c,c=r.parentNode}return null}function _r(r){if(r=r[$t]||r[Er]){var s=r.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return r}return null}function Vs(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r.stateNode;throw Error(i(33))}function Mr(r){var s=r[Om];return s||(s=r[Om]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function It(r){r[zs]=!0}var Bm=new Set,Um={};function er(r,s){Rr(r,s),Rr(r+"Capture",s)}function Rr(r,s){for(Um[r]=s,r=0;r<s.length;r++)Bm.add(s[r])}var Nb=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),zm={},Vm={};function Sb(r){return ut.call(Vm,r)?!0:ut.call(zm,r)?!1:Nb.test(r)?Vm[r]=!0:(zm[r]=!0,!1)}function ul(r,s,c){if(Sb(s))if(c===null)r.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":r.removeAttribute(s);return;case"boolean":var d=s.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){r.removeAttribute(s);return}}r.setAttribute(s,""+c)}}function dl(r,s,c){if(c===null)r.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(s);return}r.setAttribute(s,""+c)}}function ti(r,s,c,d){if(d===null)r.removeAttribute(c);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(c);return}r.setAttributeNS(s,c,""+d)}}var xc,$m;function Ir(r){if(xc===void 0)try{throw Error()}catch(c){var s=c.stack.trim().match(/\n( *(at )?)/);xc=s&&s[1]||"",$m=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+xc+r+$m}var yc=!1;function vc(r,s){if(!r||yc)return"";yc=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(s){var me=function(){throw Error()};if(Object.defineProperty(me.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(me,[])}catch(le){var ae=le}Reflect.construct(r,[],me)}else{try{me.call()}catch(le){ae=le}r.call(me.prototype)}}else{try{throw Error()}catch(le){ae=le}(me=r())&&typeof me.catch=="function"&&me.catch(function(){})}}catch(le){if(le&&ae&&typeof le.stack=="string")return[le.stack,ae.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var b=d.DetermineComponentFrameRoot(),T=b[0],A=b[1];if(T&&A){var U=T.split(`
`),re=A.split(`
`);for(y=d=0;d<U.length&&!U[d].includes("DetermineComponentFrameRoot");)d++;for(;y<re.length&&!re[y].includes("DetermineComponentFrameRoot");)y++;if(d===U.length||y===re.length)for(d=U.length-1,y=re.length-1;1<=d&&0<=y&&U[d]!==re[y];)y--;for(;1<=d&&0<=y;d--,y--)if(U[d]!==re[y]){if(d!==1||y!==1)do if(d--,y--,0>y||U[d]!==re[y]){var ce=`
`+U[d].replace(" at new "," at ");return r.displayName&&ce.includes("<anonymous>")&&(ce=ce.replace("<anonymous>",r.displayName)),ce}while(1<=d&&0<=y);break}}}finally{yc=!1,Error.prepareStackTrace=c}return(c=r?r.displayName||r.name:"")?Ir(c):""}function Cb(r){switch(r.tag){case 26:case 27:case 5:return Ir(r.type);case 16:return Ir("Lazy");case 13:return Ir("Suspense");case 19:return Ir("SuspenseList");case 0:case 15:return vc(r.type,!1);case 11:return vc(r.type.render,!1);case 1:return vc(r.type,!0);case 31:return Ir("Activity");default:return""}}function qm(r){try{var s="";do s+=Cb(r),r=r.return;while(r);return s}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function yn(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Fm(r){var s=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Tb(r){var s=Fm(r)?"checked":"value",c=Object.getOwnPropertyDescriptor(r.constructor.prototype,s),d=""+r[s];if(!r.hasOwnProperty(s)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var y=c.get,b=c.set;return Object.defineProperty(r,s,{configurable:!0,get:function(){return y.call(this)},set:function(T){d=""+T,b.call(this,T)}}),Object.defineProperty(r,s,{enumerable:c.enumerable}),{getValue:function(){return d},setValue:function(T){d=""+T},stopTracking:function(){r._valueTracker=null,delete r[s]}}}}function fl(r){r._valueTracker||(r._valueTracker=Tb(r))}function Hm(r){if(!r)return!1;var s=r._valueTracker;if(!s)return!0;var c=s.getValue(),d="";return r&&(d=Fm(r)?r.checked?"true":"false":r.value),r=d,r!==c?(s.setValue(r),!0):!1}function ml(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var jb=/[\n"\\]/g;function vn(r){return r.replace(jb,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function bc(r,s,c,d,y,b,T,A){r.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?r.type=T:r.removeAttribute("type"),s!=null?T==="number"?(s===0&&r.value===""||r.value!=s)&&(r.value=""+yn(s)):r.value!==""+yn(s)&&(r.value=""+yn(s)):T!=="submit"&&T!=="reset"||r.removeAttribute("value"),s!=null?wc(r,T,yn(s)):c!=null?wc(r,T,yn(c)):d!=null&&r.removeAttribute("value"),y==null&&b!=null&&(r.defaultChecked=!!b),y!=null&&(r.checked=y&&typeof y!="function"&&typeof y!="symbol"),A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?r.name=""+yn(A):r.removeAttribute("name")}function Gm(r,s,c,d,y,b,T,A){if(b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(r.type=b),s!=null||c!=null){if(!(b!=="submit"&&b!=="reset"||s!=null))return;c=c!=null?""+yn(c):"",s=s!=null?""+yn(s):c,A||s===r.value||(r.value=s),r.defaultValue=s}d=d??y,d=typeof d!="function"&&typeof d!="symbol"&&!!d,r.checked=A?r.checked:!!d,r.defaultChecked=!!d,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(r.name=T)}function wc(r,s,c){s==="number"&&ml(r.ownerDocument)===r||r.defaultValue===""+c||(r.defaultValue=""+c)}function Dr(r,s,c,d){if(r=r.options,s){s={};for(var y=0;y<c.length;y++)s["$"+c[y]]=!0;for(c=0;c<r.length;c++)y=s.hasOwnProperty("$"+r[c].value),r[c].selected!==y&&(r[c].selected=y),y&&d&&(r[c].defaultSelected=!0)}else{for(c=""+yn(c),s=null,y=0;y<r.length;y++){if(r[y].value===c){r[y].selected=!0,d&&(r[y].defaultSelected=!0);return}s!==null||r[y].disabled||(s=r[y])}s!==null&&(s.selected=!0)}}function Jm(r,s,c){if(s!=null&&(s=""+yn(s),s!==r.value&&(r.value=s),c==null)){r.defaultValue!==s&&(r.defaultValue=s);return}r.defaultValue=c!=null?""+yn(c):""}function Ym(r,s,c,d){if(s==null){if(d!=null){if(c!=null)throw Error(i(92));if(Q(d)){if(1<d.length)throw Error(i(93));d=d[0]}c=d}c==null&&(c=""),s=c}c=yn(s),r.defaultValue=c,d=r.textContent,d===c&&d!==""&&d!==null&&(r.value=d)}function Lr(r,s){if(s){var c=r.firstChild;if(c&&c===r.lastChild&&c.nodeType===3){c.nodeValue=s;return}}r.textContent=s}var kb=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Zm(r,s,c){var d=s.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?d?r.setProperty(s,""):s==="float"?r.cssFloat="":r[s]="":d?r.setProperty(s,c):typeof c!="number"||c===0||kb.has(s)?s==="float"?r.cssFloat=c:r[s]=(""+c).trim():r[s]=c+"px"}function Qm(r,s,c){if(s!=null&&typeof s!="object")throw Error(i(62));if(r=r.style,c!=null){for(var d in c)!c.hasOwnProperty(d)||s!=null&&s.hasOwnProperty(d)||(d.indexOf("--")===0?r.setProperty(d,""):d==="float"?r.cssFloat="":r[d]="");for(var y in s)d=s[y],s.hasOwnProperty(y)&&c[y]!==d&&Zm(r,y,d)}else for(var b in s)s.hasOwnProperty(b)&&Zm(r,b,s[b])}function Nc(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Eb=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ab=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function hl(r){return Ab.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}var Sc=null;function Cc(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Pr=null,Or=null;function Km(r){var s=_r(r);if(s&&(r=s.stateNode)){var c=r[Kt]||null;e:switch(r=s.stateNode,s.type){case"input":if(bc(r,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),s=c.name,c.type==="radio"&&s!=null){for(c=r;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+vn(""+s)+'"][type="radio"]'),s=0;s<c.length;s++){var d=c[s];if(d!==r&&d.form===r.form){var y=d[Kt]||null;if(!y)throw Error(i(90));bc(d,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(s=0;s<c.length;s++)d=c[s],d.form===r.form&&Hm(d)}break e;case"textarea":Jm(r,c.value,c.defaultValue);break e;case"select":s=c.value,s!=null&&Dr(r,!!c.multiple,s,!1)}}}var Tc=!1;function Wm(r,s,c){if(Tc)return r(s,c);Tc=!0;try{var d=r(s);return d}finally{if(Tc=!1,(Pr!==null||Or!==null)&&(Xl(),Pr&&(s=Pr,r=Or,Or=Pr=null,Km(s),r)))for(s=0;s<r.length;s++)Km(r[s])}}function $s(r,s){var c=r.stateNode;if(c===null)return null;var d=c[Kt]||null;if(d===null)return null;c=d[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(r=r.type,d=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!d;break e;default:r=!1}if(r)return null;if(c&&typeof c!="function")throw Error(i(231,s,typeof c));return c}var ni=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),jc=!1;if(ni)try{var qs={};Object.defineProperty(qs,"passive",{get:function(){jc=!0}}),window.addEventListener("test",qs,qs),window.removeEventListener("test",qs,qs)}catch{jc=!1}var Ci=null,kc=null,pl=null;function Xm(){if(pl)return pl;var r,s=kc,c=s.length,d,y="value"in Ci?Ci.value:Ci.textContent,b=y.length;for(r=0;r<c&&s[r]===y[r];r++);var T=c-r;for(d=1;d<=T&&s[c-d]===y[b-d];d++);return pl=y.slice(r,1<d?1-d:void 0)}function gl(r){var s=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&s===13&&(r=13)):r=s,r===10&&(r=13),32<=r||r===13?r:0}function xl(){return!0}function eh(){return!1}function Wt(r){function s(c,d,y,b,T){this._reactName=c,this._targetInst=y,this.type=d,this.nativeEvent=b,this.target=T,this.currentTarget=null;for(var A in r)r.hasOwnProperty(A)&&(c=r[A],this[A]=c?c(b):b[A]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?xl:eh,this.isPropagationStopped=eh,this}return x(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=xl)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=xl)},persist:function(){},isPersistent:xl}),s}var tr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},yl=Wt(tr),Fs=x({},tr,{view:0,detail:0}),_b=Wt(Fs),Ec,Ac,Hs,vl=x({},Fs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mc,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Hs&&(Hs&&r.type==="mousemove"?(Ec=r.screenX-Hs.screenX,Ac=r.screenY-Hs.screenY):Ac=Ec=0,Hs=r),Ec)},movementY:function(r){return"movementY"in r?r.movementY:Ac}}),th=Wt(vl),Mb=x({},vl,{dataTransfer:0}),Rb=Wt(Mb),Ib=x({},Fs,{relatedTarget:0}),_c=Wt(Ib),Db=x({},tr,{animationName:0,elapsedTime:0,pseudoElement:0}),Lb=Wt(Db),Pb=x({},tr,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Ob=Wt(Pb),Bb=x({},tr,{data:0}),nh=Wt(Bb),Ub={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},zb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Vb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $b(r){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(r):(r=Vb[r])?!!s[r]:!1}function Mc(){return $b}var qb=x({},Fs,{key:function(r){if(r.key){var s=Ub[r.key]||r.key;if(s!=="Unidentified")return s}return r.type==="keypress"?(r=gl(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?zb[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mc,charCode:function(r){return r.type==="keypress"?gl(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?gl(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Fb=Wt(qb),Hb=x({},vl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ih=Wt(Hb),Gb=x({},Fs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mc}),Jb=Wt(Gb),Yb=x({},tr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Zb=Wt(Yb),Qb=x({},vl,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),Kb=Wt(Qb),Wb=x({},tr,{newState:0,oldState:0}),Xb=Wt(Wb),e2=[9,13,27,32],Rc=ni&&"CompositionEvent"in window,Gs=null;ni&&"documentMode"in document&&(Gs=document.documentMode);var t2=ni&&"TextEvent"in window&&!Gs,rh=ni&&(!Rc||Gs&&8<Gs&&11>=Gs),sh=" ",ah=!1;function lh(r,s){switch(r){case"keyup":return e2.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function oh(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Br=!1;function n2(r,s){switch(r){case"compositionend":return oh(s);case"keypress":return s.which!==32?null:(ah=!0,sh);case"textInput":return r=s.data,r===sh&&ah?null:r;default:return null}}function i2(r,s){if(Br)return r==="compositionend"||!Rc&&lh(r,s)?(r=Xm(),pl=kc=Ci=null,Br=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return rh&&s.locale!=="ko"?null:s.data;default:return null}}var r2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ch(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s==="input"?!!r2[r.type]:s==="textarea"}function uh(r,s,c,d){Pr?Or?Or.push(d):Or=[d]:Pr=d,s=so(s,"onChange"),0<s.length&&(c=new yl("onChange","change",null,c,d),r.push({event:c,listeners:s}))}var Js=null,Ys=null;function s2(r){Fg(r,0)}function bl(r){var s=Vs(r);if(Hm(s))return r}function dh(r,s){if(r==="change")return s}var fh=!1;if(ni){var Ic;if(ni){var Dc="oninput"in document;if(!Dc){var mh=document.createElement("div");mh.setAttribute("oninput","return;"),Dc=typeof mh.oninput=="function"}Ic=Dc}else Ic=!1;fh=Ic&&(!document.documentMode||9<document.documentMode)}function hh(){Js&&(Js.detachEvent("onpropertychange",ph),Ys=Js=null)}function ph(r){if(r.propertyName==="value"&&bl(Ys)){var s=[];uh(s,Ys,r,Cc(r)),Wm(s2,s)}}function a2(r,s,c){r==="focusin"?(hh(),Js=s,Ys=c,Js.attachEvent("onpropertychange",ph)):r==="focusout"&&hh()}function l2(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return bl(Ys)}function o2(r,s){if(r==="click")return bl(s)}function c2(r,s){if(r==="input"||r==="change")return bl(s)}function u2(r,s){return r===s&&(r!==0||1/r===1/s)||r!==r&&s!==s}var on=typeof Object.is=="function"?Object.is:u2;function Zs(r,s){if(on(r,s))return!0;if(typeof r!="object"||r===null||typeof s!="object"||s===null)return!1;var c=Object.keys(r),d=Object.keys(s);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++){var y=c[d];if(!ut.call(s,y)||!on(r[y],s[y]))return!1}return!0}function gh(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function xh(r,s){var c=gh(r);r=0;for(var d;c;){if(c.nodeType===3){if(d=r+c.textContent.length,r<=s&&d>=s)return{node:c,offset:s-r};r=d}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=gh(c)}}function yh(r,s){return r&&s?r===s?!0:r&&r.nodeType===3?!1:s&&s.nodeType===3?yh(r,s.parentNode):"contains"in r?r.contains(s):r.compareDocumentPosition?!!(r.compareDocumentPosition(s)&16):!1:!1}function vh(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var s=ml(r.document);s instanceof r.HTMLIFrameElement;){try{var c=typeof s.contentWindow.location.href=="string"}catch{c=!1}if(c)r=s.contentWindow;else break;s=ml(r.document)}return s}function Lc(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s&&(s==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||s==="textarea"||r.contentEditable==="true")}var d2=ni&&"documentMode"in document&&11>=document.documentMode,Ur=null,Pc=null,Qs=null,Oc=!1;function bh(r,s,c){var d=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Oc||Ur==null||Ur!==ml(d)||(d=Ur,"selectionStart"in d&&Lc(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Qs&&Zs(Qs,d)||(Qs=d,d=so(Pc,"onSelect"),0<d.length&&(s=new yl("onSelect","select",null,s,c),r.push({event:s,listeners:d}),s.target=Ur)))}function nr(r,s){var c={};return c[r.toLowerCase()]=s.toLowerCase(),c["Webkit"+r]="webkit"+s,c["Moz"+r]="moz"+s,c}var zr={animationend:nr("Animation","AnimationEnd"),animationiteration:nr("Animation","AnimationIteration"),animationstart:nr("Animation","AnimationStart"),transitionrun:nr("Transition","TransitionRun"),transitionstart:nr("Transition","TransitionStart"),transitioncancel:nr("Transition","TransitionCancel"),transitionend:nr("Transition","TransitionEnd")},Bc={},wh={};ni&&(wh=document.createElement("div").style,"AnimationEvent"in window||(delete zr.animationend.animation,delete zr.animationiteration.animation,delete zr.animationstart.animation),"TransitionEvent"in window||delete zr.transitionend.transition);function ir(r){if(Bc[r])return Bc[r];if(!zr[r])return r;var s=zr[r],c;for(c in s)if(s.hasOwnProperty(c)&&c in wh)return Bc[r]=s[c];return r}var Nh=ir("animationend"),Sh=ir("animationiteration"),Ch=ir("animationstart"),f2=ir("transitionrun"),m2=ir("transitionstart"),h2=ir("transitioncancel"),Th=ir("transitionend"),jh=new Map,Uc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Uc.push("scrollEnd");function Mn(r,s){jh.set(r,s),er(s,[r])}var kh=new WeakMap;function bn(r,s){if(typeof r=="object"&&r!==null){var c=kh.get(r);return c!==void 0?c:(s={value:r,source:s,stack:qm(s)},kh.set(r,s),s)}return{value:r,source:s,stack:qm(s)}}var wn=[],Vr=0,zc=0;function wl(){for(var r=Vr,s=zc=Vr=0;s<r;){var c=wn[s];wn[s++]=null;var d=wn[s];wn[s++]=null;var y=wn[s];wn[s++]=null;var b=wn[s];if(wn[s++]=null,d!==null&&y!==null){var T=d.pending;T===null?y.next=y:(y.next=T.next,T.next=y),d.pending=y}b!==0&&Eh(c,y,b)}}function Nl(r,s,c,d){wn[Vr++]=r,wn[Vr++]=s,wn[Vr++]=c,wn[Vr++]=d,zc|=d,r.lanes|=d,r=r.alternate,r!==null&&(r.lanes|=d)}function Vc(r,s,c,d){return Nl(r,s,c,d),Sl(r)}function $r(r,s){return Nl(r,null,null,s),Sl(r)}function Eh(r,s,c){r.lanes|=c;var d=r.alternate;d!==null&&(d.lanes|=c);for(var y=!1,b=r.return;b!==null;)b.childLanes|=c,d=b.alternate,d!==null&&(d.childLanes|=c),b.tag===22&&(r=b.stateNode,r===null||r._visibility&1||(y=!0)),r=b,b=b.return;return r.tag===3?(b=r.stateNode,y&&s!==null&&(y=31-oe(c),r=b.hiddenUpdates,d=r[y],d===null?r[y]=[s]:d.push(s),s.lane=c|536870912),b):null}function Sl(r){if(50<wa)throw wa=0,Ju=null,Error(i(185));for(var s=r.return;s!==null;)r=s,s=r.return;return r.tag===3?r.stateNode:null}var qr={};function p2(r,s,c,d){this.tag=r,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function cn(r,s,c,d){return new p2(r,s,c,d)}function $c(r){return r=r.prototype,!(!r||!r.isReactComponent)}function ii(r,s){var c=r.alternate;return c===null?(c=cn(r.tag,s,r.key,r.mode),c.elementType=r.elementType,c.type=r.type,c.stateNode=r.stateNode,c.alternate=r,r.alternate=c):(c.pendingProps=s,c.type=r.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=r.flags&65011712,c.childLanes=r.childLanes,c.lanes=r.lanes,c.child=r.child,c.memoizedProps=r.memoizedProps,c.memoizedState=r.memoizedState,c.updateQueue=r.updateQueue,s=r.dependencies,c.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},c.sibling=r.sibling,c.index=r.index,c.ref=r.ref,c.refCleanup=r.refCleanup,c}function Ah(r,s){r.flags&=65011714;var c=r.alternate;return c===null?(r.childLanes=0,r.lanes=s,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=c.childLanes,r.lanes=c.lanes,r.child=c.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=c.memoizedProps,r.memoizedState=c.memoizedState,r.updateQueue=c.updateQueue,r.type=c.type,s=c.dependencies,r.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),r}function Cl(r,s,c,d,y,b){var T=0;if(d=r,typeof r=="function")$c(r)&&(T=1);else if(typeof r=="string")T=xw(r,c,ve.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case B:return r=cn(31,c,s,y),r.elementType=B,r.lanes=b,r;case C:return rr(c.children,y,b,s);case j:T=8,y|=24;break;case k:return r=cn(12,c,s,y|2),r.elementType=k,r.lanes=b,r;case H:return r=cn(13,c,s,y),r.elementType=H,r.lanes=b,r;case I:return r=cn(19,c,s,y),r.elementType=I,r.lanes=b,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case E:case D:T=10;break e;case L:T=9;break e;case O:T=11;break e;case R:T=14;break e;case q:T=16,d=null;break e}T=29,c=Error(i(130,r===null?"null":typeof r,"")),d=null}return s=cn(T,c,s,y),s.elementType=r,s.type=d,s.lanes=b,s}function rr(r,s,c,d){return r=cn(7,r,d,s),r.lanes=c,r}function qc(r,s,c){return r=cn(6,r,null,s),r.lanes=c,r}function Fc(r,s,c){return s=cn(4,r.children!==null?r.children:[],r.key,s),s.lanes=c,s.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},s}var Fr=[],Hr=0,Tl=null,jl=0,Nn=[],Sn=0,sr=null,ri=1,si="";function ar(r,s){Fr[Hr++]=jl,Fr[Hr++]=Tl,Tl=r,jl=s}function _h(r,s,c){Nn[Sn++]=ri,Nn[Sn++]=si,Nn[Sn++]=sr,sr=r;var d=ri;r=si;var y=32-oe(d)-1;d&=~(1<<y),c+=1;var b=32-oe(s)+y;if(30<b){var T=y-y%5;b=(d&(1<<T)-1).toString(32),d>>=T,y-=T,ri=1<<32-oe(s)+y|c<<y|d,si=b+r}else ri=1<<b|c<<y|d,si=r}function Hc(r){r.return!==null&&(ar(r,1),_h(r,1,0))}function Gc(r){for(;r===Tl;)Tl=Fr[--Hr],Fr[Hr]=null,jl=Fr[--Hr],Fr[Hr]=null;for(;r===sr;)sr=Nn[--Sn],Nn[Sn]=null,si=Nn[--Sn],Nn[Sn]=null,ri=Nn[--Sn],Nn[Sn]=null}var Yt=null,bt=null,et=!1,lr=null,Un=!1,Jc=Error(i(519));function or(r){var s=Error(i(418,""));throw Xs(bn(s,r)),Jc}function Mh(r){var s=r.stateNode,c=r.type,d=r.memoizedProps;switch(s[$t]=r,s[Kt]=d,c){case"dialog":He("cancel",s),He("close",s);break;case"iframe":case"object":case"embed":He("load",s);break;case"video":case"audio":for(c=0;c<Sa.length;c++)He(Sa[c],s);break;case"source":He("error",s);break;case"img":case"image":case"link":He("error",s),He("load",s);break;case"details":He("toggle",s);break;case"input":He("invalid",s),Gm(s,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0),fl(s);break;case"select":He("invalid",s);break;case"textarea":He("invalid",s),Ym(s,d.value,d.defaultValue,d.children),fl(s)}c=d.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||s.textContent===""+c||d.suppressHydrationWarning===!0||Yg(s.textContent,c)?(d.popover!=null&&(He("beforetoggle",s),He("toggle",s)),d.onScroll!=null&&He("scroll",s),d.onScrollEnd!=null&&He("scrollend",s),d.onClick!=null&&(s.onclick=ao),s=!0):s=!1,s||or(r)}function Rh(r){for(Yt=r.return;Yt;)switch(Yt.tag){case 5:case 13:Un=!1;return;case 27:case 3:Un=!0;return;default:Yt=Yt.return}}function Ks(r){if(r!==Yt)return!1;if(!et)return Rh(r),et=!0,!1;var s=r.tag,c;if((c=s!==3&&s!==27)&&((c=s===5)&&(c=r.type,c=!(c!=="form"&&c!=="button")||cd(r.type,r.memoizedProps)),c=!c),c&&bt&&or(r),Rh(r),s===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));e:{for(r=r.nextSibling,s=0;r;){if(r.nodeType===8)if(c=r.data,c==="/$"){if(s===0){bt=In(r.nextSibling);break e}s--}else c!=="$"&&c!=="$!"&&c!=="$?"||s++;r=r.nextSibling}bt=null}}else s===27?(s=bt,zi(r.type)?(r=md,md=null,bt=r):bt=s):bt=Yt?In(r.stateNode.nextSibling):null;return!0}function Ws(){bt=Yt=null,et=!1}function Ih(){var r=lr;return r!==null&&(tn===null?tn=r:tn.push.apply(tn,r),lr=null),r}function Xs(r){lr===null?lr=[r]:lr.push(r)}var Yc=V(null),cr=null,ai=null;function Ti(r,s,c){_(Yc,s._currentValue),s._currentValue=c}function li(r){r._currentValue=Yc.current,ie(Yc)}function Zc(r,s,c){for(;r!==null;){var d=r.alternate;if((r.childLanes&s)!==s?(r.childLanes|=s,d!==null&&(d.childLanes|=s)):d!==null&&(d.childLanes&s)!==s&&(d.childLanes|=s),r===c)break;r=r.return}}function Qc(r,s,c,d){var y=r.child;for(y!==null&&(y.return=r);y!==null;){var b=y.dependencies;if(b!==null){var T=y.child;b=b.firstContext;e:for(;b!==null;){var A=b;b=y;for(var U=0;U<s.length;U++)if(A.context===s[U]){b.lanes|=c,A=b.alternate,A!==null&&(A.lanes|=c),Zc(b.return,c,r),d||(T=null);break e}b=A.next}}else if(y.tag===18){if(T=y.return,T===null)throw Error(i(341));T.lanes|=c,b=T.alternate,b!==null&&(b.lanes|=c),Zc(T,c,r),T=null}else T=y.child;if(T!==null)T.return=y;else for(T=y;T!==null;){if(T===r){T=null;break}if(y=T.sibling,y!==null){y.return=T.return,T=y;break}T=T.return}y=T}}function ea(r,s,c,d){r=null;for(var y=s,b=!1;y!==null;){if(!b){if((y.flags&524288)!==0)b=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var T=y.alternate;if(T===null)throw Error(i(387));if(T=T.memoizedProps,T!==null){var A=y.type;on(y.pendingProps.value,T.value)||(r!==null?r.push(A):r=[A])}}else if(y===he.current){if(T=y.alternate,T===null)throw Error(i(387));T.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(r!==null?r.push(Aa):r=[Aa])}y=y.return}r!==null&&Qc(s,r,c,d),s.flags|=262144}function kl(r){for(r=r.firstContext;r!==null;){if(!on(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function ur(r){cr=r,ai=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function qt(r){return Dh(cr,r)}function El(r,s){return cr===null&&ur(r),Dh(r,s)}function Dh(r,s){var c=s._currentValue;if(s={context:s,memoizedValue:c,next:null},ai===null){if(r===null)throw Error(i(308));ai=s,r.dependencies={lanes:0,firstContext:s},r.flags|=524288}else ai=ai.next=s;return c}var g2=typeof AbortController<"u"?AbortController:function(){var r=[],s=this.signal={aborted:!1,addEventListener:function(c,d){r.push(d)}};this.abort=function(){s.aborted=!0,r.forEach(function(c){return c()})}},x2=t.unstable_scheduleCallback,y2=t.unstable_NormalPriority,At={$$typeof:D,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Kc(){return{controller:new g2,data:new Map,refCount:0}}function ta(r){r.refCount--,r.refCount===0&&x2(y2,function(){r.controller.abort()})}var na=null,Wc=0,Gr=0,Jr=null;function v2(r,s){if(na===null){var c=na=[];Wc=0,Gr=ed(),Jr={status:"pending",value:void 0,then:function(d){c.push(d)}}}return Wc++,s.then(Lh,Lh),s}function Lh(){if(--Wc===0&&na!==null){Jr!==null&&(Jr.status="fulfilled");var r=na;na=null,Gr=0,Jr=null;for(var s=0;s<r.length;s++)(0,r[s])()}}function b2(r,s){var c=[],d={status:"pending",value:null,reason:null,then:function(y){c.push(y)}};return r.then(function(){d.status="fulfilled",d.value=s;for(var y=0;y<c.length;y++)(0,c[y])(s)},function(y){for(d.status="rejected",d.reason=y,y=0;y<c.length;y++)(0,c[y])(void 0)}),d}var Ph=P.S;P.S=function(r,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&v2(r,s),Ph!==null&&Ph(r,s)};var dr=V(null);function Xc(){var r=dr.current;return r!==null?r:dt.pooledCache}function Al(r,s){s===null?_(dr,dr.current):_(dr,s.pool)}function Oh(){var r=Xc();return r===null?null:{parent:At._currentValue,pool:r}}var ia=Error(i(460)),Bh=Error(i(474)),_l=Error(i(542)),eu={then:function(){}};function Uh(r){return r=r.status,r==="fulfilled"||r==="rejected"}function Ml(){}function zh(r,s,c){switch(c=r[c],c===void 0?r.push(s):c!==s&&(s.then(Ml,Ml),s=c),s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,$h(r),r;default:if(typeof s.status=="string")s.then(Ml,Ml);else{if(r=dt,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=s,r.status="pending",r.then(function(d){if(s.status==="pending"){var y=s;y.status="fulfilled",y.value=d}},function(d){if(s.status==="pending"){var y=s;y.status="rejected",y.reason=d}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,$h(r),r}throw ra=s,ia}}var ra=null;function Vh(){if(ra===null)throw Error(i(459));var r=ra;return ra=null,r}function $h(r){if(r===ia||r===_l)throw Error(i(483))}var ji=!1;function tu(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function nu(r,s){r=r.updateQueue,s.updateQueue===r&&(s.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function ki(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function Ei(r,s,c){var d=r.updateQueue;if(d===null)return null;if(d=d.shared,(nt&2)!==0){var y=d.pending;return y===null?s.next=s:(s.next=y.next,y.next=s),d.pending=s,s=Sl(r),Eh(r,null,c),s}return Nl(r,d,s,c),Sl(r)}function sa(r,s,c){if(s=s.updateQueue,s!==null&&(s=s.shared,(c&4194048)!==0)){var d=s.lanes;d&=r.pendingLanes,c|=d,s.lanes=c,Lm(r,c)}}function iu(r,s){var c=r.updateQueue,d=r.alternate;if(d!==null&&(d=d.updateQueue,c===d)){var y=null,b=null;if(c=c.firstBaseUpdate,c!==null){do{var T={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};b===null?y=b=T:b=b.next=T,c=c.next}while(c!==null);b===null?y=b=s:b=b.next=s}else y=b=s;c={baseState:d.baseState,firstBaseUpdate:y,lastBaseUpdate:b,shared:d.shared,callbacks:d.callbacks},r.updateQueue=c;return}r=c.lastBaseUpdate,r===null?c.firstBaseUpdate=s:r.next=s,c.lastBaseUpdate=s}var ru=!1;function aa(){if(ru){var r=Jr;if(r!==null)throw r}}function la(r,s,c,d){ru=!1;var y=r.updateQueue;ji=!1;var b=y.firstBaseUpdate,T=y.lastBaseUpdate,A=y.shared.pending;if(A!==null){y.shared.pending=null;var U=A,re=U.next;U.next=null,T===null?b=re:T.next=re,T=U;var ce=r.alternate;ce!==null&&(ce=ce.updateQueue,A=ce.lastBaseUpdate,A!==T&&(A===null?ce.firstBaseUpdate=re:A.next=re,ce.lastBaseUpdate=U))}if(b!==null){var me=y.baseState;T=0,ce=re=U=null,A=b;do{var ae=A.lane&-536870913,le=ae!==A.lane;if(le?(Ye&ae)===ae:(d&ae)===ae){ae!==0&&ae===Gr&&(ru=!0),ce!==null&&(ce=ce.next={lane:0,tag:A.tag,payload:A.payload,callback:null,next:null});e:{var Me=r,Ae=A;ae=s;var lt=c;switch(Ae.tag){case 1:if(Me=Ae.payload,typeof Me=="function"){me=Me.call(lt,me,ae);break e}me=Me;break e;case 3:Me.flags=Me.flags&-65537|128;case 0:if(Me=Ae.payload,ae=typeof Me=="function"?Me.call(lt,me,ae):Me,ae==null)break e;me=x({},me,ae);break e;case 2:ji=!0}}ae=A.callback,ae!==null&&(r.flags|=64,le&&(r.flags|=8192),le=y.callbacks,le===null?y.callbacks=[ae]:le.push(ae))}else le={lane:ae,tag:A.tag,payload:A.payload,callback:A.callback,next:null},ce===null?(re=ce=le,U=me):ce=ce.next=le,T|=ae;if(A=A.next,A===null){if(A=y.shared.pending,A===null)break;le=A,A=le.next,le.next=null,y.lastBaseUpdate=le,y.shared.pending=null}}while(!0);ce===null&&(U=me),y.baseState=U,y.firstBaseUpdate=re,y.lastBaseUpdate=ce,b===null&&(y.shared.lanes=0),Pi|=T,r.lanes=T,r.memoizedState=me}}function qh(r,s){if(typeof r!="function")throw Error(i(191,r));r.call(s)}function Fh(r,s){var c=r.callbacks;if(c!==null)for(r.callbacks=null,r=0;r<c.length;r++)qh(c[r],s)}var Yr=V(null),Rl=V(0);function Hh(r,s){r=hi,_(Rl,r),_(Yr,s),hi=r|s.baseLanes}function su(){_(Rl,hi),_(Yr,Yr.current)}function au(){hi=Rl.current,ie(Yr),ie(Rl)}var Ai=0,ze=null,st=null,Tt=null,Il=!1,Zr=!1,fr=!1,Dl=0,oa=0,Qr=null,w2=0;function St(){throw Error(i(321))}function lu(r,s){if(s===null)return!1;for(var c=0;c<s.length&&c<r.length;c++)if(!on(r[c],s[c]))return!1;return!0}function ou(r,s,c,d,y,b){return Ai=b,ze=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,P.H=r===null||r.memoizedState===null?Ep:Ap,fr=!1,b=c(d,y),fr=!1,Zr&&(b=Jh(s,c,d,y)),Gh(r),b}function Gh(r){P.H=zl;var s=st!==null&&st.next!==null;if(Ai=0,Tt=st=ze=null,Il=!1,oa=0,Qr=null,s)throw Error(i(300));r===null||Dt||(r=r.dependencies,r!==null&&kl(r)&&(Dt=!0))}function Jh(r,s,c,d){ze=r;var y=0;do{if(Zr&&(Qr=null),oa=0,Zr=!1,25<=y)throw Error(i(301));if(y+=1,Tt=st=null,r.updateQueue!=null){var b=r.updateQueue;b.lastEffect=null,b.events=null,b.stores=null,b.memoCache!=null&&(b.memoCache.index=0)}P.H=E2,b=s(c,d)}while(Zr);return b}function N2(){var r=P.H,s=r.useState()[0];return s=typeof s.then=="function"?ca(s):s,r=r.useState()[0],(st!==null?st.memoizedState:null)!==r&&(ze.flags|=1024),s}function cu(){var r=Dl!==0;return Dl=0,r}function uu(r,s,c){s.updateQueue=r.updateQueue,s.flags&=-2053,r.lanes&=~c}function du(r){if(Il){for(r=r.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Il=!1}Ai=0,Tt=st=ze=null,Zr=!1,oa=Dl=0,Qr=null}function Xt(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Tt===null?ze.memoizedState=Tt=r:Tt=Tt.next=r,Tt}function jt(){if(st===null){var r=ze.alternate;r=r!==null?r.memoizedState:null}else r=st.next;var s=Tt===null?ze.memoizedState:Tt.next;if(s!==null)Tt=s,st=r;else{if(r===null)throw ze.alternate===null?Error(i(467)):Error(i(310));st=r,r={memoizedState:st.memoizedState,baseState:st.baseState,baseQueue:st.baseQueue,queue:st.queue,next:null},Tt===null?ze.memoizedState=Tt=r:Tt=Tt.next=r}return Tt}function fu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ca(r){var s=oa;return oa+=1,Qr===null&&(Qr=[]),r=zh(Qr,r,s),s=ze,(Tt===null?s.memoizedState:Tt.next)===null&&(s=s.alternate,P.H=s===null||s.memoizedState===null?Ep:Ap),r}function Ll(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return ca(r);if(r.$$typeof===D)return qt(r)}throw Error(i(438,String(r)))}function mu(r){var s=null,c=ze.updateQueue;if(c!==null&&(s=c.memoCache),s==null){var d=ze.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(s={data:d.data.map(function(y){return y.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),c===null&&(c=fu(),ze.updateQueue=c),c.memoCache=s,c=s.data[s.index],c===void 0)for(c=s.data[s.index]=Array(r),d=0;d<r;d++)c[d]=ee;return s.index++,c}function oi(r,s){return typeof s=="function"?s(r):s}function Pl(r){var s=jt();return hu(s,st,r)}function hu(r,s,c){var d=r.queue;if(d===null)throw Error(i(311));d.lastRenderedReducer=c;var y=r.baseQueue,b=d.pending;if(b!==null){if(y!==null){var T=y.next;y.next=b.next,b.next=T}s.baseQueue=y=b,d.pending=null}if(b=r.baseState,y===null)r.memoizedState=b;else{s=y.next;var A=T=null,U=null,re=s,ce=!1;do{var me=re.lane&-536870913;if(me!==re.lane?(Ye&me)===me:(Ai&me)===me){var ae=re.revertLane;if(ae===0)U!==null&&(U=U.next={lane:0,revertLane:0,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null}),me===Gr&&(ce=!0);else if((Ai&ae)===ae){re=re.next,ae===Gr&&(ce=!0);continue}else me={lane:0,revertLane:re.revertLane,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null},U===null?(A=U=me,T=b):U=U.next=me,ze.lanes|=ae,Pi|=ae;me=re.action,fr&&c(b,me),b=re.hasEagerState?re.eagerState:c(b,me)}else ae={lane:me,revertLane:re.revertLane,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null},U===null?(A=U=ae,T=b):U=U.next=ae,ze.lanes|=me,Pi|=me;re=re.next}while(re!==null&&re!==s);if(U===null?T=b:U.next=A,!on(b,r.memoizedState)&&(Dt=!0,ce&&(c=Jr,c!==null)))throw c;r.memoizedState=b,r.baseState=T,r.baseQueue=U,d.lastRenderedState=b}return y===null&&(d.lanes=0),[r.memoizedState,d.dispatch]}function pu(r){var s=jt(),c=s.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=r;var d=c.dispatch,y=c.pending,b=s.memoizedState;if(y!==null){c.pending=null;var T=y=y.next;do b=r(b,T.action),T=T.next;while(T!==y);on(b,s.memoizedState)||(Dt=!0),s.memoizedState=b,s.baseQueue===null&&(s.baseState=b),c.lastRenderedState=b}return[b,d]}function Yh(r,s,c){var d=ze,y=jt(),b=et;if(b){if(c===void 0)throw Error(i(407));c=c()}else c=s();var T=!on((st||y).memoizedState,c);T&&(y.memoizedState=c,Dt=!0),y=y.queue;var A=Kh.bind(null,d,y,r);if(ua(2048,8,A,[r]),y.getSnapshot!==s||T||Tt!==null&&Tt.memoizedState.tag&1){if(d.flags|=2048,Kr(9,Ol(),Qh.bind(null,d,y,c,s),null),dt===null)throw Error(i(349));b||(Ai&124)!==0||Zh(d,s,c)}return c}function Zh(r,s,c){r.flags|=16384,r={getSnapshot:s,value:c},s=ze.updateQueue,s===null?(s=fu(),ze.updateQueue=s,s.stores=[r]):(c=s.stores,c===null?s.stores=[r]:c.push(r))}function Qh(r,s,c,d){s.value=c,s.getSnapshot=d,Wh(s)&&Xh(r)}function Kh(r,s,c){return c(function(){Wh(s)&&Xh(r)})}function Wh(r){var s=r.getSnapshot;r=r.value;try{var c=s();return!on(r,c)}catch{return!0}}function Xh(r){var s=$r(r,2);s!==null&&hn(s,r,2)}function gu(r){var s=Xt();if(typeof r=="function"){var c=r;if(r=c(),fr){J(!0);try{c()}finally{J(!1)}}}return s.memoizedState=s.baseState=r,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:oi,lastRenderedState:r},s}function ep(r,s,c,d){return r.baseState=c,hu(r,st,typeof d=="function"?d:oi)}function S2(r,s,c,d,y){if(Ul(r))throw Error(i(485));if(r=s.action,r!==null){var b={payload:y,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){b.listeners.push(T)}};P.T!==null?c(!0):b.isTransition=!1,d(b),c=s.pending,c===null?(b.next=s.pending=b,tp(s,b)):(b.next=c.next,s.pending=c.next=b)}}function tp(r,s){var c=s.action,d=s.payload,y=r.state;if(s.isTransition){var b=P.T,T={};P.T=T;try{var A=c(y,d),U=P.S;U!==null&&U(T,A),np(r,s,A)}catch(re){xu(r,s,re)}finally{P.T=b}}else try{b=c(y,d),np(r,s,b)}catch(re){xu(r,s,re)}}function np(r,s,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(d){ip(r,s,d)},function(d){return xu(r,s,d)}):ip(r,s,c)}function ip(r,s,c){s.status="fulfilled",s.value=c,rp(s),r.state=c,s=r.pending,s!==null&&(c=s.next,c===s?r.pending=null:(c=c.next,s.next=c,tp(r,c)))}function xu(r,s,c){var d=r.pending;if(r.pending=null,d!==null){d=d.next;do s.status="rejected",s.reason=c,rp(s),s=s.next;while(s!==d)}r.action=null}function rp(r){r=r.listeners;for(var s=0;s<r.length;s++)(0,r[s])()}function sp(r,s){return s}function ap(r,s){if(et){var c=dt.formState;if(c!==null){e:{var d=ze;if(et){if(bt){t:{for(var y=bt,b=Un;y.nodeType!==8;){if(!b){y=null;break t}if(y=In(y.nextSibling),y===null){y=null;break t}}b=y.data,y=b==="F!"||b==="F"?y:null}if(y){bt=In(y.nextSibling),d=y.data==="F!";break e}}or(d)}d=!1}d&&(s=c[0])}}return c=Xt(),c.memoizedState=c.baseState=s,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:sp,lastRenderedState:s},c.queue=d,c=Tp.bind(null,ze,d),d.dispatch=c,d=gu(!1),b=Nu.bind(null,ze,!1,d.queue),d=Xt(),y={state:s,dispatch:null,action:r,pending:null},d.queue=y,c=S2.bind(null,ze,y,b,c),y.dispatch=c,d.memoizedState=r,[s,c,!1]}function lp(r){var s=jt();return op(s,st,r)}function op(r,s,c){if(s=hu(r,s,sp)[0],r=Pl(oi)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var d=ca(s)}catch(T){throw T===ia?_l:T}else d=s;s=jt();var y=s.queue,b=y.dispatch;return c!==s.memoizedState&&(ze.flags|=2048,Kr(9,Ol(),C2.bind(null,y,c),null)),[d,b,r]}function C2(r,s){r.action=s}function cp(r){var s=jt(),c=st;if(c!==null)return op(s,c,r);jt(),s=s.memoizedState,c=jt();var d=c.queue.dispatch;return c.memoizedState=r,[s,d,!1]}function Kr(r,s,c,d){return r={tag:r,create:c,deps:d,inst:s,next:null},s=ze.updateQueue,s===null&&(s=fu(),ze.updateQueue=s),c=s.lastEffect,c===null?s.lastEffect=r.next=r:(d=c.next,c.next=r,r.next=d,s.lastEffect=r),r}function Ol(){return{destroy:void 0,resource:void 0}}function up(){return jt().memoizedState}function Bl(r,s,c,d){var y=Xt();d=d===void 0?null:d,ze.flags|=r,y.memoizedState=Kr(1|s,Ol(),c,d)}function ua(r,s,c,d){var y=jt();d=d===void 0?null:d;var b=y.memoizedState.inst;st!==null&&d!==null&&lu(d,st.memoizedState.deps)?y.memoizedState=Kr(s,b,c,d):(ze.flags|=r,y.memoizedState=Kr(1|s,b,c,d))}function dp(r,s){Bl(8390656,8,r,s)}function fp(r,s){ua(2048,8,r,s)}function mp(r,s){return ua(4,2,r,s)}function hp(r,s){return ua(4,4,r,s)}function pp(r,s){if(typeof s=="function"){r=r();var c=s(r);return function(){typeof c=="function"?c():s(null)}}if(s!=null)return r=r(),s.current=r,function(){s.current=null}}function gp(r,s,c){c=c!=null?c.concat([r]):null,ua(4,4,pp.bind(null,s,r),c)}function yu(){}function xp(r,s){var c=jt();s=s===void 0?null:s;var d=c.memoizedState;return s!==null&&lu(s,d[1])?d[0]:(c.memoizedState=[r,s],r)}function yp(r,s){var c=jt();s=s===void 0?null:s;var d=c.memoizedState;if(s!==null&&lu(s,d[1]))return d[0];if(d=r(),fr){J(!0);try{r()}finally{J(!1)}}return c.memoizedState=[d,s],d}function vu(r,s,c){return c===void 0||(Ai&1073741824)!==0?r.memoizedState=s:(r.memoizedState=c,r=wg(),ze.lanes|=r,Pi|=r,c)}function vp(r,s,c,d){return on(c,s)?c:Yr.current!==null?(r=vu(r,c,d),on(r,s)||(Dt=!0),r):(Ai&42)===0?(Dt=!0,r.memoizedState=c):(r=wg(),ze.lanes|=r,Pi|=r,s)}function bp(r,s,c,d,y){var b=K.p;K.p=b!==0&&8>b?b:8;var T=P.T,A={};P.T=A,Nu(r,!1,s,c);try{var U=y(),re=P.S;if(re!==null&&re(A,U),U!==null&&typeof U=="object"&&typeof U.then=="function"){var ce=b2(U,d);da(r,s,ce,mn(r))}else da(r,s,d,mn(r))}catch(me){da(r,s,{then:function(){},status:"rejected",reason:me},mn())}finally{K.p=b,P.T=T}}function T2(){}function bu(r,s,c,d){if(r.tag!==5)throw Error(i(476));var y=wp(r).queue;bp(r,y,s,pe,c===null?T2:function(){return Np(r),c(d)})}function wp(r){var s=r.memoizedState;if(s!==null)return s;s={memoizedState:pe,baseState:pe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:oi,lastRenderedState:pe},next:null};var c={};return s.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:oi,lastRenderedState:c},next:null},r.memoizedState=s,r=r.alternate,r!==null&&(r.memoizedState=s),s}function Np(r){var s=wp(r).next.queue;da(r,s,{},mn())}function wu(){return qt(Aa)}function Sp(){return jt().memoizedState}function Cp(){return jt().memoizedState}function j2(r){for(var s=r.return;s!==null;){switch(s.tag){case 24:case 3:var c=mn();r=ki(c);var d=Ei(s,r,c);d!==null&&(hn(d,s,c),sa(d,s,c)),s={cache:Kc()},r.payload=s;return}s=s.return}}function k2(r,s,c){var d=mn();c={lane:d,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},Ul(r)?jp(s,c):(c=Vc(r,s,c,d),c!==null&&(hn(c,r,d),kp(c,s,d)))}function Tp(r,s,c){var d=mn();da(r,s,c,d)}function da(r,s,c,d){var y={lane:d,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(Ul(r))jp(s,y);else{var b=r.alternate;if(r.lanes===0&&(b===null||b.lanes===0)&&(b=s.lastRenderedReducer,b!==null))try{var T=s.lastRenderedState,A=b(T,c);if(y.hasEagerState=!0,y.eagerState=A,on(A,T))return Nl(r,s,y,0),dt===null&&wl(),!1}catch{}finally{}if(c=Vc(r,s,y,d),c!==null)return hn(c,r,d),kp(c,s,d),!0}return!1}function Nu(r,s,c,d){if(d={lane:2,revertLane:ed(),action:d,hasEagerState:!1,eagerState:null,next:null},Ul(r)){if(s)throw Error(i(479))}else s=Vc(r,c,d,2),s!==null&&hn(s,r,2)}function Ul(r){var s=r.alternate;return r===ze||s!==null&&s===ze}function jp(r,s){Zr=Il=!0;var c=r.pending;c===null?s.next=s:(s.next=c.next,c.next=s),r.pending=s}function kp(r,s,c){if((c&4194048)!==0){var d=s.lanes;d&=r.pendingLanes,c|=d,s.lanes=c,Lm(r,c)}}var zl={readContext:qt,use:Ll,useCallback:St,useContext:St,useEffect:St,useImperativeHandle:St,useLayoutEffect:St,useInsertionEffect:St,useMemo:St,useReducer:St,useRef:St,useState:St,useDebugValue:St,useDeferredValue:St,useTransition:St,useSyncExternalStore:St,useId:St,useHostTransitionStatus:St,useFormState:St,useActionState:St,useOptimistic:St,useMemoCache:St,useCacheRefresh:St},Ep={readContext:qt,use:Ll,useCallback:function(r,s){return Xt().memoizedState=[r,s===void 0?null:s],r},useContext:qt,useEffect:dp,useImperativeHandle:function(r,s,c){c=c!=null?c.concat([r]):null,Bl(4194308,4,pp.bind(null,s,r),c)},useLayoutEffect:function(r,s){return Bl(4194308,4,r,s)},useInsertionEffect:function(r,s){Bl(4,2,r,s)},useMemo:function(r,s){var c=Xt();s=s===void 0?null:s;var d=r();if(fr){J(!0);try{r()}finally{J(!1)}}return c.memoizedState=[d,s],d},useReducer:function(r,s,c){var d=Xt();if(c!==void 0){var y=c(s);if(fr){J(!0);try{c(s)}finally{J(!1)}}}else y=s;return d.memoizedState=d.baseState=y,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:y},d.queue=r,r=r.dispatch=k2.bind(null,ze,r),[d.memoizedState,r]},useRef:function(r){var s=Xt();return r={current:r},s.memoizedState=r},useState:function(r){r=gu(r);var s=r.queue,c=Tp.bind(null,ze,s);return s.dispatch=c,[r.memoizedState,c]},useDebugValue:yu,useDeferredValue:function(r,s){var c=Xt();return vu(c,r,s)},useTransition:function(){var r=gu(!1);return r=bp.bind(null,ze,r.queue,!0,!1),Xt().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,s,c){var d=ze,y=Xt();if(et){if(c===void 0)throw Error(i(407));c=c()}else{if(c=s(),dt===null)throw Error(i(349));(Ye&124)!==0||Zh(d,s,c)}y.memoizedState=c;var b={value:c,getSnapshot:s};return y.queue=b,dp(Kh.bind(null,d,b,r),[r]),d.flags|=2048,Kr(9,Ol(),Qh.bind(null,d,b,c,s),null),c},useId:function(){var r=Xt(),s=dt.identifierPrefix;if(et){var c=si,d=ri;c=(d&~(1<<32-oe(d)-1)).toString(32)+c,s="«"+s+"R"+c,c=Dl++,0<c&&(s+="H"+c.toString(32)),s+="»"}else c=w2++,s="«"+s+"r"+c.toString(32)+"»";return r.memoizedState=s},useHostTransitionStatus:wu,useFormState:ap,useActionState:ap,useOptimistic:function(r){var s=Xt();s.memoizedState=s.baseState=r;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=c,s=Nu.bind(null,ze,!0,c),c.dispatch=s,[r,s]},useMemoCache:mu,useCacheRefresh:function(){return Xt().memoizedState=j2.bind(null,ze)}},Ap={readContext:qt,use:Ll,useCallback:xp,useContext:qt,useEffect:fp,useImperativeHandle:gp,useInsertionEffect:mp,useLayoutEffect:hp,useMemo:yp,useReducer:Pl,useRef:up,useState:function(){return Pl(oi)},useDebugValue:yu,useDeferredValue:function(r,s){var c=jt();return vp(c,st.memoizedState,r,s)},useTransition:function(){var r=Pl(oi)[0],s=jt().memoizedState;return[typeof r=="boolean"?r:ca(r),s]},useSyncExternalStore:Yh,useId:Sp,useHostTransitionStatus:wu,useFormState:lp,useActionState:lp,useOptimistic:function(r,s){var c=jt();return ep(c,st,r,s)},useMemoCache:mu,useCacheRefresh:Cp},E2={readContext:qt,use:Ll,useCallback:xp,useContext:qt,useEffect:fp,useImperativeHandle:gp,useInsertionEffect:mp,useLayoutEffect:hp,useMemo:yp,useReducer:pu,useRef:up,useState:function(){return pu(oi)},useDebugValue:yu,useDeferredValue:function(r,s){var c=jt();return st===null?vu(c,r,s):vp(c,st.memoizedState,r,s)},useTransition:function(){var r=pu(oi)[0],s=jt().memoizedState;return[typeof r=="boolean"?r:ca(r),s]},useSyncExternalStore:Yh,useId:Sp,useHostTransitionStatus:wu,useFormState:cp,useActionState:cp,useOptimistic:function(r,s){var c=jt();return st!==null?ep(c,st,r,s):(c.baseState=r,[r,c.queue.dispatch])},useMemoCache:mu,useCacheRefresh:Cp},Wr=null,fa=0;function Vl(r){var s=fa;return fa+=1,Wr===null&&(Wr=[]),zh(Wr,r,s)}function ma(r,s){s=s.props.ref,r.ref=s!==void 0?s:null}function $l(r,s){throw s.$$typeof===v?Error(i(525)):(r=Object.prototype.toString.call(s),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":r)))}function _p(r){var s=r._init;return s(r._payload)}function Mp(r){function s(W,F){if(r){var ne=W.deletions;ne===null?(W.deletions=[F],W.flags|=16):ne.push(F)}}function c(W,F){if(!r)return null;for(;F!==null;)s(W,F),F=F.sibling;return null}function d(W){for(var F=new Map;W!==null;)W.key!==null?F.set(W.key,W):F.set(W.index,W),W=W.sibling;return F}function y(W,F){return W=ii(W,F),W.index=0,W.sibling=null,W}function b(W,F,ne){return W.index=ne,r?(ne=W.alternate,ne!==null?(ne=ne.index,ne<F?(W.flags|=67108866,F):ne):(W.flags|=67108866,F)):(W.flags|=1048576,F)}function T(W){return r&&W.alternate===null&&(W.flags|=67108866),W}function A(W,F,ne,ue){return F===null||F.tag!==6?(F=qc(ne,W.mode,ue),F.return=W,F):(F=y(F,ne),F.return=W,F)}function U(W,F,ne,ue){var Ce=ne.type;return Ce===C?ce(W,F,ne.props.children,ue,ne.key):F!==null&&(F.elementType===Ce||typeof Ce=="object"&&Ce!==null&&Ce.$$typeof===q&&_p(Ce)===F.type)?(F=y(F,ne.props),ma(F,ne),F.return=W,F):(F=Cl(ne.type,ne.key,ne.props,null,W.mode,ue),ma(F,ne),F.return=W,F)}function re(W,F,ne,ue){return F===null||F.tag!==4||F.stateNode.containerInfo!==ne.containerInfo||F.stateNode.implementation!==ne.implementation?(F=Fc(ne,W.mode,ue),F.return=W,F):(F=y(F,ne.children||[]),F.return=W,F)}function ce(W,F,ne,ue,Ce){return F===null||F.tag!==7?(F=rr(ne,W.mode,ue,Ce),F.return=W,F):(F=y(F,ne),F.return=W,F)}function me(W,F,ne){if(typeof F=="string"&&F!==""||typeof F=="number"||typeof F=="bigint")return F=qc(""+F,W.mode,ne),F.return=W,F;if(typeof F=="object"&&F!==null){switch(F.$$typeof){case N:return ne=Cl(F.type,F.key,F.props,null,W.mode,ne),ma(ne,F),ne.return=W,ne;case w:return F=Fc(F,W.mode,ne),F.return=W,F;case q:var ue=F._init;return F=ue(F._payload),me(W,F,ne)}if(Q(F)||Y(F))return F=rr(F,W.mode,ne,null),F.return=W,F;if(typeof F.then=="function")return me(W,Vl(F),ne);if(F.$$typeof===D)return me(W,El(W,F),ne);$l(W,F)}return null}function ae(W,F,ne,ue){var Ce=F!==null?F.key:null;if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return Ce!==null?null:A(W,F,""+ne,ue);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case N:return ne.key===Ce?U(W,F,ne,ue):null;case w:return ne.key===Ce?re(W,F,ne,ue):null;case q:return Ce=ne._init,ne=Ce(ne._payload),ae(W,F,ne,ue)}if(Q(ne)||Y(ne))return Ce!==null?null:ce(W,F,ne,ue,null);if(typeof ne.then=="function")return ae(W,F,Vl(ne),ue);if(ne.$$typeof===D)return ae(W,F,El(W,ne),ue);$l(W,ne)}return null}function le(W,F,ne,ue,Ce){if(typeof ue=="string"&&ue!==""||typeof ue=="number"||typeof ue=="bigint")return W=W.get(ne)||null,A(F,W,""+ue,Ce);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case N:return W=W.get(ue.key===null?ne:ue.key)||null,U(F,W,ue,Ce);case w:return W=W.get(ue.key===null?ne:ue.key)||null,re(F,W,ue,Ce);case q:var qe=ue._init;return ue=qe(ue._payload),le(W,F,ne,ue,Ce)}if(Q(ue)||Y(ue))return W=W.get(ne)||null,ce(F,W,ue,Ce,null);if(typeof ue.then=="function")return le(W,F,ne,Vl(ue),Ce);if(ue.$$typeof===D)return le(W,F,ne,El(F,ue),Ce);$l(F,ue)}return null}function Me(W,F,ne,ue){for(var Ce=null,qe=null,ke=F,_e=F=0,Pt=null;ke!==null&&_e<ne.length;_e++){ke.index>_e?(Pt=ke,ke=null):Pt=ke.sibling;var We=ae(W,ke,ne[_e],ue);if(We===null){ke===null&&(ke=Pt);break}r&&ke&&We.alternate===null&&s(W,ke),F=b(We,F,_e),qe===null?Ce=We:qe.sibling=We,qe=We,ke=Pt}if(_e===ne.length)return c(W,ke),et&&ar(W,_e),Ce;if(ke===null){for(;_e<ne.length;_e++)ke=me(W,ne[_e],ue),ke!==null&&(F=b(ke,F,_e),qe===null?Ce=ke:qe.sibling=ke,qe=ke);return et&&ar(W,_e),Ce}for(ke=d(ke);_e<ne.length;_e++)Pt=le(ke,W,_e,ne[_e],ue),Pt!==null&&(r&&Pt.alternate!==null&&ke.delete(Pt.key===null?_e:Pt.key),F=b(Pt,F,_e),qe===null?Ce=Pt:qe.sibling=Pt,qe=Pt);return r&&ke.forEach(function(Hi){return s(W,Hi)}),et&&ar(W,_e),Ce}function Ae(W,F,ne,ue){if(ne==null)throw Error(i(151));for(var Ce=null,qe=null,ke=F,_e=F=0,Pt=null,We=ne.next();ke!==null&&!We.done;_e++,We=ne.next()){ke.index>_e?(Pt=ke,ke=null):Pt=ke.sibling;var Hi=ae(W,ke,We.value,ue);if(Hi===null){ke===null&&(ke=Pt);break}r&&ke&&Hi.alternate===null&&s(W,ke),F=b(Hi,F,_e),qe===null?Ce=Hi:qe.sibling=Hi,qe=Hi,ke=Pt}if(We.done)return c(W,ke),et&&ar(W,_e),Ce;if(ke===null){for(;!We.done;_e++,We=ne.next())We=me(W,We.value,ue),We!==null&&(F=b(We,F,_e),qe===null?Ce=We:qe.sibling=We,qe=We);return et&&ar(W,_e),Ce}for(ke=d(ke);!We.done;_e++,We=ne.next())We=le(ke,W,_e,We.value,ue),We!==null&&(r&&We.alternate!==null&&ke.delete(We.key===null?_e:We.key),F=b(We,F,_e),qe===null?Ce=We:qe.sibling=We,qe=We);return r&&ke.forEach(function(Aw){return s(W,Aw)}),et&&ar(W,_e),Ce}function lt(W,F,ne,ue){if(typeof ne=="object"&&ne!==null&&ne.type===C&&ne.key===null&&(ne=ne.props.children),typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case N:e:{for(var Ce=ne.key;F!==null;){if(F.key===Ce){if(Ce=ne.type,Ce===C){if(F.tag===7){c(W,F.sibling),ue=y(F,ne.props.children),ue.return=W,W=ue;break e}}else if(F.elementType===Ce||typeof Ce=="object"&&Ce!==null&&Ce.$$typeof===q&&_p(Ce)===F.type){c(W,F.sibling),ue=y(F,ne.props),ma(ue,ne),ue.return=W,W=ue;break e}c(W,F);break}else s(W,F);F=F.sibling}ne.type===C?(ue=rr(ne.props.children,W.mode,ue,ne.key),ue.return=W,W=ue):(ue=Cl(ne.type,ne.key,ne.props,null,W.mode,ue),ma(ue,ne),ue.return=W,W=ue)}return T(W);case w:e:{for(Ce=ne.key;F!==null;){if(F.key===Ce)if(F.tag===4&&F.stateNode.containerInfo===ne.containerInfo&&F.stateNode.implementation===ne.implementation){c(W,F.sibling),ue=y(F,ne.children||[]),ue.return=W,W=ue;break e}else{c(W,F);break}else s(W,F);F=F.sibling}ue=Fc(ne,W.mode,ue),ue.return=W,W=ue}return T(W);case q:return Ce=ne._init,ne=Ce(ne._payload),lt(W,F,ne,ue)}if(Q(ne))return Me(W,F,ne,ue);if(Y(ne)){if(Ce=Y(ne),typeof Ce!="function")throw Error(i(150));return ne=Ce.call(ne),Ae(W,F,ne,ue)}if(typeof ne.then=="function")return lt(W,F,Vl(ne),ue);if(ne.$$typeof===D)return lt(W,F,El(W,ne),ue);$l(W,ne)}return typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint"?(ne=""+ne,F!==null&&F.tag===6?(c(W,F.sibling),ue=y(F,ne),ue.return=W,W=ue):(c(W,F),ue=qc(ne,W.mode,ue),ue.return=W,W=ue),T(W)):c(W,F)}return function(W,F,ne,ue){try{fa=0;var Ce=lt(W,F,ne,ue);return Wr=null,Ce}catch(ke){if(ke===ia||ke===_l)throw ke;var qe=cn(29,ke,null,W.mode);return qe.lanes=ue,qe.return=W,qe}finally{}}}var Xr=Mp(!0),Rp=Mp(!1),Cn=V(null),zn=null;function _i(r){var s=r.alternate;_(_t,_t.current&1),_(Cn,r),zn===null&&(s===null||Yr.current!==null||s.memoizedState!==null)&&(zn=r)}function Ip(r){if(r.tag===22){if(_(_t,_t.current),_(Cn,r),zn===null){var s=r.alternate;s!==null&&s.memoizedState!==null&&(zn=r)}}else Mi()}function Mi(){_(_t,_t.current),_(Cn,Cn.current)}function ci(r){ie(Cn),zn===r&&(zn=null),ie(_t)}var _t=V(0);function ql(r){for(var s=r;s!==null;){if(s.tag===13){var c=s.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||fd(c)))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}function Su(r,s,c,d){s=r.memoizedState,c=c(d,s),c=c==null?s:x({},s,c),r.memoizedState=c,r.lanes===0&&(r.updateQueue.baseState=c)}var Cu={enqueueSetState:function(r,s,c){r=r._reactInternals;var d=mn(),y=ki(d);y.payload=s,c!=null&&(y.callback=c),s=Ei(r,y,d),s!==null&&(hn(s,r,d),sa(s,r,d))},enqueueReplaceState:function(r,s,c){r=r._reactInternals;var d=mn(),y=ki(d);y.tag=1,y.payload=s,c!=null&&(y.callback=c),s=Ei(r,y,d),s!==null&&(hn(s,r,d),sa(s,r,d))},enqueueForceUpdate:function(r,s){r=r._reactInternals;var c=mn(),d=ki(c);d.tag=2,s!=null&&(d.callback=s),s=Ei(r,d,c),s!==null&&(hn(s,r,c),sa(s,r,c))}};function Dp(r,s,c,d,y,b,T){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(d,b,T):s.prototype&&s.prototype.isPureReactComponent?!Zs(c,d)||!Zs(y,b):!0}function Lp(r,s,c,d){r=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(c,d),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(c,d),s.state!==r&&Cu.enqueueReplaceState(s,s.state,null)}function mr(r,s){var c=s;if("ref"in s){c={};for(var d in s)d!=="ref"&&(c[d]=s[d])}if(r=r.defaultProps){c===s&&(c=x({},c));for(var y in r)c[y]===void 0&&(c[y]=r[y])}return c}var Fl=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)};function Pp(r){Fl(r)}function Op(r){console.error(r)}function Bp(r){Fl(r)}function Hl(r,s){try{var c=r.onUncaughtError;c(s.value,{componentStack:s.stack})}catch(d){setTimeout(function(){throw d})}}function Up(r,s,c){try{var d=r.onCaughtError;d(c.value,{componentStack:c.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function Tu(r,s,c){return c=ki(c),c.tag=3,c.payload={element:null},c.callback=function(){Hl(r,s)},c}function zp(r){return r=ki(r),r.tag=3,r}function Vp(r,s,c,d){var y=c.type.getDerivedStateFromError;if(typeof y=="function"){var b=d.value;r.payload=function(){return y(b)},r.callback=function(){Up(s,c,d)}}var T=c.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(r.callback=function(){Up(s,c,d),typeof y!="function"&&(Oi===null?Oi=new Set([this]):Oi.add(this));var A=d.stack;this.componentDidCatch(d.value,{componentStack:A!==null?A:""})})}function A2(r,s,c,d,y){if(c.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(s=c.alternate,s!==null&&ea(s,c,y,!0),c=Cn.current,c!==null){switch(c.tag){case 13:return zn===null?Zu():c.alternate===null&&wt===0&&(wt=3),c.flags&=-257,c.flags|=65536,c.lanes=y,d===eu?c.flags|=16384:(s=c.updateQueue,s===null?c.updateQueue=new Set([d]):s.add(d),Ku(r,d,y)),!1;case 22:return c.flags|=65536,d===eu?c.flags|=16384:(s=c.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([d])},c.updateQueue=s):(c=s.retryQueue,c===null?s.retryQueue=new Set([d]):c.add(d)),Ku(r,d,y)),!1}throw Error(i(435,c.tag))}return Ku(r,d,y),Zu(),!1}if(et)return s=Cn.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=y,d!==Jc&&(r=Error(i(422),{cause:d}),Xs(bn(r,c)))):(d!==Jc&&(s=Error(i(423),{cause:d}),Xs(bn(s,c))),r=r.current.alternate,r.flags|=65536,y&=-y,r.lanes|=y,d=bn(d,c),y=Tu(r.stateNode,d,y),iu(r,y),wt!==4&&(wt=2)),!1;var b=Error(i(520),{cause:d});if(b=bn(b,c),ba===null?ba=[b]:ba.push(b),wt!==4&&(wt=2),s===null)return!0;d=bn(d,c),c=s;do{switch(c.tag){case 3:return c.flags|=65536,r=y&-y,c.lanes|=r,r=Tu(c.stateNode,d,r),iu(c,r),!1;case 1:if(s=c.type,b=c.stateNode,(c.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Oi===null||!Oi.has(b))))return c.flags|=65536,y&=-y,c.lanes|=y,y=zp(y),Vp(y,r,c,d),iu(c,y),!1}c=c.return}while(c!==null);return!1}var $p=Error(i(461)),Dt=!1;function Ot(r,s,c,d){s.child=r===null?Rp(s,null,c,d):Xr(s,r.child,c,d)}function qp(r,s,c,d,y){c=c.render;var b=s.ref;if("ref"in d){var T={};for(var A in d)A!=="ref"&&(T[A]=d[A])}else T=d;return ur(s),d=ou(r,s,c,T,b,y),A=cu(),r!==null&&!Dt?(uu(r,s,y),ui(r,s,y)):(et&&A&&Hc(s),s.flags|=1,Ot(r,s,d,y),s.child)}function Fp(r,s,c,d,y){if(r===null){var b=c.type;return typeof b=="function"&&!$c(b)&&b.defaultProps===void 0&&c.compare===null?(s.tag=15,s.type=b,Hp(r,s,b,d,y)):(r=Cl(c.type,null,d,s,s.mode,y),r.ref=s.ref,r.return=s,s.child=r)}if(b=r.child,!Iu(r,y)){var T=b.memoizedProps;if(c=c.compare,c=c!==null?c:Zs,c(T,d)&&r.ref===s.ref)return ui(r,s,y)}return s.flags|=1,r=ii(b,d),r.ref=s.ref,r.return=s,s.child=r}function Hp(r,s,c,d,y){if(r!==null){var b=r.memoizedProps;if(Zs(b,d)&&r.ref===s.ref)if(Dt=!1,s.pendingProps=d=b,Iu(r,y))(r.flags&131072)!==0&&(Dt=!0);else return s.lanes=r.lanes,ui(r,s,y)}return ju(r,s,c,d,y)}function Gp(r,s,c){var d=s.pendingProps,y=d.children,b=r!==null?r.memoizedState:null;if(d.mode==="hidden"){if((s.flags&128)!==0){if(d=b!==null?b.baseLanes|c:c,r!==null){for(y=s.child=r.child,b=0;y!==null;)b=b|y.lanes|y.childLanes,y=y.sibling;s.childLanes=b&~d}else s.childLanes=0,s.child=null;return Jp(r,s,d,c)}if((c&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},r!==null&&Al(s,b!==null?b.cachePool:null),b!==null?Hh(s,b):su(),Ip(s);else return s.lanes=s.childLanes=536870912,Jp(r,s,b!==null?b.baseLanes|c:c,c)}else b!==null?(Al(s,b.cachePool),Hh(s,b),Mi(),s.memoizedState=null):(r!==null&&Al(s,null),su(),Mi());return Ot(r,s,y,c),s.child}function Jp(r,s,c,d){var y=Xc();return y=y===null?null:{parent:At._currentValue,pool:y},s.memoizedState={baseLanes:c,cachePool:y},r!==null&&Al(s,null),su(),Ip(s),r!==null&&ea(r,s,d,!0),null}function Gl(r,s){var c=s.ref;if(c===null)r!==null&&r.ref!==null&&(s.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(i(284));(r===null||r.ref!==c)&&(s.flags|=4194816)}}function ju(r,s,c,d,y){return ur(s),c=ou(r,s,c,d,void 0,y),d=cu(),r!==null&&!Dt?(uu(r,s,y),ui(r,s,y)):(et&&d&&Hc(s),s.flags|=1,Ot(r,s,c,y),s.child)}function Yp(r,s,c,d,y,b){return ur(s),s.updateQueue=null,c=Jh(s,d,c,y),Gh(r),d=cu(),r!==null&&!Dt?(uu(r,s,b),ui(r,s,b)):(et&&d&&Hc(s),s.flags|=1,Ot(r,s,c,b),s.child)}function Zp(r,s,c,d,y){if(ur(s),s.stateNode===null){var b=qr,T=c.contextType;typeof T=="object"&&T!==null&&(b=qt(T)),b=new c(d,b),s.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,b.updater=Cu,s.stateNode=b,b._reactInternals=s,b=s.stateNode,b.props=d,b.state=s.memoizedState,b.refs={},tu(s),T=c.contextType,b.context=typeof T=="object"&&T!==null?qt(T):qr,b.state=s.memoizedState,T=c.getDerivedStateFromProps,typeof T=="function"&&(Su(s,c,T,d),b.state=s.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(T=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),T!==b.state&&Cu.enqueueReplaceState(b,b.state,null),la(s,d,b,y),aa(),b.state=s.memoizedState),typeof b.componentDidMount=="function"&&(s.flags|=4194308),d=!0}else if(r===null){b=s.stateNode;var A=s.memoizedProps,U=mr(c,A);b.props=U;var re=b.context,ce=c.contextType;T=qr,typeof ce=="object"&&ce!==null&&(T=qt(ce));var me=c.getDerivedStateFromProps;ce=typeof me=="function"||typeof b.getSnapshotBeforeUpdate=="function",A=s.pendingProps!==A,ce||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(A||re!==T)&&Lp(s,b,d,T),ji=!1;var ae=s.memoizedState;b.state=ae,la(s,d,b,y),aa(),re=s.memoizedState,A||ae!==re||ji?(typeof me=="function"&&(Su(s,c,me,d),re=s.memoizedState),(U=ji||Dp(s,c,U,d,ae,re,T))?(ce||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(s.flags|=4194308)):(typeof b.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=d,s.memoizedState=re),b.props=d,b.state=re,b.context=T,d=U):(typeof b.componentDidMount=="function"&&(s.flags|=4194308),d=!1)}else{b=s.stateNode,nu(r,s),T=s.memoizedProps,ce=mr(c,T),b.props=ce,me=s.pendingProps,ae=b.context,re=c.contextType,U=qr,typeof re=="object"&&re!==null&&(U=qt(re)),A=c.getDerivedStateFromProps,(re=typeof A=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(T!==me||ae!==U)&&Lp(s,b,d,U),ji=!1,ae=s.memoizedState,b.state=ae,la(s,d,b,y),aa();var le=s.memoizedState;T!==me||ae!==le||ji||r!==null&&r.dependencies!==null&&kl(r.dependencies)?(typeof A=="function"&&(Su(s,c,A,d),le=s.memoizedState),(ce=ji||Dp(s,c,ce,d,ae,le,U)||r!==null&&r.dependencies!==null&&kl(r.dependencies))?(re||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(d,le,U),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(d,le,U)),typeof b.componentDidUpdate=="function"&&(s.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof b.componentDidUpdate!="function"||T===r.memoizedProps&&ae===r.memoizedState||(s.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||T===r.memoizedProps&&ae===r.memoizedState||(s.flags|=1024),s.memoizedProps=d,s.memoizedState=le),b.props=d,b.state=le,b.context=U,d=ce):(typeof b.componentDidUpdate!="function"||T===r.memoizedProps&&ae===r.memoizedState||(s.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||T===r.memoizedProps&&ae===r.memoizedState||(s.flags|=1024),d=!1)}return b=d,Gl(r,s),d=(s.flags&128)!==0,b||d?(b=s.stateNode,c=d&&typeof c.getDerivedStateFromError!="function"?null:b.render(),s.flags|=1,r!==null&&d?(s.child=Xr(s,r.child,null,y),s.child=Xr(s,null,c,y)):Ot(r,s,c,y),s.memoizedState=b.state,r=s.child):r=ui(r,s,y),r}function Qp(r,s,c,d){return Ws(),s.flags|=256,Ot(r,s,c,d),s.child}var ku={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Eu(r){return{baseLanes:r,cachePool:Oh()}}function Au(r,s,c){return r=r!==null?r.childLanes&~c:0,s&&(r|=Tn),r}function Kp(r,s,c){var d=s.pendingProps,y=!1,b=(s.flags&128)!==0,T;if((T=b)||(T=r!==null&&r.memoizedState===null?!1:(_t.current&2)!==0),T&&(y=!0,s.flags&=-129),T=(s.flags&32)!==0,s.flags&=-33,r===null){if(et){if(y?_i(s):Mi(),et){var A=bt,U;if(U=A){e:{for(U=A,A=Un;U.nodeType!==8;){if(!A){A=null;break e}if(U=In(U.nextSibling),U===null){A=null;break e}}A=U}A!==null?(s.memoizedState={dehydrated:A,treeContext:sr!==null?{id:ri,overflow:si}:null,retryLane:536870912,hydrationErrors:null},U=cn(18,null,null,0),U.stateNode=A,U.return=s,s.child=U,Yt=s,bt=null,U=!0):U=!1}U||or(s)}if(A=s.memoizedState,A!==null&&(A=A.dehydrated,A!==null))return fd(A)?s.lanes=32:s.lanes=536870912,null;ci(s)}return A=d.children,d=d.fallback,y?(Mi(),y=s.mode,A=Jl({mode:"hidden",children:A},y),d=rr(d,y,c,null),A.return=s,d.return=s,A.sibling=d,s.child=A,y=s.child,y.memoizedState=Eu(c),y.childLanes=Au(r,T,c),s.memoizedState=ku,d):(_i(s),_u(s,A))}if(U=r.memoizedState,U!==null&&(A=U.dehydrated,A!==null)){if(b)s.flags&256?(_i(s),s.flags&=-257,s=Mu(r,s,c)):s.memoizedState!==null?(Mi(),s.child=r.child,s.flags|=128,s=null):(Mi(),y=d.fallback,A=s.mode,d=Jl({mode:"visible",children:d.children},A),y=rr(y,A,c,null),y.flags|=2,d.return=s,y.return=s,d.sibling=y,s.child=d,Xr(s,r.child,null,c),d=s.child,d.memoizedState=Eu(c),d.childLanes=Au(r,T,c),s.memoizedState=ku,s=y);else if(_i(s),fd(A)){if(T=A.nextSibling&&A.nextSibling.dataset,T)var re=T.dgst;T=re,d=Error(i(419)),d.stack="",d.digest=T,Xs({value:d,source:null,stack:null}),s=Mu(r,s,c)}else if(Dt||ea(r,s,c,!1),T=(c&r.childLanes)!==0,Dt||T){if(T=dt,T!==null&&(d=c&-c,d=(d&42)!==0?1:mc(d),d=(d&(T.suspendedLanes|c))!==0?0:d,d!==0&&d!==U.retryLane))throw U.retryLane=d,$r(r,d),hn(T,r,d),$p;A.data==="$?"||Zu(),s=Mu(r,s,c)}else A.data==="$?"?(s.flags|=192,s.child=r.child,s=null):(r=U.treeContext,bt=In(A.nextSibling),Yt=s,et=!0,lr=null,Un=!1,r!==null&&(Nn[Sn++]=ri,Nn[Sn++]=si,Nn[Sn++]=sr,ri=r.id,si=r.overflow,sr=s),s=_u(s,d.children),s.flags|=4096);return s}return y?(Mi(),y=d.fallback,A=s.mode,U=r.child,re=U.sibling,d=ii(U,{mode:"hidden",children:d.children}),d.subtreeFlags=U.subtreeFlags&65011712,re!==null?y=ii(re,y):(y=rr(y,A,c,null),y.flags|=2),y.return=s,d.return=s,d.sibling=y,s.child=d,d=y,y=s.child,A=r.child.memoizedState,A===null?A=Eu(c):(U=A.cachePool,U!==null?(re=At._currentValue,U=U.parent!==re?{parent:re,pool:re}:U):U=Oh(),A={baseLanes:A.baseLanes|c,cachePool:U}),y.memoizedState=A,y.childLanes=Au(r,T,c),s.memoizedState=ku,d):(_i(s),c=r.child,r=c.sibling,c=ii(c,{mode:"visible",children:d.children}),c.return=s,c.sibling=null,r!==null&&(T=s.deletions,T===null?(s.deletions=[r],s.flags|=16):T.push(r)),s.child=c,s.memoizedState=null,c)}function _u(r,s){return s=Jl({mode:"visible",children:s},r.mode),s.return=r,r.child=s}function Jl(r,s){return r=cn(22,r,null,s),r.lanes=0,r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},r}function Mu(r,s,c){return Xr(s,r.child,null,c),r=_u(s,s.pendingProps.children),r.flags|=2,s.memoizedState=null,r}function Wp(r,s,c){r.lanes|=s;var d=r.alternate;d!==null&&(d.lanes|=s),Zc(r.return,s,c)}function Ru(r,s,c,d,y){var b=r.memoizedState;b===null?r.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:d,tail:c,tailMode:y}:(b.isBackwards=s,b.rendering=null,b.renderingStartTime=0,b.last=d,b.tail=c,b.tailMode=y)}function Xp(r,s,c){var d=s.pendingProps,y=d.revealOrder,b=d.tail;if(Ot(r,s,d.children,c),d=_t.current,(d&2)!==0)d=d&1|2,s.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=s.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Wp(r,c,s);else if(r.tag===19)Wp(r,c,s);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}d&=1}switch(_(_t,d),y){case"forwards":for(c=s.child,y=null;c!==null;)r=c.alternate,r!==null&&ql(r)===null&&(y=c),c=c.sibling;c=y,c===null?(y=s.child,s.child=null):(y=c.sibling,c.sibling=null),Ru(s,!1,y,c,b);break;case"backwards":for(c=null,y=s.child,s.child=null;y!==null;){if(r=y.alternate,r!==null&&ql(r)===null){s.child=y;break}r=y.sibling,y.sibling=c,c=y,y=r}Ru(s,!0,c,null,b);break;case"together":Ru(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function ui(r,s,c){if(r!==null&&(s.dependencies=r.dependencies),Pi|=s.lanes,(c&s.childLanes)===0)if(r!==null){if(ea(r,s,c,!1),(c&s.childLanes)===0)return null}else return null;if(r!==null&&s.child!==r.child)throw Error(i(153));if(s.child!==null){for(r=s.child,c=ii(r,r.pendingProps),s.child=c,c.return=s;r.sibling!==null;)r=r.sibling,c=c.sibling=ii(r,r.pendingProps),c.return=s;c.sibling=null}return s.child}function Iu(r,s){return(r.lanes&s)!==0?!0:(r=r.dependencies,!!(r!==null&&kl(r)))}function _2(r,s,c){switch(s.tag){case 3:de(s,s.stateNode.containerInfo),Ti(s,At,r.memoizedState.cache),Ws();break;case 27:case 5:Ve(s);break;case 4:de(s,s.stateNode.containerInfo);break;case 10:Ti(s,s.type,s.memoizedProps.value);break;case 13:var d=s.memoizedState;if(d!==null)return d.dehydrated!==null?(_i(s),s.flags|=128,null):(c&s.child.childLanes)!==0?Kp(r,s,c):(_i(s),r=ui(r,s,c),r!==null?r.sibling:null);_i(s);break;case 19:var y=(r.flags&128)!==0;if(d=(c&s.childLanes)!==0,d||(ea(r,s,c,!1),d=(c&s.childLanes)!==0),y){if(d)return Xp(r,s,c);s.flags|=128}if(y=s.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),_(_t,_t.current),d)break;return null;case 22:case 23:return s.lanes=0,Gp(r,s,c);case 24:Ti(s,At,r.memoizedState.cache)}return ui(r,s,c)}function eg(r,s,c){if(r!==null)if(r.memoizedProps!==s.pendingProps)Dt=!0;else{if(!Iu(r,c)&&(s.flags&128)===0)return Dt=!1,_2(r,s,c);Dt=(r.flags&131072)!==0}else Dt=!1,et&&(s.flags&1048576)!==0&&_h(s,jl,s.index);switch(s.lanes=0,s.tag){case 16:e:{r=s.pendingProps;var d=s.elementType,y=d._init;if(d=y(d._payload),s.type=d,typeof d=="function")$c(d)?(r=mr(d,r),s.tag=1,s=Zp(null,s,d,r,c)):(s.tag=0,s=ju(null,s,d,r,c));else{if(d!=null){if(y=d.$$typeof,y===O){s.tag=11,s=qp(null,s,d,r,c);break e}else if(y===R){s.tag=14,s=Fp(null,s,d,r,c);break e}}throw s=$(d)||d,Error(i(306,s,""))}}return s;case 0:return ju(r,s,s.type,s.pendingProps,c);case 1:return d=s.type,y=mr(d,s.pendingProps),Zp(r,s,d,y,c);case 3:e:{if(de(s,s.stateNode.containerInfo),r===null)throw Error(i(387));d=s.pendingProps;var b=s.memoizedState;y=b.element,nu(r,s),la(s,d,null,c);var T=s.memoizedState;if(d=T.cache,Ti(s,At,d),d!==b.cache&&Qc(s,[At],c,!0),aa(),d=T.element,b.isDehydrated)if(b={element:d,isDehydrated:!1,cache:T.cache},s.updateQueue.baseState=b,s.memoizedState=b,s.flags&256){s=Qp(r,s,d,c);break e}else if(d!==y){y=bn(Error(i(424)),s),Xs(y),s=Qp(r,s,d,c);break e}else{switch(r=s.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(bt=In(r.firstChild),Yt=s,et=!0,lr=null,Un=!0,c=Rp(s,null,d,c),s.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(Ws(),d===y){s=ui(r,s,c);break e}Ot(r,s,d,c)}s=s.child}return s;case 26:return Gl(r,s),r===null?(c=r0(s.type,null,s.pendingProps,null))?s.memoizedState=c:et||(c=s.type,r=s.pendingProps,d=lo(se.current).createElement(c),d[$t]=s,d[Kt]=r,Ut(d,c,r),It(d),s.stateNode=d):s.memoizedState=r0(s.type,r.memoizedProps,s.pendingProps,r.memoizedState),null;case 27:return Ve(s),r===null&&et&&(d=s.stateNode=t0(s.type,s.pendingProps,se.current),Yt=s,Un=!0,y=bt,zi(s.type)?(md=y,bt=In(d.firstChild)):bt=y),Ot(r,s,s.pendingProps.children,c),Gl(r,s),r===null&&(s.flags|=4194304),s.child;case 5:return r===null&&et&&((y=d=bt)&&(d=rw(d,s.type,s.pendingProps,Un),d!==null?(s.stateNode=d,Yt=s,bt=In(d.firstChild),Un=!1,y=!0):y=!1),y||or(s)),Ve(s),y=s.type,b=s.pendingProps,T=r!==null?r.memoizedProps:null,d=b.children,cd(y,b)?d=null:T!==null&&cd(y,T)&&(s.flags|=32),s.memoizedState!==null&&(y=ou(r,s,N2,null,null,c),Aa._currentValue=y),Gl(r,s),Ot(r,s,d,c),s.child;case 6:return r===null&&et&&((r=c=bt)&&(c=sw(c,s.pendingProps,Un),c!==null?(s.stateNode=c,Yt=s,bt=null,r=!0):r=!1),r||or(s)),null;case 13:return Kp(r,s,c);case 4:return de(s,s.stateNode.containerInfo),d=s.pendingProps,r===null?s.child=Xr(s,null,d,c):Ot(r,s,d,c),s.child;case 11:return qp(r,s,s.type,s.pendingProps,c);case 7:return Ot(r,s,s.pendingProps,c),s.child;case 8:return Ot(r,s,s.pendingProps.children,c),s.child;case 12:return Ot(r,s,s.pendingProps.children,c),s.child;case 10:return d=s.pendingProps,Ti(s,s.type,d.value),Ot(r,s,d.children,c),s.child;case 9:return y=s.type._context,d=s.pendingProps.children,ur(s),y=qt(y),d=d(y),s.flags|=1,Ot(r,s,d,c),s.child;case 14:return Fp(r,s,s.type,s.pendingProps,c);case 15:return Hp(r,s,s.type,s.pendingProps,c);case 19:return Xp(r,s,c);case 31:return d=s.pendingProps,c=s.mode,d={mode:d.mode,children:d.children},r===null?(c=Jl(d,c),c.ref=s.ref,s.child=c,c.return=s,s=c):(c=ii(r.child,d),c.ref=s.ref,s.child=c,c.return=s,s=c),s;case 22:return Gp(r,s,c);case 24:return ur(s),d=qt(At),r===null?(y=Xc(),y===null&&(y=dt,b=Kc(),y.pooledCache=b,b.refCount++,b!==null&&(y.pooledCacheLanes|=c),y=b),s.memoizedState={parent:d,cache:y},tu(s),Ti(s,At,y)):((r.lanes&c)!==0&&(nu(r,s),la(s,null,null,c),aa()),y=r.memoizedState,b=s.memoizedState,y.parent!==d?(y={parent:d,cache:d},s.memoizedState=y,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=y),Ti(s,At,d)):(d=b.cache,Ti(s,At,d),d!==y.cache&&Qc(s,[At],c,!0))),Ot(r,s,s.pendingProps.children,c),s.child;case 29:throw s.pendingProps}throw Error(i(156,s.tag))}function di(r){r.flags|=4}function tg(r,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!c0(s)){if(s=Cn.current,s!==null&&((Ye&4194048)===Ye?zn!==null:(Ye&62914560)!==Ye&&(Ye&536870912)===0||s!==zn))throw ra=eu,Bh;r.flags|=8192}}function Yl(r,s){s!==null&&(r.flags|=4),r.flags&16384&&(s=r.tag!==22?Im():536870912,r.lanes|=s,is|=s)}function ha(r,s){if(!et)switch(r.tailMode){case"hidden":s=r.tail;for(var c=null;s!==null;)s.alternate!==null&&(c=s),s=s.sibling;c===null?r.tail=null:c.sibling=null;break;case"collapsed":c=r.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?s||r.tail===null?r.tail=null:r.tail.sibling=null:d.sibling=null}}function yt(r){var s=r.alternate!==null&&r.alternate.child===r.child,c=0,d=0;if(s)for(var y=r.child;y!==null;)c|=y.lanes|y.childLanes,d|=y.subtreeFlags&65011712,d|=y.flags&65011712,y.return=r,y=y.sibling;else for(y=r.child;y!==null;)c|=y.lanes|y.childLanes,d|=y.subtreeFlags,d|=y.flags,y.return=r,y=y.sibling;return r.subtreeFlags|=d,r.childLanes=c,s}function M2(r,s,c){var d=s.pendingProps;switch(Gc(s),s.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return yt(s),null;case 1:return yt(s),null;case 3:return c=s.stateNode,d=null,r!==null&&(d=r.memoizedState.cache),s.memoizedState.cache!==d&&(s.flags|=2048),li(At),be(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(r===null||r.child===null)&&(Ks(s)?di(s):r===null||r.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Ih())),yt(s),null;case 26:return c=s.memoizedState,r===null?(di(s),c!==null?(yt(s),tg(s,c)):(yt(s),s.flags&=-16777217)):c?c!==r.memoizedState?(di(s),yt(s),tg(s,c)):(yt(s),s.flags&=-16777217):(r.memoizedProps!==d&&di(s),yt(s),s.flags&=-16777217),null;case 27:Ze(s),c=se.current;var y=s.type;if(r!==null&&s.stateNode!=null)r.memoizedProps!==d&&di(s);else{if(!d){if(s.stateNode===null)throw Error(i(166));return yt(s),null}r=ve.current,Ks(s)?Mh(s):(r=t0(y,d,c),s.stateNode=r,di(s))}return yt(s),null;case 5:if(Ze(s),c=s.type,r!==null&&s.stateNode!=null)r.memoizedProps!==d&&di(s);else{if(!d){if(s.stateNode===null)throw Error(i(166));return yt(s),null}if(r=ve.current,Ks(s))Mh(s);else{switch(y=lo(se.current),r){case 1:r=y.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:r=y.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":r=y.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":r=y.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":r=y.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof d.is=="string"?y.createElement("select",{is:d.is}):y.createElement("select"),d.multiple?r.multiple=!0:d.size&&(r.size=d.size);break;default:r=typeof d.is=="string"?y.createElement(c,{is:d.is}):y.createElement(c)}}r[$t]=s,r[Kt]=d;e:for(y=s.child;y!==null;){if(y.tag===5||y.tag===6)r.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===s)break e;for(;y.sibling===null;){if(y.return===null||y.return===s)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}s.stateNode=r;e:switch(Ut(r,c,d),c){case"button":case"input":case"select":case"textarea":r=!!d.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&di(s)}}return yt(s),s.flags&=-16777217,null;case 6:if(r&&s.stateNode!=null)r.memoizedProps!==d&&di(s);else{if(typeof d!="string"&&s.stateNode===null)throw Error(i(166));if(r=se.current,Ks(s)){if(r=s.stateNode,c=s.memoizedProps,d=null,y=Yt,y!==null)switch(y.tag){case 27:case 5:d=y.memoizedProps}r[$t]=s,r=!!(r.nodeValue===c||d!==null&&d.suppressHydrationWarning===!0||Yg(r.nodeValue,c)),r||or(s)}else r=lo(r).createTextNode(d),r[$t]=s,s.stateNode=r}return yt(s),null;case 13:if(d=s.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(y=Ks(s),d!==null&&d.dehydrated!==null){if(r===null){if(!y)throw Error(i(318));if(y=s.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(i(317));y[$t]=s}else Ws(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;yt(s),y=!1}else y=Ih(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=y),y=!0;if(!y)return s.flags&256?(ci(s),s):(ci(s),null)}if(ci(s),(s.flags&128)!==0)return s.lanes=c,s;if(c=d!==null,r=r!==null&&r.memoizedState!==null,c){d=s.child,y=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(y=d.alternate.memoizedState.cachePool.pool);var b=null;d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(b=d.memoizedState.cachePool.pool),b!==y&&(d.flags|=2048)}return c!==r&&c&&(s.child.flags|=8192),Yl(s,s.updateQueue),yt(s),null;case 4:return be(),r===null&&rd(s.stateNode.containerInfo),yt(s),null;case 10:return li(s.type),yt(s),null;case 19:if(ie(_t),y=s.memoizedState,y===null)return yt(s),null;if(d=(s.flags&128)!==0,b=y.rendering,b===null)if(d)ha(y,!1);else{if(wt!==0||r!==null&&(r.flags&128)!==0)for(r=s.child;r!==null;){if(b=ql(r),b!==null){for(s.flags|=128,ha(y,!1),r=b.updateQueue,s.updateQueue=r,Yl(s,r),s.subtreeFlags=0,r=c,c=s.child;c!==null;)Ah(c,r),c=c.sibling;return _(_t,_t.current&1|2),s.child}r=r.sibling}y.tail!==null&&Rt()>Kl&&(s.flags|=128,d=!0,ha(y,!1),s.lanes=4194304)}else{if(!d)if(r=ql(b),r!==null){if(s.flags|=128,d=!0,r=r.updateQueue,s.updateQueue=r,Yl(s,r),ha(y,!0),y.tail===null&&y.tailMode==="hidden"&&!b.alternate&&!et)return yt(s),null}else 2*Rt()-y.renderingStartTime>Kl&&c!==536870912&&(s.flags|=128,d=!0,ha(y,!1),s.lanes=4194304);y.isBackwards?(b.sibling=s.child,s.child=b):(r=y.last,r!==null?r.sibling=b:s.child=b,y.last=b)}return y.tail!==null?(s=y.tail,y.rendering=s,y.tail=s.sibling,y.renderingStartTime=Rt(),s.sibling=null,r=_t.current,_(_t,d?r&1|2:r&1),s):(yt(s),null);case 22:case 23:return ci(s),au(),d=s.memoizedState!==null,r!==null?r.memoizedState!==null!==d&&(s.flags|=8192):d&&(s.flags|=8192),d?(c&536870912)!==0&&(s.flags&128)===0&&(yt(s),s.subtreeFlags&6&&(s.flags|=8192)):yt(s),c=s.updateQueue,c!==null&&Yl(s,c.retryQueue),c=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),d=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(d=s.memoizedState.cachePool.pool),d!==c&&(s.flags|=2048),r!==null&&ie(dr),null;case 24:return c=null,r!==null&&(c=r.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),li(At),yt(s),null;case 25:return null;case 30:return null}throw Error(i(156,s.tag))}function R2(r,s){switch(Gc(s),s.tag){case 1:return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 3:return li(At),be(),r=s.flags,(r&65536)!==0&&(r&128)===0?(s.flags=r&-65537|128,s):null;case 26:case 27:case 5:return Ze(s),null;case 13:if(ci(s),r=s.memoizedState,r!==null&&r.dehydrated!==null){if(s.alternate===null)throw Error(i(340));Ws()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 19:return ie(_t),null;case 4:return be(),null;case 10:return li(s.type),null;case 22:case 23:return ci(s),au(),r!==null&&ie(dr),r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 24:return li(At),null;case 25:return null;default:return null}}function ng(r,s){switch(Gc(s),s.tag){case 3:li(At),be();break;case 26:case 27:case 5:Ze(s);break;case 4:be();break;case 13:ci(s);break;case 19:ie(_t);break;case 10:li(s.type);break;case 22:case 23:ci(s),au(),r!==null&&ie(dr);break;case 24:li(At)}}function pa(r,s){try{var c=s.updateQueue,d=c!==null?c.lastEffect:null;if(d!==null){var y=d.next;c=y;do{if((c.tag&r)===r){d=void 0;var b=c.create,T=c.inst;d=b(),T.destroy=d}c=c.next}while(c!==y)}}catch(A){ct(s,s.return,A)}}function Ri(r,s,c){try{var d=s.updateQueue,y=d!==null?d.lastEffect:null;if(y!==null){var b=y.next;d=b;do{if((d.tag&r)===r){var T=d.inst,A=T.destroy;if(A!==void 0){T.destroy=void 0,y=s;var U=c,re=A;try{re()}catch(ce){ct(y,U,ce)}}}d=d.next}while(d!==b)}}catch(ce){ct(s,s.return,ce)}}function ig(r){var s=r.updateQueue;if(s!==null){var c=r.stateNode;try{Fh(s,c)}catch(d){ct(r,r.return,d)}}}function rg(r,s,c){c.props=mr(r.type,r.memoizedProps),c.state=r.memoizedState;try{c.componentWillUnmount()}catch(d){ct(r,s,d)}}function ga(r,s){try{var c=r.ref;if(c!==null){switch(r.tag){case 26:case 27:case 5:var d=r.stateNode;break;case 30:d=r.stateNode;break;default:d=r.stateNode}typeof c=="function"?r.refCleanup=c(d):c.current=d}}catch(y){ct(r,s,y)}}function Vn(r,s){var c=r.ref,d=r.refCleanup;if(c!==null)if(typeof d=="function")try{d()}catch(y){ct(r,s,y)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(y){ct(r,s,y)}else c.current=null}function sg(r){var s=r.type,c=r.memoizedProps,d=r.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":c.autoFocus&&d.focus();break e;case"img":c.src?d.src=c.src:c.srcSet&&(d.srcset=c.srcSet)}}catch(y){ct(r,r.return,y)}}function Du(r,s,c){try{var d=r.stateNode;X2(d,r.type,c,s),d[Kt]=s}catch(y){ct(r,r.return,y)}}function ag(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&zi(r.type)||r.tag===4}function Lu(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||ag(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&zi(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Pu(r,s,c){var d=r.tag;if(d===5||d===6)r=r.stateNode,s?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(r,s):(s=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,s.appendChild(r),c=c._reactRootContainer,c!=null||s.onclick!==null||(s.onclick=ao));else if(d!==4&&(d===27&&zi(r.type)&&(c=r.stateNode,s=null),r=r.child,r!==null))for(Pu(r,s,c),r=r.sibling;r!==null;)Pu(r,s,c),r=r.sibling}function Zl(r,s,c){var d=r.tag;if(d===5||d===6)r=r.stateNode,s?c.insertBefore(r,s):c.appendChild(r);else if(d!==4&&(d===27&&zi(r.type)&&(c=r.stateNode),r=r.child,r!==null))for(Zl(r,s,c),r=r.sibling;r!==null;)Zl(r,s,c),r=r.sibling}function lg(r){var s=r.stateNode,c=r.memoizedProps;try{for(var d=r.type,y=s.attributes;y.length;)s.removeAttributeNode(y[0]);Ut(s,d,c),s[$t]=r,s[Kt]=c}catch(b){ct(r,r.return,b)}}var fi=!1,Ct=!1,Ou=!1,og=typeof WeakSet=="function"?WeakSet:Set,Lt=null;function I2(r,s){if(r=r.containerInfo,ld=ho,r=vh(r),Lc(r)){if("selectionStart"in r)var c={start:r.selectionStart,end:r.selectionEnd};else e:{c=(c=r.ownerDocument)&&c.defaultView||window;var d=c.getSelection&&c.getSelection();if(d&&d.rangeCount!==0){c=d.anchorNode;var y=d.anchorOffset,b=d.focusNode;d=d.focusOffset;try{c.nodeType,b.nodeType}catch{c=null;break e}var T=0,A=-1,U=-1,re=0,ce=0,me=r,ae=null;t:for(;;){for(var le;me!==c||y!==0&&me.nodeType!==3||(A=T+y),me!==b||d!==0&&me.nodeType!==3||(U=T+d),me.nodeType===3&&(T+=me.nodeValue.length),(le=me.firstChild)!==null;)ae=me,me=le;for(;;){if(me===r)break t;if(ae===c&&++re===y&&(A=T),ae===b&&++ce===d&&(U=T),(le=me.nextSibling)!==null)break;me=ae,ae=me.parentNode}me=le}c=A===-1||U===-1?null:{start:A,end:U}}else c=null}c=c||{start:0,end:0}}else c=null;for(od={focusedElem:r,selectionRange:c},ho=!1,Lt=s;Lt!==null;)if(s=Lt,r=s.child,(s.subtreeFlags&1024)!==0&&r!==null)r.return=s,Lt=r;else for(;Lt!==null;){switch(s=Lt,b=s.alternate,r=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((r&1024)!==0&&b!==null){r=void 0,c=s,y=b.memoizedProps,b=b.memoizedState,d=c.stateNode;try{var Me=mr(c.type,y,c.elementType===c.type);r=d.getSnapshotBeforeUpdate(Me,b),d.__reactInternalSnapshotBeforeUpdate=r}catch(Ae){ct(c,c.return,Ae)}}break;case 3:if((r&1024)!==0){if(r=s.stateNode.containerInfo,c=r.nodeType,c===9)dd(r);else if(c===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":dd(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=s.sibling,r!==null){r.return=s.return,Lt=r;break}Lt=s.return}}function cg(r,s,c){var d=c.flags;switch(c.tag){case 0:case 11:case 15:Ii(r,c),d&4&&pa(5,c);break;case 1:if(Ii(r,c),d&4)if(r=c.stateNode,s===null)try{r.componentDidMount()}catch(T){ct(c,c.return,T)}else{var y=mr(c.type,s.memoizedProps);s=s.memoizedState;try{r.componentDidUpdate(y,s,r.__reactInternalSnapshotBeforeUpdate)}catch(T){ct(c,c.return,T)}}d&64&&ig(c),d&512&&ga(c,c.return);break;case 3:if(Ii(r,c),d&64&&(r=c.updateQueue,r!==null)){if(s=null,c.child!==null)switch(c.child.tag){case 27:case 5:s=c.child.stateNode;break;case 1:s=c.child.stateNode}try{Fh(r,s)}catch(T){ct(c,c.return,T)}}break;case 27:s===null&&d&4&&lg(c);case 26:case 5:Ii(r,c),s===null&&d&4&&sg(c),d&512&&ga(c,c.return);break;case 12:Ii(r,c);break;case 13:Ii(r,c),d&4&&fg(r,c),d&64&&(r=c.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(c=$2.bind(null,c),aw(r,c))));break;case 22:if(d=c.memoizedState!==null||fi,!d){s=s!==null&&s.memoizedState!==null||Ct,y=fi;var b=Ct;fi=d,(Ct=s)&&!b?Di(r,c,(c.subtreeFlags&8772)!==0):Ii(r,c),fi=y,Ct=b}break;case 30:break;default:Ii(r,c)}}function ug(r){var s=r.alternate;s!==null&&(r.alternate=null,ug(s)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(s=r.stateNode,s!==null&&gc(s)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var xt=null,en=!1;function mi(r,s,c){for(c=c.child;c!==null;)dg(r,s,c),c=c.sibling}function dg(r,s,c){if(te&&typeof te.onCommitFiberUnmount=="function")try{te.onCommitFiberUnmount(Z,c)}catch{}switch(c.tag){case 26:Ct||Vn(c,s),mi(r,s,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Ct||Vn(c,s);var d=xt,y=en;zi(c.type)&&(xt=c.stateNode,en=!1),mi(r,s,c),Ta(c.stateNode),xt=d,en=y;break;case 5:Ct||Vn(c,s);case 6:if(d=xt,y=en,xt=null,mi(r,s,c),xt=d,en=y,xt!==null)if(en)try{(xt.nodeType===9?xt.body:xt.nodeName==="HTML"?xt.ownerDocument.body:xt).removeChild(c.stateNode)}catch(b){ct(c,s,b)}else try{xt.removeChild(c.stateNode)}catch(b){ct(c,s,b)}break;case 18:xt!==null&&(en?(r=xt,Xg(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,c.stateNode),Ia(r)):Xg(xt,c.stateNode));break;case 4:d=xt,y=en,xt=c.stateNode.containerInfo,en=!0,mi(r,s,c),xt=d,en=y;break;case 0:case 11:case 14:case 15:Ct||Ri(2,c,s),Ct||Ri(4,c,s),mi(r,s,c);break;case 1:Ct||(Vn(c,s),d=c.stateNode,typeof d.componentWillUnmount=="function"&&rg(c,s,d)),mi(r,s,c);break;case 21:mi(r,s,c);break;case 22:Ct=(d=Ct)||c.memoizedState!==null,mi(r,s,c),Ct=d;break;default:mi(r,s,c)}}function fg(r,s){if(s.memoizedState===null&&(r=s.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Ia(r)}catch(c){ct(s,s.return,c)}}function D2(r){switch(r.tag){case 13:case 19:var s=r.stateNode;return s===null&&(s=r.stateNode=new og),s;case 22:return r=r.stateNode,s=r._retryCache,s===null&&(s=r._retryCache=new og),s;default:throw Error(i(435,r.tag))}}function Bu(r,s){var c=D2(r);s.forEach(function(d){var y=q2.bind(null,r,d);c.has(d)||(c.add(d),d.then(y,y))})}function un(r,s){var c=s.deletions;if(c!==null)for(var d=0;d<c.length;d++){var y=c[d],b=r,T=s,A=T;e:for(;A!==null;){switch(A.tag){case 27:if(zi(A.type)){xt=A.stateNode,en=!1;break e}break;case 5:xt=A.stateNode,en=!1;break e;case 3:case 4:xt=A.stateNode.containerInfo,en=!0;break e}A=A.return}if(xt===null)throw Error(i(160));dg(b,T,y),xt=null,en=!1,b=y.alternate,b!==null&&(b.return=null),y.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)mg(s,r),s=s.sibling}var Rn=null;function mg(r,s){var c=r.alternate,d=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:un(s,r),dn(r),d&4&&(Ri(3,r,r.return),pa(3,r),Ri(5,r,r.return));break;case 1:un(s,r),dn(r),d&512&&(Ct||c===null||Vn(c,c.return)),d&64&&fi&&(r=r.updateQueue,r!==null&&(d=r.callbacks,d!==null&&(c=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=c===null?d:c.concat(d))));break;case 26:var y=Rn;if(un(s,r),dn(r),d&512&&(Ct||c===null||Vn(c,c.return)),d&4){var b=c!==null?c.memoizedState:null;if(d=r.memoizedState,c===null)if(d===null)if(r.stateNode===null){e:{d=r.type,c=r.memoizedProps,y=y.ownerDocument||y;t:switch(d){case"title":b=y.getElementsByTagName("title")[0],(!b||b[zs]||b[$t]||b.namespaceURI==="http://www.w3.org/2000/svg"||b.hasAttribute("itemprop"))&&(b=y.createElement(d),y.head.insertBefore(b,y.querySelector("head > title"))),Ut(b,d,c),b[$t]=r,It(b),d=b;break e;case"link":var T=l0("link","href",y).get(d+(c.href||""));if(T){for(var A=0;A<T.length;A++)if(b=T[A],b.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&b.getAttribute("rel")===(c.rel==null?null:c.rel)&&b.getAttribute("title")===(c.title==null?null:c.title)&&b.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){T.splice(A,1);break t}}b=y.createElement(d),Ut(b,d,c),y.head.appendChild(b);break;case"meta":if(T=l0("meta","content",y).get(d+(c.content||""))){for(A=0;A<T.length;A++)if(b=T[A],b.getAttribute("content")===(c.content==null?null:""+c.content)&&b.getAttribute("name")===(c.name==null?null:c.name)&&b.getAttribute("property")===(c.property==null?null:c.property)&&b.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&b.getAttribute("charset")===(c.charSet==null?null:c.charSet)){T.splice(A,1);break t}}b=y.createElement(d),Ut(b,d,c),y.head.appendChild(b);break;default:throw Error(i(468,d))}b[$t]=r,It(b),d=b}r.stateNode=d}else o0(y,r.type,r.stateNode);else r.stateNode=a0(y,d,r.memoizedProps);else b!==d?(b===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):b.count--,d===null?o0(y,r.type,r.stateNode):a0(y,d,r.memoizedProps)):d===null&&r.stateNode!==null&&Du(r,r.memoizedProps,c.memoizedProps)}break;case 27:un(s,r),dn(r),d&512&&(Ct||c===null||Vn(c,c.return)),c!==null&&d&4&&Du(r,r.memoizedProps,c.memoizedProps);break;case 5:if(un(s,r),dn(r),d&512&&(Ct||c===null||Vn(c,c.return)),r.flags&32){y=r.stateNode;try{Lr(y,"")}catch(le){ct(r,r.return,le)}}d&4&&r.stateNode!=null&&(y=r.memoizedProps,Du(r,y,c!==null?c.memoizedProps:y)),d&1024&&(Ou=!0);break;case 6:if(un(s,r),dn(r),d&4){if(r.stateNode===null)throw Error(i(162));d=r.memoizedProps,c=r.stateNode;try{c.nodeValue=d}catch(le){ct(r,r.return,le)}}break;case 3:if(uo=null,y=Rn,Rn=oo(s.containerInfo),un(s,r),Rn=y,dn(r),d&4&&c!==null&&c.memoizedState.isDehydrated)try{Ia(s.containerInfo)}catch(le){ct(r,r.return,le)}Ou&&(Ou=!1,hg(r));break;case 4:d=Rn,Rn=oo(r.stateNode.containerInfo),un(s,r),dn(r),Rn=d;break;case 12:un(s,r),dn(r);break;case 13:un(s,r),dn(r),r.child.flags&8192&&r.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Fu=Rt()),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,Bu(r,d)));break;case 22:y=r.memoizedState!==null;var U=c!==null&&c.memoizedState!==null,re=fi,ce=Ct;if(fi=re||y,Ct=ce||U,un(s,r),Ct=ce,fi=re,dn(r),d&8192)e:for(s=r.stateNode,s._visibility=y?s._visibility&-2:s._visibility|1,y&&(c===null||U||fi||Ct||hr(r)),c=null,s=r;;){if(s.tag===5||s.tag===26){if(c===null){U=c=s;try{if(b=U.stateNode,y)T=b.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{A=U.stateNode;var me=U.memoizedProps.style,ae=me!=null&&me.hasOwnProperty("display")?me.display:null;A.style.display=ae==null||typeof ae=="boolean"?"":(""+ae).trim()}}catch(le){ct(U,U.return,le)}}}else if(s.tag===6){if(c===null){U=s;try{U.stateNode.nodeValue=y?"":U.memoizedProps}catch(le){ct(U,U.return,le)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===r)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;c===s&&(c=null),s=s.return}c===s&&(c=null),s.sibling.return=s.return,s=s.sibling}d&4&&(d=r.updateQueue,d!==null&&(c=d.retryQueue,c!==null&&(d.retryQueue=null,Bu(r,c))));break;case 19:un(s,r),dn(r),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,Bu(r,d)));break;case 30:break;case 21:break;default:un(s,r),dn(r)}}function dn(r){var s=r.flags;if(s&2){try{for(var c,d=r.return;d!==null;){if(ag(d)){c=d;break}d=d.return}if(c==null)throw Error(i(160));switch(c.tag){case 27:var y=c.stateNode,b=Lu(r);Zl(r,b,y);break;case 5:var T=c.stateNode;c.flags&32&&(Lr(T,""),c.flags&=-33);var A=Lu(r);Zl(r,A,T);break;case 3:case 4:var U=c.stateNode.containerInfo,re=Lu(r);Pu(r,re,U);break;default:throw Error(i(161))}}catch(ce){ct(r,r.return,ce)}r.flags&=-3}s&4096&&(r.flags&=-4097)}function hg(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var s=r;hg(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),r=r.sibling}}function Ii(r,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)cg(r,s.alternate,s),s=s.sibling}function hr(r){for(r=r.child;r!==null;){var s=r;switch(s.tag){case 0:case 11:case 14:case 15:Ri(4,s,s.return),hr(s);break;case 1:Vn(s,s.return);var c=s.stateNode;typeof c.componentWillUnmount=="function"&&rg(s,s.return,c),hr(s);break;case 27:Ta(s.stateNode);case 26:case 5:Vn(s,s.return),hr(s);break;case 22:s.memoizedState===null&&hr(s);break;case 30:hr(s);break;default:hr(s)}r=r.sibling}}function Di(r,s,c){for(c=c&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var d=s.alternate,y=r,b=s,T=b.flags;switch(b.tag){case 0:case 11:case 15:Di(y,b,c),pa(4,b);break;case 1:if(Di(y,b,c),d=b,y=d.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(re){ct(d,d.return,re)}if(d=b,y=d.updateQueue,y!==null){var A=d.stateNode;try{var U=y.shared.hiddenCallbacks;if(U!==null)for(y.shared.hiddenCallbacks=null,y=0;y<U.length;y++)qh(U[y],A)}catch(re){ct(d,d.return,re)}}c&&T&64&&ig(b),ga(b,b.return);break;case 27:lg(b);case 26:case 5:Di(y,b,c),c&&d===null&&T&4&&sg(b),ga(b,b.return);break;case 12:Di(y,b,c);break;case 13:Di(y,b,c),c&&T&4&&fg(y,b);break;case 22:b.memoizedState===null&&Di(y,b,c),ga(b,b.return);break;case 30:break;default:Di(y,b,c)}s=s.sibling}}function Uu(r,s){var c=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),r=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(r=s.memoizedState.cachePool.pool),r!==c&&(r!=null&&r.refCount++,c!=null&&ta(c))}function zu(r,s){r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&ta(r))}function $n(r,s,c,d){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)pg(r,s,c,d),s=s.sibling}function pg(r,s,c,d){var y=s.flags;switch(s.tag){case 0:case 11:case 15:$n(r,s,c,d),y&2048&&pa(9,s);break;case 1:$n(r,s,c,d);break;case 3:$n(r,s,c,d),y&2048&&(r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&ta(r)));break;case 12:if(y&2048){$n(r,s,c,d),r=s.stateNode;try{var b=s.memoizedProps,T=b.id,A=b.onPostCommit;typeof A=="function"&&A(T,s.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(U){ct(s,s.return,U)}}else $n(r,s,c,d);break;case 13:$n(r,s,c,d);break;case 23:break;case 22:b=s.stateNode,T=s.alternate,s.memoizedState!==null?b._visibility&2?$n(r,s,c,d):xa(r,s):b._visibility&2?$n(r,s,c,d):(b._visibility|=2,es(r,s,c,d,(s.subtreeFlags&10256)!==0)),y&2048&&Uu(T,s);break;case 24:$n(r,s,c,d),y&2048&&zu(s.alternate,s);break;default:$n(r,s,c,d)}}function es(r,s,c,d,y){for(y=y&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var b=r,T=s,A=c,U=d,re=T.flags;switch(T.tag){case 0:case 11:case 15:es(b,T,A,U,y),pa(8,T);break;case 23:break;case 22:var ce=T.stateNode;T.memoizedState!==null?ce._visibility&2?es(b,T,A,U,y):xa(b,T):(ce._visibility|=2,es(b,T,A,U,y)),y&&re&2048&&Uu(T.alternate,T);break;case 24:es(b,T,A,U,y),y&&re&2048&&zu(T.alternate,T);break;default:es(b,T,A,U,y)}s=s.sibling}}function xa(r,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var c=r,d=s,y=d.flags;switch(d.tag){case 22:xa(c,d),y&2048&&Uu(d.alternate,d);break;case 24:xa(c,d),y&2048&&zu(d.alternate,d);break;default:xa(c,d)}s=s.sibling}}var ya=8192;function ts(r){if(r.subtreeFlags&ya)for(r=r.child;r!==null;)gg(r),r=r.sibling}function gg(r){switch(r.tag){case 26:ts(r),r.flags&ya&&r.memoizedState!==null&&vw(Rn,r.memoizedState,r.memoizedProps);break;case 5:ts(r);break;case 3:case 4:var s=Rn;Rn=oo(r.stateNode.containerInfo),ts(r),Rn=s;break;case 22:r.memoizedState===null&&(s=r.alternate,s!==null&&s.memoizedState!==null?(s=ya,ya=16777216,ts(r),ya=s):ts(r));break;default:ts(r)}}function xg(r){var s=r.alternate;if(s!==null&&(r=s.child,r!==null)){s.child=null;do s=r.sibling,r.sibling=null,r=s;while(r!==null)}}function va(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var d=s[c];Lt=d,vg(d,r)}xg(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)yg(r),r=r.sibling}function yg(r){switch(r.tag){case 0:case 11:case 15:va(r),r.flags&2048&&Ri(9,r,r.return);break;case 3:va(r);break;case 12:va(r);break;case 22:var s=r.stateNode;r.memoizedState!==null&&s._visibility&2&&(r.return===null||r.return.tag!==13)?(s._visibility&=-3,Ql(r)):va(r);break;default:va(r)}}function Ql(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var d=s[c];Lt=d,vg(d,r)}xg(r)}for(r=r.child;r!==null;){switch(s=r,s.tag){case 0:case 11:case 15:Ri(8,s,s.return),Ql(s);break;case 22:c=s.stateNode,c._visibility&2&&(c._visibility&=-3,Ql(s));break;default:Ql(s)}r=r.sibling}}function vg(r,s){for(;Lt!==null;){var c=Lt;switch(c.tag){case 0:case 11:case 15:Ri(8,c,s);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var d=c.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:ta(c.memoizedState.cache)}if(d=c.child,d!==null)d.return=c,Lt=d;else e:for(c=r;Lt!==null;){d=Lt;var y=d.sibling,b=d.return;if(ug(d),d===c){Lt=null;break e}if(y!==null){y.return=b,Lt=y;break e}Lt=b}}}var L2={getCacheForType:function(r){var s=qt(At),c=s.data.get(r);return c===void 0&&(c=r(),s.data.set(r,c)),c}},P2=typeof WeakMap=="function"?WeakMap:Map,nt=0,dt=null,Fe=null,Ye=0,it=0,fn=null,Li=!1,ns=!1,Vu=!1,hi=0,wt=0,Pi=0,pr=0,$u=0,Tn=0,is=0,ba=null,tn=null,qu=!1,Fu=0,Kl=1/0,Wl=null,Oi=null,Bt=0,Bi=null,rs=null,ss=0,Hu=0,Gu=null,bg=null,wa=0,Ju=null;function mn(){if((nt&2)!==0&&Ye!==0)return Ye&-Ye;if(P.T!==null){var r=Gr;return r!==0?r:ed()}return Pm()}function wg(){Tn===0&&(Tn=(Ye&536870912)===0||et?Rm():536870912);var r=Cn.current;return r!==null&&(r.flags|=32),Tn}function hn(r,s,c){(r===dt&&(it===2||it===9)||r.cancelPendingCommit!==null)&&(as(r,0),Ui(r,Ye,Tn,!1)),Us(r,c),((nt&2)===0||r!==dt)&&(r===dt&&((nt&2)===0&&(pr|=c),wt===4&&Ui(r,Ye,Tn,!1)),qn(r))}function Ng(r,s,c){if((nt&6)!==0)throw Error(i(327));var d=!c&&(s&124)===0&&(s&r.expiredLanes)===0||Jt(r,s),y=d?U2(r,s):Qu(r,s,!0),b=d;do{if(y===0){ns&&!d&&Ui(r,s,0,!1);break}else{if(c=r.current.alternate,b&&!O2(c)){y=Qu(r,s,!1),b=!1;continue}if(y===2){if(b=s,r.errorRecoveryDisabledLanes&b)var T=0;else T=r.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){s=T;e:{var A=r;y=ba;var U=A.current.memoizedState.isDehydrated;if(U&&(as(A,T).flags|=256),T=Qu(A,T,!1),T!==2){if(Vu&&!U){A.errorRecoveryDisabledLanes|=b,pr|=b,y=4;break e}b=tn,tn=y,b!==null&&(tn===null?tn=b:tn.push.apply(tn,b))}y=T}if(b=!1,y!==2)continue}}if(y===1){as(r,0),Ui(r,s,0,!0);break}e:{switch(d=r,b=y,b){case 0:case 1:throw Error(i(345));case 4:if((s&4194048)!==s)break;case 6:Ui(d,s,Tn,!Li);break e;case 2:tn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((s&62914560)===s&&(y=Fu+300-Rt(),10<y)){if(Ui(d,s,Tn,!Li),Nt(d,0,!0)!==0)break e;d.timeoutHandle=Kg(Sg.bind(null,d,c,tn,Wl,qu,s,Tn,pr,is,Li,b,2,-0,0),y);break e}Sg(d,c,tn,Wl,qu,s,Tn,pr,is,Li,b,0,-0,0)}}break}while(!0);qn(r)}function Sg(r,s,c,d,y,b,T,A,U,re,ce,me,ae,le){if(r.timeoutHandle=-1,me=s.subtreeFlags,(me&8192||(me&16785408)===16785408)&&(Ea={stylesheets:null,count:0,unsuspend:yw},gg(s),me=bw(),me!==null)){r.cancelPendingCommit=me(_g.bind(null,r,s,b,c,d,y,T,A,U,ce,1,ae,le)),Ui(r,b,T,!re);return}_g(r,s,b,c,d,y,T,A,U)}function O2(r){for(var s=r;;){var c=s.tag;if((c===0||c===11||c===15)&&s.flags&16384&&(c=s.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var d=0;d<c.length;d++){var y=c[d],b=y.getSnapshot;y=y.value;try{if(!on(b(),y))return!1}catch{return!1}}if(c=s.child,s.subtreeFlags&16384&&c!==null)c.return=s,s=c;else{if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Ui(r,s,c,d){s&=~$u,s&=~pr,r.suspendedLanes|=s,r.pingedLanes&=~s,d&&(r.warmLanes|=s),d=r.expirationTimes;for(var y=s;0<y;){var b=31-oe(y),T=1<<b;d[b]=-1,y&=~T}c!==0&&Dm(r,c,s)}function Xl(){return(nt&6)===0?(Na(0),!1):!0}function Yu(){if(Fe!==null){if(it===0)var r=Fe.return;else r=Fe,ai=cr=null,du(r),Wr=null,fa=0,r=Fe;for(;r!==null;)ng(r.alternate,r),r=r.return;Fe=null}}function as(r,s){var c=r.timeoutHandle;c!==-1&&(r.timeoutHandle=-1,tw(c)),c=r.cancelPendingCommit,c!==null&&(r.cancelPendingCommit=null,c()),Yu(),dt=r,Fe=c=ii(r.current,null),Ye=s,it=0,fn=null,Li=!1,ns=Jt(r,s),Vu=!1,is=Tn=$u=pr=Pi=wt=0,tn=ba=null,qu=!1,(s&8)!==0&&(s|=s&32);var d=r.entangledLanes;if(d!==0)for(r=r.entanglements,d&=s;0<d;){var y=31-oe(d),b=1<<y;s|=r[y],d&=~b}return hi=s,wl(),c}function Cg(r,s){ze=null,P.H=zl,s===ia||s===_l?(s=Vh(),it=3):s===Bh?(s=Vh(),it=4):it=s===$p?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,fn=s,Fe===null&&(wt=1,Hl(r,bn(s,r.current)))}function Tg(){var r=P.H;return P.H=zl,r===null?zl:r}function jg(){var r=P.A;return P.A=L2,r}function Zu(){wt=4,Li||(Ye&4194048)!==Ye&&Cn.current!==null||(ns=!0),(Pi&134217727)===0&&(pr&134217727)===0||dt===null||Ui(dt,Ye,Tn,!1)}function Qu(r,s,c){var d=nt;nt|=2;var y=Tg(),b=jg();(dt!==r||Ye!==s)&&(Wl=null,as(r,s)),s=!1;var T=wt;e:do try{if(it!==0&&Fe!==null){var A=Fe,U=fn;switch(it){case 8:Yu(),T=6;break e;case 3:case 2:case 9:case 6:Cn.current===null&&(s=!0);var re=it;if(it=0,fn=null,ls(r,A,U,re),c&&ns){T=0;break e}break;default:re=it,it=0,fn=null,ls(r,A,U,re)}}B2(),T=wt;break}catch(ce){Cg(r,ce)}while(!0);return s&&r.shellSuspendCounter++,ai=cr=null,nt=d,P.H=y,P.A=b,Fe===null&&(dt=null,Ye=0,wl()),T}function B2(){for(;Fe!==null;)kg(Fe)}function U2(r,s){var c=nt;nt|=2;var d=Tg(),y=jg();dt!==r||Ye!==s?(Wl=null,Kl=Rt()+500,as(r,s)):ns=Jt(r,s);e:do try{if(it!==0&&Fe!==null){s=Fe;var b=fn;t:switch(it){case 1:it=0,fn=null,ls(r,s,b,1);break;case 2:case 9:if(Uh(b)){it=0,fn=null,Eg(s);break}s=function(){it!==2&&it!==9||dt!==r||(it=7),qn(r)},b.then(s,s);break e;case 3:it=7;break e;case 4:it=5;break e;case 7:Uh(b)?(it=0,fn=null,Eg(s)):(it=0,fn=null,ls(r,s,b,7));break;case 5:var T=null;switch(Fe.tag){case 26:T=Fe.memoizedState;case 5:case 27:var A=Fe;if(!T||c0(T)){it=0,fn=null;var U=A.sibling;if(U!==null)Fe=U;else{var re=A.return;re!==null?(Fe=re,eo(re)):Fe=null}break t}}it=0,fn=null,ls(r,s,b,5);break;case 6:it=0,fn=null,ls(r,s,b,6);break;case 8:Yu(),wt=6;break e;default:throw Error(i(462))}}z2();break}catch(ce){Cg(r,ce)}while(!0);return ai=cr=null,P.H=d,P.A=y,nt=c,Fe!==null?0:(dt=null,Ye=0,wl(),wt)}function z2(){for(;Fe!==null&&!Gt();)kg(Fe)}function kg(r){var s=eg(r.alternate,r,hi);r.memoizedProps=r.pendingProps,s===null?eo(r):Fe=s}function Eg(r){var s=r,c=s.alternate;switch(s.tag){case 15:case 0:s=Yp(c,s,s.pendingProps,s.type,void 0,Ye);break;case 11:s=Yp(c,s,s.pendingProps,s.type.render,s.ref,Ye);break;case 5:du(s);default:ng(c,s),s=Fe=Ah(s,hi),s=eg(c,s,hi)}r.memoizedProps=r.pendingProps,s===null?eo(r):Fe=s}function ls(r,s,c,d){ai=cr=null,du(s),Wr=null,fa=0;var y=s.return;try{if(A2(r,y,s,c,Ye)){wt=1,Hl(r,bn(c,r.current)),Fe=null;return}}catch(b){if(y!==null)throw Fe=y,b;wt=1,Hl(r,bn(c,r.current)),Fe=null;return}s.flags&32768?(et||d===1?r=!0:ns||(Ye&536870912)!==0?r=!1:(Li=r=!0,(d===2||d===9||d===3||d===6)&&(d=Cn.current,d!==null&&d.tag===13&&(d.flags|=16384))),Ag(s,r)):eo(s)}function eo(r){var s=r;do{if((s.flags&32768)!==0){Ag(s,Li);return}r=s.return;var c=M2(s.alternate,s,hi);if(c!==null){Fe=c;return}if(s=s.sibling,s!==null){Fe=s;return}Fe=s=r}while(s!==null);wt===0&&(wt=5)}function Ag(r,s){do{var c=R2(r.alternate,r);if(c!==null){c.flags&=32767,Fe=c;return}if(c=r.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!s&&(r=r.sibling,r!==null)){Fe=r;return}Fe=r=c}while(r!==null);wt=6,Fe=null}function _g(r,s,c,d,y,b,T,A,U){r.cancelPendingCommit=null;do to();while(Bt!==0);if((nt&6)!==0)throw Error(i(327));if(s!==null){if(s===r.current)throw Error(i(177));if(b=s.lanes|s.childLanes,b|=zc,yb(r,c,b,T,A,U),r===dt&&(Fe=dt=null,Ye=0),rs=s,Bi=r,ss=c,Hu=b,Gu=y,bg=d,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,F2(Qe,function(){return Lg(),null})):(r.callbackNode=null,r.callbackPriority=0),d=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||d){d=P.T,P.T=null,y=K.p,K.p=2,T=nt,nt|=4;try{I2(r,s,c)}finally{nt=T,K.p=y,P.T=d}}Bt=1,Mg(),Rg(),Ig()}}function Mg(){if(Bt===1){Bt=0;var r=Bi,s=rs,c=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||c){c=P.T,P.T=null;var d=K.p;K.p=2;var y=nt;nt|=4;try{mg(s,r);var b=od,T=vh(r.containerInfo),A=b.focusedElem,U=b.selectionRange;if(T!==A&&A&&A.ownerDocument&&yh(A.ownerDocument.documentElement,A)){if(U!==null&&Lc(A)){var re=U.start,ce=U.end;if(ce===void 0&&(ce=re),"selectionStart"in A)A.selectionStart=re,A.selectionEnd=Math.min(ce,A.value.length);else{var me=A.ownerDocument||document,ae=me&&me.defaultView||window;if(ae.getSelection){var le=ae.getSelection(),Me=A.textContent.length,Ae=Math.min(U.start,Me),lt=U.end===void 0?Ae:Math.min(U.end,Me);!le.extend&&Ae>lt&&(T=lt,lt=Ae,Ae=T);var W=xh(A,Ae),F=xh(A,lt);if(W&&F&&(le.rangeCount!==1||le.anchorNode!==W.node||le.anchorOffset!==W.offset||le.focusNode!==F.node||le.focusOffset!==F.offset)){var ne=me.createRange();ne.setStart(W.node,W.offset),le.removeAllRanges(),Ae>lt?(le.addRange(ne),le.extend(F.node,F.offset)):(ne.setEnd(F.node,F.offset),le.addRange(ne))}}}}for(me=[],le=A;le=le.parentNode;)le.nodeType===1&&me.push({element:le,left:le.scrollLeft,top:le.scrollTop});for(typeof A.focus=="function"&&A.focus(),A=0;A<me.length;A++){var ue=me[A];ue.element.scrollLeft=ue.left,ue.element.scrollTop=ue.top}}ho=!!ld,od=ld=null}finally{nt=y,K.p=d,P.T=c}}r.current=s,Bt=2}}function Rg(){if(Bt===2){Bt=0;var r=Bi,s=rs,c=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||c){c=P.T,P.T=null;var d=K.p;K.p=2;var y=nt;nt|=4;try{cg(r,s.alternate,s)}finally{nt=y,K.p=d,P.T=c}}Bt=3}}function Ig(){if(Bt===4||Bt===3){Bt=0,xn();var r=Bi,s=rs,c=ss,d=bg;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?Bt=5:(Bt=0,rs=Bi=null,Dg(r,r.pendingLanes));var y=r.pendingLanes;if(y===0&&(Oi=null),hc(c),s=s.stateNode,te&&typeof te.onCommitFiberRoot=="function")try{te.onCommitFiberRoot(Z,s,void 0,(s.current.flags&128)===128)}catch{}if(d!==null){s=P.T,y=K.p,K.p=2,P.T=null;try{for(var b=r.onRecoverableError,T=0;T<d.length;T++){var A=d[T];b(A.value,{componentStack:A.stack})}}finally{P.T=s,K.p=y}}(ss&3)!==0&&to(),qn(r),y=r.pendingLanes,(c&4194090)!==0&&(y&42)!==0?r===Ju?wa++:(wa=0,Ju=r):wa=0,Na(0)}}function Dg(r,s){(r.pooledCacheLanes&=s)===0&&(s=r.pooledCache,s!=null&&(r.pooledCache=null,ta(s)))}function to(r){return Mg(),Rg(),Ig(),Lg()}function Lg(){if(Bt!==5)return!1;var r=Bi,s=Hu;Hu=0;var c=hc(ss),d=P.T,y=K.p;try{K.p=32>c?32:c,P.T=null,c=Gu,Gu=null;var b=Bi,T=ss;if(Bt=0,rs=Bi=null,ss=0,(nt&6)!==0)throw Error(i(331));var A=nt;if(nt|=4,yg(b.current),pg(b,b.current,T,c),nt=A,Na(0,!1),te&&typeof te.onPostCommitFiberRoot=="function")try{te.onPostCommitFiberRoot(Z,b)}catch{}return!0}finally{K.p=y,P.T=d,Dg(r,s)}}function Pg(r,s,c){s=bn(c,s),s=Tu(r.stateNode,s,2),r=Ei(r,s,2),r!==null&&(Us(r,2),qn(r))}function ct(r,s,c){if(r.tag===3)Pg(r,r,c);else for(;s!==null;){if(s.tag===3){Pg(s,r,c);break}else if(s.tag===1){var d=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(Oi===null||!Oi.has(d))){r=bn(c,r),c=zp(2),d=Ei(s,c,2),d!==null&&(Vp(c,d,s,r),Us(d,2),qn(d));break}}s=s.return}}function Ku(r,s,c){var d=r.pingCache;if(d===null){d=r.pingCache=new P2;var y=new Set;d.set(s,y)}else y=d.get(s),y===void 0&&(y=new Set,d.set(s,y));y.has(c)||(Vu=!0,y.add(c),r=V2.bind(null,r,s,c),s.then(r,r))}function V2(r,s,c){var d=r.pingCache;d!==null&&d.delete(s),r.pingedLanes|=r.suspendedLanes&c,r.warmLanes&=~c,dt===r&&(Ye&c)===c&&(wt===4||wt===3&&(Ye&62914560)===Ye&&300>Rt()-Fu?(nt&2)===0&&as(r,0):$u|=c,is===Ye&&(is=0)),qn(r)}function Og(r,s){s===0&&(s=Im()),r=$r(r,s),r!==null&&(Us(r,s),qn(r))}function $2(r){var s=r.memoizedState,c=0;s!==null&&(c=s.retryLane),Og(r,c)}function q2(r,s){var c=0;switch(r.tag){case 13:var d=r.stateNode,y=r.memoizedState;y!==null&&(c=y.retryLane);break;case 19:d=r.stateNode;break;case 22:d=r.stateNode._retryCache;break;default:throw Error(i(314))}d!==null&&d.delete(s),Og(r,c)}function F2(r,s){return gt(r,s)}var no=null,os=null,Wu=!1,io=!1,Xu=!1,gr=0;function qn(r){r!==os&&r.next===null&&(os===null?no=os=r:os=os.next=r),io=!0,Wu||(Wu=!0,G2())}function Na(r,s){if(!Xu&&io){Xu=!0;do for(var c=!1,d=no;d!==null;){if(r!==0){var y=d.pendingLanes;if(y===0)var b=0;else{var T=d.suspendedLanes,A=d.pingedLanes;b=(1<<31-oe(42|r)+1)-1,b&=y&~(T&~A),b=b&201326741?b&201326741|1:b?b|2:0}b!==0&&(c=!0,Vg(d,b))}else b=Ye,b=Nt(d,d===dt?b:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(b&3)===0||Jt(d,b)||(c=!0,Vg(d,b));d=d.next}while(c);Xu=!1}}function H2(){Bg()}function Bg(){io=Wu=!1;var r=0;gr!==0&&(ew()&&(r=gr),gr=0);for(var s=Rt(),c=null,d=no;d!==null;){var y=d.next,b=Ug(d,s);b===0?(d.next=null,c===null?no=y:c.next=y,y===null&&(os=c)):(c=d,(r!==0||(b&3)!==0)&&(io=!0)),d=y}Na(r)}function Ug(r,s){for(var c=r.suspendedLanes,d=r.pingedLanes,y=r.expirationTimes,b=r.pendingLanes&-62914561;0<b;){var T=31-oe(b),A=1<<T,U=y[T];U===-1?((A&c)===0||(A&d)!==0)&&(y[T]=_n(A,s)):U<=s&&(r.expiredLanes|=A),b&=~A}if(s=dt,c=Ye,c=Nt(r,r===s?c:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),d=r.callbackNode,c===0||r===s&&(it===2||it===9)||r.cancelPendingCommit!==null)return d!==null&&d!==null&&Je(d),r.callbackNode=null,r.callbackPriority=0;if((c&3)===0||Jt(r,c)){if(s=c&-c,s===r.callbackPriority)return s;switch(d!==null&&Je(d),hc(c)){case 2:case 8:c=ei;break;case 32:c=Qe;break;case 268435456:c=ln;break;default:c=Qe}return d=zg.bind(null,r),c=gt(c,d),r.callbackPriority=s,r.callbackNode=c,s}return d!==null&&d!==null&&Je(d),r.callbackPriority=2,r.callbackNode=null,2}function zg(r,s){if(Bt!==0&&Bt!==5)return r.callbackNode=null,r.callbackPriority=0,null;var c=r.callbackNode;if(to()&&r.callbackNode!==c)return null;var d=Ye;return d=Nt(r,r===dt?d:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),d===0?null:(Ng(r,d,s),Ug(r,Rt()),r.callbackNode!=null&&r.callbackNode===c?zg.bind(null,r):null)}function Vg(r,s){if(to())return null;Ng(r,s,!0)}function G2(){nw(function(){(nt&6)!==0?gt($e,H2):Bg()})}function ed(){return gr===0&&(gr=Rm()),gr}function $g(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:hl(""+r)}function qg(r,s){var c=s.ownerDocument.createElement("input");return c.name=s.name,c.value=s.value,r.id&&c.setAttribute("form",r.id),s.parentNode.insertBefore(c,s),r=new FormData(r),c.parentNode.removeChild(c),r}function J2(r,s,c,d,y){if(s==="submit"&&c&&c.stateNode===y){var b=$g((y[Kt]||null).action),T=d.submitter;T&&(s=(s=T[Kt]||null)?$g(s.formAction):T.getAttribute("formAction"),s!==null&&(b=s,T=null));var A=new yl("action","action",null,d,y);r.push({event:A,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(gr!==0){var U=T?qg(y,T):new FormData(y);bu(c,{pending:!0,data:U,method:y.method,action:b},null,U)}}else typeof b=="function"&&(A.preventDefault(),U=T?qg(y,T):new FormData(y),bu(c,{pending:!0,data:U,method:y.method,action:b},b,U))},currentTarget:y}]})}}for(var td=0;td<Uc.length;td++){var nd=Uc[td],Y2=nd.toLowerCase(),Z2=nd[0].toUpperCase()+nd.slice(1);Mn(Y2,"on"+Z2)}Mn(Nh,"onAnimationEnd"),Mn(Sh,"onAnimationIteration"),Mn(Ch,"onAnimationStart"),Mn("dblclick","onDoubleClick"),Mn("focusin","onFocus"),Mn("focusout","onBlur"),Mn(f2,"onTransitionRun"),Mn(m2,"onTransitionStart"),Mn(h2,"onTransitionCancel"),Mn(Th,"onTransitionEnd"),Rr("onMouseEnter",["mouseout","mouseover"]),Rr("onMouseLeave",["mouseout","mouseover"]),Rr("onPointerEnter",["pointerout","pointerover"]),Rr("onPointerLeave",["pointerout","pointerover"]),er("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),er("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),er("onBeforeInput",["compositionend","keypress","textInput","paste"]),er("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),er("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),er("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Sa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Q2=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Sa));function Fg(r,s){s=(s&4)!==0;for(var c=0;c<r.length;c++){var d=r[c],y=d.event;d=d.listeners;e:{var b=void 0;if(s)for(var T=d.length-1;0<=T;T--){var A=d[T],U=A.instance,re=A.currentTarget;if(A=A.listener,U!==b&&y.isPropagationStopped())break e;b=A,y.currentTarget=re;try{b(y)}catch(ce){Fl(ce)}y.currentTarget=null,b=U}else for(T=0;T<d.length;T++){if(A=d[T],U=A.instance,re=A.currentTarget,A=A.listener,U!==b&&y.isPropagationStopped())break e;b=A,y.currentTarget=re;try{b(y)}catch(ce){Fl(ce)}y.currentTarget=null,b=U}}}}function He(r,s){var c=s[pc];c===void 0&&(c=s[pc]=new Set);var d=r+"__bubble";c.has(d)||(Hg(s,r,2,!1),c.add(d))}function id(r,s,c){var d=0;s&&(d|=4),Hg(c,r,d,s)}var ro="_reactListening"+Math.random().toString(36).slice(2);function rd(r){if(!r[ro]){r[ro]=!0,Bm.forEach(function(c){c!=="selectionchange"&&(Q2.has(c)||id(c,!1,r),id(c,!0,r))});var s=r.nodeType===9?r:r.ownerDocument;s===null||s[ro]||(s[ro]=!0,id("selectionchange",!1,s))}}function Hg(r,s,c,d){switch(p0(s)){case 2:var y=Sw;break;case 8:y=Cw;break;default:y=yd}c=y.bind(null,s,c,r),y=void 0,!jc||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(y=!0),d?y!==void 0?r.addEventListener(s,c,{capture:!0,passive:y}):r.addEventListener(s,c,!0):y!==void 0?r.addEventListener(s,c,{passive:y}):r.addEventListener(s,c,!1)}function sd(r,s,c,d,y){var b=d;if((s&1)===0&&(s&2)===0&&d!==null)e:for(;;){if(d===null)return;var T=d.tag;if(T===3||T===4){var A=d.stateNode.containerInfo;if(A===y)break;if(T===4)for(T=d.return;T!==null;){var U=T.tag;if((U===3||U===4)&&T.stateNode.containerInfo===y)return;T=T.return}for(;A!==null;){if(T=Ar(A),T===null)return;if(U=T.tag,U===5||U===6||U===26||U===27){d=b=T;continue e}A=A.parentNode}}d=d.return}Wm(function(){var re=b,ce=Cc(c),me=[];e:{var ae=jh.get(r);if(ae!==void 0){var le=yl,Me=r;switch(r){case"keypress":if(gl(c)===0)break e;case"keydown":case"keyup":le=Fb;break;case"focusin":Me="focus",le=_c;break;case"focusout":Me="blur",le=_c;break;case"beforeblur":case"afterblur":le=_c;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":le=th;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":le=Rb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":le=Jb;break;case Nh:case Sh:case Ch:le=Lb;break;case Th:le=Zb;break;case"scroll":case"scrollend":le=_b;break;case"wheel":le=Kb;break;case"copy":case"cut":case"paste":le=Ob;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":le=ih;break;case"toggle":case"beforetoggle":le=Xb}var Ae=(s&4)!==0,lt=!Ae&&(r==="scroll"||r==="scrollend"),W=Ae?ae!==null?ae+"Capture":null:ae;Ae=[];for(var F=re,ne;F!==null;){var ue=F;if(ne=ue.stateNode,ue=ue.tag,ue!==5&&ue!==26&&ue!==27||ne===null||W===null||(ue=$s(F,W),ue!=null&&Ae.push(Ca(F,ue,ne))),lt)break;F=F.return}0<Ae.length&&(ae=new le(ae,Me,null,c,ce),me.push({event:ae,listeners:Ae}))}}if((s&7)===0){e:{if(ae=r==="mouseover"||r==="pointerover",le=r==="mouseout"||r==="pointerout",ae&&c!==Sc&&(Me=c.relatedTarget||c.fromElement)&&(Ar(Me)||Me[Er]))break e;if((le||ae)&&(ae=ce.window===ce?ce:(ae=ce.ownerDocument)?ae.defaultView||ae.parentWindow:window,le?(Me=c.relatedTarget||c.toElement,le=re,Me=Me?Ar(Me):null,Me!==null&&(lt=o(Me),Ae=Me.tag,Me!==lt||Ae!==5&&Ae!==27&&Ae!==6)&&(Me=null)):(le=null,Me=re),le!==Me)){if(Ae=th,ue="onMouseLeave",W="onMouseEnter",F="mouse",(r==="pointerout"||r==="pointerover")&&(Ae=ih,ue="onPointerLeave",W="onPointerEnter",F="pointer"),lt=le==null?ae:Vs(le),ne=Me==null?ae:Vs(Me),ae=new Ae(ue,F+"leave",le,c,ce),ae.target=lt,ae.relatedTarget=ne,ue=null,Ar(ce)===re&&(Ae=new Ae(W,F+"enter",Me,c,ce),Ae.target=ne,Ae.relatedTarget=lt,ue=Ae),lt=ue,le&&Me)t:{for(Ae=le,W=Me,F=0,ne=Ae;ne;ne=cs(ne))F++;for(ne=0,ue=W;ue;ue=cs(ue))ne++;for(;0<F-ne;)Ae=cs(Ae),F--;for(;0<ne-F;)W=cs(W),ne--;for(;F--;){if(Ae===W||W!==null&&Ae===W.alternate)break t;Ae=cs(Ae),W=cs(W)}Ae=null}else Ae=null;le!==null&&Gg(me,ae,le,Ae,!1),Me!==null&&lt!==null&&Gg(me,lt,Me,Ae,!0)}}e:{if(ae=re?Vs(re):window,le=ae.nodeName&&ae.nodeName.toLowerCase(),le==="select"||le==="input"&&ae.type==="file")var Ce=dh;else if(ch(ae))if(fh)Ce=c2;else{Ce=l2;var qe=a2}else le=ae.nodeName,!le||le.toLowerCase()!=="input"||ae.type!=="checkbox"&&ae.type!=="radio"?re&&Nc(re.elementType)&&(Ce=dh):Ce=o2;if(Ce&&(Ce=Ce(r,re))){uh(me,Ce,c,ce);break e}qe&&qe(r,ae,re),r==="focusout"&&re&&ae.type==="number"&&re.memoizedProps.value!=null&&wc(ae,"number",ae.value)}switch(qe=re?Vs(re):window,r){case"focusin":(ch(qe)||qe.contentEditable==="true")&&(Ur=qe,Pc=re,Qs=null);break;case"focusout":Qs=Pc=Ur=null;break;case"mousedown":Oc=!0;break;case"contextmenu":case"mouseup":case"dragend":Oc=!1,bh(me,c,ce);break;case"selectionchange":if(d2)break;case"keydown":case"keyup":bh(me,c,ce)}var ke;if(Rc)e:{switch(r){case"compositionstart":var _e="onCompositionStart";break e;case"compositionend":_e="onCompositionEnd";break e;case"compositionupdate":_e="onCompositionUpdate";break e}_e=void 0}else Br?lh(r,c)&&(_e="onCompositionEnd"):r==="keydown"&&c.keyCode===229&&(_e="onCompositionStart");_e&&(rh&&c.locale!=="ko"&&(Br||_e!=="onCompositionStart"?_e==="onCompositionEnd"&&Br&&(ke=Xm()):(Ci=ce,kc="value"in Ci?Ci.value:Ci.textContent,Br=!0)),qe=so(re,_e),0<qe.length&&(_e=new nh(_e,r,null,c,ce),me.push({event:_e,listeners:qe}),ke?_e.data=ke:(ke=oh(c),ke!==null&&(_e.data=ke)))),(ke=t2?n2(r,c):i2(r,c))&&(_e=so(re,"onBeforeInput"),0<_e.length&&(qe=new nh("onBeforeInput","beforeinput",null,c,ce),me.push({event:qe,listeners:_e}),qe.data=ke)),J2(me,r,re,c,ce)}Fg(me,s)})}function Ca(r,s,c){return{instance:r,listener:s,currentTarget:c}}function so(r,s){for(var c=s+"Capture",d=[];r!==null;){var y=r,b=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||b===null||(y=$s(r,c),y!=null&&d.unshift(Ca(r,y,b)),y=$s(r,s),y!=null&&d.push(Ca(r,y,b))),r.tag===3)return d;r=r.return}return[]}function cs(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function Gg(r,s,c,d,y){for(var b=s._reactName,T=[];c!==null&&c!==d;){var A=c,U=A.alternate,re=A.stateNode;if(A=A.tag,U!==null&&U===d)break;A!==5&&A!==26&&A!==27||re===null||(U=re,y?(re=$s(c,b),re!=null&&T.unshift(Ca(c,re,U))):y||(re=$s(c,b),re!=null&&T.push(Ca(c,re,U)))),c=c.return}T.length!==0&&r.push({event:s,listeners:T})}var K2=/\r\n?/g,W2=/\u0000|\uFFFD/g;function Jg(r){return(typeof r=="string"?r:""+r).replace(K2,`
`).replace(W2,"")}function Yg(r,s){return s=Jg(s),Jg(r)===s}function ao(){}function at(r,s,c,d,y,b){switch(c){case"children":typeof d=="string"?s==="body"||s==="textarea"&&d===""||Lr(r,d):(typeof d=="number"||typeof d=="bigint")&&s!=="body"&&Lr(r,""+d);break;case"className":dl(r,"class",d);break;case"tabIndex":dl(r,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":dl(r,c,d);break;case"style":Qm(r,d,b);break;case"data":if(s!=="object"){dl(r,"data",d);break}case"src":case"href":if(d===""&&(s!=="a"||c!=="href")){r.removeAttribute(c);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){r.removeAttribute(c);break}d=hl(""+d),r.setAttribute(c,d);break;case"action":case"formAction":if(typeof d=="function"){r.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof b=="function"&&(c==="formAction"?(s!=="input"&&at(r,s,"name",y.name,y,null),at(r,s,"formEncType",y.formEncType,y,null),at(r,s,"formMethod",y.formMethod,y,null),at(r,s,"formTarget",y.formTarget,y,null)):(at(r,s,"encType",y.encType,y,null),at(r,s,"method",y.method,y,null),at(r,s,"target",y.target,y,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){r.removeAttribute(c);break}d=hl(""+d),r.setAttribute(c,d);break;case"onClick":d!=null&&(r.onclick=ao);break;case"onScroll":d!=null&&He("scroll",r);break;case"onScrollEnd":d!=null&&He("scrollend",r);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(i(61));if(c=d.__html,c!=null){if(y.children!=null)throw Error(i(60));r.innerHTML=c}}break;case"multiple":r.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":r.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){r.removeAttribute("xlink:href");break}c=hl(""+d),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(c,""+d):r.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(c,""):r.removeAttribute(c);break;case"capture":case"download":d===!0?r.setAttribute(c,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(c,d):r.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?r.setAttribute(c,d):r.removeAttribute(c);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?r.removeAttribute(c):r.setAttribute(c,d);break;case"popover":He("beforetoggle",r),He("toggle",r),ul(r,"popover",d);break;case"xlinkActuate":ti(r,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":ti(r,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":ti(r,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":ti(r,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":ti(r,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":ti(r,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":ti(r,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":ti(r,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":ti(r,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":ul(r,"is",d);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=Eb.get(c)||c,ul(r,c,d))}}function ad(r,s,c,d,y,b){switch(c){case"style":Qm(r,d,b);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(i(61));if(c=d.__html,c!=null){if(y.children!=null)throw Error(i(60));r.innerHTML=c}}break;case"children":typeof d=="string"?Lr(r,d):(typeof d=="number"||typeof d=="bigint")&&Lr(r,""+d);break;case"onScroll":d!=null&&He("scroll",r);break;case"onScrollEnd":d!=null&&He("scrollend",r);break;case"onClick":d!=null&&(r.onclick=ao);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Um.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(y=c.endsWith("Capture"),s=c.slice(2,y?c.length-7:void 0),b=r[Kt]||null,b=b!=null?b[c]:null,typeof b=="function"&&r.removeEventListener(s,b,y),typeof d=="function")){typeof b!="function"&&b!==null&&(c in r?r[c]=null:r.hasAttribute(c)&&r.removeAttribute(c)),r.addEventListener(s,d,y);break e}c in r?r[c]=d:d===!0?r.setAttribute(c,""):ul(r,c,d)}}}function Ut(r,s,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":He("error",r),He("load",r);var d=!1,y=!1,b;for(b in c)if(c.hasOwnProperty(b)){var T=c[b];if(T!=null)switch(b){case"src":d=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:at(r,s,b,T,c,null)}}y&&at(r,s,"srcSet",c.srcSet,c,null),d&&at(r,s,"src",c.src,c,null);return;case"input":He("invalid",r);var A=b=T=y=null,U=null,re=null;for(d in c)if(c.hasOwnProperty(d)){var ce=c[d];if(ce!=null)switch(d){case"name":y=ce;break;case"type":T=ce;break;case"checked":U=ce;break;case"defaultChecked":re=ce;break;case"value":b=ce;break;case"defaultValue":A=ce;break;case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(i(137,s));break;default:at(r,s,d,ce,c,null)}}Gm(r,b,A,U,re,T,y,!1),fl(r);return;case"select":He("invalid",r),d=T=b=null;for(y in c)if(c.hasOwnProperty(y)&&(A=c[y],A!=null))switch(y){case"value":b=A;break;case"defaultValue":T=A;break;case"multiple":d=A;default:at(r,s,y,A,c,null)}s=b,c=T,r.multiple=!!d,s!=null?Dr(r,!!d,s,!1):c!=null&&Dr(r,!!d,c,!0);return;case"textarea":He("invalid",r),b=y=d=null;for(T in c)if(c.hasOwnProperty(T)&&(A=c[T],A!=null))switch(T){case"value":d=A;break;case"defaultValue":y=A;break;case"children":b=A;break;case"dangerouslySetInnerHTML":if(A!=null)throw Error(i(91));break;default:at(r,s,T,A,c,null)}Ym(r,d,y,b),fl(r);return;case"option":for(U in c)if(c.hasOwnProperty(U)&&(d=c[U],d!=null))switch(U){case"selected":r.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:at(r,s,U,d,c,null)}return;case"dialog":He("beforetoggle",r),He("toggle",r),He("cancel",r),He("close",r);break;case"iframe":case"object":He("load",r);break;case"video":case"audio":for(d=0;d<Sa.length;d++)He(Sa[d],r);break;case"image":He("error",r),He("load",r);break;case"details":He("toggle",r);break;case"embed":case"source":case"link":He("error",r),He("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(re in c)if(c.hasOwnProperty(re)&&(d=c[re],d!=null))switch(re){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:at(r,s,re,d,c,null)}return;default:if(Nc(s)){for(ce in c)c.hasOwnProperty(ce)&&(d=c[ce],d!==void 0&&ad(r,s,ce,d,c,void 0));return}}for(A in c)c.hasOwnProperty(A)&&(d=c[A],d!=null&&at(r,s,A,d,c,null))}function X2(r,s,c,d){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,b=null,T=null,A=null,U=null,re=null,ce=null;for(le in c){var me=c[le];if(c.hasOwnProperty(le)&&me!=null)switch(le){case"checked":break;case"value":break;case"defaultValue":U=me;default:d.hasOwnProperty(le)||at(r,s,le,null,d,me)}}for(var ae in d){var le=d[ae];if(me=c[ae],d.hasOwnProperty(ae)&&(le!=null||me!=null))switch(ae){case"type":b=le;break;case"name":y=le;break;case"checked":re=le;break;case"defaultChecked":ce=le;break;case"value":T=le;break;case"defaultValue":A=le;break;case"children":case"dangerouslySetInnerHTML":if(le!=null)throw Error(i(137,s));break;default:le!==me&&at(r,s,ae,le,d,me)}}bc(r,T,A,U,re,ce,b,y);return;case"select":le=T=A=ae=null;for(b in c)if(U=c[b],c.hasOwnProperty(b)&&U!=null)switch(b){case"value":break;case"multiple":le=U;default:d.hasOwnProperty(b)||at(r,s,b,null,d,U)}for(y in d)if(b=d[y],U=c[y],d.hasOwnProperty(y)&&(b!=null||U!=null))switch(y){case"value":ae=b;break;case"defaultValue":A=b;break;case"multiple":T=b;default:b!==U&&at(r,s,y,b,d,U)}s=A,c=T,d=le,ae!=null?Dr(r,!!c,ae,!1):!!d!=!!c&&(s!=null?Dr(r,!!c,s,!0):Dr(r,!!c,c?[]:"",!1));return;case"textarea":le=ae=null;for(A in c)if(y=c[A],c.hasOwnProperty(A)&&y!=null&&!d.hasOwnProperty(A))switch(A){case"value":break;case"children":break;default:at(r,s,A,null,d,y)}for(T in d)if(y=d[T],b=c[T],d.hasOwnProperty(T)&&(y!=null||b!=null))switch(T){case"value":ae=y;break;case"defaultValue":le=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(i(91));break;default:y!==b&&at(r,s,T,y,d,b)}Jm(r,ae,le);return;case"option":for(var Me in c)if(ae=c[Me],c.hasOwnProperty(Me)&&ae!=null&&!d.hasOwnProperty(Me))switch(Me){case"selected":r.selected=!1;break;default:at(r,s,Me,null,d,ae)}for(U in d)if(ae=d[U],le=c[U],d.hasOwnProperty(U)&&ae!==le&&(ae!=null||le!=null))switch(U){case"selected":r.selected=ae&&typeof ae!="function"&&typeof ae!="symbol";break;default:at(r,s,U,ae,d,le)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ae in c)ae=c[Ae],c.hasOwnProperty(Ae)&&ae!=null&&!d.hasOwnProperty(Ae)&&at(r,s,Ae,null,d,ae);for(re in d)if(ae=d[re],le=c[re],d.hasOwnProperty(re)&&ae!==le&&(ae!=null||le!=null))switch(re){case"children":case"dangerouslySetInnerHTML":if(ae!=null)throw Error(i(137,s));break;default:at(r,s,re,ae,d,le)}return;default:if(Nc(s)){for(var lt in c)ae=c[lt],c.hasOwnProperty(lt)&&ae!==void 0&&!d.hasOwnProperty(lt)&&ad(r,s,lt,void 0,d,ae);for(ce in d)ae=d[ce],le=c[ce],!d.hasOwnProperty(ce)||ae===le||ae===void 0&&le===void 0||ad(r,s,ce,ae,d,le);return}}for(var W in c)ae=c[W],c.hasOwnProperty(W)&&ae!=null&&!d.hasOwnProperty(W)&&at(r,s,W,null,d,ae);for(me in d)ae=d[me],le=c[me],!d.hasOwnProperty(me)||ae===le||ae==null&&le==null||at(r,s,me,ae,d,le)}var ld=null,od=null;function lo(r){return r.nodeType===9?r:r.ownerDocument}function Zg(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Qg(r,s){if(r===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&s==="foreignObject"?0:r}function cd(r,s){return r==="textarea"||r==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var ud=null;function ew(){var r=window.event;return r&&r.type==="popstate"?r===ud?!1:(ud=r,!0):(ud=null,!1)}var Kg=typeof setTimeout=="function"?setTimeout:void 0,tw=typeof clearTimeout=="function"?clearTimeout:void 0,Wg=typeof Promise=="function"?Promise:void 0,nw=typeof queueMicrotask=="function"?queueMicrotask:typeof Wg<"u"?function(r){return Wg.resolve(null).then(r).catch(iw)}:Kg;function iw(r){setTimeout(function(){throw r})}function zi(r){return r==="head"}function Xg(r,s){var c=s,d=0,y=0;do{var b=c.nextSibling;if(r.removeChild(c),b&&b.nodeType===8)if(c=b.data,c==="/$"){if(0<d&&8>d){c=d;var T=r.ownerDocument;if(c&1&&Ta(T.documentElement),c&2&&Ta(T.body),c&4)for(c=T.head,Ta(c),T=c.firstChild;T;){var A=T.nextSibling,U=T.nodeName;T[zs]||U==="SCRIPT"||U==="STYLE"||U==="LINK"&&T.rel.toLowerCase()==="stylesheet"||c.removeChild(T),T=A}}if(y===0){r.removeChild(b),Ia(s);return}y--}else c==="$"||c==="$?"||c==="$!"?y++:d=c.charCodeAt(0)-48;else d=0;c=b}while(c);Ia(s)}function dd(r){var s=r.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var c=s;switch(s=s.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":dd(c),gc(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}r.removeChild(c)}}function rw(r,s,c,d){for(;r.nodeType===1;){var y=c;if(r.nodeName.toLowerCase()!==s.toLowerCase()){if(!d&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(d){if(!r[zs])switch(s){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(b=r.getAttribute("rel"),b==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(b!==y.rel||r.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||r.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||r.getAttribute("title")!==(y.title==null?null:y.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(b=r.getAttribute("src"),(b!==(y.src==null?null:y.src)||r.getAttribute("type")!==(y.type==null?null:y.type)||r.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&b&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(s==="input"&&r.type==="hidden"){var b=y.name==null?null:""+y.name;if(y.type==="hidden"&&r.getAttribute("name")===b)return r}else return r;if(r=In(r.nextSibling),r===null)break}return null}function sw(r,s,c){if(s==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!c||(r=In(r.nextSibling),r===null))return null;return r}function fd(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState==="complete"}function aw(r,s){var c=r.ownerDocument;if(r.data!=="$?"||c.readyState==="complete")s();else{var d=function(){s(),c.removeEventListener("DOMContentLoaded",d)};c.addEventListener("DOMContentLoaded",d),r._reactRetry=d}}function In(r){for(;r!=null;r=r.nextSibling){var s=r.nodeType;if(s===1||s===3)break;if(s===8){if(s=r.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return r}var md=null;function e0(r){r=r.previousSibling;for(var s=0;r;){if(r.nodeType===8){var c=r.data;if(c==="$"||c==="$!"||c==="$?"){if(s===0)return r;s--}else c==="/$"&&s++}r=r.previousSibling}return null}function t0(r,s,c){switch(s=lo(c),r){case"html":if(r=s.documentElement,!r)throw Error(i(452));return r;case"head":if(r=s.head,!r)throw Error(i(453));return r;case"body":if(r=s.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function Ta(r){for(var s=r.attributes;s.length;)r.removeAttributeNode(s[0]);gc(r)}var jn=new Map,n0=new Set;function oo(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var pi=K.d;K.d={f:lw,r:ow,D:cw,C:uw,L:dw,m:fw,X:hw,S:mw,M:pw};function lw(){var r=pi.f(),s=Xl();return r||s}function ow(r){var s=_r(r);s!==null&&s.tag===5&&s.type==="form"?Np(s):pi.r(r)}var us=typeof document>"u"?null:document;function i0(r,s,c){var d=us;if(d&&typeof s=="string"&&s){var y=vn(s);y='link[rel="'+r+'"][href="'+y+'"]',typeof c=="string"&&(y+='[crossorigin="'+c+'"]'),n0.has(y)||(n0.add(y),r={rel:r,crossOrigin:c,href:s},d.querySelector(y)===null&&(s=d.createElement("link"),Ut(s,"link",r),It(s),d.head.appendChild(s)))}}function cw(r){pi.D(r),i0("dns-prefetch",r,null)}function uw(r,s){pi.C(r,s),i0("preconnect",r,s)}function dw(r,s,c){pi.L(r,s,c);var d=us;if(d&&r&&s){var y='link[rel="preload"][as="'+vn(s)+'"]';s==="image"&&c&&c.imageSrcSet?(y+='[imagesrcset="'+vn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(y+='[imagesizes="'+vn(c.imageSizes)+'"]')):y+='[href="'+vn(r)+'"]';var b=y;switch(s){case"style":b=ds(r);break;case"script":b=fs(r)}jn.has(b)||(r=x({rel:"preload",href:s==="image"&&c&&c.imageSrcSet?void 0:r,as:s},c),jn.set(b,r),d.querySelector(y)!==null||s==="style"&&d.querySelector(ja(b))||s==="script"&&d.querySelector(ka(b))||(s=d.createElement("link"),Ut(s,"link",r),It(s),d.head.appendChild(s)))}}function fw(r,s){pi.m(r,s);var c=us;if(c&&r){var d=s&&typeof s.as=="string"?s.as:"script",y='link[rel="modulepreload"][as="'+vn(d)+'"][href="'+vn(r)+'"]',b=y;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":b=fs(r)}if(!jn.has(b)&&(r=x({rel:"modulepreload",href:r},s),jn.set(b,r),c.querySelector(y)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(ka(b)))return}d=c.createElement("link"),Ut(d,"link",r),It(d),c.head.appendChild(d)}}}function mw(r,s,c){pi.S(r,s,c);var d=us;if(d&&r){var y=Mr(d).hoistableStyles,b=ds(r);s=s||"default";var T=y.get(b);if(!T){var A={loading:0,preload:null};if(T=d.querySelector(ja(b)))A.loading=5;else{r=x({rel:"stylesheet",href:r,"data-precedence":s},c),(c=jn.get(b))&&hd(r,c);var U=T=d.createElement("link");It(U),Ut(U,"link",r),U._p=new Promise(function(re,ce){U.onload=re,U.onerror=ce}),U.addEventListener("load",function(){A.loading|=1}),U.addEventListener("error",function(){A.loading|=2}),A.loading|=4,co(T,s,d)}T={type:"stylesheet",instance:T,count:1,state:A},y.set(b,T)}}}function hw(r,s){pi.X(r,s);var c=us;if(c&&r){var d=Mr(c).hoistableScripts,y=fs(r),b=d.get(y);b||(b=c.querySelector(ka(y)),b||(r=x({src:r,async:!0},s),(s=jn.get(y))&&pd(r,s),b=c.createElement("script"),It(b),Ut(b,"link",r),c.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},d.set(y,b))}}function pw(r,s){pi.M(r,s);var c=us;if(c&&r){var d=Mr(c).hoistableScripts,y=fs(r),b=d.get(y);b||(b=c.querySelector(ka(y)),b||(r=x({src:r,async:!0,type:"module"},s),(s=jn.get(y))&&pd(r,s),b=c.createElement("script"),It(b),Ut(b,"link",r),c.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},d.set(y,b))}}function r0(r,s,c,d){var y=(y=se.current)?oo(y):null;if(!y)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(s=ds(c.href),c=Mr(y).hoistableStyles,d=c.get(s),d||(d={type:"style",instance:null,count:0,state:null},c.set(s,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){r=ds(c.href);var b=Mr(y).hoistableStyles,T=b.get(r);if(T||(y=y.ownerDocument||y,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},b.set(r,T),(b=y.querySelector(ja(r)))&&!b._p&&(T.instance=b,T.state.loading=5),jn.has(r)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},jn.set(r,c),b||gw(y,r,c,T.state))),s&&d===null)throw Error(i(528,""));return T}if(s&&d!==null)throw Error(i(529,""));return null;case"script":return s=c.async,c=c.src,typeof c=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=fs(c),c=Mr(y).hoistableScripts,d=c.get(s),d||(d={type:"script",instance:null,count:0,state:null},c.set(s,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function ds(r){return'href="'+vn(r)+'"'}function ja(r){return'link[rel="stylesheet"]['+r+"]"}function s0(r){return x({},r,{"data-precedence":r.precedence,precedence:null})}function gw(r,s,c,d){r.querySelector('link[rel="preload"][as="style"]['+s+"]")?d.loading=1:(s=r.createElement("link"),d.preload=s,s.addEventListener("load",function(){return d.loading|=1}),s.addEventListener("error",function(){return d.loading|=2}),Ut(s,"link",c),It(s),r.head.appendChild(s))}function fs(r){return'[src="'+vn(r)+'"]'}function ka(r){return"script[async]"+r}function a0(r,s,c){if(s.count++,s.instance===null)switch(s.type){case"style":var d=r.querySelector('style[data-href~="'+vn(c.href)+'"]');if(d)return s.instance=d,It(d),d;var y=x({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return d=(r.ownerDocument||r).createElement("style"),It(d),Ut(d,"style",y),co(d,c.precedence,r),s.instance=d;case"stylesheet":y=ds(c.href);var b=r.querySelector(ja(y));if(b)return s.state.loading|=4,s.instance=b,It(b),b;d=s0(c),(y=jn.get(y))&&hd(d,y),b=(r.ownerDocument||r).createElement("link"),It(b);var T=b;return T._p=new Promise(function(A,U){T.onload=A,T.onerror=U}),Ut(b,"link",d),s.state.loading|=4,co(b,c.precedence,r),s.instance=b;case"script":return b=fs(c.src),(y=r.querySelector(ka(b)))?(s.instance=y,It(y),y):(d=c,(y=jn.get(b))&&(d=x({},c),pd(d,y)),r=r.ownerDocument||r,y=r.createElement("script"),It(y),Ut(y,"link",d),r.head.appendChild(y),s.instance=y);case"void":return null;default:throw Error(i(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(d=s.instance,s.state.loading|=4,co(d,c.precedence,r));return s.instance}function co(r,s,c){for(var d=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=d.length?d[d.length-1]:null,b=y,T=0;T<d.length;T++){var A=d[T];if(A.dataset.precedence===s)b=A;else if(b!==y)break}b?b.parentNode.insertBefore(r,b.nextSibling):(s=c.nodeType===9?c.head:c,s.insertBefore(r,s.firstChild))}function hd(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.title==null&&(r.title=s.title)}function pd(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.integrity==null&&(r.integrity=s.integrity)}var uo=null;function l0(r,s,c){if(uo===null){var d=new Map,y=uo=new Map;y.set(c,d)}else y=uo,d=y.get(c),d||(d=new Map,y.set(c,d));if(d.has(r))return d;for(d.set(r,null),c=c.getElementsByTagName(r),y=0;y<c.length;y++){var b=c[y];if(!(b[zs]||b[$t]||r==="link"&&b.getAttribute("rel")==="stylesheet")&&b.namespaceURI!=="http://www.w3.org/2000/svg"){var T=b.getAttribute(s)||"";T=r+T;var A=d.get(T);A?A.push(b):d.set(T,[b])}}return d}function o0(r,s,c){r=r.ownerDocument||r,r.head.insertBefore(c,s==="title"?r.querySelector("head > title"):null)}function xw(r,s,c){if(c===1||s.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return r=s.disabled,typeof s.precedence=="string"&&r==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function c0(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}var Ea=null;function yw(){}function vw(r,s,c){if(Ea===null)throw Error(i(475));var d=Ea;if(s.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var y=ds(c.href),b=r.querySelector(ja(y));if(b){r=b._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(d.count++,d=fo.bind(d),r.then(d,d)),s.state.loading|=4,s.instance=b,It(b);return}b=r.ownerDocument||r,c=s0(c),(y=jn.get(y))&&hd(c,y),b=b.createElement("link"),It(b);var T=b;T._p=new Promise(function(A,U){T.onload=A,T.onerror=U}),Ut(b,"link",c),s.instance=b}d.stylesheets===null&&(d.stylesheets=new Map),d.stylesheets.set(s,r),(r=s.state.preload)&&(s.state.loading&3)===0&&(d.count++,s=fo.bind(d),r.addEventListener("load",s),r.addEventListener("error",s))}}function bw(){if(Ea===null)throw Error(i(475));var r=Ea;return r.stylesheets&&r.count===0&&gd(r,r.stylesheets),0<r.count?function(s){var c=setTimeout(function(){if(r.stylesheets&&gd(r,r.stylesheets),r.unsuspend){var d=r.unsuspend;r.unsuspend=null,d()}},6e4);return r.unsuspend=s,function(){r.unsuspend=null,clearTimeout(c)}}:null}function fo(){if(this.count--,this.count===0){if(this.stylesheets)gd(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var mo=null;function gd(r,s){r.stylesheets=null,r.unsuspend!==null&&(r.count++,mo=new Map,s.forEach(ww,r),mo=null,fo.call(r))}function ww(r,s){if(!(s.state.loading&4)){var c=mo.get(r);if(c)var d=c.get(null);else{c=new Map,mo.set(r,c);for(var y=r.querySelectorAll("link[data-precedence],style[data-precedence]"),b=0;b<y.length;b++){var T=y[b];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(c.set(T.dataset.precedence,T),d=T)}d&&c.set(null,d)}y=s.instance,T=y.getAttribute("data-precedence"),b=c.get(T)||d,b===d&&c.set(null,y),c.set(T,y),this.count++,d=fo.bind(this),y.addEventListener("load",d),y.addEventListener("error",d),b?b.parentNode.insertBefore(y,b.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(y,r.firstChild)),s.state.loading|=4}}var Aa={$$typeof:D,Provider:null,Consumer:null,_currentValue:pe,_currentValue2:pe,_threadCount:0};function Nw(r,s,c,d,y,b,T,A){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=fc(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=fc(0),this.hiddenUpdates=fc(null),this.identifierPrefix=d,this.onUncaughtError=y,this.onCaughtError=b,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=A,this.incompleteTransitions=new Map}function u0(r,s,c,d,y,b,T,A,U,re,ce,me){return r=new Nw(r,s,c,T,A,U,re,me),s=1,b===!0&&(s|=24),b=cn(3,null,null,s),r.current=b,b.stateNode=r,s=Kc(),s.refCount++,r.pooledCache=s,s.refCount++,b.memoizedState={element:d,isDehydrated:c,cache:s},tu(b),r}function d0(r){return r?(r=qr,r):qr}function f0(r,s,c,d,y,b){y=d0(y),d.context===null?d.context=y:d.pendingContext=y,d=ki(s),d.payload={element:c},b=b===void 0?null:b,b!==null&&(d.callback=b),c=Ei(r,d,s),c!==null&&(hn(c,r,s),sa(c,r,s))}function m0(r,s){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var c=r.retryLane;r.retryLane=c!==0&&c<s?c:s}}function xd(r,s){m0(r,s),(r=r.alternate)&&m0(r,s)}function h0(r){if(r.tag===13){var s=$r(r,67108864);s!==null&&hn(s,r,67108864),xd(r,67108864)}}var ho=!0;function Sw(r,s,c,d){var y=P.T;P.T=null;var b=K.p;try{K.p=2,yd(r,s,c,d)}finally{K.p=b,P.T=y}}function Cw(r,s,c,d){var y=P.T;P.T=null;var b=K.p;try{K.p=8,yd(r,s,c,d)}finally{K.p=b,P.T=y}}function yd(r,s,c,d){if(ho){var y=vd(d);if(y===null)sd(r,s,d,po,c),g0(r,d);else if(jw(y,r,s,c,d))d.stopPropagation();else if(g0(r,d),s&4&&-1<Tw.indexOf(r)){for(;y!==null;){var b=_r(y);if(b!==null)switch(b.tag){case 3:if(b=b.stateNode,b.current.memoizedState.isDehydrated){var T=Vt(b.pendingLanes);if(T!==0){var A=b;for(A.pendingLanes|=2,A.entangledLanes|=2;T;){var U=1<<31-oe(T);A.entanglements[1]|=U,T&=~U}qn(b),(nt&6)===0&&(Kl=Rt()+500,Na(0))}}break;case 13:A=$r(b,2),A!==null&&hn(A,b,2),Xl(),xd(b,2)}if(b=vd(d),b===null&&sd(r,s,d,po,c),b===y)break;y=b}y!==null&&d.stopPropagation()}else sd(r,s,d,null,c)}}function vd(r){return r=Cc(r),bd(r)}var po=null;function bd(r){if(po=null,r=Ar(r),r!==null){var s=o(r);if(s===null)r=null;else{var c=s.tag;if(c===13){if(r=u(s),r!==null)return r;r=null}else if(c===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;r=null}else s!==r&&(r=null)}}return po=r,null}function p0(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(wi()){case $e:return 2;case ei:return 8;case Qe:case Bn:return 32;case ln:return 268435456;default:return 32}default:return 32}}var wd=!1,Vi=null,$i=null,qi=null,_a=new Map,Ma=new Map,Fi=[],Tw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function g0(r,s){switch(r){case"focusin":case"focusout":Vi=null;break;case"dragenter":case"dragleave":$i=null;break;case"mouseover":case"mouseout":qi=null;break;case"pointerover":case"pointerout":_a.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ma.delete(s.pointerId)}}function Ra(r,s,c,d,y,b){return r===null||r.nativeEvent!==b?(r={blockedOn:s,domEventName:c,eventSystemFlags:d,nativeEvent:b,targetContainers:[y]},s!==null&&(s=_r(s),s!==null&&h0(s)),r):(r.eventSystemFlags|=d,s=r.targetContainers,y!==null&&s.indexOf(y)===-1&&s.push(y),r)}function jw(r,s,c,d,y){switch(s){case"focusin":return Vi=Ra(Vi,r,s,c,d,y),!0;case"dragenter":return $i=Ra($i,r,s,c,d,y),!0;case"mouseover":return qi=Ra(qi,r,s,c,d,y),!0;case"pointerover":var b=y.pointerId;return _a.set(b,Ra(_a.get(b)||null,r,s,c,d,y)),!0;case"gotpointercapture":return b=y.pointerId,Ma.set(b,Ra(Ma.get(b)||null,r,s,c,d,y)),!0}return!1}function x0(r){var s=Ar(r.target);if(s!==null){var c=o(s);if(c!==null){if(s=c.tag,s===13){if(s=u(c),s!==null){r.blockedOn=s,vb(r.priority,function(){if(c.tag===13){var d=mn();d=mc(d);var y=$r(c,d);y!==null&&hn(y,c,d),xd(c,d)}});return}}else if(s===3&&c.stateNode.current.memoizedState.isDehydrated){r.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}r.blockedOn=null}function go(r){if(r.blockedOn!==null)return!1;for(var s=r.targetContainers;0<s.length;){var c=vd(r.nativeEvent);if(c===null){c=r.nativeEvent;var d=new c.constructor(c.type,c);Sc=d,c.target.dispatchEvent(d),Sc=null}else return s=_r(c),s!==null&&h0(s),r.blockedOn=c,!1;s.shift()}return!0}function y0(r,s,c){go(r)&&c.delete(s)}function kw(){wd=!1,Vi!==null&&go(Vi)&&(Vi=null),$i!==null&&go($i)&&($i=null),qi!==null&&go(qi)&&(qi=null),_a.forEach(y0),Ma.forEach(y0)}function xo(r,s){r.blockedOn===s&&(r.blockedOn=null,wd||(wd=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,kw)))}var yo=null;function v0(r){yo!==r&&(yo=r,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){yo===r&&(yo=null);for(var s=0;s<r.length;s+=3){var c=r[s],d=r[s+1],y=r[s+2];if(typeof d!="function"){if(bd(d||c)===null)continue;break}var b=_r(c);b!==null&&(r.splice(s,3),s-=3,bu(b,{pending:!0,data:y,method:c.method,action:d},d,y))}}))}function Ia(r){function s(U){return xo(U,r)}Vi!==null&&xo(Vi,r),$i!==null&&xo($i,r),qi!==null&&xo(qi,r),_a.forEach(s),Ma.forEach(s);for(var c=0;c<Fi.length;c++){var d=Fi[c];d.blockedOn===r&&(d.blockedOn=null)}for(;0<Fi.length&&(c=Fi[0],c.blockedOn===null);)x0(c),c.blockedOn===null&&Fi.shift();if(c=(r.ownerDocument||r).$$reactFormReplay,c!=null)for(d=0;d<c.length;d+=3){var y=c[d],b=c[d+1],T=y[Kt]||null;if(typeof b=="function")T||v0(c);else if(T){var A=null;if(b&&b.hasAttribute("formAction")){if(y=b,T=b[Kt]||null)A=T.formAction;else if(bd(y)!==null)continue}else A=T.action;typeof A=="function"?c[d+1]=A:(c.splice(d,3),d-=3),v0(c)}}}function Nd(r){this._internalRoot=r}vo.prototype.render=Nd.prototype.render=function(r){var s=this._internalRoot;if(s===null)throw Error(i(409));var c=s.current,d=mn();f0(c,d,r,s,null,null)},vo.prototype.unmount=Nd.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var s=r.containerInfo;f0(r.current,2,null,r,null,null),Xl(),s[Er]=null}};function vo(r){this._internalRoot=r}vo.prototype.unstable_scheduleHydration=function(r){if(r){var s=Pm();r={blockedOn:null,target:r,priority:s};for(var c=0;c<Fi.length&&s!==0&&s<Fi[c].priority;c++);Fi.splice(c,0,r),c===0&&x0(r)}};var b0=e.version;if(b0!=="19.1.0")throw Error(i(527,b0,"19.1.0"));K.findDOMNode=function(r){var s=r._reactInternals;if(s===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=g(s),r=r!==null?h(r):null,r=r===null?null:r.stateNode,r};var Ew={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:P,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bo.isDisabled&&bo.supportsFiber)try{Z=bo.inject(Ew),te=bo}catch{}}return La.createRoot=function(r,s){if(!l(r))throw Error(i(299));var c=!1,d="",y=Pp,b=Op,T=Bp,A=null;return s!=null&&(s.unstable_strictMode===!0&&(c=!0),s.identifierPrefix!==void 0&&(d=s.identifierPrefix),s.onUncaughtError!==void 0&&(y=s.onUncaughtError),s.onCaughtError!==void 0&&(b=s.onCaughtError),s.onRecoverableError!==void 0&&(T=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(A=s.unstable_transitionCallbacks)),s=u0(r,1,!1,null,null,c,d,y,b,T,A,null),r[Er]=s.current,rd(r),new Nd(s)},La.hydrateRoot=function(r,s,c){if(!l(r))throw Error(i(299));var d=!1,y="",b=Pp,T=Op,A=Bp,U=null,re=null;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(y=c.identifierPrefix),c.onUncaughtError!==void 0&&(b=c.onUncaughtError),c.onCaughtError!==void 0&&(T=c.onCaughtError),c.onRecoverableError!==void 0&&(A=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(U=c.unstable_transitionCallbacks),c.formState!==void 0&&(re=c.formState)),s=u0(r,1,!0,s,c??null,d,y,b,T,A,U,re),s.context=d0(null),c=s.current,d=mn(),d=mc(d),y=ki(d),y.callback=null,Ei(c,y,d),c=d,s.current.lanes=c,Us(s,c),qn(s),r[Er]=s.current,rd(r),new vo(s)},La.version="19.1.0",La}var _0;function Bw(){if(_0)return Td.exports;_0=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Td.exports=Ow(),Td.exports}var Uw=Bw();const zw=tl(Uw);var Xe;(function(t){t.assertEqual=l=>{};function e(l){}t.assertIs=e;function n(l){throw new Error}t.assertNever=n,t.arrayToEnum=l=>{const o={};for(const u of l)o[u]=u;return o},t.getValidEnumValues=l=>{const o=t.objectKeys(l).filter(f=>typeof l[l[f]]!="number"),u={};for(const f of o)u[f]=l[f];return t.objectValues(u)},t.objectValues=l=>t.objectKeys(l).map(function(o){return l[o]}),t.objectKeys=typeof Object.keys=="function"?l=>Object.keys(l):l=>{const o=[];for(const u in l)Object.prototype.hasOwnProperty.call(l,u)&&o.push(u);return o},t.find=(l,o)=>{for(const u of l)if(o(u))return u},t.isInteger=typeof Number.isInteger=="function"?l=>Number.isInteger(l):l=>typeof l=="number"&&Number.isFinite(l)&&Math.floor(l)===l;function i(l,o=" | "){return l.map(u=>typeof u=="string"?`'${u}'`:u).join(o)}t.joinValues=i,t.jsonStringifyReplacer=(l,o)=>typeof o=="bigint"?o.toString():o})(Xe||(Xe={}));var M0;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(M0||(M0={}));const Te=Xe.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Yi=t=>{switch(typeof t){case"undefined":return Te.undefined;case"string":return Te.string;case"number":return Number.isNaN(t)?Te.nan:Te.number;case"boolean":return Te.boolean;case"function":return Te.function;case"bigint":return Te.bigint;case"symbol":return Te.symbol;case"object":return Array.isArray(t)?Te.array:t===null?Te.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?Te.promise:typeof Map<"u"&&t instanceof Map?Te.map:typeof Set<"u"&&t instanceof Set?Te.set:typeof Date<"u"&&t instanceof Date?Te.date:Te.object;default:return Te.unknown}},ye=Xe.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class yi extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=i=>{this.issues=[...this.issues,i]},this.addIssues=(i=[])=>{this.issues=[...this.issues,...i]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}format(e){const n=e||function(o){return o.message},i={_errors:[]},l=o=>{for(const u of o.issues)if(u.code==="invalid_union")u.unionErrors.map(l);else if(u.code==="invalid_return_type")l(u.returnTypeError);else if(u.code==="invalid_arguments")l(u.argumentsError);else if(u.path.length===0)i._errors.push(n(u));else{let f=i,g=0;for(;g<u.path.length;){const h=u.path[g];g===u.path.length-1?(f[h]=f[h]||{_errors:[]},f[h]._errors.push(n(u))):f[h]=f[h]||{_errors:[]},f=f[h],g++}}};return l(this),i}static assert(e){if(!(e instanceof yi))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Xe.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},i=[];for(const l of this.issues)l.path.length>0?(n[l.path[0]]=n[l.path[0]]||[],n[l.path[0]].push(e(l))):i.push(e(l));return{formErrors:i,fieldErrors:n}}get formErrors(){return this.flatten()}}yi.create=t=>new yi(t);const yf=(t,e)=>{let n;switch(t.code){case ye.invalid_type:t.received===Te.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case ye.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,Xe.jsonStringifyReplacer)}`;break;case ye.unrecognized_keys:n=`Unrecognized key(s) in object: ${Xe.joinValues(t.keys,", ")}`;break;case ye.invalid_union:n="Invalid input";break;case ye.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Xe.joinValues(t.options)}`;break;case ye.invalid_enum_value:n=`Invalid enum value. Expected ${Xe.joinValues(t.options)}, received '${t.received}'`;break;case ye.invalid_arguments:n="Invalid function arguments";break;case ye.invalid_return_type:n="Invalid function return type";break;case ye.invalid_date:n="Invalid date";break;case ye.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:Xe.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case ye.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case ye.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case ye.custom:n="Invalid input";break;case ye.invalid_intersection_types:n="Intersection results could not be merged";break;case ye.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case ye.not_finite:n="Number must be finite";break;default:n=e.defaultError,Xe.assertNever(t)}return{message:n}};let Vw=yf;function $w(){return Vw}const qw=t=>{const{data:e,path:n,errorMaps:i,issueData:l}=t,o=[...n,...l.path||[]],u={...l,path:o};if(l.message!==void 0)return{...l,path:o,message:l.message};let f="";const g=i.filter(h=>!!h).slice().reverse();for(const h of g)f=h(u,{data:e,defaultError:f}).message;return{...l,path:o,message:f}};function we(t,e){const n=$w(),i=qw({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===yf?void 0:yf].filter(l=>!!l)});t.common.issues.push(i)}class Qt{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const i=[];for(const l of n){if(l.status==="aborted")return Le;l.status==="dirty"&&e.dirty(),i.push(l.value)}return{status:e.value,value:i}}static async mergeObjectAsync(e,n){const i=[];for(const l of n){const o=await l.key,u=await l.value;i.push({key:o,value:u})}return Qt.mergeObjectSync(e,i)}static mergeObjectSync(e,n){const i={};for(const l of n){const{key:o,value:u}=l;if(o.status==="aborted"||u.status==="aborted")return Le;o.status==="dirty"&&e.dirty(),u.status==="dirty"&&e.dirty(),o.value!=="__proto__"&&(typeof u.value<"u"||l.alwaysSet)&&(i[o.value]=u.value)}return{status:e.value,value:i}}}const Le=Object.freeze({status:"aborted"}),Fa=t=>({status:"dirty",value:t}),An=t=>({status:"valid",value:t}),R0=t=>t.status==="aborted",I0=t=>t.status==="dirty",js=t=>t.status==="valid",Uo=t=>typeof Promise<"u"&&t instanceof Promise;var je;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(je||(je={}));class Qn{constructor(e,n,i,l){this._cachedPath=[],this.parent=e,this.data=n,this._path=i,this._key=l}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const D0=(t,e)=>{if(js(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new yi(t.common.issues);return this._error=n,this._error}}};function Ue(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:i,description:l}=t;if(e&&(n||i))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:l}:{errorMap:(u,f)=>{const{message:g}=t;return u.code==="invalid_enum_value"?{message:g??f.defaultError}:typeof f.data>"u"?{message:g??i??f.defaultError}:u.code!=="invalid_type"?{message:f.defaultError}:{message:g??n??f.defaultError}},description:l}}class Ge{get description(){return this._def.description}_getType(e){return Yi(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:Yi(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Qt,ctx:{common:e.parent.common,data:e.data,parsedType:Yi(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(Uo(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const i=this.safeParse(e,n);if(i.success)return i.data;throw i.error}safeParse(e,n){const i={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Yi(e)},l=this._parseSync({data:e,path:i.path,parent:i});return D0(i,l)}"~validate"(e){var i,l;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Yi(e)};if(!this["~standard"].async)try{const o=this._parseSync({data:e,path:[],parent:n});return js(o)?{value:o.value}:{issues:n.common.issues}}catch(o){(l=(i=o==null?void 0:o.message)==null?void 0:i.toLowerCase())!=null&&l.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(o=>js(o)?{value:o.value}:{issues:n.common.issues})}async parseAsync(e,n){const i=await this.safeParseAsync(e,n);if(i.success)return i.data;throw i.error}async safeParseAsync(e,n){const i={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Yi(e)},l=this._parse({data:e,path:i.path,parent:i}),o=await(Uo(l)?l:Promise.resolve(l));return D0(i,o)}refine(e,n){const i=l=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(l):n;return this._refinement((l,o)=>{const u=e(l),f=()=>o.addIssue({code:ye.custom,...i(l)});return typeof Promise<"u"&&u instanceof Promise?u.then(g=>g?!0:(f(),!1)):u?!0:(f(),!1)})}refinement(e,n){return this._refinement((i,l)=>e(i)?!0:(l.addIssue(typeof n=="function"?n(i,l):n),!1))}_refinement(e){return new As({schema:this,typeName:De.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Zi.create(this,this._def)}nullable(){return _s.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Zn.create(this)}promise(){return Fo.create(this,this._def)}or(e){return Vo.create([this,e],this._def)}and(e){return $o.create(this,e,this._def)}transform(e){return new As({...Ue(this._def),schema:this,typeName:De.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new Nf({...Ue(this._def),innerType:this,defaultValue:n,typeName:De.ZodDefault})}brand(){return new f5({typeName:De.ZodBranded,type:this,...Ue(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new Sf({...Ue(this._def),innerType:this,catchValue:n,typeName:De.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return Wf.create(this,e)}readonly(){return Cf.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Fw=/^c[^\s-]{8,}$/i,Hw=/^[0-9a-z]+$/,Gw=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Jw=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Yw=/^[a-z0-9_-]{21}$/i,Zw=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Qw=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Kw=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Ww="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Ad;const Xw=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,e5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,t5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,n5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,i5=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,r5=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,E1="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",s5=new RegExp(`^${E1}$`);function A1(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);const n=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${n}`}function a5(t){return new RegExp(`^${A1(t)}$`)}function l5(t){let e=`${E1}T${A1(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function o5(t,e){return!!((e==="v4"||!e)&&Xw.test(t)||(e==="v6"||!e)&&t5.test(t))}function c5(t,e){if(!Zw.test(t))return!1;try{const[n]=t.split("."),i=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),l=JSON.parse(atob(i));return!(typeof l!="object"||l===null||"typ"in l&&(l==null?void 0:l.typ)!=="JWT"||!l.alg||e&&l.alg!==e)}catch{return!1}}function u5(t,e){return!!((e==="v4"||!e)&&e5.test(t)||(e==="v6"||!e)&&n5.test(t))}class Jn extends Ge{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==Te.string){const o=this._getOrReturnCtx(e);return we(o,{code:ye.invalid_type,expected:Te.string,received:o.parsedType}),Le}const i=new Qt;let l;for(const o of this._def.checks)if(o.kind==="min")e.data.length<o.value&&(l=this._getOrReturnCtx(e,l),we(l,{code:ye.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),i.dirty());else if(o.kind==="max")e.data.length>o.value&&(l=this._getOrReturnCtx(e,l),we(l,{code:ye.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),i.dirty());else if(o.kind==="length"){const u=e.data.length>o.value,f=e.data.length<o.value;(u||f)&&(l=this._getOrReturnCtx(e,l),u?we(l,{code:ye.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}):f&&we(l,{code:ye.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}),i.dirty())}else if(o.kind==="email")Kw.test(e.data)||(l=this._getOrReturnCtx(e,l),we(l,{validation:"email",code:ye.invalid_string,message:o.message}),i.dirty());else if(o.kind==="emoji")Ad||(Ad=new RegExp(Ww,"u")),Ad.test(e.data)||(l=this._getOrReturnCtx(e,l),we(l,{validation:"emoji",code:ye.invalid_string,message:o.message}),i.dirty());else if(o.kind==="uuid")Jw.test(e.data)||(l=this._getOrReturnCtx(e,l),we(l,{validation:"uuid",code:ye.invalid_string,message:o.message}),i.dirty());else if(o.kind==="nanoid")Yw.test(e.data)||(l=this._getOrReturnCtx(e,l),we(l,{validation:"nanoid",code:ye.invalid_string,message:o.message}),i.dirty());else if(o.kind==="cuid")Fw.test(e.data)||(l=this._getOrReturnCtx(e,l),we(l,{validation:"cuid",code:ye.invalid_string,message:o.message}),i.dirty());else if(o.kind==="cuid2")Hw.test(e.data)||(l=this._getOrReturnCtx(e,l),we(l,{validation:"cuid2",code:ye.invalid_string,message:o.message}),i.dirty());else if(o.kind==="ulid")Gw.test(e.data)||(l=this._getOrReturnCtx(e,l),we(l,{validation:"ulid",code:ye.invalid_string,message:o.message}),i.dirty());else if(o.kind==="url")try{new URL(e.data)}catch{l=this._getOrReturnCtx(e,l),we(l,{validation:"url",code:ye.invalid_string,message:o.message}),i.dirty()}else o.kind==="regex"?(o.regex.lastIndex=0,o.regex.test(e.data)||(l=this._getOrReturnCtx(e,l),we(l,{validation:"regex",code:ye.invalid_string,message:o.message}),i.dirty())):o.kind==="trim"?e.data=e.data.trim():o.kind==="includes"?e.data.includes(o.value,o.position)||(l=this._getOrReturnCtx(e,l),we(l,{code:ye.invalid_string,validation:{includes:o.value,position:o.position},message:o.message}),i.dirty()):o.kind==="toLowerCase"?e.data=e.data.toLowerCase():o.kind==="toUpperCase"?e.data=e.data.toUpperCase():o.kind==="startsWith"?e.data.startsWith(o.value)||(l=this._getOrReturnCtx(e,l),we(l,{code:ye.invalid_string,validation:{startsWith:o.value},message:o.message}),i.dirty()):o.kind==="endsWith"?e.data.endsWith(o.value)||(l=this._getOrReturnCtx(e,l),we(l,{code:ye.invalid_string,validation:{endsWith:o.value},message:o.message}),i.dirty()):o.kind==="datetime"?l5(o).test(e.data)||(l=this._getOrReturnCtx(e,l),we(l,{code:ye.invalid_string,validation:"datetime",message:o.message}),i.dirty()):o.kind==="date"?s5.test(e.data)||(l=this._getOrReturnCtx(e,l),we(l,{code:ye.invalid_string,validation:"date",message:o.message}),i.dirty()):o.kind==="time"?a5(o).test(e.data)||(l=this._getOrReturnCtx(e,l),we(l,{code:ye.invalid_string,validation:"time",message:o.message}),i.dirty()):o.kind==="duration"?Qw.test(e.data)||(l=this._getOrReturnCtx(e,l),we(l,{validation:"duration",code:ye.invalid_string,message:o.message}),i.dirty()):o.kind==="ip"?o5(e.data,o.version)||(l=this._getOrReturnCtx(e,l),we(l,{validation:"ip",code:ye.invalid_string,message:o.message}),i.dirty()):o.kind==="jwt"?c5(e.data,o.alg)||(l=this._getOrReturnCtx(e,l),we(l,{validation:"jwt",code:ye.invalid_string,message:o.message}),i.dirty()):o.kind==="cidr"?u5(e.data,o.version)||(l=this._getOrReturnCtx(e,l),we(l,{validation:"cidr",code:ye.invalid_string,message:o.message}),i.dirty()):o.kind==="base64"?i5.test(e.data)||(l=this._getOrReturnCtx(e,l),we(l,{validation:"base64",code:ye.invalid_string,message:o.message}),i.dirty()):o.kind==="base64url"?r5.test(e.data)||(l=this._getOrReturnCtx(e,l),we(l,{validation:"base64url",code:ye.invalid_string,message:o.message}),i.dirty()):Xe.assertNever(o);return{status:i.value,value:e.data}}_regex(e,n,i){return this.refinement(l=>e.test(l),{validation:n,code:ye.invalid_string,...je.errToObj(i)})}_addCheck(e){return new Jn({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...je.errToObj(e)})}url(e){return this._addCheck({kind:"url",...je.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...je.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...je.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...je.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...je.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...je.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...je.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...je.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...je.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...je.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...je.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...je.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(e==null?void 0:e.offset)??!1,local:(e==null?void 0:e.local)??!1,...je.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...je.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...je.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...je.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...je.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...je.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...je.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...je.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...je.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...je.errToObj(n)})}nonempty(e){return this.min(1,je.errToObj(e))}trim(){return new Jn({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Jn({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Jn({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Jn.create=t=>new Jn({checks:[],typeName:De.ZodString,coerce:(t==null?void 0:t.coerce)??!1,...Ue(t)});function d5(t,e){const n=(t.toString().split(".")[1]||"").length,i=(e.toString().split(".")[1]||"").length,l=n>i?n:i,o=Number.parseInt(t.toFixed(l).replace(".","")),u=Number.parseInt(e.toFixed(l).replace(".",""));return o%u/10**l}class vr extends Ge{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==Te.number){const o=this._getOrReturnCtx(e);return we(o,{code:ye.invalid_type,expected:Te.number,received:o.parsedType}),Le}let i;const l=new Qt;for(const o of this._def.checks)o.kind==="int"?Xe.isInteger(e.data)||(i=this._getOrReturnCtx(e,i),we(i,{code:ye.invalid_type,expected:"integer",received:"float",message:o.message}),l.dirty()):o.kind==="min"?(o.inclusive?e.data<o.value:e.data<=o.value)&&(i=this._getOrReturnCtx(e,i),we(i,{code:ye.too_small,minimum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),l.dirty()):o.kind==="max"?(o.inclusive?e.data>o.value:e.data>=o.value)&&(i=this._getOrReturnCtx(e,i),we(i,{code:ye.too_big,maximum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),l.dirty()):o.kind==="multipleOf"?d5(e.data,o.value)!==0&&(i=this._getOrReturnCtx(e,i),we(i,{code:ye.not_multiple_of,multipleOf:o.value,message:o.message}),l.dirty()):o.kind==="finite"?Number.isFinite(e.data)||(i=this._getOrReturnCtx(e,i),we(i,{code:ye.not_finite,message:o.message}),l.dirty()):Xe.assertNever(o);return{status:l.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,je.toString(n))}gt(e,n){return this.setLimit("min",e,!1,je.toString(n))}lte(e,n){return this.setLimit("max",e,!0,je.toString(n))}lt(e,n){return this.setLimit("max",e,!1,je.toString(n))}setLimit(e,n,i,l){return new vr({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:i,message:je.toString(l)}]})}_addCheck(e){return new vr({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:je.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:je.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:je.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:je.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:je.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:je.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:je.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:je.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:je.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Xe.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const i of this._def.checks){if(i.kind==="finite"||i.kind==="int"||i.kind==="multipleOf")return!0;i.kind==="min"?(n===null||i.value>n)&&(n=i.value):i.kind==="max"&&(e===null||i.value<e)&&(e=i.value)}return Number.isFinite(n)&&Number.isFinite(e)}}vr.create=t=>new vr({checks:[],typeName:De.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...Ue(t)});class br extends Ge{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==Te.bigint)return this._getInvalidInput(e);let i;const l=new Qt;for(const o of this._def.checks)o.kind==="min"?(o.inclusive?e.data<o.value:e.data<=o.value)&&(i=this._getOrReturnCtx(e,i),we(i,{code:ye.too_small,type:"bigint",minimum:o.value,inclusive:o.inclusive,message:o.message}),l.dirty()):o.kind==="max"?(o.inclusive?e.data>o.value:e.data>=o.value)&&(i=this._getOrReturnCtx(e,i),we(i,{code:ye.too_big,type:"bigint",maximum:o.value,inclusive:o.inclusive,message:o.message}),l.dirty()):o.kind==="multipleOf"?e.data%o.value!==BigInt(0)&&(i=this._getOrReturnCtx(e,i),we(i,{code:ye.not_multiple_of,multipleOf:o.value,message:o.message}),l.dirty()):Xe.assertNever(o);return{status:l.value,value:e.data}}_getInvalidInput(e){const n=this._getOrReturnCtx(e);return we(n,{code:ye.invalid_type,expected:Te.bigint,received:n.parsedType}),Le}gte(e,n){return this.setLimit("min",e,!0,je.toString(n))}gt(e,n){return this.setLimit("min",e,!1,je.toString(n))}lte(e,n){return this.setLimit("max",e,!0,je.toString(n))}lt(e,n){return this.setLimit("max",e,!1,je.toString(n))}setLimit(e,n,i,l){return new br({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:i,message:je.toString(l)}]})}_addCheck(e){return new br({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:je.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:je.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:je.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:je.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:je.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}br.create=t=>new br({checks:[],typeName:De.ZodBigInt,coerce:(t==null?void 0:t.coerce)??!1,...Ue(t)});class zo extends Ge{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==Te.boolean){const i=this._getOrReturnCtx(e);return we(i,{code:ye.invalid_type,expected:Te.boolean,received:i.parsedType}),Le}return An(e.data)}}zo.create=t=>new zo({typeName:De.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...Ue(t)});class ks extends Ge{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==Te.date){const o=this._getOrReturnCtx(e);return we(o,{code:ye.invalid_type,expected:Te.date,received:o.parsedType}),Le}if(Number.isNaN(e.data.getTime())){const o=this._getOrReturnCtx(e);return we(o,{code:ye.invalid_date}),Le}const i=new Qt;let l;for(const o of this._def.checks)o.kind==="min"?e.data.getTime()<o.value&&(l=this._getOrReturnCtx(e,l),we(l,{code:ye.too_small,message:o.message,inclusive:!0,exact:!1,minimum:o.value,type:"date"}),i.dirty()):o.kind==="max"?e.data.getTime()>o.value&&(l=this._getOrReturnCtx(e,l),we(l,{code:ye.too_big,message:o.message,inclusive:!0,exact:!1,maximum:o.value,type:"date"}),i.dirty()):Xe.assertNever(o);return{status:i.value,value:new Date(e.data.getTime())}}_addCheck(e){return new ks({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:je.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:je.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}ks.create=t=>new ks({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:De.ZodDate,...Ue(t)});class L0 extends Ge{_parse(e){if(this._getType(e)!==Te.symbol){const i=this._getOrReturnCtx(e);return we(i,{code:ye.invalid_type,expected:Te.symbol,received:i.parsedType}),Le}return An(e.data)}}L0.create=t=>new L0({typeName:De.ZodSymbol,...Ue(t)});class P0 extends Ge{_parse(e){if(this._getType(e)!==Te.undefined){const i=this._getOrReturnCtx(e);return we(i,{code:ye.invalid_type,expected:Te.undefined,received:i.parsedType}),Le}return An(e.data)}}P0.create=t=>new P0({typeName:De.ZodUndefined,...Ue(t)});class O0 extends Ge{_parse(e){if(this._getType(e)!==Te.null){const i=this._getOrReturnCtx(e);return we(i,{code:ye.invalid_type,expected:Te.null,received:i.parsedType}),Le}return An(e.data)}}O0.create=t=>new O0({typeName:De.ZodNull,...Ue(t)});class B0 extends Ge{constructor(){super(...arguments),this._any=!0}_parse(e){return An(e.data)}}B0.create=t=>new B0({typeName:De.ZodAny,...Ue(t)});class vf extends Ge{constructor(){super(...arguments),this._unknown=!0}_parse(e){return An(e.data)}}vf.create=t=>new vf({typeName:De.ZodUnknown,...Ue(t)});class Qi extends Ge{_parse(e){const n=this._getOrReturnCtx(e);return we(n,{code:ye.invalid_type,expected:Te.never,received:n.parsedType}),Le}}Qi.create=t=>new Qi({typeName:De.ZodNever,...Ue(t)});class U0 extends Ge{_parse(e){if(this._getType(e)!==Te.undefined){const i=this._getOrReturnCtx(e);return we(i,{code:ye.invalid_type,expected:Te.void,received:i.parsedType}),Le}return An(e.data)}}U0.create=t=>new U0({typeName:De.ZodVoid,...Ue(t)});class Zn extends Ge{_parse(e){const{ctx:n,status:i}=this._processInputParams(e),l=this._def;if(n.parsedType!==Te.array)return we(n,{code:ye.invalid_type,expected:Te.array,received:n.parsedType}),Le;if(l.exactLength!==null){const u=n.data.length>l.exactLength.value,f=n.data.length<l.exactLength.value;(u||f)&&(we(n,{code:u?ye.too_big:ye.too_small,minimum:f?l.exactLength.value:void 0,maximum:u?l.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:l.exactLength.message}),i.dirty())}if(l.minLength!==null&&n.data.length<l.minLength.value&&(we(n,{code:ye.too_small,minimum:l.minLength.value,type:"array",inclusive:!0,exact:!1,message:l.minLength.message}),i.dirty()),l.maxLength!==null&&n.data.length>l.maxLength.value&&(we(n,{code:ye.too_big,maximum:l.maxLength.value,type:"array",inclusive:!0,exact:!1,message:l.maxLength.message}),i.dirty()),n.common.async)return Promise.all([...n.data].map((u,f)=>l.type._parseAsync(new Qn(n,u,n.path,f)))).then(u=>Qt.mergeArray(i,u));const o=[...n.data].map((u,f)=>l.type._parseSync(new Qn(n,u,n.path,f)));return Qt.mergeArray(i,o)}get element(){return this._def.type}min(e,n){return new Zn({...this._def,minLength:{value:e,message:je.toString(n)}})}max(e,n){return new Zn({...this._def,maxLength:{value:e,message:je.toString(n)}})}length(e,n){return new Zn({...this._def,exactLength:{value:e,message:je.toString(n)}})}nonempty(e){return this.min(1,e)}}Zn.create=(t,e)=>new Zn({type:t,minLength:null,maxLength:null,exactLength:null,typeName:De.ZodArray,...Ue(e)});function xs(t){if(t instanceof Et){const e={};for(const n in t.shape){const i=t.shape[n];e[n]=Zi.create(xs(i))}return new Et({...t._def,shape:()=>e})}else return t instanceof Zn?new Zn({...t._def,type:xs(t.element)}):t instanceof Zi?Zi.create(xs(t.unwrap())):t instanceof _s?_s.create(xs(t.unwrap())):t instanceof wr?wr.create(t.items.map(e=>xs(e))):t}class Et extends Ge{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=Xe.objectKeys(e);return this._cached={shape:e,keys:n},this._cached}_parse(e){if(this._getType(e)!==Te.object){const h=this._getOrReturnCtx(e);return we(h,{code:ye.invalid_type,expected:Te.object,received:h.parsedType}),Le}const{status:i,ctx:l}=this._processInputParams(e),{shape:o,keys:u}=this._getCached(),f=[];if(!(this._def.catchall instanceof Qi&&this._def.unknownKeys==="strip"))for(const h in l.data)u.includes(h)||f.push(h);const g=[];for(const h of u){const x=o[h],v=l.data[h];g.push({key:{status:"valid",value:h},value:x._parse(new Qn(l,v,l.path,h)),alwaysSet:h in l.data})}if(this._def.catchall instanceof Qi){const h=this._def.unknownKeys;if(h==="passthrough")for(const x of f)g.push({key:{status:"valid",value:x},value:{status:"valid",value:l.data[x]}});else if(h==="strict")f.length>0&&(we(l,{code:ye.unrecognized_keys,keys:f}),i.dirty());else if(h!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const h=this._def.catchall;for(const x of f){const v=l.data[x];g.push({key:{status:"valid",value:x},value:h._parse(new Qn(l,v,l.path,x)),alwaysSet:x in l.data})}}return l.common.async?Promise.resolve().then(async()=>{const h=[];for(const x of g){const v=await x.key,N=await x.value;h.push({key:v,value:N,alwaysSet:x.alwaysSet})}return h}).then(h=>Qt.mergeObjectSync(i,h)):Qt.mergeObjectSync(i,g)}get shape(){return this._def.shape()}strict(e){return je.errToObj,new Et({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,i)=>{var o,u;const l=((u=(o=this._def).errorMap)==null?void 0:u.call(o,n,i).message)??i.defaultError;return n.code==="unrecognized_keys"?{message:je.errToObj(e).message??l}:{message:l}}}:{}})}strip(){return new Et({...this._def,unknownKeys:"strip"})}passthrough(){return new Et({...this._def,unknownKeys:"passthrough"})}extend(e){return new Et({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Et({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:De.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new Et({...this._def,catchall:e})}pick(e){const n={};for(const i of Xe.objectKeys(e))e[i]&&this.shape[i]&&(n[i]=this.shape[i]);return new Et({...this._def,shape:()=>n})}omit(e){const n={};for(const i of Xe.objectKeys(this.shape))e[i]||(n[i]=this.shape[i]);return new Et({...this._def,shape:()=>n})}deepPartial(){return xs(this)}partial(e){const n={};for(const i of Xe.objectKeys(this.shape)){const l=this.shape[i];e&&!e[i]?n[i]=l:n[i]=l.optional()}return new Et({...this._def,shape:()=>n})}required(e){const n={};for(const i of Xe.objectKeys(this.shape))if(e&&!e[i])n[i]=this.shape[i];else{let o=this.shape[i];for(;o instanceof Zi;)o=o._def.innerType;n[i]=o}return new Et({...this._def,shape:()=>n})}keyof(){return _1(Xe.objectKeys(this.shape))}}Et.create=(t,e)=>new Et({shape:()=>t,unknownKeys:"strip",catchall:Qi.create(),typeName:De.ZodObject,...Ue(e)});Et.strictCreate=(t,e)=>new Et({shape:()=>t,unknownKeys:"strict",catchall:Qi.create(),typeName:De.ZodObject,...Ue(e)});Et.lazycreate=(t,e)=>new Et({shape:t,unknownKeys:"strip",catchall:Qi.create(),typeName:De.ZodObject,...Ue(e)});class Vo extends Ge{_parse(e){const{ctx:n}=this._processInputParams(e),i=this._def.options;function l(o){for(const f of o)if(f.result.status==="valid")return f.result;for(const f of o)if(f.result.status==="dirty")return n.common.issues.push(...f.ctx.common.issues),f.result;const u=o.map(f=>new yi(f.ctx.common.issues));return we(n,{code:ye.invalid_union,unionErrors:u}),Le}if(n.common.async)return Promise.all(i.map(async o=>{const u={...n,common:{...n.common,issues:[]},parent:null};return{result:await o._parseAsync({data:n.data,path:n.path,parent:u}),ctx:u}})).then(l);{let o;const u=[];for(const g of i){const h={...n,common:{...n.common,issues:[]},parent:null},x=g._parseSync({data:n.data,path:n.path,parent:h});if(x.status==="valid")return x;x.status==="dirty"&&!o&&(o={result:x,ctx:h}),h.common.issues.length&&u.push(h.common.issues)}if(o)return n.common.issues.push(...o.ctx.common.issues),o.result;const f=u.map(g=>new yi(g));return we(n,{code:ye.invalid_union,unionErrors:f}),Le}}get options(){return this._def.options}}Vo.create=(t,e)=>new Vo({options:t,typeName:De.ZodUnion,...Ue(e)});function bf(t,e){const n=Yi(t),i=Yi(e);if(t===e)return{valid:!0,data:t};if(n===Te.object&&i===Te.object){const l=Xe.objectKeys(e),o=Xe.objectKeys(t).filter(f=>l.indexOf(f)!==-1),u={...t,...e};for(const f of o){const g=bf(t[f],e[f]);if(!g.valid)return{valid:!1};u[f]=g.data}return{valid:!0,data:u}}else if(n===Te.array&&i===Te.array){if(t.length!==e.length)return{valid:!1};const l=[];for(let o=0;o<t.length;o++){const u=t[o],f=e[o],g=bf(u,f);if(!g.valid)return{valid:!1};l.push(g.data)}return{valid:!0,data:l}}else return n===Te.date&&i===Te.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class $o extends Ge{_parse(e){const{status:n,ctx:i}=this._processInputParams(e),l=(o,u)=>{if(R0(o)||R0(u))return Le;const f=bf(o.value,u.value);return f.valid?((I0(o)||I0(u))&&n.dirty(),{status:n.value,value:f.data}):(we(i,{code:ye.invalid_intersection_types}),Le)};return i.common.async?Promise.all([this._def.left._parseAsync({data:i.data,path:i.path,parent:i}),this._def.right._parseAsync({data:i.data,path:i.path,parent:i})]).then(([o,u])=>l(o,u)):l(this._def.left._parseSync({data:i.data,path:i.path,parent:i}),this._def.right._parseSync({data:i.data,path:i.path,parent:i}))}}$o.create=(t,e,n)=>new $o({left:t,right:e,typeName:De.ZodIntersection,...Ue(n)});class wr extends Ge{_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.parsedType!==Te.array)return we(i,{code:ye.invalid_type,expected:Te.array,received:i.parsedType}),Le;if(i.data.length<this._def.items.length)return we(i,{code:ye.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Le;!this._def.rest&&i.data.length>this._def.items.length&&(we(i,{code:ye.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const o=[...i.data].map((u,f)=>{const g=this._def.items[f]||this._def.rest;return g?g._parse(new Qn(i,u,i.path,f)):null}).filter(u=>!!u);return i.common.async?Promise.all(o).then(u=>Qt.mergeArray(n,u)):Qt.mergeArray(n,o)}get items(){return this._def.items}rest(e){return new wr({...this._def,rest:e})}}wr.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new wr({items:t,typeName:De.ZodTuple,rest:null,...Ue(e)})};class qo extends Ge{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.parsedType!==Te.object)return we(i,{code:ye.invalid_type,expected:Te.object,received:i.parsedType}),Le;const l=[],o=this._def.keyType,u=this._def.valueType;for(const f in i.data)l.push({key:o._parse(new Qn(i,f,i.path,f)),value:u._parse(new Qn(i,i.data[f],i.path,f)),alwaysSet:f in i.data});return i.common.async?Qt.mergeObjectAsync(n,l):Qt.mergeObjectSync(n,l)}get element(){return this._def.valueType}static create(e,n,i){return n instanceof Ge?new qo({keyType:e,valueType:n,typeName:De.ZodRecord,...Ue(i)}):new qo({keyType:Jn.create(),valueType:e,typeName:De.ZodRecord,...Ue(n)})}}class z0 extends Ge{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.parsedType!==Te.map)return we(i,{code:ye.invalid_type,expected:Te.map,received:i.parsedType}),Le;const l=this._def.keyType,o=this._def.valueType,u=[...i.data.entries()].map(([f,g],h)=>({key:l._parse(new Qn(i,f,i.path,[h,"key"])),value:o._parse(new Qn(i,g,i.path,[h,"value"]))}));if(i.common.async){const f=new Map;return Promise.resolve().then(async()=>{for(const g of u){const h=await g.key,x=await g.value;if(h.status==="aborted"||x.status==="aborted")return Le;(h.status==="dirty"||x.status==="dirty")&&n.dirty(),f.set(h.value,x.value)}return{status:n.value,value:f}})}else{const f=new Map;for(const g of u){const h=g.key,x=g.value;if(h.status==="aborted"||x.status==="aborted")return Le;(h.status==="dirty"||x.status==="dirty")&&n.dirty(),f.set(h.value,x.value)}return{status:n.value,value:f}}}}z0.create=(t,e,n)=>new z0({valueType:e,keyType:t,typeName:De.ZodMap,...Ue(n)});class Wa extends Ge{_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.parsedType!==Te.set)return we(i,{code:ye.invalid_type,expected:Te.set,received:i.parsedType}),Le;const l=this._def;l.minSize!==null&&i.data.size<l.minSize.value&&(we(i,{code:ye.too_small,minimum:l.minSize.value,type:"set",inclusive:!0,exact:!1,message:l.minSize.message}),n.dirty()),l.maxSize!==null&&i.data.size>l.maxSize.value&&(we(i,{code:ye.too_big,maximum:l.maxSize.value,type:"set",inclusive:!0,exact:!1,message:l.maxSize.message}),n.dirty());const o=this._def.valueType;function u(g){const h=new Set;for(const x of g){if(x.status==="aborted")return Le;x.status==="dirty"&&n.dirty(),h.add(x.value)}return{status:n.value,value:h}}const f=[...i.data.values()].map((g,h)=>o._parse(new Qn(i,g,i.path,h)));return i.common.async?Promise.all(f).then(g=>u(g)):u(f)}min(e,n){return new Wa({...this._def,minSize:{value:e,message:je.toString(n)}})}max(e,n){return new Wa({...this._def,maxSize:{value:e,message:je.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}Wa.create=(t,e)=>new Wa({valueType:t,minSize:null,maxSize:null,typeName:De.ZodSet,...Ue(e)});class wf extends Ge{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}wf.create=(t,e)=>new wf({getter:t,typeName:De.ZodLazy,...Ue(e)});class V0 extends Ge{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return we(n,{received:n.data,code:ye.invalid_literal,expected:this._def.value}),Le}return{status:"valid",value:e.data}}get value(){return this._def.value}}V0.create=(t,e)=>new V0({value:t,typeName:De.ZodLiteral,...Ue(e)});function _1(t,e){return new Es({values:t,typeName:De.ZodEnum,...Ue(e)})}class Es extends Ge{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),i=this._def.values;return we(n,{expected:Xe.joinValues(i),received:n.parsedType,code:ye.invalid_type}),Le}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const n=this._getOrReturnCtx(e),i=this._def.values;return we(n,{received:n.data,code:ye.invalid_enum_value,options:i}),Le}return An(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return Es.create(e,{...this._def,...n})}exclude(e,n=this._def){return Es.create(this.options.filter(i=>!e.includes(i)),{...this._def,...n})}}Es.create=_1;class $0 extends Ge{_parse(e){const n=Xe.getValidEnumValues(this._def.values),i=this._getOrReturnCtx(e);if(i.parsedType!==Te.string&&i.parsedType!==Te.number){const l=Xe.objectValues(n);return we(i,{expected:Xe.joinValues(l),received:i.parsedType,code:ye.invalid_type}),Le}if(this._cache||(this._cache=new Set(Xe.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const l=Xe.objectValues(n);return we(i,{received:i.data,code:ye.invalid_enum_value,options:l}),Le}return An(e.data)}get enum(){return this._def.values}}$0.create=(t,e)=>new $0({values:t,typeName:De.ZodNativeEnum,...Ue(e)});class Fo extends Ge{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==Te.promise&&n.common.async===!1)return we(n,{code:ye.invalid_type,expected:Te.promise,received:n.parsedType}),Le;const i=n.parsedType===Te.promise?n.data:Promise.resolve(n.data);return An(i.then(l=>this._def.type.parseAsync(l,{path:n.path,errorMap:n.common.contextualErrorMap})))}}Fo.create=(t,e)=>new Fo({type:t,typeName:De.ZodPromise,...Ue(e)});class As extends Ge{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===De.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:i}=this._processInputParams(e),l=this._def.effect||null,o={addIssue:u=>{we(i,u),u.fatal?n.abort():n.dirty()},get path(){return i.path}};if(o.addIssue=o.addIssue.bind(o),l.type==="preprocess"){const u=l.transform(i.data,o);if(i.common.async)return Promise.resolve(u).then(async f=>{if(n.value==="aborted")return Le;const g=await this._def.schema._parseAsync({data:f,path:i.path,parent:i});return g.status==="aborted"?Le:g.status==="dirty"||n.value==="dirty"?Fa(g.value):g});{if(n.value==="aborted")return Le;const f=this._def.schema._parseSync({data:u,path:i.path,parent:i});return f.status==="aborted"?Le:f.status==="dirty"||n.value==="dirty"?Fa(f.value):f}}if(l.type==="refinement"){const u=f=>{const g=l.refinement(f,o);if(i.common.async)return Promise.resolve(g);if(g instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return f};if(i.common.async===!1){const f=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});return f.status==="aborted"?Le:(f.status==="dirty"&&n.dirty(),u(f.value),{status:n.value,value:f.value})}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(f=>f.status==="aborted"?Le:(f.status==="dirty"&&n.dirty(),u(f.value).then(()=>({status:n.value,value:f.value}))))}if(l.type==="transform")if(i.common.async===!1){const u=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});if(!js(u))return Le;const f=l.transform(u.value,o);if(f instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:f}}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(u=>js(u)?Promise.resolve(l.transform(u.value,o)).then(f=>({status:n.value,value:f})):Le);Xe.assertNever(l)}}As.create=(t,e,n)=>new As({schema:t,typeName:De.ZodEffects,effect:e,...Ue(n)});As.createWithPreprocess=(t,e,n)=>new As({schema:e,effect:{type:"preprocess",transform:t},typeName:De.ZodEffects,...Ue(n)});class Zi extends Ge{_parse(e){return this._getType(e)===Te.undefined?An(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Zi.create=(t,e)=>new Zi({innerType:t,typeName:De.ZodOptional,...Ue(e)});class _s extends Ge{_parse(e){return this._getType(e)===Te.null?An(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}_s.create=(t,e)=>new _s({innerType:t,typeName:De.ZodNullable,...Ue(e)});class Nf extends Ge{_parse(e){const{ctx:n}=this._processInputParams(e);let i=n.data;return n.parsedType===Te.undefined&&(i=this._def.defaultValue()),this._def.innerType._parse({data:i,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}Nf.create=(t,e)=>new Nf({innerType:t,typeName:De.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Ue(e)});class Sf extends Ge{_parse(e){const{ctx:n}=this._processInputParams(e),i={...n,common:{...n.common,issues:[]}},l=this._def.innerType._parse({data:i.data,path:i.path,parent:{...i}});return Uo(l)?l.then(o=>({status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new yi(i.common.issues)},input:i.data})})):{status:"valid",value:l.status==="valid"?l.value:this._def.catchValue({get error(){return new yi(i.common.issues)},input:i.data})}}removeCatch(){return this._def.innerType}}Sf.create=(t,e)=>new Sf({innerType:t,typeName:De.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Ue(e)});class q0 extends Ge{_parse(e){if(this._getType(e)!==Te.nan){const i=this._getOrReturnCtx(e);return we(i,{code:ye.invalid_type,expected:Te.nan,received:i.parsedType}),Le}return{status:"valid",value:e.data}}}q0.create=t=>new q0({typeName:De.ZodNaN,...Ue(t)});class f5 extends Ge{_parse(e){const{ctx:n}=this._processInputParams(e),i=n.data;return this._def.type._parse({data:i,path:n.path,parent:n})}unwrap(){return this._def.type}}class Wf extends Ge{_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.common.async)return(async()=>{const o=await this._def.in._parseAsync({data:i.data,path:i.path,parent:i});return o.status==="aborted"?Le:o.status==="dirty"?(n.dirty(),Fa(o.value)):this._def.out._parseAsync({data:o.value,path:i.path,parent:i})})();{const l=this._def.in._parseSync({data:i.data,path:i.path,parent:i});return l.status==="aborted"?Le:l.status==="dirty"?(n.dirty(),{status:"dirty",value:l.value}):this._def.out._parseSync({data:l.value,path:i.path,parent:i})}}static create(e,n){return new Wf({in:e,out:n,typeName:De.ZodPipeline})}}class Cf extends Ge{_parse(e){const n=this._def.innerType._parse(e),i=l=>(js(l)&&(l.value=Object.freeze(l.value)),l);return Uo(n)?n.then(l=>i(l)):i(n)}unwrap(){return this._def.innerType}}Cf.create=(t,e)=>new Cf({innerType:t,typeName:De.ZodReadonly,...Ue(e)});var De;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(De||(De={}));const xr=Jn.create,F0=vr.create;br.create;const m5=zo.create;ks.create;const H0=vf.create;Qi.create;const Ha=Zn.create,h5=Et.create,p5=Vo.create;$o.create;wr.create;const g5=qo.create,x5=wf.create,y5=Es.create;Fo.create;Zi.create;_s.create;const ms={string:t=>Jn.create({...t,coerce:!0}),number:t=>vr.create({...t,coerce:!0}),boolean:t=>zo.create({...t,coerce:!0}),bigint:t=>br.create({...t,coerce:!0}),date:t=>ks.create({...t,coerce:!0})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let v5,b5;function w5(){return{geminiUrl:v5,vertexUrl:b5}}function N5(t,e,n){var i,l,o;if(!(!((i=t.httpOptions)===null||i===void 0)&&i.baseUrl)){const u=w5();return t.vertexai?(l=u.vertexUrl)!==null&&l!==void 0?l:e:(o=u.geminiUrl)!==null&&o!==void 0?o:n}return t.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Rs{}function Re(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(i,l)=>{if(Object.prototype.hasOwnProperty.call(e,l)){const o=e[l];return o!=null?String(o):""}else throw new Error(`Key '${l}' not found in valueMap.`)})}function p(t,e,n){for(let o=0;o<e.length-1;o++){const u=e[o];if(u.endsWith("[]")){const f=u.slice(0,-2);if(!(f in t))if(Array.isArray(n))t[f]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${u}`);if(Array.isArray(t[f])){const g=t[f];if(Array.isArray(n))for(let h=0;h<g.length;h++){const x=g[h];p(x,e.slice(o+1),n[h])}else for(const h of g)p(h,e.slice(o+1),n)}return}else if(u.endsWith("[0]")){const f=u.slice(0,-3);f in t||(t[f]=[{}]);const g=t[f];p(g[0],e.slice(o+1),n);return}(!t[u]||typeof t[u]!="object")&&(t[u]={}),t=t[u]}const i=e[e.length-1],l=t[i];if(l!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===l)return;if(typeof l=="object"&&typeof n=="object"&&l!==null&&n!==null)Object.assign(l,n);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else t[i]=n}function m(t,e){try{if(e.length===1&&e[0]==="_self")return t;for(let n=0;n<e.length;n++){if(typeof t!="object"||t===null)return;const i=e[n];if(i.endsWith("[]")){const l=i.slice(0,-2);if(l in t){const o=t[l];return Array.isArray(o)?o.map(u=>m(u,e.slice(n+1))):void 0}else return}else t=t[i]}return t}catch(n){if(n instanceof TypeError)return;throw n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var G0;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(G0||(G0={}));var J0;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(J0||(J0={}));var Yn;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(Yn||(Yn={}));var Y0;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(Y0||(Y0={}));var Z0;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(Z0||(Z0={}));var Q0;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(Q0||(Q0={}));var K0;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(K0||(K0={}));var W0;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(W0||(W0={}));var X0;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(X0||(X0={}));var ex;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(ex||(ex={}));var tx;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(tx||(tx={}));var nx;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(nx||(nx={}));var ix;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(ix||(ix={}));var Ho;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(Ho||(Ho={}));var rx;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(rx||(rx={}));var Tf;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Tf||(Tf={}));var sx;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(sx||(sx={}));var ax;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(ax||(ax={}));var lx;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(lx||(lx={}));var ox;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(ox||(ox={}));var cx;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE"})(cx||(cx={}));var ux;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(ux||(ux={}));var dx;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(dx||(dx={}));var fx;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(fx||(fx={}));var mx;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi"})(mx||(mx={}));var hx;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(hx||(hx={}));var px;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(px||(px={}));var gx;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(gx||(gx={}));var xx;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(xx||(xx={}));var yx;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(yx||(yx={}));var vx;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(vx||(vx={}));var bx;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(bx||(bx={}));var wx;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(wx||(wx={}));var Nx;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Nx||(Nx={}));var Sx;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(Sx||(Sx={}));var Cx;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Cx||(Cx={}));var Tx;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(Tx||(Tx={}));var jx;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(jx||(jx={}));var vs;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(vs||(vs={}));class jf{constructor(e){const n={};for(const i of e.headers.entries())n[i[0]]=i[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class Pa{get text(){var e,n,i,l,o,u,f,g;if(((l=(i=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||l===void 0?void 0:l.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let h="",x=!1;const v=[];for(const N of(g=(f=(u=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||u===void 0?void 0:u.content)===null||f===void 0?void 0:f.parts)!==null&&g!==void 0?g:[]){for(const[w,C]of Object.entries(N))w!=="text"&&w!=="thought"&&(C!==null||C!==void 0)&&v.push(w);if(typeof N.text=="string"){if(typeof N.thought=="boolean"&&N.thought)continue;x=!0,h+=N.text}}return v.length>0&&console.warn(`there are non-text parts ${v} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),x?h:void 0}get data(){var e,n,i,l,o,u,f,g;if(((l=(i=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||l===void 0?void 0:l.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let h="";const x=[];for(const v of(g=(f=(u=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||u===void 0?void 0:u.content)===null||f===void 0?void 0:f.parts)!==null&&g!==void 0?g:[]){for(const[N,w]of Object.entries(v))N!=="inlineData"&&(w!==null||w!==void 0)&&x.push(N);v.inlineData&&typeof v.inlineData.data=="string"&&(h+=atob(v.inlineData.data))}return x.length>0&&console.warn(`there are non-data parts ${x} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),h.length>0?btoa(h):void 0}get functionCalls(){var e,n,i,l,o,u,f,g;if(((l=(i=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||l===void 0?void 0:l.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const h=(g=(f=(u=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||u===void 0?void 0:u.content)===null||f===void 0?void 0:f.parts)===null||g===void 0?void 0:g.filter(x=>x.functionCall).map(x=>x.functionCall).filter(x=>x!==void 0);if((h==null?void 0:h.length)!==0)return h}get executableCode(){var e,n,i,l,o,u,f,g,h;if(((l=(i=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||l===void 0?void 0:l.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const x=(g=(f=(u=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||u===void 0?void 0:u.content)===null||f===void 0?void 0:f.parts)===null||g===void 0?void 0:g.filter(v=>v.executableCode).map(v=>v.executableCode).filter(v=>v!==void 0);if((x==null?void 0:x.length)!==0)return(h=x==null?void 0:x[0])===null||h===void 0?void 0:h.code}get codeExecutionResult(){var e,n,i,l,o,u,f,g,h;if(((l=(i=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||l===void 0?void 0:l.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const x=(g=(f=(u=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||u===void 0?void 0:u.content)===null||f===void 0?void 0:f.parts)===null||g===void 0?void 0:g.filter(v=>v.codeExecutionResult).map(v=>v.codeExecutionResult).filter(v=>v!==void 0);if((x==null?void 0:x.length)!==0)return(h=x==null?void 0:x[0])===null||h===void 0?void 0:h.output}}class kx{}class Ex{}class S5{}class C5{}class Ax{}class _x{}class Mx{}class T5{}class Rx{}class Ix{}class Dx{}class j5{}class k5{}class E5{}class A5{get text(){var e,n,i;let l="",o=!1;const u=[];for(const f of(i=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&i!==void 0?i:[]){for(const[g,h]of Object.entries(f))g!=="text"&&g!=="thought"&&h!==null&&u.push(g);if(typeof f.text=="string"){if(typeof f.thought=="boolean"&&f.thought)continue;o=!0,l+=f.text}}return u.length>0&&console.warn(`there are non-text parts ${u} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?l:void 0}get data(){var e,n,i;let l="";const o=[];for(const u of(i=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&i!==void 0?i:[]){for(const[f,g]of Object.entries(u))f!=="inlineData"&&g!==null&&o.push(f);u.inlineData&&typeof u.inlineData.data=="string"&&(l+=atob(u.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),l.length>0?btoa(l):void 0}}class _5{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ht(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function M1(t,e){const n=ht(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function R1(t){return Array.isArray(t)?t.map(e=>Go(e)):[Go(t)]}function Go(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function M5(t){const e=Go(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function R5(t){const e=Go(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Lx(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function I1(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>Lx(e)):[Lx(t)]}function kf(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function Px(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function Ox(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function Zt(t){if(t==null)throw new Error("ContentUnion is required");return kf(t)?t:{role:"user",parts:I1(t)}}function D1(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const i=Zt(n);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(t.isVertexAI()){const n=Zt(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>Zt(n)):[Zt(e)]}function Ln(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(Px(t)||Ox(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Zt(t)]}const e=[],n=[],i=kf(t[0]);for(const l of t){const o=kf(l);if(o!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)e.push(l);else{if(Px(l)||Ox(l))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(l)}}return i||e.push({role:"user",parts:I1(n)}),e}const I5=new Set(["type","format","title","description","default","items","minItems","maxItems","enum","properties","required","minProperties","maxProperties","minimum","maximum","minLength","maxLength","pattern","anyOf","propertyOrdering"]),Bx=y5(["string","number","integer","object","array","boolean","null"]),D5=p5([Bx,Ha(Bx)]);function L5(t=!0){const e=x5(()=>{const n=h5({type:D5.optional(),format:xr().optional(),title:xr().optional(),description:xr().optional(),default:H0().optional(),items:e.optional(),minItems:ms.string().optional(),maxItems:ms.string().optional(),enum:Ha(H0()).optional(),properties:g5(xr(),e).optional(),required:Ha(xr()).optional(),minProperties:ms.string().optional(),maxProperties:ms.string().optional(),propertyOrdering:Ha(xr()).optional(),minimum:F0().optional(),maximum:F0().optional(),minLength:ms.string().optional(),maxLength:ms.string().optional(),pattern:xr().optional(),anyOf:Ha(e).optional(),additionalProperties:m5().optional()});return t?n.strict():n});return e}function P5(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(i=>i!=="null");if(n.length===1)e.type=Object.values(Yn).includes(n[0].toUpperCase())?n[0].toUpperCase():Yn.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of n)e.anyOf.push({type:Object.values(Yn).includes(i.toUpperCase())?i.toUpperCase():Yn.TYPE_UNSPECIFIED})}}function bs(t){const e={},n=["items"],i=["anyOf"],l=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const o=t.anyOf;o!=null&&o.length==2&&(o[0].type==="null"?(e.nullable=!0,t=o[1]):o[1].type==="null"&&(e.nullable=!0,t=o[0])),t.type instanceof Array&&P5(t.type,e);for(const[u,f]of Object.entries(t))if(f!=null)if(u=="type"){if(f==="null")throw new Error("type: null can not be the only possible type for the field.");if(f instanceof Array)continue;e.type=Object.values(Yn).includes(f.toUpperCase())?f.toUpperCase():Yn.TYPE_UNSPECIFIED}else if(n.includes(u))e[u]=bs(f);else if(i.includes(u)){const g=[];for(const h of f){if(h.type=="null"){e.nullable=!0;continue}g.push(bs(h))}e[u]=g}else if(l.includes(u)){const g={};for(const[h,x]of Object.entries(f))g[h]=bs(x);e[u]=g}else{if(u==="additionalProperties")continue;e[u]=f}return e}function Jo(t){if(Object.keys(t).includes("$schema")){delete t.$schema;const e=L5().parse(t);return bs(e)}else return bs(t)}function L1(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function Xf(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function nl(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(e.parameters=Jo(e.parameters)),e.response&&(e.response=Jo(e.response));return t}function il(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function O5(t,e,n,i=1){const l=!e.startsWith(`${n}/`)&&e.split("/").length===i;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:l?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:l?`${n}/${e}`:e}function Ki(t,e){if(typeof e!="string")throw new Error("name must be a string");return O5(t,e,"cachedContents")}function P1(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function bi(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}function B5(t){return t!=null&&typeof t=="object"&&"name"in t}function U5(t){return t!=null&&typeof t=="object"&&"video"in t}function z5(t){return t!=null&&typeof t=="object"&&"uri"in t}function O1(t){var e;let n;if(B5(t)&&(n=t.name),!(z5(t)&&(n=t.uri,n===void 0))&&!(U5(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const l=n.split("files/")[1].match(/[a-z0-9]+/);if(l===null)throw new Error(`Could not extract file name from URI ${n}`);n=l[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function B1(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function U1(t){for(const e of["models","tunedModels","publisherModels"])if(V5(t,e))return t[e];return[]}function V5(t,e){return t!==null&&typeof t=="object"&&e in t}function $5(t,e={}){const n=t,i={name:n.name,description:n.description,parameters:bs(ec(n.inputSchema))};return e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function q5(t,e={}){const n=[],i=new Set;for(const l of t){const o=l.name;if(i.has(o))throw new Error(`Duplicate function name ${o} found in MCP tools. Please ensure function names are unique.`);i.add(o);const u=$5(l,e);u.functionDeclarations&&n.push(...u.functionDeclarations)}return{functionDeclarations:n}}function F5(t){const e=[];for(const n of t)e.push(ec(n));return e}function H5(t){const e={};for(const[n,i]of Object.entries(t)){const l=i;e[n]=ec(l)}return e}function ec(t){const e=new Set(["items"]),n=new Set(["anyOf"]),i=new Set(["properties"]),l={};for(const[o,u]of Object.entries(t))if(e.has(o))l[o]=ec(u);else if(n.has(o))l[o]=F5(u);else if(i.has(o))l[o]=H5(u);else if(o==="type"){const f=u.toUpperCase();l[o]=Object.values(Yn).includes(f)?f:Yn.TYPE_UNSPECIFIED}else I5.has(o)&&(l[o]=u);return l}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function G5(t){const e={},n=m(t,["fps"]);n!=null&&p(e,["fps"],n);const i=m(t,["endOffset"]);i!=null&&p(e,["endOffset"],i);const l=m(t,["startOffset"]);return l!=null&&p(e,["startOffset"],l),e}function J5(t){const e={};if(m(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(t,["data"]);n!=null&&p(e,["data"],n);const i=m(t,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function Y5(t){const e={};if(m(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(t,["fileUri"]);n!=null&&p(e,["fileUri"],n);const i=m(t,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function Z5(t){const e={},n=m(t,["videoMetadata"]);n!=null&&p(e,["videoMetadata"],G5(n));const i=m(t,["thought"]);i!=null&&p(e,["thought"],i);const l=m(t,["inlineData"]);l!=null&&p(e,["inlineData"],J5(l));const o=m(t,["fileData"]);o!=null&&p(e,["fileData"],Y5(o));const u=m(t,["thoughtSignature"]);u!=null&&p(e,["thoughtSignature"],u);const f=m(t,["codeExecutionResult"]);f!=null&&p(e,["codeExecutionResult"],f);const g=m(t,["executableCode"]);g!=null&&p(e,["executableCode"],g);const h=m(t,["functionCall"]);h!=null&&p(e,["functionCall"],h);const x=m(t,["functionResponse"]);x!=null&&p(e,["functionResponse"],x);const v=m(t,["text"]);return v!=null&&p(e,["text"],v),e}function Ux(t){const e={},n=m(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(o=>Z5(o))),p(e,["parts"],l)}const i=m(t,["role"]);return i!=null&&p(e,["role"],i),e}function Q5(t){const e={},n=m(t,["behavior"]);n!=null&&p(e,["behavior"],n);const i=m(t,["description"]);i!=null&&p(e,["description"],i);const l=m(t,["name"]);l!=null&&p(e,["name"],l);const o=m(t,["parameters"]);o!=null&&p(e,["parameters"],o);const u=m(t,["parametersJsonSchema"]);u!=null&&p(e,["parametersJsonSchema"],u);const f=m(t,["response"]);f!=null&&p(e,["response"],f);const g=m(t,["responseJsonSchema"]);return g!=null&&p(e,["responseJsonSchema"],g),e}function K5(t){const e={},n=m(t,["startTime"]);n!=null&&p(e,["startTime"],n);const i=m(t,["endTime"]);return i!=null&&p(e,["endTime"],i),e}function W5(t){const e={},n=m(t,["timeRangeFilter"]);return n!=null&&p(e,["timeRangeFilter"],K5(n)),e}function X5(t){const e={},n=m(t,["mode"]);n!=null&&p(e,["mode"],n);const i=m(t,["dynamicThreshold"]);return i!=null&&p(e,["dynamicThreshold"],i),e}function eN(t){const e={},n=m(t,["dynamicRetrievalConfig"]);return n!=null&&p(e,["dynamicRetrievalConfig"],X5(n)),e}function tN(){return{}}function nN(t){const e={},n=m(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(g=>Q5(g))),p(e,["functionDeclarations"],f)}if(m(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=m(t,["googleSearch"]);i!=null&&p(e,["googleSearch"],W5(i));const l=m(t,["googleSearchRetrieval"]);if(l!=null&&p(e,["googleSearchRetrieval"],eN(l)),m(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(m(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");m(t,["urlContext"])!=null&&p(e,["urlContext"],tN());const u=m(t,["codeExecution"]);return u!=null&&p(e,["codeExecution"],u),e}function iN(t){const e={},n=m(t,["mode"]);n!=null&&p(e,["mode"],n);const i=m(t,["allowedFunctionNames"]);return i!=null&&p(e,["allowedFunctionNames"],i),e}function rN(t){const e={},n=m(t,["latitude"]);n!=null&&p(e,["latitude"],n);const i=m(t,["longitude"]);return i!=null&&p(e,["longitude"],i),e}function sN(t){const e={},n=m(t,["latLng"]);n!=null&&p(e,["latLng"],rN(n));const i=m(t,["languageCode"]);return i!=null&&p(e,["languageCode"],i),e}function aN(t){const e={},n=m(t,["functionCallingConfig"]);n!=null&&p(e,["functionCallingConfig"],iN(n));const i=m(t,["retrievalConfig"]);return i!=null&&p(e,["retrievalConfig"],sN(i)),e}function lN(t,e){const n={},i=m(t,["ttl"]);e!==void 0&&i!=null&&p(e,["ttl"],i);const l=m(t,["expireTime"]);e!==void 0&&l!=null&&p(e,["expireTime"],l);const o=m(t,["displayName"]);e!==void 0&&o!=null&&p(e,["displayName"],o);const u=m(t,["contents"]);if(e!==void 0&&u!=null){let x=Ln(u);Array.isArray(x)&&(x=x.map(v=>Ux(v))),p(e,["contents"],x)}const f=m(t,["systemInstruction"]);e!==void 0&&f!=null&&p(e,["systemInstruction"],Ux(Zt(f)));const g=m(t,["tools"]);if(e!==void 0&&g!=null){let x=g;Array.isArray(x)&&(x=x.map(v=>nN(v))),p(e,["tools"],x)}const h=m(t,["toolConfig"]);if(e!==void 0&&h!=null&&p(e,["toolConfig"],aN(h)),m(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function oN(t,e){const n={},i=m(e,["model"]);i!=null&&p(n,["model"],M1(t,i));const l=m(e,["config"]);return l!=null&&p(n,["config"],lN(l,n)),n}function cN(t,e){const n={},i=m(e,["name"]);i!=null&&p(n,["_url","name"],Ki(t,i));const l=m(e,["config"]);return l!=null&&p(n,["config"],l),n}function uN(t,e){const n={},i=m(e,["name"]);i!=null&&p(n,["_url","name"],Ki(t,i));const l=m(e,["config"]);return l!=null&&p(n,["config"],l),n}function dN(t,e){const n={},i=m(t,["ttl"]);e!==void 0&&i!=null&&p(e,["ttl"],i);const l=m(t,["expireTime"]);return e!==void 0&&l!=null&&p(e,["expireTime"],l),n}function fN(t,e){const n={},i=m(e,["name"]);i!=null&&p(n,["_url","name"],Ki(t,i));const l=m(e,["config"]);return l!=null&&p(n,["config"],dN(l,n)),n}function mN(t,e){const n={},i=m(t,["pageSize"]);e!==void 0&&i!=null&&p(e,["_query","pageSize"],i);const l=m(t,["pageToken"]);return e!==void 0&&l!=null&&p(e,["_query","pageToken"],l),n}function hN(t){const e={},n=m(t,["config"]);return n!=null&&p(e,["config"],mN(n,e)),e}function pN(t){const e={},n=m(t,["fps"]);n!=null&&p(e,["fps"],n);const i=m(t,["endOffset"]);i!=null&&p(e,["endOffset"],i);const l=m(t,["startOffset"]);return l!=null&&p(e,["startOffset"],l),e}function gN(t){const e={},n=m(t,["displayName"]);n!=null&&p(e,["displayName"],n);const i=m(t,["data"]);i!=null&&p(e,["data"],i);const l=m(t,["mimeType"]);return l!=null&&p(e,["mimeType"],l),e}function xN(t){const e={},n=m(t,["displayName"]);n!=null&&p(e,["displayName"],n);const i=m(t,["fileUri"]);i!=null&&p(e,["fileUri"],i);const l=m(t,["mimeType"]);return l!=null&&p(e,["mimeType"],l),e}function yN(t){const e={},n=m(t,["videoMetadata"]);n!=null&&p(e,["videoMetadata"],pN(n));const i=m(t,["thought"]);i!=null&&p(e,["thought"],i);const l=m(t,["inlineData"]);l!=null&&p(e,["inlineData"],gN(l));const o=m(t,["fileData"]);o!=null&&p(e,["fileData"],xN(o));const u=m(t,["thoughtSignature"]);u!=null&&p(e,["thoughtSignature"],u);const f=m(t,["codeExecutionResult"]);f!=null&&p(e,["codeExecutionResult"],f);const g=m(t,["executableCode"]);g!=null&&p(e,["executableCode"],g);const h=m(t,["functionCall"]);h!=null&&p(e,["functionCall"],h);const x=m(t,["functionResponse"]);x!=null&&p(e,["functionResponse"],x);const v=m(t,["text"]);return v!=null&&p(e,["text"],v),e}function zx(t){const e={},n=m(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(o=>yN(o))),p(e,["parts"],l)}const i=m(t,["role"]);return i!=null&&p(e,["role"],i),e}function vN(t){const e={};if(m(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=m(t,["description"]);n!=null&&p(e,["description"],n);const i=m(t,["name"]);i!=null&&p(e,["name"],i);const l=m(t,["parameters"]);l!=null&&p(e,["parameters"],l);const o=m(t,["parametersJsonSchema"]);o!=null&&p(e,["parametersJsonSchema"],o);const u=m(t,["response"]);u!=null&&p(e,["response"],u);const f=m(t,["responseJsonSchema"]);return f!=null&&p(e,["responseJsonSchema"],f),e}function bN(t){const e={},n=m(t,["startTime"]);n!=null&&p(e,["startTime"],n);const i=m(t,["endTime"]);return i!=null&&p(e,["endTime"],i),e}function wN(t){const e={},n=m(t,["timeRangeFilter"]);return n!=null&&p(e,["timeRangeFilter"],bN(n)),e}function NN(t){const e={},n=m(t,["mode"]);n!=null&&p(e,["mode"],n);const i=m(t,["dynamicThreshold"]);return i!=null&&p(e,["dynamicThreshold"],i),e}function SN(t){const e={},n=m(t,["dynamicRetrievalConfig"]);return n!=null&&p(e,["dynamicRetrievalConfig"],NN(n)),e}function CN(){return{}}function TN(t){const e={},n=m(t,["apiKeyString"]);return n!=null&&p(e,["apiKeyString"],n),e}function jN(t){const e={},n=m(t,["apiKeyConfig"]);n!=null&&p(e,["apiKeyConfig"],TN(n));const i=m(t,["authType"]);i!=null&&p(e,["authType"],i);const l=m(t,["googleServiceAccountConfig"]);l!=null&&p(e,["googleServiceAccountConfig"],l);const o=m(t,["httpBasicAuthConfig"]);o!=null&&p(e,["httpBasicAuthConfig"],o);const u=m(t,["oauthConfig"]);u!=null&&p(e,["oauthConfig"],u);const f=m(t,["oidcConfig"]);return f!=null&&p(e,["oidcConfig"],f),e}function kN(t){const e={},n=m(t,["authConfig"]);return n!=null&&p(e,["authConfig"],jN(n)),e}function EN(){return{}}function AN(t){const e={},n=m(t,["functionDeclarations"]);if(n!=null){let x=n;Array.isArray(x)&&(x=x.map(v=>vN(v))),p(e,["functionDeclarations"],x)}const i=m(t,["retrieval"]);i!=null&&p(e,["retrieval"],i);const l=m(t,["googleSearch"]);l!=null&&p(e,["googleSearch"],wN(l));const o=m(t,["googleSearchRetrieval"]);o!=null&&p(e,["googleSearchRetrieval"],SN(o)),m(t,["enterpriseWebSearch"])!=null&&p(e,["enterpriseWebSearch"],CN());const f=m(t,["googleMaps"]);f!=null&&p(e,["googleMaps"],kN(f)),m(t,["urlContext"])!=null&&p(e,["urlContext"],EN());const h=m(t,["codeExecution"]);return h!=null&&p(e,["codeExecution"],h),e}function _N(t){const e={},n=m(t,["mode"]);n!=null&&p(e,["mode"],n);const i=m(t,["allowedFunctionNames"]);return i!=null&&p(e,["allowedFunctionNames"],i),e}function MN(t){const e={},n=m(t,["latitude"]);n!=null&&p(e,["latitude"],n);const i=m(t,["longitude"]);return i!=null&&p(e,["longitude"],i),e}function RN(t){const e={},n=m(t,["latLng"]);n!=null&&p(e,["latLng"],MN(n));const i=m(t,["languageCode"]);return i!=null&&p(e,["languageCode"],i),e}function IN(t){const e={},n=m(t,["functionCallingConfig"]);n!=null&&p(e,["functionCallingConfig"],_N(n));const i=m(t,["retrievalConfig"]);return i!=null&&p(e,["retrievalConfig"],RN(i)),e}function DN(t,e){const n={},i=m(t,["ttl"]);e!==void 0&&i!=null&&p(e,["ttl"],i);const l=m(t,["expireTime"]);e!==void 0&&l!=null&&p(e,["expireTime"],l);const o=m(t,["displayName"]);e!==void 0&&o!=null&&p(e,["displayName"],o);const u=m(t,["contents"]);if(e!==void 0&&u!=null){let v=Ln(u);Array.isArray(v)&&(v=v.map(N=>zx(N))),p(e,["contents"],v)}const f=m(t,["systemInstruction"]);e!==void 0&&f!=null&&p(e,["systemInstruction"],zx(Zt(f)));const g=m(t,["tools"]);if(e!==void 0&&g!=null){let v=g;Array.isArray(v)&&(v=v.map(N=>AN(N))),p(e,["tools"],v)}const h=m(t,["toolConfig"]);e!==void 0&&h!=null&&p(e,["toolConfig"],IN(h));const x=m(t,["kmsKeyName"]);return e!==void 0&&x!=null&&p(e,["encryption_spec","kmsKeyName"],x),n}function LN(t,e){const n={},i=m(e,["model"]);i!=null&&p(n,["model"],M1(t,i));const l=m(e,["config"]);return l!=null&&p(n,["config"],DN(l,n)),n}function PN(t,e){const n={},i=m(e,["name"]);i!=null&&p(n,["_url","name"],Ki(t,i));const l=m(e,["config"]);return l!=null&&p(n,["config"],l),n}function ON(t,e){const n={},i=m(e,["name"]);i!=null&&p(n,["_url","name"],Ki(t,i));const l=m(e,["config"]);return l!=null&&p(n,["config"],l),n}function BN(t,e){const n={},i=m(t,["ttl"]);e!==void 0&&i!=null&&p(e,["ttl"],i);const l=m(t,["expireTime"]);return e!==void 0&&l!=null&&p(e,["expireTime"],l),n}function UN(t,e){const n={},i=m(e,["name"]);i!=null&&p(n,["_url","name"],Ki(t,i));const l=m(e,["config"]);return l!=null&&p(n,["config"],BN(l,n)),n}function zN(t,e){const n={},i=m(t,["pageSize"]);e!==void 0&&i!=null&&p(e,["_query","pageSize"],i);const l=m(t,["pageToken"]);return e!==void 0&&l!=null&&p(e,["_query","pageToken"],l),n}function VN(t){const e={},n=m(t,["config"]);return n!=null&&p(e,["config"],zN(n,e)),e}function Eo(t){const e={},n=m(t,["name"]);n!=null&&p(e,["name"],n);const i=m(t,["displayName"]);i!=null&&p(e,["displayName"],i);const l=m(t,["model"]);l!=null&&p(e,["model"],l);const o=m(t,["createTime"]);o!=null&&p(e,["createTime"],o);const u=m(t,["updateTime"]);u!=null&&p(e,["updateTime"],u);const f=m(t,["expireTime"]);f!=null&&p(e,["expireTime"],f);const g=m(t,["usageMetadata"]);return g!=null&&p(e,["usageMetadata"],g),e}function $N(){return{}}function qN(t){const e={},n=m(t,["nextPageToken"]);n!=null&&p(e,["nextPageToken"],n);const i=m(t,["cachedContents"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(o=>Eo(o))),p(e,["cachedContents"],l)}return e}function Ao(t){const e={},n=m(t,["name"]);n!=null&&p(e,["name"],n);const i=m(t,["displayName"]);i!=null&&p(e,["displayName"],i);const l=m(t,["model"]);l!=null&&p(e,["model"],l);const o=m(t,["createTime"]);o!=null&&p(e,["createTime"],o);const u=m(t,["updateTime"]);u!=null&&p(e,["updateTime"],u);const f=m(t,["expireTime"]);f!=null&&p(e,["expireTime"],f);const g=m(t,["usageMetadata"]);return g!=null&&p(e,["usageMetadata"],g),e}function FN(){return{}}function HN(t){const e={},n=m(t,["nextPageToken"]);n!=null&&p(e,["nextPageToken"],n);const i=m(t,["cachedContents"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(o=>Ao(o))),p(e,["cachedContents"],l)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Ms;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Ms||(Ms={}));class tc{constructor(e,n,i,l){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,i,l)}init(e,n,i){var l,o;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.idxInternal=0;let u={config:{}};i?typeof i=="object"?u=Object.assign({},i):u=i:u={config:{}},u.config&&(u.config.pageToken=n.nextPageToken),this.paramsInternal=u,this.pageInternalSize=(o=(l=u.config)===null||l===void 0?void 0:l.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class GN extends Rs{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new tc(Ms.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(n),n)}async create(e){var n,i,l,o;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=LN(this.apiClient,e);return f=Re("cachedContents",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),u.then(x=>Ao(x))}else{const h=oN(this.apiClient,e);return f=Re("cachedContents",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(l=e.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(x=>x.json()),u.then(x=>Eo(x))}}async get(e){var n,i,l,o;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=PN(this.apiClient,e);return f=Re("{name}",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),u.then(x=>Ao(x))}else{const h=cN(this.apiClient,e);return f=Re("{name}",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(l=e.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(x=>x.json()),u.then(x=>Eo(x))}}async delete(e){var n,i,l,o;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=ON(this.apiClient,e);return f=Re("{name}",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),u.then(()=>{const x=FN(),v=new Ix;return Object.assign(v,x),v})}else{const h=uN(this.apiClient,e);return f=Re("{name}",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(l=e.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(x=>x.json()),u.then(()=>{const x=$N(),v=new Ix;return Object.assign(v,x),v})}}async update(e){var n,i,l,o;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=UN(this.apiClient,e);return f=Re("{name}",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),u.then(x=>Ao(x))}else{const h=fN(this.apiClient,e);return f=Re("{name}",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(l=e.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(x=>x.json()),u.then(x=>Eo(x))}}async listInternal(e){var n,i,l,o;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=VN(e);return f=Re("cachedContents",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),u.then(x=>{const v=HN(x),N=new Dx;return Object.assign(N,v),N})}else{const h=hN(e);return f=Re("cachedContents",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(l=e.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(x=>x.json()),u.then(x=>{const v=qN(x),N=new Dx;return Object.assign(N,v),N})}}}function Vx(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function pt(t){return this instanceof pt?(this.v=t,this):new pt(t)}function ws(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n.apply(t,e||[]),l,o=[];return l=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),f("next"),f("throw"),f("return",u),l[Symbol.asyncIterator]=function(){return this},l;function u(w){return function(C){return Promise.resolve(C).then(w,v)}}function f(w,C){i[w]&&(l[w]=function(j){return new Promise(function(k,E){o.push([w,j,k,E])>1||g(w,j)})},C&&(l[w]=C(l[w])))}function g(w,C){try{h(i[w](C))}catch(j){N(o[0][3],j)}}function h(w){w.value instanceof pt?Promise.resolve(w.value.v).then(x,v):N(o[0][2],w)}function x(w){g("next",w)}function v(w){g("throw",w)}function N(w,C){w(C),o.shift(),o.length&&g(o[0][0],o[0][1])}}function Ga(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Vx=="function"?Vx(t):t[Symbol.iterator](),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(o){n[o]=t[o]&&function(u){return new Promise(function(f,g){u=t[o](u),l(f,g,u.done,u.value)})}}function l(o,u,f,g){Promise.resolve(g).then(function(h){o({value:h,done:f})},u)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function JN(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:z1(n)}function z1(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0||!e.thought&&e.text!==void 0&&e.text==="")return!1;return!0}function YN(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function $x(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let i=0;for(;i<n;)if(t[i].role==="user")e.push(t[i]),i++;else{const l=[];let o=!0;for(;i<n&&t[i].role==="model";)l.push(t[i]),o&&!z1(t[i])&&(o=!1),i++;o?e.push(...l):e.pop()}return e}class ZN{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new QN(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class QN{constructor(e,n,i,l={},o=[]){this.apiClient=e,this.modelsModule=n,this.model=i,this.config=l,this.history=o,this.sendPromise=Promise.resolve(),YN(o)}async sendMessage(e){var n;await this.sendPromise;const i=Zt(e.message),l=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var o,u,f;const g=await l,h=(u=(o=g.candidates)===null||o===void 0?void 0:o[0])===null||u===void 0?void 0:u.content,x=g.automaticFunctionCallingHistory,v=this.getHistory(!0).length;let N=[];x!=null&&(N=(f=x.slice(v))!==null&&f!==void 0?f:[]);const w=h?[h]:[];this.recordHistory(i,w,N)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),l}async sendMessageStream(e){var n;await this.sendPromise;const i=Zt(e.message),l=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=l.then(()=>{}).catch(()=>{});const o=await l;return this.processStreamResponse(o,i)}getHistory(e=!1){const n=e?$x(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){var i,l;return ws(this,arguments,function*(){var u,f,g,h;const x=[];try{for(var v=!0,N=Ga(e),w;w=yield pt(N.next()),u=w.done,!u;v=!0){h=w.value,v=!1;const C=h;if(JN(C)){const j=(l=(i=C.candidates)===null||i===void 0?void 0:i[0])===null||l===void 0?void 0:l.content;j!==void 0&&x.push(j)}yield yield pt(C)}}catch(C){f={error:C}}finally{try{!v&&!u&&(g=N.return)&&(yield pt(g.call(N)))}finally{if(f)throw f.error}}this.recordHistory(n,x)})}recordHistory(e,n,i){let l=[];n.length>0&&n.every(o=>o.role!==void 0)?l=n:l.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...$x(i)):this.history.push(e),this.history.push(...l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class nc extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,nc.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function KN(t,e){const n={},i=m(t,["pageSize"]);e!==void 0&&i!=null&&p(e,["_query","pageSize"],i);const l=m(t,["pageToken"]);return e!==void 0&&l!=null&&p(e,["_query","pageToken"],l),n}function WN(t){const e={},n=m(t,["config"]);return n!=null&&p(e,["config"],KN(n,e)),e}function XN(t){const e={},n=m(t,["details"]);n!=null&&p(e,["details"],n);const i=m(t,["message"]);i!=null&&p(e,["message"],i);const l=m(t,["code"]);return l!=null&&p(e,["code"],l),e}function eS(t){const e={},n=m(t,["name"]);n!=null&&p(e,["name"],n);const i=m(t,["displayName"]);i!=null&&p(e,["displayName"],i);const l=m(t,["mimeType"]);l!=null&&p(e,["mimeType"],l);const o=m(t,["sizeBytes"]);o!=null&&p(e,["sizeBytes"],o);const u=m(t,["createTime"]);u!=null&&p(e,["createTime"],u);const f=m(t,["expirationTime"]);f!=null&&p(e,["expirationTime"],f);const g=m(t,["updateTime"]);g!=null&&p(e,["updateTime"],g);const h=m(t,["sha256Hash"]);h!=null&&p(e,["sha256Hash"],h);const x=m(t,["uri"]);x!=null&&p(e,["uri"],x);const v=m(t,["downloadUri"]);v!=null&&p(e,["downloadUri"],v);const N=m(t,["state"]);N!=null&&p(e,["state"],N);const w=m(t,["source"]);w!=null&&p(e,["source"],w);const C=m(t,["videoMetadata"]);C!=null&&p(e,["videoMetadata"],C);const j=m(t,["error"]);return j!=null&&p(e,["error"],XN(j)),e}function tS(t){const e={},n=m(t,["file"]);n!=null&&p(e,["file"],eS(n));const i=m(t,["config"]);return i!=null&&p(e,["config"],i),e}function nS(t){const e={},n=m(t,["name"]);n!=null&&p(e,["_url","file"],O1(n));const i=m(t,["config"]);return i!=null&&p(e,["config"],i),e}function iS(t){const e={},n=m(t,["name"]);n!=null&&p(e,["_url","file"],O1(n));const i=m(t,["config"]);return i!=null&&p(e,["config"],i),e}function rS(t){const e={},n=m(t,["details"]);n!=null&&p(e,["details"],n);const i=m(t,["message"]);i!=null&&p(e,["message"],i);const l=m(t,["code"]);return l!=null&&p(e,["code"],l),e}function Ef(t){const e={},n=m(t,["name"]);n!=null&&p(e,["name"],n);const i=m(t,["displayName"]);i!=null&&p(e,["displayName"],i);const l=m(t,["mimeType"]);l!=null&&p(e,["mimeType"],l);const o=m(t,["sizeBytes"]);o!=null&&p(e,["sizeBytes"],o);const u=m(t,["createTime"]);u!=null&&p(e,["createTime"],u);const f=m(t,["expirationTime"]);f!=null&&p(e,["expirationTime"],f);const g=m(t,["updateTime"]);g!=null&&p(e,["updateTime"],g);const h=m(t,["sha256Hash"]);h!=null&&p(e,["sha256Hash"],h);const x=m(t,["uri"]);x!=null&&p(e,["uri"],x);const v=m(t,["downloadUri"]);v!=null&&p(e,["downloadUri"],v);const N=m(t,["state"]);N!=null&&p(e,["state"],N);const w=m(t,["source"]);w!=null&&p(e,["source"],w);const C=m(t,["videoMetadata"]);C!=null&&p(e,["videoMetadata"],C);const j=m(t,["error"]);return j!=null&&p(e,["error"],rS(j)),e}function sS(t){const e={},n=m(t,["nextPageToken"]);n!=null&&p(e,["nextPageToken"],n);const i=m(t,["files"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(o=>Ef(o))),p(e,["files"],l)}return e}function aS(){return{}}function lS(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class oS extends Rs{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new tc(Ms.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>Ef(n))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,i;let l,o="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=WN(e);return o=Re("files",f._url),u=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const h=sS(g),x=new j5;return Object.assign(x,h),x})}}async createInternal(e){var n,i;let l,o="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=tS(e);return o=Re("upload/v1beta/files",f._url),u=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(()=>{const g=aS(),h=new k5;return Object.assign(h,g),h})}}async get(e){var n,i;let l,o="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=nS(e);return o=Re("files/{file}",f._url),u=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>Ef(g))}}async delete(e){var n,i;let l,o="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=iS(e);return o=Re("files/{file}",f._url),u=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(()=>{const g=lS(),h=new E5;return Object.assign(h,g),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function cS(t){const e={},n=m(t,["voiceName"]);return n!=null&&p(e,["voiceName"],n),e}function uS(t){const e={},n=m(t,["voiceName"]);return n!=null&&p(e,["voiceName"],n),e}function V1(t){const e={},n=m(t,["prebuiltVoiceConfig"]);return n!=null&&p(e,["prebuiltVoiceConfig"],cS(n)),e}function dS(t){const e={},n=m(t,["prebuiltVoiceConfig"]);return n!=null&&p(e,["prebuiltVoiceConfig"],uS(n)),e}function fS(t){const e={},n=m(t,["speaker"]);n!=null&&p(e,["speaker"],n);const i=m(t,["voiceConfig"]);return i!=null&&p(e,["voiceConfig"],V1(i)),e}function mS(t){const e={},n=m(t,["speakerVoiceConfigs"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>fS(l))),p(e,["speakerVoiceConfigs"],i)}return e}function hS(t){const e={},n=m(t,["voiceConfig"]);n!=null&&p(e,["voiceConfig"],V1(n));const i=m(t,["multiSpeakerVoiceConfig"]);i!=null&&p(e,["multiSpeakerVoiceConfig"],mS(i));const l=m(t,["languageCode"]);return l!=null&&p(e,["languageCode"],l),e}function pS(t){const e={},n=m(t,["voiceConfig"]);if(n!=null&&p(e,["voiceConfig"],dS(n)),m(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=m(t,["languageCode"]);return i!=null&&p(e,["languageCode"],i),e}function gS(t){const e={},n=m(t,["fps"]);n!=null&&p(e,["fps"],n);const i=m(t,["endOffset"]);i!=null&&p(e,["endOffset"],i);const l=m(t,["startOffset"]);return l!=null&&p(e,["startOffset"],l),e}function xS(t){const e={},n=m(t,["fps"]);n!=null&&p(e,["fps"],n);const i=m(t,["endOffset"]);i!=null&&p(e,["endOffset"],i);const l=m(t,["startOffset"]);return l!=null&&p(e,["startOffset"],l),e}function yS(t){const e={};if(m(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(t,["data"]);n!=null&&p(e,["data"],n);const i=m(t,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function vS(t){const e={},n=m(t,["displayName"]);n!=null&&p(e,["displayName"],n);const i=m(t,["data"]);i!=null&&p(e,["data"],i);const l=m(t,["mimeType"]);return l!=null&&p(e,["mimeType"],l),e}function bS(t){const e={};if(m(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(t,["fileUri"]);n!=null&&p(e,["fileUri"],n);const i=m(t,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function wS(t){const e={},n=m(t,["displayName"]);n!=null&&p(e,["displayName"],n);const i=m(t,["fileUri"]);i!=null&&p(e,["fileUri"],i);const l=m(t,["mimeType"]);return l!=null&&p(e,["mimeType"],l),e}function NS(t){const e={},n=m(t,["videoMetadata"]);n!=null&&p(e,["videoMetadata"],gS(n));const i=m(t,["thought"]);i!=null&&p(e,["thought"],i);const l=m(t,["inlineData"]);l!=null&&p(e,["inlineData"],yS(l));const o=m(t,["fileData"]);o!=null&&p(e,["fileData"],bS(o));const u=m(t,["thoughtSignature"]);u!=null&&p(e,["thoughtSignature"],u);const f=m(t,["codeExecutionResult"]);f!=null&&p(e,["codeExecutionResult"],f);const g=m(t,["executableCode"]);g!=null&&p(e,["executableCode"],g);const h=m(t,["functionCall"]);h!=null&&p(e,["functionCall"],h);const x=m(t,["functionResponse"]);x!=null&&p(e,["functionResponse"],x);const v=m(t,["text"]);return v!=null&&p(e,["text"],v),e}function SS(t){const e={},n=m(t,["videoMetadata"]);n!=null&&p(e,["videoMetadata"],xS(n));const i=m(t,["thought"]);i!=null&&p(e,["thought"],i);const l=m(t,["inlineData"]);l!=null&&p(e,["inlineData"],vS(l));const o=m(t,["fileData"]);o!=null&&p(e,["fileData"],wS(o));const u=m(t,["thoughtSignature"]);u!=null&&p(e,["thoughtSignature"],u);const f=m(t,["codeExecutionResult"]);f!=null&&p(e,["codeExecutionResult"],f);const g=m(t,["executableCode"]);g!=null&&p(e,["executableCode"],g);const h=m(t,["functionCall"]);h!=null&&p(e,["functionCall"],h);const x=m(t,["functionResponse"]);x!=null&&p(e,["functionResponse"],x);const v=m(t,["text"]);return v!=null&&p(e,["text"],v),e}function CS(t){const e={},n=m(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(o=>NS(o))),p(e,["parts"],l)}const i=m(t,["role"]);return i!=null&&p(e,["role"],i),e}function TS(t){const e={},n=m(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(o=>SS(o))),p(e,["parts"],l)}const i=m(t,["role"]);return i!=null&&p(e,["role"],i),e}function jS(t){const e={},n=m(t,["behavior"]);n!=null&&p(e,["behavior"],n);const i=m(t,["description"]);i!=null&&p(e,["description"],i);const l=m(t,["name"]);l!=null&&p(e,["name"],l);const o=m(t,["parameters"]);o!=null&&p(e,["parameters"],o);const u=m(t,["parametersJsonSchema"]);u!=null&&p(e,["parametersJsonSchema"],u);const f=m(t,["response"]);f!=null&&p(e,["response"],f);const g=m(t,["responseJsonSchema"]);return g!=null&&p(e,["responseJsonSchema"],g),e}function kS(t){const e={};if(m(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=m(t,["description"]);n!=null&&p(e,["description"],n);const i=m(t,["name"]);i!=null&&p(e,["name"],i);const l=m(t,["parameters"]);l!=null&&p(e,["parameters"],l);const o=m(t,["parametersJsonSchema"]);o!=null&&p(e,["parametersJsonSchema"],o);const u=m(t,["response"]);u!=null&&p(e,["response"],u);const f=m(t,["responseJsonSchema"]);return f!=null&&p(e,["responseJsonSchema"],f),e}function ES(t){const e={},n=m(t,["startTime"]);n!=null&&p(e,["startTime"],n);const i=m(t,["endTime"]);return i!=null&&p(e,["endTime"],i),e}function AS(t){const e={},n=m(t,["startTime"]);n!=null&&p(e,["startTime"],n);const i=m(t,["endTime"]);return i!=null&&p(e,["endTime"],i),e}function _S(t){const e={},n=m(t,["timeRangeFilter"]);return n!=null&&p(e,["timeRangeFilter"],ES(n)),e}function MS(t){const e={},n=m(t,["timeRangeFilter"]);return n!=null&&p(e,["timeRangeFilter"],AS(n)),e}function RS(t){const e={},n=m(t,["mode"]);n!=null&&p(e,["mode"],n);const i=m(t,["dynamicThreshold"]);return i!=null&&p(e,["dynamicThreshold"],i),e}function IS(t){const e={},n=m(t,["mode"]);n!=null&&p(e,["mode"],n);const i=m(t,["dynamicThreshold"]);return i!=null&&p(e,["dynamicThreshold"],i),e}function DS(t){const e={},n=m(t,["dynamicRetrievalConfig"]);return n!=null&&p(e,["dynamicRetrievalConfig"],RS(n)),e}function LS(t){const e={},n=m(t,["dynamicRetrievalConfig"]);return n!=null&&p(e,["dynamicRetrievalConfig"],IS(n)),e}function PS(){return{}}function OS(t){const e={},n=m(t,["apiKeyString"]);return n!=null&&p(e,["apiKeyString"],n),e}function BS(t){const e={},n=m(t,["apiKeyConfig"]);n!=null&&p(e,["apiKeyConfig"],OS(n));const i=m(t,["authType"]);i!=null&&p(e,["authType"],i);const l=m(t,["googleServiceAccountConfig"]);l!=null&&p(e,["googleServiceAccountConfig"],l);const o=m(t,["httpBasicAuthConfig"]);o!=null&&p(e,["httpBasicAuthConfig"],o);const u=m(t,["oauthConfig"]);u!=null&&p(e,["oauthConfig"],u);const f=m(t,["oidcConfig"]);return f!=null&&p(e,["oidcConfig"],f),e}function US(t){const e={},n=m(t,["authConfig"]);return n!=null&&p(e,["authConfig"],BS(n)),e}function zS(){return{}}function VS(){return{}}function $S(t){const e={},n=m(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(g=>jS(g))),p(e,["functionDeclarations"],f)}if(m(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=m(t,["googleSearch"]);i!=null&&p(e,["googleSearch"],_S(i));const l=m(t,["googleSearchRetrieval"]);if(l!=null&&p(e,["googleSearchRetrieval"],DS(l)),m(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(m(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");m(t,["urlContext"])!=null&&p(e,["urlContext"],zS());const u=m(t,["codeExecution"]);return u!=null&&p(e,["codeExecution"],u),e}function qS(t){const e={},n=m(t,["functionDeclarations"]);if(n!=null){let x=n;Array.isArray(x)&&(x=x.map(v=>kS(v))),p(e,["functionDeclarations"],x)}const i=m(t,["retrieval"]);i!=null&&p(e,["retrieval"],i);const l=m(t,["googleSearch"]);l!=null&&p(e,["googleSearch"],MS(l));const o=m(t,["googleSearchRetrieval"]);o!=null&&p(e,["googleSearchRetrieval"],LS(o)),m(t,["enterpriseWebSearch"])!=null&&p(e,["enterpriseWebSearch"],PS());const f=m(t,["googleMaps"]);f!=null&&p(e,["googleMaps"],US(f)),m(t,["urlContext"])!=null&&p(e,["urlContext"],VS());const h=m(t,["codeExecution"]);return h!=null&&p(e,["codeExecution"],h),e}function FS(t){const e={},n=m(t,["handle"]);if(n!=null&&p(e,["handle"],n),m(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function HS(t){const e={},n=m(t,["handle"]);n!=null&&p(e,["handle"],n);const i=m(t,["transparent"]);return i!=null&&p(e,["transparent"],i),e}function qx(){return{}}function Fx(){return{}}function GS(t){const e={},n=m(t,["disabled"]);n!=null&&p(e,["disabled"],n);const i=m(t,["startOfSpeechSensitivity"]);i!=null&&p(e,["startOfSpeechSensitivity"],i);const l=m(t,["endOfSpeechSensitivity"]);l!=null&&p(e,["endOfSpeechSensitivity"],l);const o=m(t,["prefixPaddingMs"]);o!=null&&p(e,["prefixPaddingMs"],o);const u=m(t,["silenceDurationMs"]);return u!=null&&p(e,["silenceDurationMs"],u),e}function JS(t){const e={},n=m(t,["disabled"]);n!=null&&p(e,["disabled"],n);const i=m(t,["startOfSpeechSensitivity"]);i!=null&&p(e,["startOfSpeechSensitivity"],i);const l=m(t,["endOfSpeechSensitivity"]);l!=null&&p(e,["endOfSpeechSensitivity"],l);const o=m(t,["prefixPaddingMs"]);o!=null&&p(e,["prefixPaddingMs"],o);const u=m(t,["silenceDurationMs"]);return u!=null&&p(e,["silenceDurationMs"],u),e}function YS(t){const e={},n=m(t,["automaticActivityDetection"]);n!=null&&p(e,["automaticActivityDetection"],GS(n));const i=m(t,["activityHandling"]);i!=null&&p(e,["activityHandling"],i);const l=m(t,["turnCoverage"]);return l!=null&&p(e,["turnCoverage"],l),e}function ZS(t){const e={},n=m(t,["automaticActivityDetection"]);n!=null&&p(e,["automaticActivityDetection"],JS(n));const i=m(t,["activityHandling"]);i!=null&&p(e,["activityHandling"],i);const l=m(t,["turnCoverage"]);return l!=null&&p(e,["turnCoverage"],l),e}function QS(t){const e={},n=m(t,["targetTokens"]);return n!=null&&p(e,["targetTokens"],n),e}function KS(t){const e={},n=m(t,["targetTokens"]);return n!=null&&p(e,["targetTokens"],n),e}function WS(t){const e={},n=m(t,["triggerTokens"]);n!=null&&p(e,["triggerTokens"],n);const i=m(t,["slidingWindow"]);return i!=null&&p(e,["slidingWindow"],QS(i)),e}function XS(t){const e={},n=m(t,["triggerTokens"]);n!=null&&p(e,["triggerTokens"],n);const i=m(t,["slidingWindow"]);return i!=null&&p(e,["slidingWindow"],KS(i)),e}function eC(t){const e={},n=m(t,["proactiveAudio"]);return n!=null&&p(e,["proactiveAudio"],n),e}function tC(t){const e={},n=m(t,["proactiveAudio"]);return n!=null&&p(e,["proactiveAudio"],n),e}function nC(t,e){const n={},i=m(t,["generationConfig"]);e!==void 0&&i!=null&&p(e,["setup","generationConfig"],i);const l=m(t,["responseModalities"]);e!==void 0&&l!=null&&p(e,["setup","generationConfig","responseModalities"],l);const o=m(t,["temperature"]);e!==void 0&&o!=null&&p(e,["setup","generationConfig","temperature"],o);const u=m(t,["topP"]);e!==void 0&&u!=null&&p(e,["setup","generationConfig","topP"],u);const f=m(t,["topK"]);e!==void 0&&f!=null&&p(e,["setup","generationConfig","topK"],f);const g=m(t,["maxOutputTokens"]);e!==void 0&&g!=null&&p(e,["setup","generationConfig","maxOutputTokens"],g);const h=m(t,["mediaResolution"]);e!==void 0&&h!=null&&p(e,["setup","generationConfig","mediaResolution"],h);const x=m(t,["seed"]);e!==void 0&&x!=null&&p(e,["setup","generationConfig","seed"],x);const v=m(t,["speechConfig"]);e!==void 0&&v!=null&&p(e,["setup","generationConfig","speechConfig"],hS(Xf(v)));const N=m(t,["enableAffectiveDialog"]);e!==void 0&&N!=null&&p(e,["setup","generationConfig","enableAffectiveDialog"],N);const w=m(t,["systemInstruction"]);e!==void 0&&w!=null&&p(e,["setup","systemInstruction"],CS(Zt(w)));const C=m(t,["tools"]);if(e!==void 0&&C!=null){let H=il(C);Array.isArray(H)&&(H=H.map(I=>$S(nl(I)))),p(e,["setup","tools"],H)}const j=m(t,["sessionResumption"]);e!==void 0&&j!=null&&p(e,["setup","sessionResumption"],FS(j));const k=m(t,["inputAudioTranscription"]);e!==void 0&&k!=null&&p(e,["setup","inputAudioTranscription"],qx());const E=m(t,["outputAudioTranscription"]);e!==void 0&&E!=null&&p(e,["setup","outputAudioTranscription"],qx());const L=m(t,["realtimeInputConfig"]);e!==void 0&&L!=null&&p(e,["setup","realtimeInputConfig"],YS(L));const D=m(t,["contextWindowCompression"]);e!==void 0&&D!=null&&p(e,["setup","contextWindowCompression"],WS(D));const O=m(t,["proactivity"]);return e!==void 0&&O!=null&&p(e,["setup","proactivity"],eC(O)),n}function iC(t,e){const n={},i=m(t,["generationConfig"]);e!==void 0&&i!=null&&p(e,["setup","generationConfig"],i);const l=m(t,["responseModalities"]);e!==void 0&&l!=null&&p(e,["setup","generationConfig","responseModalities"],l);const o=m(t,["temperature"]);e!==void 0&&o!=null&&p(e,["setup","generationConfig","temperature"],o);const u=m(t,["topP"]);e!==void 0&&u!=null&&p(e,["setup","generationConfig","topP"],u);const f=m(t,["topK"]);e!==void 0&&f!=null&&p(e,["setup","generationConfig","topK"],f);const g=m(t,["maxOutputTokens"]);e!==void 0&&g!=null&&p(e,["setup","generationConfig","maxOutputTokens"],g);const h=m(t,["mediaResolution"]);e!==void 0&&h!=null&&p(e,["setup","generationConfig","mediaResolution"],h);const x=m(t,["seed"]);e!==void 0&&x!=null&&p(e,["setup","generationConfig","seed"],x);const v=m(t,["speechConfig"]);e!==void 0&&v!=null&&p(e,["setup","generationConfig","speechConfig"],pS(Xf(v)));const N=m(t,["enableAffectiveDialog"]);e!==void 0&&N!=null&&p(e,["setup","generationConfig","enableAffectiveDialog"],N);const w=m(t,["systemInstruction"]);e!==void 0&&w!=null&&p(e,["setup","systemInstruction"],TS(Zt(w)));const C=m(t,["tools"]);if(e!==void 0&&C!=null){let H=il(C);Array.isArray(H)&&(H=H.map(I=>qS(nl(I)))),p(e,["setup","tools"],H)}const j=m(t,["sessionResumption"]);e!==void 0&&j!=null&&p(e,["setup","sessionResumption"],HS(j));const k=m(t,["inputAudioTranscription"]);e!==void 0&&k!=null&&p(e,["setup","inputAudioTranscription"],Fx());const E=m(t,["outputAudioTranscription"]);e!==void 0&&E!=null&&p(e,["setup","outputAudioTranscription"],Fx());const L=m(t,["realtimeInputConfig"]);e!==void 0&&L!=null&&p(e,["setup","realtimeInputConfig"],ZS(L));const D=m(t,["contextWindowCompression"]);e!==void 0&&D!=null&&p(e,["setup","contextWindowCompression"],XS(D));const O=m(t,["proactivity"]);return e!==void 0&&O!=null&&p(e,["setup","proactivity"],tC(O)),n}function rC(t,e){const n={},i=m(e,["model"]);i!=null&&p(n,["setup","model"],ht(t,i));const l=m(e,["config"]);return l!=null&&p(n,["config"],nC(l,n)),n}function sC(t,e){const n={},i=m(e,["model"]);i!=null&&p(n,["setup","model"],ht(t,i));const l=m(e,["config"]);return l!=null&&p(n,["config"],iC(l,n)),n}function aC(){return{}}function lC(){return{}}function oC(){return{}}function cC(){return{}}function uC(t){const e={},n=m(t,["media"]);n!=null&&p(e,["mediaChunks"],R1(n));const i=m(t,["audio"]);i!=null&&p(e,["audio"],R5(i));const l=m(t,["audioStreamEnd"]);l!=null&&p(e,["audioStreamEnd"],l);const o=m(t,["video"]);o!=null&&p(e,["video"],M5(o));const u=m(t,["text"]);return u!=null&&p(e,["text"],u),m(t,["activityStart"])!=null&&p(e,["activityStart"],aC()),m(t,["activityEnd"])!=null&&p(e,["activityEnd"],oC()),e}function dC(t){const e={},n=m(t,["media"]);if(n!=null&&p(e,["mediaChunks"],R1(n)),m(t,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const i=m(t,["audioStreamEnd"]);if(i!=null&&p(e,["audioStreamEnd"],i),m(t,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(m(t,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return m(t,["activityStart"])!=null&&p(e,["activityStart"],lC()),m(t,["activityEnd"])!=null&&p(e,["activityEnd"],cC()),e}function $1(t){const e={},n=m(t,["text"]);n!=null&&p(e,["text"],n);const i=m(t,["weight"]);return i!=null&&p(e,["weight"],i),e}function fC(t){const e={},n=m(t,["weightedPrompts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>$1(l))),p(e,["weightedPrompts"],i)}return e}function q1(t){const e={},n=m(t,["temperature"]);n!=null&&p(e,["temperature"],n);const i=m(t,["topK"]);i!=null&&p(e,["topK"],i);const l=m(t,["seed"]);l!=null&&p(e,["seed"],l);const o=m(t,["guidance"]);o!=null&&p(e,["guidance"],o);const u=m(t,["bpm"]);u!=null&&p(e,["bpm"],u);const f=m(t,["density"]);f!=null&&p(e,["density"],f);const g=m(t,["brightness"]);g!=null&&p(e,["brightness"],g);const h=m(t,["scale"]);h!=null&&p(e,["scale"],h);const x=m(t,["muteBass"]);x!=null&&p(e,["muteBass"],x);const v=m(t,["muteDrums"]);v!=null&&p(e,["muteDrums"],v);const N=m(t,["onlyBassAndDrums"]);return N!=null&&p(e,["onlyBassAndDrums"],N),e}function mC(t){const e={},n=m(t,["musicGenerationConfig"]);return n!=null&&p(e,["musicGenerationConfig"],q1(n)),e}function F1(t){const e={},n=m(t,["model"]);return n!=null&&p(e,["model"],n),e}function H1(t){const e={},n=m(t,["weightedPrompts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>$1(l))),p(e,["weightedPrompts"],i)}return e}function Af(t){const e={},n=m(t,["setup"]);n!=null&&p(e,["setup"],F1(n));const i=m(t,["clientContent"]);i!=null&&p(e,["clientContent"],H1(i));const l=m(t,["musicGenerationConfig"]);l!=null&&p(e,["musicGenerationConfig"],q1(l));const o=m(t,["playbackControl"]);return o!=null&&p(e,["playbackControl"],o),e}function hC(){return{}}function pC(){return{}}function gC(t){const e={},n=m(t,["fps"]);n!=null&&p(e,["fps"],n);const i=m(t,["endOffset"]);i!=null&&p(e,["endOffset"],i);const l=m(t,["startOffset"]);return l!=null&&p(e,["startOffset"],l),e}function xC(t){const e={},n=m(t,["fps"]);n!=null&&p(e,["fps"],n);const i=m(t,["endOffset"]);i!=null&&p(e,["endOffset"],i);const l=m(t,["startOffset"]);return l!=null&&p(e,["startOffset"],l),e}function yC(t){const e={},n=m(t,["data"]);n!=null&&p(e,["data"],n);const i=m(t,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function vC(t){const e={},n=m(t,["displayName"]);n!=null&&p(e,["displayName"],n);const i=m(t,["data"]);i!=null&&p(e,["data"],i);const l=m(t,["mimeType"]);return l!=null&&p(e,["mimeType"],l),e}function bC(t){const e={},n=m(t,["fileUri"]);n!=null&&p(e,["fileUri"],n);const i=m(t,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function wC(t){const e={},n=m(t,["displayName"]);n!=null&&p(e,["displayName"],n);const i=m(t,["fileUri"]);i!=null&&p(e,["fileUri"],i);const l=m(t,["mimeType"]);return l!=null&&p(e,["mimeType"],l),e}function NC(t){const e={},n=m(t,["videoMetadata"]);n!=null&&p(e,["videoMetadata"],gC(n));const i=m(t,["thought"]);i!=null&&p(e,["thought"],i);const l=m(t,["inlineData"]);l!=null&&p(e,["inlineData"],yC(l));const o=m(t,["fileData"]);o!=null&&p(e,["fileData"],bC(o));const u=m(t,["thoughtSignature"]);u!=null&&p(e,["thoughtSignature"],u);const f=m(t,["codeExecutionResult"]);f!=null&&p(e,["codeExecutionResult"],f);const g=m(t,["executableCode"]);g!=null&&p(e,["executableCode"],g);const h=m(t,["functionCall"]);h!=null&&p(e,["functionCall"],h);const x=m(t,["functionResponse"]);x!=null&&p(e,["functionResponse"],x);const v=m(t,["text"]);return v!=null&&p(e,["text"],v),e}function SC(t){const e={},n=m(t,["videoMetadata"]);n!=null&&p(e,["videoMetadata"],xC(n));const i=m(t,["thought"]);i!=null&&p(e,["thought"],i);const l=m(t,["inlineData"]);l!=null&&p(e,["inlineData"],vC(l));const o=m(t,["fileData"]);o!=null&&p(e,["fileData"],wC(o));const u=m(t,["thoughtSignature"]);u!=null&&p(e,["thoughtSignature"],u);const f=m(t,["codeExecutionResult"]);f!=null&&p(e,["codeExecutionResult"],f);const g=m(t,["executableCode"]);g!=null&&p(e,["executableCode"],g);const h=m(t,["functionCall"]);h!=null&&p(e,["functionCall"],h);const x=m(t,["functionResponse"]);x!=null&&p(e,["functionResponse"],x);const v=m(t,["text"]);return v!=null&&p(e,["text"],v),e}function CC(t){const e={},n=m(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(o=>NC(o))),p(e,["parts"],l)}const i=m(t,["role"]);return i!=null&&p(e,["role"],i),e}function TC(t){const e={},n=m(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(o=>SC(o))),p(e,["parts"],l)}const i=m(t,["role"]);return i!=null&&p(e,["role"],i),e}function Hx(t){const e={},n=m(t,["text"]);n!=null&&p(e,["text"],n);const i=m(t,["finished"]);return i!=null&&p(e,["finished"],i),e}function Gx(t){const e={},n=m(t,["text"]);n!=null&&p(e,["text"],n);const i=m(t,["finished"]);return i!=null&&p(e,["finished"],i),e}function jC(t){const e={},n=m(t,["retrievedUrl"]);n!=null&&p(e,["retrievedUrl"],n);const i=m(t,["urlRetrievalStatus"]);return i!=null&&p(e,["urlRetrievalStatus"],i),e}function kC(t){const e={},n=m(t,["urlMetadata"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>jC(l))),p(e,["urlMetadata"],i)}return e}function EC(t){const e={},n=m(t,["modelTurn"]);n!=null&&p(e,["modelTurn"],CC(n));const i=m(t,["turnComplete"]);i!=null&&p(e,["turnComplete"],i);const l=m(t,["interrupted"]);l!=null&&p(e,["interrupted"],l);const o=m(t,["groundingMetadata"]);o!=null&&p(e,["groundingMetadata"],o);const u=m(t,["generationComplete"]);u!=null&&p(e,["generationComplete"],u);const f=m(t,["inputTranscription"]);f!=null&&p(e,["inputTranscription"],Hx(f));const g=m(t,["outputTranscription"]);g!=null&&p(e,["outputTranscription"],Hx(g));const h=m(t,["urlContextMetadata"]);return h!=null&&p(e,["urlContextMetadata"],kC(h)),e}function AC(t){const e={},n=m(t,["modelTurn"]);n!=null&&p(e,["modelTurn"],TC(n));const i=m(t,["turnComplete"]);i!=null&&p(e,["turnComplete"],i);const l=m(t,["interrupted"]);l!=null&&p(e,["interrupted"],l);const o=m(t,["groundingMetadata"]);o!=null&&p(e,["groundingMetadata"],o);const u=m(t,["generationComplete"]);u!=null&&p(e,["generationComplete"],u);const f=m(t,["inputTranscription"]);f!=null&&p(e,["inputTranscription"],Gx(f));const g=m(t,["outputTranscription"]);return g!=null&&p(e,["outputTranscription"],Gx(g)),e}function _C(t){const e={},n=m(t,["id"]);n!=null&&p(e,["id"],n);const i=m(t,["args"]);i!=null&&p(e,["args"],i);const l=m(t,["name"]);return l!=null&&p(e,["name"],l),e}function MC(t){const e={},n=m(t,["args"]);n!=null&&p(e,["args"],n);const i=m(t,["name"]);return i!=null&&p(e,["name"],i),e}function RC(t){const e={},n=m(t,["functionCalls"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>_C(l))),p(e,["functionCalls"],i)}return e}function IC(t){const e={},n=m(t,["functionCalls"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>MC(l))),p(e,["functionCalls"],i)}return e}function DC(t){const e={},n=m(t,["ids"]);return n!=null&&p(e,["ids"],n),e}function LC(t){const e={},n=m(t,["ids"]);return n!=null&&p(e,["ids"],n),e}function wo(t){const e={},n=m(t,["modality"]);n!=null&&p(e,["modality"],n);const i=m(t,["tokenCount"]);return i!=null&&p(e,["tokenCount"],i),e}function No(t){const e={},n=m(t,["modality"]);n!=null&&p(e,["modality"],n);const i=m(t,["tokenCount"]);return i!=null&&p(e,["tokenCount"],i),e}function PC(t){const e={},n=m(t,["promptTokenCount"]);n!=null&&p(e,["promptTokenCount"],n);const i=m(t,["cachedContentTokenCount"]);i!=null&&p(e,["cachedContentTokenCount"],i);const l=m(t,["responseTokenCount"]);l!=null&&p(e,["responseTokenCount"],l);const o=m(t,["toolUsePromptTokenCount"]);o!=null&&p(e,["toolUsePromptTokenCount"],o);const u=m(t,["thoughtsTokenCount"]);u!=null&&p(e,["thoughtsTokenCount"],u);const f=m(t,["totalTokenCount"]);f!=null&&p(e,["totalTokenCount"],f);const g=m(t,["promptTokensDetails"]);if(g!=null){let N=g;Array.isArray(N)&&(N=N.map(w=>wo(w))),p(e,["promptTokensDetails"],N)}const h=m(t,["cacheTokensDetails"]);if(h!=null){let N=h;Array.isArray(N)&&(N=N.map(w=>wo(w))),p(e,["cacheTokensDetails"],N)}const x=m(t,["responseTokensDetails"]);if(x!=null){let N=x;Array.isArray(N)&&(N=N.map(w=>wo(w))),p(e,["responseTokensDetails"],N)}const v=m(t,["toolUsePromptTokensDetails"]);if(v!=null){let N=v;Array.isArray(N)&&(N=N.map(w=>wo(w))),p(e,["toolUsePromptTokensDetails"],N)}return e}function OC(t){const e={},n=m(t,["promptTokenCount"]);n!=null&&p(e,["promptTokenCount"],n);const i=m(t,["cachedContentTokenCount"]);i!=null&&p(e,["cachedContentTokenCount"],i);const l=m(t,["candidatesTokenCount"]);l!=null&&p(e,["responseTokenCount"],l);const o=m(t,["toolUsePromptTokenCount"]);o!=null&&p(e,["toolUsePromptTokenCount"],o);const u=m(t,["thoughtsTokenCount"]);u!=null&&p(e,["thoughtsTokenCount"],u);const f=m(t,["totalTokenCount"]);f!=null&&p(e,["totalTokenCount"],f);const g=m(t,["promptTokensDetails"]);if(g!=null){let w=g;Array.isArray(w)&&(w=w.map(C=>No(C))),p(e,["promptTokensDetails"],w)}const h=m(t,["cacheTokensDetails"]);if(h!=null){let w=h;Array.isArray(w)&&(w=w.map(C=>No(C))),p(e,["cacheTokensDetails"],w)}const x=m(t,["candidatesTokensDetails"]);if(x!=null){let w=x;Array.isArray(w)&&(w=w.map(C=>No(C))),p(e,["responseTokensDetails"],w)}const v=m(t,["toolUsePromptTokensDetails"]);if(v!=null){let w=v;Array.isArray(w)&&(w=w.map(C=>No(C))),p(e,["toolUsePromptTokensDetails"],w)}const N=m(t,["trafficType"]);return N!=null&&p(e,["trafficType"],N),e}function BC(t){const e={},n=m(t,["timeLeft"]);return n!=null&&p(e,["timeLeft"],n),e}function UC(t){const e={},n=m(t,["timeLeft"]);return n!=null&&p(e,["timeLeft"],n),e}function zC(t){const e={},n=m(t,["newHandle"]);n!=null&&p(e,["newHandle"],n);const i=m(t,["resumable"]);i!=null&&p(e,["resumable"],i);const l=m(t,["lastConsumedClientMessageIndex"]);return l!=null&&p(e,["lastConsumedClientMessageIndex"],l),e}function VC(t){const e={},n=m(t,["newHandle"]);n!=null&&p(e,["newHandle"],n);const i=m(t,["resumable"]);i!=null&&p(e,["resumable"],i);const l=m(t,["lastConsumedClientMessageIndex"]);return l!=null&&p(e,["lastConsumedClientMessageIndex"],l),e}function $C(t){const e={};m(t,["setupComplete"])!=null&&p(e,["setupComplete"],hC());const i=m(t,["serverContent"]);i!=null&&p(e,["serverContent"],EC(i));const l=m(t,["toolCall"]);l!=null&&p(e,["toolCall"],RC(l));const o=m(t,["toolCallCancellation"]);o!=null&&p(e,["toolCallCancellation"],DC(o));const u=m(t,["usageMetadata"]);u!=null&&p(e,["usageMetadata"],PC(u));const f=m(t,["goAway"]);f!=null&&p(e,["goAway"],BC(f));const g=m(t,["sessionResumptionUpdate"]);return g!=null&&p(e,["sessionResumptionUpdate"],zC(g)),e}function qC(t){const e={};m(t,["setupComplete"])!=null&&p(e,["setupComplete"],pC());const i=m(t,["serverContent"]);i!=null&&p(e,["serverContent"],AC(i));const l=m(t,["toolCall"]);l!=null&&p(e,["toolCall"],IC(l));const o=m(t,["toolCallCancellation"]);o!=null&&p(e,["toolCallCancellation"],LC(o));const u=m(t,["usageMetadata"]);u!=null&&p(e,["usageMetadata"],OC(u));const f=m(t,["goAway"]);f!=null&&p(e,["goAway"],UC(f));const g=m(t,["sessionResumptionUpdate"]);return g!=null&&p(e,["sessionResumptionUpdate"],VC(g)),e}function FC(){return{}}function HC(t){const e={},n=m(t,["text"]);n!=null&&p(e,["text"],n);const i=m(t,["weight"]);return i!=null&&p(e,["weight"],i),e}function GC(t){const e={},n=m(t,["weightedPrompts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>HC(l))),p(e,["weightedPrompts"],i)}return e}function JC(t){const e={},n=m(t,["temperature"]);n!=null&&p(e,["temperature"],n);const i=m(t,["topK"]);i!=null&&p(e,["topK"],i);const l=m(t,["seed"]);l!=null&&p(e,["seed"],l);const o=m(t,["guidance"]);o!=null&&p(e,["guidance"],o);const u=m(t,["bpm"]);u!=null&&p(e,["bpm"],u);const f=m(t,["density"]);f!=null&&p(e,["density"],f);const g=m(t,["brightness"]);g!=null&&p(e,["brightness"],g);const h=m(t,["scale"]);h!=null&&p(e,["scale"],h);const x=m(t,["muteBass"]);x!=null&&p(e,["muteBass"],x);const v=m(t,["muteDrums"]);v!=null&&p(e,["muteDrums"],v);const N=m(t,["onlyBassAndDrums"]);return N!=null&&p(e,["onlyBassAndDrums"],N),e}function YC(t){const e={},n=m(t,["clientContent"]);n!=null&&p(e,["clientContent"],GC(n));const i=m(t,["musicGenerationConfig"]);return i!=null&&p(e,["musicGenerationConfig"],JC(i)),e}function ZC(t){const e={},n=m(t,["data"]);n!=null&&p(e,["data"],n);const i=m(t,["mimeType"]);i!=null&&p(e,["mimeType"],i);const l=m(t,["sourceMetadata"]);return l!=null&&p(e,["sourceMetadata"],YC(l)),e}function QC(t){const e={},n=m(t,["audioChunks"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>ZC(l))),p(e,["audioChunks"],i)}return e}function KC(t){const e={},n=m(t,["text"]);n!=null&&p(e,["text"],n);const i=m(t,["filteredReason"]);return i!=null&&p(e,["filteredReason"],i),e}function WC(t){const e={};m(t,["setupComplete"])!=null&&p(e,["setupComplete"],FC());const i=m(t,["serverContent"]);i!=null&&p(e,["serverContent"],QC(i));const l=m(t,["filteredPrompt"]);return l!=null&&p(e,["filteredPrompt"],KC(l)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function XC(t){const e={},n=m(t,["fps"]);n!=null&&p(e,["fps"],n);const i=m(t,["endOffset"]);i!=null&&p(e,["endOffset"],i);const l=m(t,["startOffset"]);return l!=null&&p(e,["startOffset"],l),e}function e4(t){const e={};if(m(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(t,["data"]);n!=null&&p(e,["data"],n);const i=m(t,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function t4(t){const e={};if(m(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(t,["fileUri"]);n!=null&&p(e,["fileUri"],n);const i=m(t,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function n4(t){const e={},n=m(t,["videoMetadata"]);n!=null&&p(e,["videoMetadata"],XC(n));const i=m(t,["thought"]);i!=null&&p(e,["thought"],i);const l=m(t,["inlineData"]);l!=null&&p(e,["inlineData"],e4(l));const o=m(t,["fileData"]);o!=null&&p(e,["fileData"],t4(o));const u=m(t,["thoughtSignature"]);u!=null&&p(e,["thoughtSignature"],u);const f=m(t,["codeExecutionResult"]);f!=null&&p(e,["codeExecutionResult"],f);const g=m(t,["executableCode"]);g!=null&&p(e,["executableCode"],g);const h=m(t,["functionCall"]);h!=null&&p(e,["functionCall"],h);const x=m(t,["functionResponse"]);x!=null&&p(e,["functionResponse"],x);const v=m(t,["text"]);return v!=null&&p(e,["text"],v),e}function ic(t){const e={},n=m(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(o=>n4(o))),p(e,["parts"],l)}const i=m(t,["role"]);return i!=null&&p(e,["role"],i),e}function i4(t){const e={},n=m(t,["anyOf"]);n!=null&&p(e,["anyOf"],n);const i=m(t,["default"]);i!=null&&p(e,["default"],i);const l=m(t,["description"]);l!=null&&p(e,["description"],l);const o=m(t,["enum"]);o!=null&&p(e,["enum"],o);const u=m(t,["example"]);u!=null&&p(e,["example"],u);const f=m(t,["format"]);f!=null&&p(e,["format"],f);const g=m(t,["items"]);g!=null&&p(e,["items"],g);const h=m(t,["maxItems"]);h!=null&&p(e,["maxItems"],h);const x=m(t,["maxLength"]);x!=null&&p(e,["maxLength"],x);const v=m(t,["maxProperties"]);v!=null&&p(e,["maxProperties"],v);const N=m(t,["maximum"]);N!=null&&p(e,["maximum"],N);const w=m(t,["minItems"]);w!=null&&p(e,["minItems"],w);const C=m(t,["minLength"]);C!=null&&p(e,["minLength"],C);const j=m(t,["minProperties"]);j!=null&&p(e,["minProperties"],j);const k=m(t,["minimum"]);k!=null&&p(e,["minimum"],k);const E=m(t,["nullable"]);E!=null&&p(e,["nullable"],E);const L=m(t,["pattern"]);L!=null&&p(e,["pattern"],L);const D=m(t,["properties"]);D!=null&&p(e,["properties"],D);const O=m(t,["propertyOrdering"]);O!=null&&p(e,["propertyOrdering"],O);const H=m(t,["required"]);H!=null&&p(e,["required"],H);const I=m(t,["title"]);I!=null&&p(e,["title"],I);const R=m(t,["type"]);return R!=null&&p(e,["type"],R),e}function r4(t){const e={};if(m(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=m(t,["category"]);n!=null&&p(e,["category"],n);const i=m(t,["threshold"]);return i!=null&&p(e,["threshold"],i),e}function s4(t){const e={},n=m(t,["behavior"]);n!=null&&p(e,["behavior"],n);const i=m(t,["description"]);i!=null&&p(e,["description"],i);const l=m(t,["name"]);l!=null&&p(e,["name"],l);const o=m(t,["parameters"]);o!=null&&p(e,["parameters"],o);const u=m(t,["parametersJsonSchema"]);u!=null&&p(e,["parametersJsonSchema"],u);const f=m(t,["response"]);f!=null&&p(e,["response"],f);const g=m(t,["responseJsonSchema"]);return g!=null&&p(e,["responseJsonSchema"],g),e}function a4(t){const e={},n=m(t,["startTime"]);n!=null&&p(e,["startTime"],n);const i=m(t,["endTime"]);return i!=null&&p(e,["endTime"],i),e}function l4(t){const e={},n=m(t,["timeRangeFilter"]);return n!=null&&p(e,["timeRangeFilter"],a4(n)),e}function o4(t){const e={},n=m(t,["mode"]);n!=null&&p(e,["mode"],n);const i=m(t,["dynamicThreshold"]);return i!=null&&p(e,["dynamicThreshold"],i),e}function c4(t){const e={},n=m(t,["dynamicRetrievalConfig"]);return n!=null&&p(e,["dynamicRetrievalConfig"],o4(n)),e}function u4(){return{}}function d4(t){const e={},n=m(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(g=>s4(g))),p(e,["functionDeclarations"],f)}if(m(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=m(t,["googleSearch"]);i!=null&&p(e,["googleSearch"],l4(i));const l=m(t,["googleSearchRetrieval"]);if(l!=null&&p(e,["googleSearchRetrieval"],c4(l)),m(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(m(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");m(t,["urlContext"])!=null&&p(e,["urlContext"],u4());const u=m(t,["codeExecution"]);return u!=null&&p(e,["codeExecution"],u),e}function f4(t){const e={},n=m(t,["mode"]);n!=null&&p(e,["mode"],n);const i=m(t,["allowedFunctionNames"]);return i!=null&&p(e,["allowedFunctionNames"],i),e}function m4(t){const e={},n=m(t,["latitude"]);n!=null&&p(e,["latitude"],n);const i=m(t,["longitude"]);return i!=null&&p(e,["longitude"],i),e}function h4(t){const e={},n=m(t,["latLng"]);n!=null&&p(e,["latLng"],m4(n));const i=m(t,["languageCode"]);return i!=null&&p(e,["languageCode"],i),e}function p4(t){const e={},n=m(t,["functionCallingConfig"]);n!=null&&p(e,["functionCallingConfig"],f4(n));const i=m(t,["retrievalConfig"]);return i!=null&&p(e,["retrievalConfig"],h4(i)),e}function g4(t){const e={},n=m(t,["voiceName"]);return n!=null&&p(e,["voiceName"],n),e}function G1(t){const e={},n=m(t,["prebuiltVoiceConfig"]);return n!=null&&p(e,["prebuiltVoiceConfig"],g4(n)),e}function x4(t){const e={},n=m(t,["speaker"]);n!=null&&p(e,["speaker"],n);const i=m(t,["voiceConfig"]);return i!=null&&p(e,["voiceConfig"],G1(i)),e}function y4(t){const e={},n=m(t,["speakerVoiceConfigs"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>x4(l))),p(e,["speakerVoiceConfigs"],i)}return e}function v4(t){const e={},n=m(t,["voiceConfig"]);n!=null&&p(e,["voiceConfig"],G1(n));const i=m(t,["multiSpeakerVoiceConfig"]);i!=null&&p(e,["multiSpeakerVoiceConfig"],y4(i));const l=m(t,["languageCode"]);return l!=null&&p(e,["languageCode"],l),e}function b4(t){const e={},n=m(t,["includeThoughts"]);n!=null&&p(e,["includeThoughts"],n);const i=m(t,["thinkingBudget"]);return i!=null&&p(e,["thinkingBudget"],i),e}function w4(t,e,n){const i={},l=m(e,["systemInstruction"]);n!==void 0&&l!=null&&p(n,["systemInstruction"],ic(Zt(l)));const o=m(e,["temperature"]);o!=null&&p(i,["temperature"],o);const u=m(e,["topP"]);u!=null&&p(i,["topP"],u);const f=m(e,["topK"]);f!=null&&p(i,["topK"],f);const g=m(e,["candidateCount"]);g!=null&&p(i,["candidateCount"],g);const h=m(e,["maxOutputTokens"]);h!=null&&p(i,["maxOutputTokens"],h);const x=m(e,["stopSequences"]);x!=null&&p(i,["stopSequences"],x);const v=m(e,["responseLogprobs"]);v!=null&&p(i,["responseLogprobs"],v);const N=m(e,["logprobs"]);N!=null&&p(i,["logprobs"],N);const w=m(e,["presencePenalty"]);w!=null&&p(i,["presencePenalty"],w);const C=m(e,["frequencyPenalty"]);C!=null&&p(i,["frequencyPenalty"],C);const j=m(e,["seed"]);j!=null&&p(i,["seed"],j);const k=m(e,["responseMimeType"]);k!=null&&p(i,["responseMimeType"],k);const E=m(e,["responseSchema"]);if(E!=null&&p(i,["responseSchema"],i4(Jo(E))),m(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(m(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const L=m(e,["safetySettings"]);if(n!==void 0&&L!=null){let ee=L;Array.isArray(ee)&&(ee=ee.map(G=>r4(G))),p(n,["safetySettings"],ee)}const D=m(e,["tools"]);if(n!==void 0&&D!=null){let ee=il(D);Array.isArray(ee)&&(ee=ee.map(G=>d4(nl(G)))),p(n,["tools"],ee)}const O=m(e,["toolConfig"]);if(n!==void 0&&O!=null&&p(n,["toolConfig"],p4(O)),m(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const H=m(e,["cachedContent"]);n!==void 0&&H!=null&&p(n,["cachedContent"],Ki(t,H));const I=m(e,["responseModalities"]);I!=null&&p(i,["responseModalities"],I);const R=m(e,["mediaResolution"]);R!=null&&p(i,["mediaResolution"],R);const q=m(e,["speechConfig"]);if(q!=null&&p(i,["speechConfig"],v4(L1(q))),m(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const B=m(e,["thinkingConfig"]);return B!=null&&p(i,["thinkingConfig"],b4(B)),i}function Jx(t,e){const n={},i=m(e,["model"]);i!=null&&p(n,["_url","model"],ht(t,i));const l=m(e,["contents"]);if(l!=null){let u=Ln(l);Array.isArray(u)&&(u=u.map(f=>ic(f))),p(n,["contents"],u)}const o=m(e,["config"]);return o!=null&&p(n,["generationConfig"],w4(t,o,n)),n}function N4(t,e){const n={},i=m(t,["taskType"]);e!==void 0&&i!=null&&p(e,["requests[]","taskType"],i);const l=m(t,["title"]);e!==void 0&&l!=null&&p(e,["requests[]","title"],l);const o=m(t,["outputDimensionality"]);if(e!==void 0&&o!=null&&p(e,["requests[]","outputDimensionality"],o),m(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(m(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function S4(t,e){const n={},i=m(e,["model"]);i!=null&&p(n,["_url","model"],ht(t,i));const l=m(e,["contents"]);l!=null&&p(n,["requests[]","content"],D1(t,l));const o=m(e,["config"]);o!=null&&p(n,["config"],N4(o,n));const u=m(e,["model"]);return u!==void 0&&p(n,["requests[]","model"],ht(t,u)),n}function C4(t,e){const n={};if(m(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(m(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=m(t,["numberOfImages"]);e!==void 0&&i!=null&&p(e,["parameters","sampleCount"],i);const l=m(t,["aspectRatio"]);e!==void 0&&l!=null&&p(e,["parameters","aspectRatio"],l);const o=m(t,["guidanceScale"]);if(e!==void 0&&o!=null&&p(e,["parameters","guidanceScale"],o),m(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const u=m(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&p(e,["parameters","safetySetting"],u);const f=m(t,["personGeneration"]);e!==void 0&&f!=null&&p(e,["parameters","personGeneration"],f);const g=m(t,["includeSafetyAttributes"]);e!==void 0&&g!=null&&p(e,["parameters","includeSafetyAttributes"],g);const h=m(t,["includeRaiReason"]);e!==void 0&&h!=null&&p(e,["parameters","includeRaiReason"],h);const x=m(t,["language"]);e!==void 0&&x!=null&&p(e,["parameters","language"],x);const v=m(t,["outputMimeType"]);e!==void 0&&v!=null&&p(e,["parameters","outputOptions","mimeType"],v);const N=m(t,["outputCompressionQuality"]);if(e!==void 0&&N!=null&&p(e,["parameters","outputOptions","compressionQuality"],N),m(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(m(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function T4(t,e){const n={},i=m(e,["model"]);i!=null&&p(n,["_url","model"],ht(t,i));const l=m(e,["prompt"]);l!=null&&p(n,["instances[0]","prompt"],l);const o=m(e,["config"]);return o!=null&&p(n,["config"],C4(o,n)),n}function j4(t,e){const n={},i=m(e,["model"]);i!=null&&p(n,["_url","name"],ht(t,i));const l=m(e,["config"]);return l!=null&&p(n,["config"],l),n}function k4(t,e,n){const i={},l=m(e,["pageSize"]);n!==void 0&&l!=null&&p(n,["_query","pageSize"],l);const o=m(e,["pageToken"]);n!==void 0&&o!=null&&p(n,["_query","pageToken"],o);const u=m(e,["filter"]);n!==void 0&&u!=null&&p(n,["_query","filter"],u);const f=m(e,["queryBase"]);return n!==void 0&&f!=null&&p(n,["_url","models_url"],B1(t,f)),i}function E4(t,e){const n={},i=m(e,["config"]);return i!=null&&p(n,["config"],k4(t,i,n)),n}function A4(t,e){const n={},i=m(t,["displayName"]);e!==void 0&&i!=null&&p(e,["displayName"],i);const l=m(t,["description"]);e!==void 0&&l!=null&&p(e,["description"],l);const o=m(t,["defaultCheckpointId"]);return e!==void 0&&o!=null&&p(e,["defaultCheckpointId"],o),n}function _4(t,e){const n={},i=m(e,["model"]);i!=null&&p(n,["_url","name"],ht(t,i));const l=m(e,["config"]);return l!=null&&p(n,["config"],A4(l,n)),n}function M4(t,e){const n={},i=m(e,["model"]);i!=null&&p(n,["_url","name"],ht(t,i));const l=m(e,["config"]);return l!=null&&p(n,["config"],l),n}function R4(t){const e={};if(m(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(m(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(m(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function I4(t,e){const n={},i=m(e,["model"]);i!=null&&p(n,["_url","model"],ht(t,i));const l=m(e,["contents"]);if(l!=null){let u=Ln(l);Array.isArray(u)&&(u=u.map(f=>ic(f))),p(n,["contents"],u)}const o=m(e,["config"]);return o!=null&&p(n,["config"],R4(o)),n}function D4(t){const e={};if(m(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=m(t,["imageBytes"]);n!=null&&p(e,["bytesBase64Encoded"],bi(n));const i=m(t,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function L4(t,e){const n={},i=m(t,["numberOfVideos"]);if(e!==void 0&&i!=null&&p(e,["parameters","sampleCount"],i),m(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(m(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const l=m(t,["durationSeconds"]);if(e!==void 0&&l!=null&&p(e,["parameters","durationSeconds"],l),m(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=m(t,["aspectRatio"]);if(e!==void 0&&o!=null&&p(e,["parameters","aspectRatio"],o),m(t,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const u=m(t,["personGeneration"]);if(e!==void 0&&u!=null&&p(e,["parameters","personGeneration"],u),m(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const f=m(t,["negativePrompt"]);e!==void 0&&f!=null&&p(e,["parameters","negativePrompt"],f);const g=m(t,["enhancePrompt"]);if(e!==void 0&&g!=null&&p(e,["parameters","enhancePrompt"],g),m(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");if(m(t,["lastFrame"])!==void 0)throw new Error("lastFrame parameter is not supported in Gemini API.");return n}function P4(t,e){const n={},i=m(e,["model"]);i!=null&&p(n,["_url","model"],ht(t,i));const l=m(e,["prompt"]);l!=null&&p(n,["instances[0]","prompt"],l);const o=m(e,["image"]);if(o!=null&&p(n,["instances[0]","image"],D4(o)),m(e,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");const u=m(e,["config"]);return u!=null&&p(n,["config"],L4(u,n)),n}function O4(t){const e={},n=m(t,["fps"]);n!=null&&p(e,["fps"],n);const i=m(t,["endOffset"]);i!=null&&p(e,["endOffset"],i);const l=m(t,["startOffset"]);return l!=null&&p(e,["startOffset"],l),e}function B4(t){const e={},n=m(t,["displayName"]);n!=null&&p(e,["displayName"],n);const i=m(t,["data"]);i!=null&&p(e,["data"],i);const l=m(t,["mimeType"]);return l!=null&&p(e,["mimeType"],l),e}function U4(t){const e={},n=m(t,["displayName"]);n!=null&&p(e,["displayName"],n);const i=m(t,["fileUri"]);i!=null&&p(e,["fileUri"],i);const l=m(t,["mimeType"]);return l!=null&&p(e,["mimeType"],l),e}function z4(t){const e={},n=m(t,["videoMetadata"]);n!=null&&p(e,["videoMetadata"],O4(n));const i=m(t,["thought"]);i!=null&&p(e,["thought"],i);const l=m(t,["inlineData"]);l!=null&&p(e,["inlineData"],B4(l));const o=m(t,["fileData"]);o!=null&&p(e,["fileData"],U4(o));const u=m(t,["thoughtSignature"]);u!=null&&p(e,["thoughtSignature"],u);const f=m(t,["codeExecutionResult"]);f!=null&&p(e,["codeExecutionResult"],f);const g=m(t,["executableCode"]);g!=null&&p(e,["executableCode"],g);const h=m(t,["functionCall"]);h!=null&&p(e,["functionCall"],h);const x=m(t,["functionResponse"]);x!=null&&p(e,["functionResponse"],x);const v=m(t,["text"]);return v!=null&&p(e,["text"],v),e}function Is(t){const e={},n=m(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(o=>z4(o))),p(e,["parts"],l)}const i=m(t,["role"]);return i!=null&&p(e,["role"],i),e}function V4(t){const e={},n=m(t,["anyOf"]);n!=null&&p(e,["anyOf"],n);const i=m(t,["default"]);i!=null&&p(e,["default"],i);const l=m(t,["description"]);l!=null&&p(e,["description"],l);const o=m(t,["enum"]);o!=null&&p(e,["enum"],o);const u=m(t,["example"]);u!=null&&p(e,["example"],u);const f=m(t,["format"]);f!=null&&p(e,["format"],f);const g=m(t,["items"]);g!=null&&p(e,["items"],g);const h=m(t,["maxItems"]);h!=null&&p(e,["maxItems"],h);const x=m(t,["maxLength"]);x!=null&&p(e,["maxLength"],x);const v=m(t,["maxProperties"]);v!=null&&p(e,["maxProperties"],v);const N=m(t,["maximum"]);N!=null&&p(e,["maximum"],N);const w=m(t,["minItems"]);w!=null&&p(e,["minItems"],w);const C=m(t,["minLength"]);C!=null&&p(e,["minLength"],C);const j=m(t,["minProperties"]);j!=null&&p(e,["minProperties"],j);const k=m(t,["minimum"]);k!=null&&p(e,["minimum"],k);const E=m(t,["nullable"]);E!=null&&p(e,["nullable"],E);const L=m(t,["pattern"]);L!=null&&p(e,["pattern"],L);const D=m(t,["properties"]);D!=null&&p(e,["properties"],D);const O=m(t,["propertyOrdering"]);O!=null&&p(e,["propertyOrdering"],O);const H=m(t,["required"]);H!=null&&p(e,["required"],H);const I=m(t,["title"]);I!=null&&p(e,["title"],I);const R=m(t,["type"]);return R!=null&&p(e,["type"],R),e}function $4(t){const e={},n=m(t,["featureSelectionPreference"]);return n!=null&&p(e,["featureSelectionPreference"],n),e}function q4(t){const e={},n=m(t,["method"]);n!=null&&p(e,["method"],n);const i=m(t,["category"]);i!=null&&p(e,["category"],i);const l=m(t,["threshold"]);return l!=null&&p(e,["threshold"],l),e}function F4(t){const e={};if(m(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=m(t,["description"]);n!=null&&p(e,["description"],n);const i=m(t,["name"]);i!=null&&p(e,["name"],i);const l=m(t,["parameters"]);l!=null&&p(e,["parameters"],l);const o=m(t,["parametersJsonSchema"]);o!=null&&p(e,["parametersJsonSchema"],o);const u=m(t,["response"]);u!=null&&p(e,["response"],u);const f=m(t,["responseJsonSchema"]);return f!=null&&p(e,["responseJsonSchema"],f),e}function H4(t){const e={},n=m(t,["startTime"]);n!=null&&p(e,["startTime"],n);const i=m(t,["endTime"]);return i!=null&&p(e,["endTime"],i),e}function G4(t){const e={},n=m(t,["timeRangeFilter"]);return n!=null&&p(e,["timeRangeFilter"],H4(n)),e}function J4(t){const e={},n=m(t,["mode"]);n!=null&&p(e,["mode"],n);const i=m(t,["dynamicThreshold"]);return i!=null&&p(e,["dynamicThreshold"],i),e}function Y4(t){const e={},n=m(t,["dynamicRetrievalConfig"]);return n!=null&&p(e,["dynamicRetrievalConfig"],J4(n)),e}function Z4(){return{}}function Q4(t){const e={},n=m(t,["apiKeyString"]);return n!=null&&p(e,["apiKeyString"],n),e}function K4(t){const e={},n=m(t,["apiKeyConfig"]);n!=null&&p(e,["apiKeyConfig"],Q4(n));const i=m(t,["authType"]);i!=null&&p(e,["authType"],i);const l=m(t,["googleServiceAccountConfig"]);l!=null&&p(e,["googleServiceAccountConfig"],l);const o=m(t,["httpBasicAuthConfig"]);o!=null&&p(e,["httpBasicAuthConfig"],o);const u=m(t,["oauthConfig"]);u!=null&&p(e,["oauthConfig"],u);const f=m(t,["oidcConfig"]);return f!=null&&p(e,["oidcConfig"],f),e}function W4(t){const e={},n=m(t,["authConfig"]);return n!=null&&p(e,["authConfig"],K4(n)),e}function X4(){return{}}function J1(t){const e={},n=m(t,["functionDeclarations"]);if(n!=null){let x=n;Array.isArray(x)&&(x=x.map(v=>F4(v))),p(e,["functionDeclarations"],x)}const i=m(t,["retrieval"]);i!=null&&p(e,["retrieval"],i);const l=m(t,["googleSearch"]);l!=null&&p(e,["googleSearch"],G4(l));const o=m(t,["googleSearchRetrieval"]);o!=null&&p(e,["googleSearchRetrieval"],Y4(o)),m(t,["enterpriseWebSearch"])!=null&&p(e,["enterpriseWebSearch"],Z4());const f=m(t,["googleMaps"]);f!=null&&p(e,["googleMaps"],W4(f)),m(t,["urlContext"])!=null&&p(e,["urlContext"],X4());const h=m(t,["codeExecution"]);return h!=null&&p(e,["codeExecution"],h),e}function eT(t){const e={},n=m(t,["mode"]);n!=null&&p(e,["mode"],n);const i=m(t,["allowedFunctionNames"]);return i!=null&&p(e,["allowedFunctionNames"],i),e}function tT(t){const e={},n=m(t,["latitude"]);n!=null&&p(e,["latitude"],n);const i=m(t,["longitude"]);return i!=null&&p(e,["longitude"],i),e}function nT(t){const e={},n=m(t,["latLng"]);n!=null&&p(e,["latLng"],tT(n));const i=m(t,["languageCode"]);return i!=null&&p(e,["languageCode"],i),e}function iT(t){const e={},n=m(t,["functionCallingConfig"]);n!=null&&p(e,["functionCallingConfig"],eT(n));const i=m(t,["retrievalConfig"]);return i!=null&&p(e,["retrievalConfig"],nT(i)),e}function rT(t){const e={},n=m(t,["voiceName"]);return n!=null&&p(e,["voiceName"],n),e}function sT(t){const e={},n=m(t,["prebuiltVoiceConfig"]);return n!=null&&p(e,["prebuiltVoiceConfig"],rT(n)),e}function aT(t){const e={},n=m(t,["voiceConfig"]);if(n!=null&&p(e,["voiceConfig"],sT(n)),m(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=m(t,["languageCode"]);return i!=null&&p(e,["languageCode"],i),e}function lT(t){const e={},n=m(t,["includeThoughts"]);n!=null&&p(e,["includeThoughts"],n);const i=m(t,["thinkingBudget"]);return i!=null&&p(e,["thinkingBudget"],i),e}function oT(t,e,n){const i={},l=m(e,["systemInstruction"]);n!==void 0&&l!=null&&p(n,["systemInstruction"],Is(Zt(l)));const o=m(e,["temperature"]);o!=null&&p(i,["temperature"],o);const u=m(e,["topP"]);u!=null&&p(i,["topP"],u);const f=m(e,["topK"]);f!=null&&p(i,["topK"],f);const g=m(e,["candidateCount"]);g!=null&&p(i,["candidateCount"],g);const h=m(e,["maxOutputTokens"]);h!=null&&p(i,["maxOutputTokens"],h);const x=m(e,["stopSequences"]);x!=null&&p(i,["stopSequences"],x);const v=m(e,["responseLogprobs"]);v!=null&&p(i,["responseLogprobs"],v);const N=m(e,["logprobs"]);N!=null&&p(i,["logprobs"],N);const w=m(e,["presencePenalty"]);w!=null&&p(i,["presencePenalty"],w);const C=m(e,["frequencyPenalty"]);C!=null&&p(i,["frequencyPenalty"],C);const j=m(e,["seed"]);j!=null&&p(i,["seed"],j);const k=m(e,["responseMimeType"]);k!=null&&p(i,["responseMimeType"],k);const E=m(e,["responseSchema"]);E!=null&&p(i,["responseSchema"],V4(Jo(E)));const L=m(e,["routingConfig"]);L!=null&&p(i,["routingConfig"],L);const D=m(e,["modelSelectionConfig"]);D!=null&&p(i,["modelConfig"],$4(D));const O=m(e,["safetySettings"]);if(n!==void 0&&O!=null){let $=O;Array.isArray($)&&($=$.map(Q=>q4(Q))),p(n,["safetySettings"],$)}const H=m(e,["tools"]);if(n!==void 0&&H!=null){let $=il(H);Array.isArray($)&&($=$.map(Q=>J1(nl(Q)))),p(n,["tools"],$)}const I=m(e,["toolConfig"]);n!==void 0&&I!=null&&p(n,["toolConfig"],iT(I));const R=m(e,["labels"]);n!==void 0&&R!=null&&p(n,["labels"],R);const q=m(e,["cachedContent"]);n!==void 0&&q!=null&&p(n,["cachedContent"],Ki(t,q));const B=m(e,["responseModalities"]);B!=null&&p(i,["responseModalities"],B);const ee=m(e,["mediaResolution"]);ee!=null&&p(i,["mediaResolution"],ee);const G=m(e,["speechConfig"]);G!=null&&p(i,["speechConfig"],aT(L1(G)));const Y=m(e,["audioTimestamp"]);Y!=null&&p(i,["audioTimestamp"],Y);const z=m(e,["thinkingConfig"]);return z!=null&&p(i,["thinkingConfig"],lT(z)),i}function Yx(t,e){const n={},i=m(e,["model"]);i!=null&&p(n,["_url","model"],ht(t,i));const l=m(e,["contents"]);if(l!=null){let u=Ln(l);Array.isArray(u)&&(u=u.map(f=>Is(f))),p(n,["contents"],u)}const o=m(e,["config"]);return o!=null&&p(n,["generationConfig"],oT(t,o,n)),n}function cT(t,e){const n={},i=m(t,["taskType"]);e!==void 0&&i!=null&&p(e,["instances[]","task_type"],i);const l=m(t,["title"]);e!==void 0&&l!=null&&p(e,["instances[]","title"],l);const o=m(t,["outputDimensionality"]);e!==void 0&&o!=null&&p(e,["parameters","outputDimensionality"],o);const u=m(t,["mimeType"]);e!==void 0&&u!=null&&p(e,["instances[]","mimeType"],u);const f=m(t,["autoTruncate"]);return e!==void 0&&f!=null&&p(e,["parameters","autoTruncate"],f),n}function uT(t,e){const n={},i=m(e,["model"]);i!=null&&p(n,["_url","model"],ht(t,i));const l=m(e,["contents"]);l!=null&&p(n,["instances[]","content"],D1(t,l));const o=m(e,["config"]);return o!=null&&p(n,["config"],cT(o,n)),n}function dT(t,e){const n={},i=m(t,["outputGcsUri"]);e!==void 0&&i!=null&&p(e,["parameters","storageUri"],i);const l=m(t,["negativePrompt"]);e!==void 0&&l!=null&&p(e,["parameters","negativePrompt"],l);const o=m(t,["numberOfImages"]);e!==void 0&&o!=null&&p(e,["parameters","sampleCount"],o);const u=m(t,["aspectRatio"]);e!==void 0&&u!=null&&p(e,["parameters","aspectRatio"],u);const f=m(t,["guidanceScale"]);e!==void 0&&f!=null&&p(e,["parameters","guidanceScale"],f);const g=m(t,["seed"]);e!==void 0&&g!=null&&p(e,["parameters","seed"],g);const h=m(t,["safetyFilterLevel"]);e!==void 0&&h!=null&&p(e,["parameters","safetySetting"],h);const x=m(t,["personGeneration"]);e!==void 0&&x!=null&&p(e,["parameters","personGeneration"],x);const v=m(t,["includeSafetyAttributes"]);e!==void 0&&v!=null&&p(e,["parameters","includeSafetyAttributes"],v);const N=m(t,["includeRaiReason"]);e!==void 0&&N!=null&&p(e,["parameters","includeRaiReason"],N);const w=m(t,["language"]);e!==void 0&&w!=null&&p(e,["parameters","language"],w);const C=m(t,["outputMimeType"]);e!==void 0&&C!=null&&p(e,["parameters","outputOptions","mimeType"],C);const j=m(t,["outputCompressionQuality"]);e!==void 0&&j!=null&&p(e,["parameters","outputOptions","compressionQuality"],j);const k=m(t,["addWatermark"]);e!==void 0&&k!=null&&p(e,["parameters","addWatermark"],k);const E=m(t,["enhancePrompt"]);return e!==void 0&&E!=null&&p(e,["parameters","enhancePrompt"],E),n}function fT(t,e){const n={},i=m(e,["model"]);i!=null&&p(n,["_url","model"],ht(t,i));const l=m(e,["prompt"]);l!=null&&p(n,["instances[0]","prompt"],l);const o=m(e,["config"]);return o!=null&&p(n,["config"],dT(o,n)),n}function rc(t){const e={},n=m(t,["gcsUri"]);n!=null&&p(e,["gcsUri"],n);const i=m(t,["imageBytes"]);i!=null&&p(e,["bytesBase64Encoded"],bi(i));const l=m(t,["mimeType"]);return l!=null&&p(e,["mimeType"],l),e}function mT(t){const e={},n=m(t,["maskMode"]);n!=null&&p(e,["maskMode"],n);const i=m(t,["segmentationClasses"]);i!=null&&p(e,["maskClasses"],i);const l=m(t,["maskDilation"]);return l!=null&&p(e,["dilation"],l),e}function hT(t){const e={},n=m(t,["controlType"]);n!=null&&p(e,["controlType"],n);const i=m(t,["enableControlImageComputation"]);return i!=null&&p(e,["computeControl"],i),e}function pT(t){const e={},n=m(t,["styleDescription"]);return n!=null&&p(e,["styleDescription"],n),e}function gT(t){const e={},n=m(t,["subjectType"]);n!=null&&p(e,["subjectType"],n);const i=m(t,["subjectDescription"]);return i!=null&&p(e,["subjectDescription"],i),e}function xT(t){const e={},n=m(t,["referenceImage"]);n!=null&&p(e,["referenceImage"],rc(n));const i=m(t,["referenceId"]);i!=null&&p(e,["referenceId"],i);const l=m(t,["referenceType"]);l!=null&&p(e,["referenceType"],l);const o=m(t,["maskImageConfig"]);o!=null&&p(e,["maskImageConfig"],mT(o));const u=m(t,["controlImageConfig"]);u!=null&&p(e,["controlImageConfig"],hT(u));const f=m(t,["styleImageConfig"]);f!=null&&p(e,["styleImageConfig"],pT(f));const g=m(t,["subjectImageConfig"]);return g!=null&&p(e,["subjectImageConfig"],gT(g)),e}function yT(t,e){const n={},i=m(t,["outputGcsUri"]);e!==void 0&&i!=null&&p(e,["parameters","storageUri"],i);const l=m(t,["negativePrompt"]);e!==void 0&&l!=null&&p(e,["parameters","negativePrompt"],l);const o=m(t,["numberOfImages"]);e!==void 0&&o!=null&&p(e,["parameters","sampleCount"],o);const u=m(t,["aspectRatio"]);e!==void 0&&u!=null&&p(e,["parameters","aspectRatio"],u);const f=m(t,["guidanceScale"]);e!==void 0&&f!=null&&p(e,["parameters","guidanceScale"],f);const g=m(t,["seed"]);e!==void 0&&g!=null&&p(e,["parameters","seed"],g);const h=m(t,["safetyFilterLevel"]);e!==void 0&&h!=null&&p(e,["parameters","safetySetting"],h);const x=m(t,["personGeneration"]);e!==void 0&&x!=null&&p(e,["parameters","personGeneration"],x);const v=m(t,["includeSafetyAttributes"]);e!==void 0&&v!=null&&p(e,["parameters","includeSafetyAttributes"],v);const N=m(t,["includeRaiReason"]);e!==void 0&&N!=null&&p(e,["parameters","includeRaiReason"],N);const w=m(t,["language"]);e!==void 0&&w!=null&&p(e,["parameters","language"],w);const C=m(t,["outputMimeType"]);e!==void 0&&C!=null&&p(e,["parameters","outputOptions","mimeType"],C);const j=m(t,["outputCompressionQuality"]);e!==void 0&&j!=null&&p(e,["parameters","outputOptions","compressionQuality"],j);const k=m(t,["editMode"]);e!==void 0&&k!=null&&p(e,["parameters","editMode"],k);const E=m(t,["baseSteps"]);return e!==void 0&&E!=null&&p(e,["parameters","editConfig","baseSteps"],E),n}function vT(t,e){const n={},i=m(e,["model"]);i!=null&&p(n,["_url","model"],ht(t,i));const l=m(e,["prompt"]);l!=null&&p(n,["instances[0]","prompt"],l);const o=m(e,["referenceImages"]);if(o!=null){let f=o;Array.isArray(f)&&(f=f.map(g=>xT(g))),p(n,["instances[0]","referenceImages"],f)}const u=m(e,["config"]);return u!=null&&p(n,["config"],yT(u,n)),n}function bT(t,e){const n={},i=m(t,["includeRaiReason"]);e!==void 0&&i!=null&&p(e,["parameters","includeRaiReason"],i);const l=m(t,["outputMimeType"]);e!==void 0&&l!=null&&p(e,["parameters","outputOptions","mimeType"],l);const o=m(t,["outputCompressionQuality"]);e!==void 0&&o!=null&&p(e,["parameters","outputOptions","compressionQuality"],o);const u=m(t,["numberOfImages"]);e!==void 0&&u!=null&&p(e,["parameters","sampleCount"],u);const f=m(t,["mode"]);return e!==void 0&&f!=null&&p(e,["parameters","mode"],f),n}function wT(t,e){const n={},i=m(e,["model"]);i!=null&&p(n,["_url","model"],ht(t,i));const l=m(e,["image"]);l!=null&&p(n,["instances[0]","image"],rc(l));const o=m(e,["upscaleFactor"]);o!=null&&p(n,["parameters","upscaleConfig","upscaleFactor"],o);const u=m(e,["config"]);return u!=null&&p(n,["config"],bT(u,n)),n}function NT(t,e){const n={},i=m(e,["model"]);i!=null&&p(n,["_url","name"],ht(t,i));const l=m(e,["config"]);return l!=null&&p(n,["config"],l),n}function ST(t,e,n){const i={},l=m(e,["pageSize"]);n!==void 0&&l!=null&&p(n,["_query","pageSize"],l);const o=m(e,["pageToken"]);n!==void 0&&o!=null&&p(n,["_query","pageToken"],o);const u=m(e,["filter"]);n!==void 0&&u!=null&&p(n,["_query","filter"],u);const f=m(e,["queryBase"]);return n!==void 0&&f!=null&&p(n,["_url","models_url"],B1(t,f)),i}function CT(t,e){const n={},i=m(e,["config"]);return i!=null&&p(n,["config"],ST(t,i,n)),n}function TT(t,e){const n={},i=m(t,["displayName"]);e!==void 0&&i!=null&&p(e,["displayName"],i);const l=m(t,["description"]);e!==void 0&&l!=null&&p(e,["description"],l);const o=m(t,["defaultCheckpointId"]);return e!==void 0&&o!=null&&p(e,["defaultCheckpointId"],o),n}function jT(t,e){const n={},i=m(e,["model"]);i!=null&&p(n,["_url","model"],ht(t,i));const l=m(e,["config"]);return l!=null&&p(n,["config"],TT(l,n)),n}function kT(t,e){const n={},i=m(e,["model"]);i!=null&&p(n,["_url","name"],ht(t,i));const l=m(e,["config"]);return l!=null&&p(n,["config"],l),n}function ET(t,e){const n={},i=m(t,["systemInstruction"]);e!==void 0&&i!=null&&p(e,["systemInstruction"],Is(Zt(i)));const l=m(t,["tools"]);if(e!==void 0&&l!=null){let u=l;Array.isArray(u)&&(u=u.map(f=>J1(f))),p(e,["tools"],u)}const o=m(t,["generationConfig"]);return e!==void 0&&o!=null&&p(e,["generationConfig"],o),n}function AT(t,e){const n={},i=m(e,["model"]);i!=null&&p(n,["_url","model"],ht(t,i));const l=m(e,["contents"]);if(l!=null){let u=Ln(l);Array.isArray(u)&&(u=u.map(f=>Is(f))),p(n,["contents"],u)}const o=m(e,["config"]);return o!=null&&p(n,["config"],ET(o,n)),n}function _T(t,e){const n={},i=m(e,["model"]);i!=null&&p(n,["_url","model"],ht(t,i));const l=m(e,["contents"]);if(l!=null){let u=Ln(l);Array.isArray(u)&&(u=u.map(f=>Is(f))),p(n,["contents"],u)}const o=m(e,["config"]);return o!=null&&p(n,["config"],o),n}function MT(t){const e={},n=m(t,["uri"]);n!=null&&p(e,["gcsUri"],n);const i=m(t,["videoBytes"]);i!=null&&p(e,["bytesBase64Encoded"],bi(i));const l=m(t,["mimeType"]);return l!=null&&p(e,["mimeType"],l),e}function RT(t,e){const n={},i=m(t,["numberOfVideos"]);e!==void 0&&i!=null&&p(e,["parameters","sampleCount"],i);const l=m(t,["outputGcsUri"]);e!==void 0&&l!=null&&p(e,["parameters","storageUri"],l);const o=m(t,["fps"]);e!==void 0&&o!=null&&p(e,["parameters","fps"],o);const u=m(t,["durationSeconds"]);e!==void 0&&u!=null&&p(e,["parameters","durationSeconds"],u);const f=m(t,["seed"]);e!==void 0&&f!=null&&p(e,["parameters","seed"],f);const g=m(t,["aspectRatio"]);e!==void 0&&g!=null&&p(e,["parameters","aspectRatio"],g);const h=m(t,["resolution"]);e!==void 0&&h!=null&&p(e,["parameters","resolution"],h);const x=m(t,["personGeneration"]);e!==void 0&&x!=null&&p(e,["parameters","personGeneration"],x);const v=m(t,["pubsubTopic"]);e!==void 0&&v!=null&&p(e,["parameters","pubsubTopic"],v);const N=m(t,["negativePrompt"]);e!==void 0&&N!=null&&p(e,["parameters","negativePrompt"],N);const w=m(t,["enhancePrompt"]);e!==void 0&&w!=null&&p(e,["parameters","enhancePrompt"],w);const C=m(t,["generateAudio"]);e!==void 0&&C!=null&&p(e,["parameters","generateAudio"],C);const j=m(t,["lastFrame"]);return e!==void 0&&j!=null&&p(e,["instances[0]","lastFrame"],rc(j)),n}function IT(t,e){const n={},i=m(e,["model"]);i!=null&&p(n,["_url","model"],ht(t,i));const l=m(e,["prompt"]);l!=null&&p(n,["instances[0]","prompt"],l);const o=m(e,["image"]);o!=null&&p(n,["instances[0]","image"],rc(o));const u=m(e,["video"]);u!=null&&p(n,["instances[0]","video"],MT(u));const f=m(e,["config"]);return f!=null&&p(n,["config"],RT(f,n)),n}function DT(t){const e={},n=m(t,["fps"]);n!=null&&p(e,["fps"],n);const i=m(t,["endOffset"]);i!=null&&p(e,["endOffset"],i);const l=m(t,["startOffset"]);return l!=null&&p(e,["startOffset"],l),e}function LT(t){const e={},n=m(t,["data"]);n!=null&&p(e,["data"],n);const i=m(t,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function PT(t){const e={},n=m(t,["fileUri"]);n!=null&&p(e,["fileUri"],n);const i=m(t,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function OT(t){const e={},n=m(t,["videoMetadata"]);n!=null&&p(e,["videoMetadata"],DT(n));const i=m(t,["thought"]);i!=null&&p(e,["thought"],i);const l=m(t,["inlineData"]);l!=null&&p(e,["inlineData"],LT(l));const o=m(t,["fileData"]);o!=null&&p(e,["fileData"],PT(o));const u=m(t,["thoughtSignature"]);u!=null&&p(e,["thoughtSignature"],u);const f=m(t,["codeExecutionResult"]);f!=null&&p(e,["codeExecutionResult"],f);const g=m(t,["executableCode"]);g!=null&&p(e,["executableCode"],g);const h=m(t,["functionCall"]);h!=null&&p(e,["functionCall"],h);const x=m(t,["functionResponse"]);x!=null&&p(e,["functionResponse"],x);const v=m(t,["text"]);return v!=null&&p(e,["text"],v),e}function BT(t){const e={},n=m(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(o=>OT(o))),p(e,["parts"],l)}const i=m(t,["role"]);return i!=null&&p(e,["role"],i),e}function UT(t){const e={},n=m(t,["citationSources"]);return n!=null&&p(e,["citations"],n),e}function zT(t){const e={},n=m(t,["retrievedUrl"]);n!=null&&p(e,["retrievedUrl"],n);const i=m(t,["urlRetrievalStatus"]);return i!=null&&p(e,["urlRetrievalStatus"],i),e}function VT(t){const e={},n=m(t,["urlMetadata"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>zT(l))),p(e,["urlMetadata"],i)}return e}function $T(t){const e={},n=m(t,["content"]);n!=null&&p(e,["content"],BT(n));const i=m(t,["citationMetadata"]);i!=null&&p(e,["citationMetadata"],UT(i));const l=m(t,["tokenCount"]);l!=null&&p(e,["tokenCount"],l);const o=m(t,["finishReason"]);o!=null&&p(e,["finishReason"],o);const u=m(t,["urlContextMetadata"]);u!=null&&p(e,["urlContextMetadata"],VT(u));const f=m(t,["avgLogprobs"]);f!=null&&p(e,["avgLogprobs"],f);const g=m(t,["groundingMetadata"]);g!=null&&p(e,["groundingMetadata"],g);const h=m(t,["index"]);h!=null&&p(e,["index"],h);const x=m(t,["logprobsResult"]);x!=null&&p(e,["logprobsResult"],x);const v=m(t,["safetyRatings"]);return v!=null&&p(e,["safetyRatings"],v),e}function Zx(t){const e={},n=m(t,["candidates"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>$T(f))),p(e,["candidates"],u)}const i=m(t,["modelVersion"]);i!=null&&p(e,["modelVersion"],i);const l=m(t,["promptFeedback"]);l!=null&&p(e,["promptFeedback"],l);const o=m(t,["usageMetadata"]);return o!=null&&p(e,["usageMetadata"],o),e}function qT(t){const e={},n=m(t,["values"]);return n!=null&&p(e,["values"],n),e}function FT(){return{}}function HT(t){const e={},n=m(t,["embeddings"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(o=>qT(o))),p(e,["embeddings"],l)}return m(t,["metadata"])!=null&&p(e,["metadata"],FT()),e}function GT(t){const e={},n=m(t,["bytesBase64Encoded"]);n!=null&&p(e,["imageBytes"],bi(n));const i=m(t,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function Y1(t){const e={},n=m(t,["safetyAttributes","categories"]);n!=null&&p(e,["categories"],n);const i=m(t,["safetyAttributes","scores"]);i!=null&&p(e,["scores"],i);const l=m(t,["contentType"]);return l!=null&&p(e,["contentType"],l),e}function JT(t){const e={},n=m(t,["_self"]);n!=null&&p(e,["image"],GT(n));const i=m(t,["raiFilteredReason"]);i!=null&&p(e,["raiFilteredReason"],i);const l=m(t,["_self"]);return l!=null&&p(e,["safetyAttributes"],Y1(l)),e}function YT(t){const e={},n=m(t,["predictions"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(o=>JT(o))),p(e,["generatedImages"],l)}const i=m(t,["positivePromptSafetyAttributes"]);return i!=null&&p(e,["positivePromptSafetyAttributes"],Y1(i)),e}function ZT(t){const e={},n=m(t,["baseModel"]);n!=null&&p(e,["baseModel"],n);const i=m(t,["createTime"]);i!=null&&p(e,["createTime"],i);const l=m(t,["updateTime"]);return l!=null&&p(e,["updateTime"],l),e}function _f(t){const e={},n=m(t,["name"]);n!=null&&p(e,["name"],n);const i=m(t,["displayName"]);i!=null&&p(e,["displayName"],i);const l=m(t,["description"]);l!=null&&p(e,["description"],l);const o=m(t,["version"]);o!=null&&p(e,["version"],o);const u=m(t,["_self"]);u!=null&&p(e,["tunedModelInfo"],ZT(u));const f=m(t,["inputTokenLimit"]);f!=null&&p(e,["inputTokenLimit"],f);const g=m(t,["outputTokenLimit"]);g!=null&&p(e,["outputTokenLimit"],g);const h=m(t,["supportedGenerationMethods"]);return h!=null&&p(e,["supportedActions"],h),e}function QT(t,e){const n={},i=m(e,["nextPageToken"]);i!=null&&p(n,["nextPageToken"],i);const l=m(e,["_self"]);if(l!=null){let o=U1(l);Array.isArray(o)&&(o=o.map(u=>_f(u))),p(n,["models"],o)}return n}function KT(){return{}}function WT(t){const e={},n=m(t,["totalTokens"]);n!=null&&p(e,["totalTokens"],n);const i=m(t,["cachedContentTokenCount"]);return i!=null&&p(e,["cachedContentTokenCount"],i),e}function XT(t){const e={},n=m(t,["video","uri"]);n!=null&&p(e,["uri"],n);const i=m(t,["video","encodedVideo"]);i!=null&&p(e,["videoBytes"],bi(i));const l=m(t,["encoding"]);return l!=null&&p(e,["mimeType"],l),e}function e3(t){const e={},n=m(t,["_self"]);return n!=null&&p(e,["video"],XT(n)),e}function t3(t){const e={},n=m(t,["generatedSamples"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(u=>e3(u))),p(e,["generatedVideos"],o)}const i=m(t,["raiMediaFilteredCount"]);i!=null&&p(e,["raiMediaFilteredCount"],i);const l=m(t,["raiMediaFilteredReasons"]);return l!=null&&p(e,["raiMediaFilteredReasons"],l),e}function n3(t){const e={},n=m(t,["name"]);n!=null&&p(e,["name"],n);const i=m(t,["metadata"]);i!=null&&p(e,["metadata"],i);const l=m(t,["done"]);l!=null&&p(e,["done"],l);const o=m(t,["error"]);o!=null&&p(e,["error"],o);const u=m(t,["response","generateVideoResponse"]);return u!=null&&p(e,["response"],t3(u)),e}function i3(t){const e={},n=m(t,["fps"]);n!=null&&p(e,["fps"],n);const i=m(t,["endOffset"]);i!=null&&p(e,["endOffset"],i);const l=m(t,["startOffset"]);return l!=null&&p(e,["startOffset"],l),e}function r3(t){const e={},n=m(t,["displayName"]);n!=null&&p(e,["displayName"],n);const i=m(t,["data"]);i!=null&&p(e,["data"],i);const l=m(t,["mimeType"]);return l!=null&&p(e,["mimeType"],l),e}function s3(t){const e={},n=m(t,["displayName"]);n!=null&&p(e,["displayName"],n);const i=m(t,["fileUri"]);i!=null&&p(e,["fileUri"],i);const l=m(t,["mimeType"]);return l!=null&&p(e,["mimeType"],l),e}function a3(t){const e={},n=m(t,["videoMetadata"]);n!=null&&p(e,["videoMetadata"],i3(n));const i=m(t,["thought"]);i!=null&&p(e,["thought"],i);const l=m(t,["inlineData"]);l!=null&&p(e,["inlineData"],r3(l));const o=m(t,["fileData"]);o!=null&&p(e,["fileData"],s3(o));const u=m(t,["thoughtSignature"]);u!=null&&p(e,["thoughtSignature"],u);const f=m(t,["codeExecutionResult"]);f!=null&&p(e,["codeExecutionResult"],f);const g=m(t,["executableCode"]);g!=null&&p(e,["executableCode"],g);const h=m(t,["functionCall"]);h!=null&&p(e,["functionCall"],h);const x=m(t,["functionResponse"]);x!=null&&p(e,["functionResponse"],x);const v=m(t,["text"]);return v!=null&&p(e,["text"],v),e}function l3(t){const e={},n=m(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(o=>a3(o))),p(e,["parts"],l)}const i=m(t,["role"]);return i!=null&&p(e,["role"],i),e}function o3(t){const e={},n=m(t,["citations"]);return n!=null&&p(e,["citations"],n),e}function c3(t){const e={},n=m(t,["retrievedUrl"]);n!=null&&p(e,["retrievedUrl"],n);const i=m(t,["urlRetrievalStatus"]);return i!=null&&p(e,["urlRetrievalStatus"],i),e}function u3(t){const e={},n=m(t,["urlMetadata"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>c3(l))),p(e,["urlMetadata"],i)}return e}function d3(t){const e={},n=m(t,["content"]);n!=null&&p(e,["content"],l3(n));const i=m(t,["citationMetadata"]);i!=null&&p(e,["citationMetadata"],o3(i));const l=m(t,["finishMessage"]);l!=null&&p(e,["finishMessage"],l);const o=m(t,["finishReason"]);o!=null&&p(e,["finishReason"],o);const u=m(t,["urlContextMetadata"]);u!=null&&p(e,["urlContextMetadata"],u3(u));const f=m(t,["avgLogprobs"]);f!=null&&p(e,["avgLogprobs"],f);const g=m(t,["groundingMetadata"]);g!=null&&p(e,["groundingMetadata"],g);const h=m(t,["index"]);h!=null&&p(e,["index"],h);const x=m(t,["logprobsResult"]);x!=null&&p(e,["logprobsResult"],x);const v=m(t,["safetyRatings"]);return v!=null&&p(e,["safetyRatings"],v),e}function Qx(t){const e={},n=m(t,["candidates"]);if(n!=null){let g=n;Array.isArray(g)&&(g=g.map(h=>d3(h))),p(e,["candidates"],g)}const i=m(t,["createTime"]);i!=null&&p(e,["createTime"],i);const l=m(t,["responseId"]);l!=null&&p(e,["responseId"],l);const o=m(t,["modelVersion"]);o!=null&&p(e,["modelVersion"],o);const u=m(t,["promptFeedback"]);u!=null&&p(e,["promptFeedback"],u);const f=m(t,["usageMetadata"]);return f!=null&&p(e,["usageMetadata"],f),e}function f3(t){const e={},n=m(t,["truncated"]);n!=null&&p(e,["truncated"],n);const i=m(t,["token_count"]);return i!=null&&p(e,["tokenCount"],i),e}function m3(t){const e={},n=m(t,["values"]);n!=null&&p(e,["values"],n);const i=m(t,["statistics"]);return i!=null&&p(e,["statistics"],f3(i)),e}function h3(t){const e={},n=m(t,["billableCharacterCount"]);return n!=null&&p(e,["billableCharacterCount"],n),e}function p3(t){const e={},n=m(t,["predictions[]","embeddings"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(o=>m3(o))),p(e,["embeddings"],l)}const i=m(t,["metadata"]);return i!=null&&p(e,["metadata"],h3(i)),e}function g3(t){const e={},n=m(t,["gcsUri"]);n!=null&&p(e,["gcsUri"],n);const i=m(t,["bytesBase64Encoded"]);i!=null&&p(e,["imageBytes"],bi(i));const l=m(t,["mimeType"]);return l!=null&&p(e,["mimeType"],l),e}function Z1(t){const e={},n=m(t,["safetyAttributes","categories"]);n!=null&&p(e,["categories"],n);const i=m(t,["safetyAttributes","scores"]);i!=null&&p(e,["scores"],i);const l=m(t,["contentType"]);return l!=null&&p(e,["contentType"],l),e}function em(t){const e={},n=m(t,["_self"]);n!=null&&p(e,["image"],g3(n));const i=m(t,["raiFilteredReason"]);i!=null&&p(e,["raiFilteredReason"],i);const l=m(t,["_self"]);l!=null&&p(e,["safetyAttributes"],Z1(l));const o=m(t,["prompt"]);return o!=null&&p(e,["enhancedPrompt"],o),e}function x3(t){const e={},n=m(t,["predictions"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(o=>em(o))),p(e,["generatedImages"],l)}const i=m(t,["positivePromptSafetyAttributes"]);return i!=null&&p(e,["positivePromptSafetyAttributes"],Z1(i)),e}function y3(t){const e={},n=m(t,["predictions"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>em(l))),p(e,["generatedImages"],i)}return e}function v3(t){const e={},n=m(t,["predictions"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>em(l))),p(e,["generatedImages"],i)}return e}function b3(t){const e={},n=m(t,["endpoint"]);n!=null&&p(e,["name"],n);const i=m(t,["deployedModelId"]);return i!=null&&p(e,["deployedModelId"],i),e}function w3(t){const e={},n=m(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&p(e,["baseModel"],n);const i=m(t,["createTime"]);i!=null&&p(e,["createTime"],i);const l=m(t,["updateTime"]);return l!=null&&p(e,["updateTime"],l),e}function N3(t){const e={},n=m(t,["checkpointId"]);n!=null&&p(e,["checkpointId"],n);const i=m(t,["epoch"]);i!=null&&p(e,["epoch"],i);const l=m(t,["step"]);return l!=null&&p(e,["step"],l),e}function Mf(t){const e={},n=m(t,["name"]);n!=null&&p(e,["name"],n);const i=m(t,["displayName"]);i!=null&&p(e,["displayName"],i);const l=m(t,["description"]);l!=null&&p(e,["description"],l);const o=m(t,["versionId"]);o!=null&&p(e,["version"],o);const u=m(t,["deployedModels"]);if(u!=null){let v=u;Array.isArray(v)&&(v=v.map(N=>b3(N))),p(e,["endpoints"],v)}const f=m(t,["labels"]);f!=null&&p(e,["labels"],f);const g=m(t,["_self"]);g!=null&&p(e,["tunedModelInfo"],w3(g));const h=m(t,["defaultCheckpointId"]);h!=null&&p(e,["defaultCheckpointId"],h);const x=m(t,["checkpoints"]);if(x!=null){let v=x;Array.isArray(v)&&(v=v.map(N=>N3(N))),p(e,["checkpoints"],v)}return e}function S3(t,e){const n={},i=m(e,["nextPageToken"]);i!=null&&p(n,["nextPageToken"],i);const l=m(e,["_self"]);if(l!=null){let o=U1(l);Array.isArray(o)&&(o=o.map(u=>Mf(u))),p(n,["models"],o)}return n}function C3(){return{}}function T3(t){const e={},n=m(t,["totalTokens"]);return n!=null&&p(e,["totalTokens"],n),e}function j3(t){const e={},n=m(t,["tokensInfo"]);return n!=null&&p(e,["tokensInfo"],n),e}function k3(t){const e={},n=m(t,["gcsUri"]);n!=null&&p(e,["uri"],n);const i=m(t,["bytesBase64Encoded"]);i!=null&&p(e,["videoBytes"],bi(i));const l=m(t,["mimeType"]);return l!=null&&p(e,["mimeType"],l),e}function E3(t){const e={},n=m(t,["_self"]);return n!=null&&p(e,["video"],k3(n)),e}function A3(t){const e={},n=m(t,["videos"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(u=>E3(u))),p(e,["generatedVideos"],o)}const i=m(t,["raiMediaFilteredCount"]);i!=null&&p(e,["raiMediaFilteredCount"],i);const l=m(t,["raiMediaFilteredReasons"]);return l!=null&&p(e,["raiMediaFilteredReasons"],l),e}function _3(t){const e={},n=m(t,["name"]);n!=null&&p(e,["name"],n);const i=m(t,["metadata"]);i!=null&&p(e,["metadata"],i);const l=m(t,["done"]);l!=null&&p(e,["done"],l);const o=m(t,["error"]);o!=null&&p(e,["error"],o);const u=m(t,["response"]);return u!=null&&p(e,["response"],A3(u)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const M3="Content-Type",R3="X-Server-Timeout",I3="User-Agent",Rf="x-goog-api-client",D3="1.6.0",L3=`google-genai-sdk/${D3}`,P3="v1beta1",O3="v1beta",Kx=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class B3{constructor(e){var n,i;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const l={};this.clientOptions.vertexai?(l.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:P3,l.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(l.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:O3,l.baseUrl="https://generativelanguage.googleapis.com/"),l.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=l,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(l,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,i){const l=[this.getRequestUrlInternal(n)];return i&&l.push(this.getBaseResourcePath()),e!==""&&l.push(e),new URL(`${l.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),l=this.constructUrl(e.path,n,i);if(e.queryParams)for(const[u,f]of Object.entries(e.queryParams))l.searchParams.append(u,String(f));let o={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=e.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,n,e.abortSignal),this.unaryApiCall(l,o,e.httpMethod)}patchHttpOptions(e,n){const i=JSON.parse(JSON.stringify(e));for(const[l,o]of Object.entries(n))typeof o=="object"?i[l]=Object.assign(Object.assign({},i[l]),o):o!==void 0&&(i[l]=o);return i}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),l=this.constructUrl(e.path,n,i);(!l.searchParams.has("alt")||l.searchParams.get("alt")!=="sse")&&l.searchParams.set("alt","sse");let o={};return o.body=e.body,o=await this.includeExtraHttpOptionsToRequestInit(o,n,e.abortSignal),this.streamApiCall(l,o,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,i){if(n&&n.timeout||i){const l=new AbortController,o=l.signal;n.timeout&&(n==null?void 0:n.timeout)>0&&setTimeout(()=>l.abort(),n.timeout),i&&i.addEventListener("abort",()=>{l.abort()}),e.signal=o}return n&&n.extraBody!==null&&U3(e,n.extraBody),e.headers=await this.getHeadersInternal(n),e}async unaryApiCall(e,n,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:i})).then(async l=>(await Wx(l),new jf(l))).catch(l=>{throw l instanceof Error?l:new Error(JSON.stringify(l))})}async streamApiCall(e,n,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:i})).then(async l=>(await Wx(l),this.processStreamResponse(l))).catch(l=>{throw l instanceof Error?l:new Error(JSON.stringify(l))})}processStreamResponse(e){var n;return ws(this,arguments,function*(){const l=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),o=new TextDecoder("utf-8");if(!l)throw new Error("Response body is empty");try{let u="";for(;;){const{done:f,value:g}=yield pt(l.read());if(f){if(u.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const h=o.decode(g);try{const v=JSON.parse(h);if("error"in v){const N=JSON.parse(JSON.stringify(v.error)),w=N.status,C=N.code,j=`got status: ${w}. ${JSON.stringify(v)}`;if(C>=400&&C<600)throw new nc({message:j,status:C})}}catch(v){if(v.name==="ApiError")throw v}u+=h;let x=u.match(Kx);for(;x;){const v=x[1];try{const N=new Response(v,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield pt(new jf(N)),u=u.slice(x[0].length),x=u.match(Kx)}catch(N){throw new Error(`exception parsing stream chunk ${v}. ${N}`)}}}}finally{l.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const e={},n=L3+" "+this.clientOptions.userAgentExtra;return e[I3]=n,e[Rf]=n,e[M3]="application/json",e}async getHeadersInternal(e){const n=new Headers;if(e&&e.headers){for(const[i,l]of Object.entries(e.headers))n.append(i,l);e.timeout&&e.timeout>0&&n.append(R3,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(e,n){var i;const l={};n!=null&&(l.mimeType=n.mimeType,l.name=n.name,l.displayName=n.displayName),l.name&&!l.name.startsWith("files/")&&(l.name=`files/${l.name}`);const o=this.clientOptions.uploader,u=await o.stat(e);l.sizeBytes=String(u.size);const f=(i=n==null?void 0:n.mimeType)!==null&&i!==void 0?i:u.type;if(f===void 0||f==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");l.mimeType=f;const g=await this.fetchUploadUrl(l,n);return o.upload(e,g,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n){var i;let l={};n!=null&&n.httpOptions?l=n.httpOptions:l={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const o={file:e},u=await this.request({path:Re("upload/v1beta/files",o._url),body:JSON.stringify(o),httpMethod:"POST",httpOptions:l});if(!u||!(u!=null&&u.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const f=(i=u==null?void 0:u.headers)===null||i===void 0?void 0:i["x-goog-upload-url"];if(f===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return f}}async function Wx(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let i;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await t.json():i={error:{message:await t.text(),code:t.status,status:t.statusText}};const l=JSON.stringify(i);throw n>=400&&n<600?new nc({message:l,status:n}):new Error(l)}}function U3(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const o=JSON.parse(t.body);if(typeof o=="object"&&o!==null&&!Array.isArray(o))n=o;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(o,u){const f=Object.assign({},o);for(const g in u)if(Object.prototype.hasOwnProperty.call(u,g)){const h=u[g],x=f[g];h&&typeof h=="object"&&!Array.isArray(h)&&x&&typeof x=="object"&&!Array.isArray(x)?f[g]=i(x,h):(x&&h&&typeof x!=typeof h&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${g}". Original type: ${typeof x}, New type: ${typeof h}. Overwriting.`),f[g]=h)}return f}const l=i(n,e);t.body=JSON.stringify(l)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const z3="mcp_used/unknown";function Q1(t){for(const e of t)if(tm(e)||typeof e=="object"&&"inputSchema"in e)return!0;return!1}function K1(t){var e;const n=(e=t[Rf])!==null&&e!==void 0?e:"";t[Rf]=(n+` ${z3}`).trimStart()}function V3(t){var e,n,i;return(i=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(l=>tm(l)))!==null&&i!==void 0?i:!1}function $3(t){var e,n,i;return(i=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(l=>!tm(l)))!==null&&i!==void 0?i:!1}function tm(t){return t!==null&&typeof t=="object"&&t instanceof nm}function q3(t,e=100){return ws(this,arguments,function*(){let i,l=0;for(;l<e;){const o=yield pt(t.listTools({cursor:i}));for(const u of o.tools)yield yield pt(u),l++;if(!o.nextCursor)break;i=o.nextCursor}})}class nm{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new nm(e,n)}async initialize(){var e,n,i,l;if(this.mcpTools.length>0)return;const o={},u=[];for(const x of this.mcpClients)try{for(var f=!0,g=(n=void 0,Ga(q3(x))),h;h=await g.next(),e=h.done,!e;f=!0){l=h.value,f=!1;const v=l;u.push(v);const N=v.name;if(o[N])throw new Error(`Duplicate function name ${N} found in MCP tools. Please ensure function names are unique.`);o[N]=x}}catch(v){n={error:v}}finally{try{!f&&!e&&(i=g.return)&&await i.call(g)}finally{if(n)throw n.error}}this.mcpTools=u,this.functionNameToMcpClient=o}async tool(){return await this.initialize(),q5(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const l=this.functionNameToMcpClient[i.name];let o;this.config.timeout&&(o={timeout:this.config.timeout});const u=await l.callTool({name:i.name,arguments:i.args},void 0,o);n.push({functionResponse:{name:i.name,response:u.isError?{error:u}:u}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function F3(t,e,n){const i=new _5;let l;n.data instanceof Blob?l=JSON.parse(await n.data.text()):l=JSON.parse(n.data);const o=WC(l);Object.assign(i,o),e(i)}class H3{constructor(e,n,i){this.apiClient=e,this.auth=n,this.webSocketFactory=i}async connect(e){var n,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const l=this.apiClient.getWebsocketBaseUrl(),o=this.apiClient.getApiVersion(),u=Y3(this.apiClient.getDefaultHeaders()),f=this.apiClient.getApiKey(),g=`${l}/ws/google.ai.generativelanguage.${o}.GenerativeService.BidiGenerateMusic?key=${f}`;let h=()=>{};const x=new Promise(D=>{h=D}),v=e.callbacks,N=function(){h({})},w=this.apiClient,C={onopen:N,onmessage:D=>{F3(w,v.onmessage,D)},onerror:(n=v==null?void 0:v.onerror)!==null&&n!==void 0?n:function(D){},onclose:(i=v==null?void 0:v.onclose)!==null&&i!==void 0?i:function(D){}},j=this.webSocketFactory.create(g,J3(u),C);j.connect(),await x;const k=ht(this.apiClient,e.model),E=F1({model:k}),L=Af({setup:E});return j.send(JSON.stringify(L)),new G3(j,this.apiClient)}}class G3{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=fC(e),i=H1(n);this.conn.send(JSON.stringify({clientContent:i}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=mC(e),i=Af(n);this.conn.send(JSON.stringify(i))}sendPlaybackControl(e){const n=Af({playbackControl:e});this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(vs.PLAY)}pause(){this.sendPlaybackControl(vs.PAUSE)}stop(){this.sendPlaybackControl(vs.STOP)}resetContext(){this.sendPlaybackControl(vs.RESET_CONTEXT)}close(){this.conn.close()}}function J3(t){const e={};return t.forEach((n,i)=>{e[i]=n}),e}function Y3(t){const e=new Headers;for(const[n,i]of Object.entries(t))e.append(n,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Z3="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function Q3(t,e,n){const i=new A5;let l;if(n.data instanceof Blob?l=JSON.parse(await n.data.text()):l=JSON.parse(n.data),t.isVertexAI()){const o=qC(l);Object.assign(i,o)}else{const o=$C(l);Object.assign(i,o)}e(i)}class K3{constructor(e,n,i){this.apiClient=e,this.auth=n,this.webSocketFactory=i,this.music=new H3(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,i,l,o,u,f;const g=this.apiClient.getWebsocketBaseUrl(),h=this.apiClient.getApiVersion();let x;const v=this.apiClient.getDefaultHeaders();e.config&&e.config.tools&&Q1(e.config.tools)&&K1(v);const N=t6(v);if(this.apiClient.isVertexAI())x=`${g}/ws/google.cloud.aiplatform.${h}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(N);else{const B=this.apiClient.getApiKey();let ee="BidiGenerateContent",G="key";B!=null&&B.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),ee="BidiGenerateContentConstrained",G="access_token"),x=`${g}/ws/google.ai.generativelanguage.${h}.GenerativeService.${ee}?${G}=${B}`}let w=()=>{};const C=new Promise(B=>{w=B}),j=e.callbacks,k=function(){var B;(B=j==null?void 0:j.onopen)===null||B===void 0||B.call(j),w({})},E=this.apiClient,L={onopen:k,onmessage:B=>{Q3(E,j.onmessage,B)},onerror:(n=j==null?void 0:j.onerror)!==null&&n!==void 0?n:function(B){},onclose:(i=j==null?void 0:j.onclose)!==null&&i!==void 0?i:function(B){}},D=this.webSocketFactory.create(x,e6(N),L);D.connect(),await C;let O=ht(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&O.startsWith("publishers/")){const B=this.apiClient.getProject(),ee=this.apiClient.getLocation();O=`projects/${B}/locations/${ee}/`+O}let H={};this.apiClient.isVertexAI()&&((l=e.config)===null||l===void 0?void 0:l.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Ho.AUDIO]}:e.config.responseModalities=[Ho.AUDIO]),!((o=e.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const I=(f=(u=e.config)===null||u===void 0?void 0:u.tools)!==null&&f!==void 0?f:[],R=[];for(const B of I)if(this.isCallableTool(B)){const ee=B;R.push(await ee.tool())}else R.push(B);R.length>0&&(e.config.tools=R);const q={model:O,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?H=sC(this.apiClient,q):H=rC(this.apiClient,q),delete H.config,D.send(JSON.stringify(H)),new X3(D,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const W3={turnComplete:!0};class X3{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let i=[];try{i=Ln(n.turns),e.isVertexAI()?i=i.map(l=>Is(l)):i=i.map(l=>ic(l))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:i,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let i=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?i=n.functionResponses:i=[n.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const o of i){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!e.isVertexAI()&&!("id"in o))throw new Error(Z3)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},W3),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:dC(e)}:n={realtimeInput:uC(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function e6(t){const e={};return t.forEach((n,i)=>{e[i]=n}),e}function t6(t){const e=new Headers;for(const[n,i]of Object.entries(t))e.append(n,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Xx=10;function ey(t){var e,n,i;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let l=!1;for(const u of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(_o(u)){l=!0;break}if(!l)return!0;const o=(i=t==null?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return o&&(o<0||!Number.isInteger(o))||o==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",o),!0):!1}function _o(t){return"callTool"in t&&typeof t.callTool=="function"}function ty(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class n6 extends Rs{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var i,l,o,u,f;const g=await this.processParamsForMcpUsage(n);if(!V3(n)||ey(n.config))return await this.generateContentInternal(g);if($3(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let h,x;const v=Ln(g.contents),N=(o=(l=(i=g.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||l===void 0?void 0:l.maximumRemoteCalls)!==null&&o!==void 0?o:Xx;let w=0;for(;w<N&&(h=await this.generateContentInternal(g),!(!h.functionCalls||h.functionCalls.length===0));){const C=h.candidates[0].content,j=[];for(const k of(f=(u=n.config)===null||u===void 0?void 0:u.tools)!==null&&f!==void 0?f:[])if(_o(k)){const L=await k.callTool(h.functionCalls);j.push(...L)}w++,x={role:"user",parts:j},g.contents=Ln(g.contents),g.contents.push(C),g.contents.push(x),ty(g.config)&&(v.push(C),v.push(x))}return ty(g.config)&&(h.automaticFunctionCallingHistory=v),h},this.generateContentStream=async n=>{if(ey(n.config)){const i=await this.processParamsForMcpUsage(n);return await this.generateContentStreamInternal(i)}else return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(i=>{var l;let o;const u=[];if(i!=null&&i.generatedImages)for(const g of i.generatedImages)g&&(g!=null&&g.safetyAttributes)&&((l=g==null?void 0:g.safetyAttributes)===null||l===void 0?void 0:l.contentType)==="Positive Prompt"?o=g==null?void 0:g.safetyAttributes:u.push(g);let f;return o?f={generatedImages:u,positivePromptSafetyAttributes:o}:f={generatedImages:u},f}),this.list=async n=>{var i;const u={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!u.config.queryBase){if(!((i=u.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");u.config.filter="labels.tune-type:*"}return new tc(Ms.PAGED_ITEM_MODELS,f=>this.listInternal(f),await this.listInternal(u),u)},this.editImage=async n=>{const i={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(i.referenceImages=n.referenceImages.map(l=>l.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async n=>{let i={numberOfImages:1,mode:"upscale"};n.config&&(i=Object.assign(Object.assign({},i),n.config));const l={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:i};return await this.upscaleImageInternal(l)}}async processParamsForMcpUsage(e){var n,i,l;const o=(n=e.config)===null||n===void 0?void 0:n.tools;if(!o)return e;const u=await Promise.all(o.map(async g=>_o(g)?await g.tool():g)),f={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:u})};if(f.config.tools=u,e.config&&e.config.tools&&Q1(e.config.tools)){const g=(l=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&l!==void 0?l:{};let h=Object.assign({},g);Object.keys(h).length===0&&(h=this.apiClient.getDefaultHeaders()),K1(h),f.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:h})}return f}async initAfcToolsMap(e){var n,i,l;const o=new Map;for(const u of(i=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&i!==void 0?i:[])if(_o(u)){const f=u,g=await f.tool();for(const h of(l=g.functionDeclarations)!==null&&l!==void 0?l:[]){if(!h.name)throw new Error("Function declaration name is required.");if(o.has(h.name))throw new Error(`Duplicate tool declaration name: ${h.name}`);o.set(h.name,f)}}return o}async processAfcStream(e){var n,i,l;const o=(l=(i=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&l!==void 0?l:Xx;let u=!1,f=0;const g=await this.initAfcToolsMap(e);return function(h,x,v){var N,w;return ws(this,arguments,function*(){for(var C,j,k,E;f<o;){u&&(f++,u=!1);const H=yield pt(h.processParamsForMcpUsage(v)),I=yield pt(h.generateContentStreamInternal(H)),R=[],q=[];try{for(var L=!0,D=(j=void 0,Ga(I)),O;O=yield pt(D.next()),C=O.done,!C;L=!0){E=O.value,L=!1;const B=E;if(yield yield pt(B),B.candidates&&(!((N=B.candidates[0])===null||N===void 0)&&N.content)){q.push(B.candidates[0].content);for(const ee of(w=B.candidates[0].content.parts)!==null&&w!==void 0?w:[])if(f<o&&ee.functionCall){if(!ee.functionCall.name)throw new Error("Function call name was not returned by the model.");if(x.has(ee.functionCall.name)){const G=yield pt(x.get(ee.functionCall.name).callTool([ee.functionCall]));R.push(...G)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${x.keys()}, mising tool: ${ee.functionCall.name}`)}}}}catch(B){j={error:B}}finally{try{!L&&!C&&(k=D.return)&&(yield pt(k.call(D)))}finally{if(j)throw j.error}}if(R.length>0){u=!0;const B=new Pa;B.candidates=[{content:{role:"user",parts:R}}],yield yield pt(B);const ee=[];ee.push(...q),ee.push({role:"user",parts:R});const G=Ln(v.contents).concat(ee);v.contents=G}else break}})}(this,g,e)}async generateContentInternal(e){var n,i,l,o;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=Yx(this.apiClient,e);return f=Re("{model}:generateContent",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),u.then(x=>{const v=Qx(x),N=new Pa;return Object.assign(N,v),N})}else{const h=Jx(this.apiClient,e);return f=Re("{model}:generateContent",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(l=e.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(x=>x.json()),u.then(x=>{const v=Zx(x),N=new Pa;return Object.assign(N,v),N})}}async generateContentStreamInternal(e){var n,i,l,o;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=Yx(this.apiClient,e);return f=Re("{model}:streamGenerateContent?alt=sse",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.requestStream({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),u.then(function(v){return ws(this,arguments,function*(){var N,w,C,j;try{for(var k=!0,E=Ga(v),L;L=yield pt(E.next()),N=L.done,!N;k=!0){j=L.value,k=!1;const O=Qx(yield pt(j.json())),H=new Pa;Object.assign(H,O),yield yield pt(H)}}catch(D){w={error:D}}finally{try{!k&&!N&&(C=E.return)&&(yield pt(C.call(E)))}finally{if(w)throw w.error}}})})}else{const h=Jx(this.apiClient,e);return f=Re("{model}:streamGenerateContent?alt=sse",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.requestStream({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(l=e.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}),u.then(function(v){return ws(this,arguments,function*(){var N,w,C,j;try{for(var k=!0,E=Ga(v),L;L=yield pt(E.next()),N=L.done,!N;k=!0){j=L.value,k=!1;const O=Zx(yield pt(j.json())),H=new Pa;Object.assign(H,O),yield yield pt(H)}}catch(D){w={error:D}}finally{try{!k&&!N&&(C=E.return)&&(yield pt(C.call(E)))}finally{if(w)throw w.error}}})})}}async embedContent(e){var n,i,l,o;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=uT(this.apiClient,e);return f=Re("{model}:predict",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),u.then(x=>{const v=p3(x),N=new kx;return Object.assign(N,v),N})}else{const h=S4(this.apiClient,e);return f=Re("{model}:batchEmbedContents",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(l=e.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(x=>x.json()),u.then(x=>{const v=HT(x),N=new kx;return Object.assign(N,v),N})}}async generateImagesInternal(e){var n,i,l,o;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=fT(this.apiClient,e);return f=Re("{model}:predict",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),u.then(x=>{const v=x3(x),N=new Ex;return Object.assign(N,v),N})}else{const h=T4(this.apiClient,e);return f=Re("{model}:predict",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(l=e.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(x=>x.json()),u.then(x=>{const v=YT(x),N=new Ex;return Object.assign(N,v),N})}}async editImageInternal(e){var n,i;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=vT(this.apiClient,e);return o=Re("{model}:predict",f._url),u=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const h=y3(g),x=new S5;return Object.assign(x,h),x})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,i;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=wT(this.apiClient,e);return o=Re("{model}:predict",f._url),u=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const h=v3(g),x=new C5;return Object.assign(x,h),x})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,i,l,o;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=NT(this.apiClient,e);return f=Re("{name}",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),u.then(x=>Mf(x))}else{const h=j4(this.apiClient,e);return f=Re("{name}",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(l=e.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(x=>x.json()),u.then(x=>_f(x))}}async listInternal(e){var n,i,l,o;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=CT(this.apiClient,e);return f=Re("{models_url}",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),u.then(x=>{const v=S3(this.apiClient,x),N=new Ax;return Object.assign(N,v),N})}else{const h=E4(this.apiClient,e);return f=Re("{models_url}",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(l=e.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(x=>x.json()),u.then(x=>{const v=QT(this.apiClient,x),N=new Ax;return Object.assign(N,v),N})}}async update(e){var n,i,l,o;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=jT(this.apiClient,e);return f=Re("{model}",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),u.then(x=>Mf(x))}else{const h=_4(this.apiClient,e);return f=Re("{name}",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(l=e.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(x=>x.json()),u.then(x=>_f(x))}}async delete(e){var n,i,l,o;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=kT(this.apiClient,e);return f=Re("{name}",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),u.then(()=>{const x=C3(),v=new _x;return Object.assign(v,x),v})}else{const h=M4(this.apiClient,e);return f=Re("{name}",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(l=e.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(x=>x.json()),u.then(()=>{const x=KT(),v=new _x;return Object.assign(v,x),v})}}async countTokens(e){var n,i,l,o;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=AT(this.apiClient,e);return f=Re("{model}:countTokens",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),u.then(x=>{const v=T3(x),N=new Mx;return Object.assign(N,v),N})}else{const h=I4(this.apiClient,e);return f=Re("{model}:countTokens",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(l=e.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(x=>x.json()),u.then(x=>{const v=WT(x),N=new Mx;return Object.assign(N,v),N})}}async computeTokens(e){var n,i;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=_T(this.apiClient,e);return o=Re("{model}:computeTokens",f._url),u=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const h=j3(g),x=new T5;return Object.assign(x,h),x})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var n,i,l,o;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=IT(this.apiClient,e);return f=Re("{model}:predictLongRunning",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),u.then(x=>_3(x))}else{const h=P4(this.apiClient,e);return f=Re("{model}:predictLongRunning",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(l=e.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(x=>x.json()),u.then(x=>n3(x))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function i6(t){const e={},n=m(t,["operationName"]);n!=null&&p(e,["_url","operationName"],n);const i=m(t,["config"]);return i!=null&&p(e,["config"],i),e}function r6(t){const e={},n=m(t,["operationName"]);n!=null&&p(e,["_url","operationName"],n);const i=m(t,["config"]);return i!=null&&p(e,["config"],i),e}function s6(t){const e={},n=m(t,["operationName"]);n!=null&&p(e,["operationName"],n);const i=m(t,["resourceName"]);i!=null&&p(e,["_url","resourceName"],i);const l=m(t,["config"]);return l!=null&&p(e,["config"],l),e}function a6(t){const e={},n=m(t,["video","uri"]);n!=null&&p(e,["uri"],n);const i=m(t,["video","encodedVideo"]);i!=null&&p(e,["videoBytes"],bi(i));const l=m(t,["encoding"]);return l!=null&&p(e,["mimeType"],l),e}function l6(t){const e={},n=m(t,["_self"]);return n!=null&&p(e,["video"],a6(n)),e}function o6(t){const e={},n=m(t,["generatedSamples"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(u=>l6(u))),p(e,["generatedVideos"],o)}const i=m(t,["raiMediaFilteredCount"]);i!=null&&p(e,["raiMediaFilteredCount"],i);const l=m(t,["raiMediaFilteredReasons"]);return l!=null&&p(e,["raiMediaFilteredReasons"],l),e}function c6(t){const e={},n=m(t,["name"]);n!=null&&p(e,["name"],n);const i=m(t,["metadata"]);i!=null&&p(e,["metadata"],i);const l=m(t,["done"]);l!=null&&p(e,["done"],l);const o=m(t,["error"]);o!=null&&p(e,["error"],o);const u=m(t,["response","generateVideoResponse"]);return u!=null&&p(e,["response"],o6(u)),e}function u6(t){const e={},n=m(t,["gcsUri"]);n!=null&&p(e,["uri"],n);const i=m(t,["bytesBase64Encoded"]);i!=null&&p(e,["videoBytes"],bi(i));const l=m(t,["mimeType"]);return l!=null&&p(e,["mimeType"],l),e}function d6(t){const e={},n=m(t,["_self"]);return n!=null&&p(e,["video"],u6(n)),e}function f6(t){const e={},n=m(t,["videos"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(u=>d6(u))),p(e,["generatedVideos"],o)}const i=m(t,["raiMediaFilteredCount"]);i!=null&&p(e,["raiMediaFilteredCount"],i);const l=m(t,["raiMediaFilteredReasons"]);return l!=null&&p(e,["raiMediaFilteredReasons"],l),e}function ny(t){const e={},n=m(t,["name"]);n!=null&&p(e,["name"],n);const i=m(t,["metadata"]);i!=null&&p(e,["metadata"],i);const l=m(t,["done"]);l!=null&&p(e,["done"],l);const o=m(t,["error"]);o!=null&&p(e,["error"],o);const u=m(t,["response"]);return u!=null&&p(e,["response"],f6(u)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class m6 extends Rs{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,i=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const l=n.name.split("/operations/")[0];let o;return i&&"httpOptions"in i&&(o=i.httpOptions),this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:l,config:{httpOptions:o}})}else return this.getVideosOperationInternal({operationName:n.name,config:i})}async getVideosOperationInternal(e){var n,i,l,o;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=r6(e);return f=Re("{operationName}",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),u.then(x=>ny(x))}else{const h=i6(e);return f=Re("{operationName}",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(l=e.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(x=>x.json()),u.then(x=>c6(x))}}async fetchPredictVideosOperationInternal(e){var n,i;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=s6(e);return o=Re("{resourceName}:fetchPredictOperation",f._url),u=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>ny(g))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function h6(t){const e={},n=m(t,["voiceName"]);return n!=null&&p(e,["voiceName"],n),e}function W1(t){const e={},n=m(t,["prebuiltVoiceConfig"]);return n!=null&&p(e,["prebuiltVoiceConfig"],h6(n)),e}function p6(t){const e={},n=m(t,["speaker"]);n!=null&&p(e,["speaker"],n);const i=m(t,["voiceConfig"]);return i!=null&&p(e,["voiceConfig"],W1(i)),e}function g6(t){const e={},n=m(t,["speakerVoiceConfigs"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>p6(l))),p(e,["speakerVoiceConfigs"],i)}return e}function x6(t){const e={},n=m(t,["voiceConfig"]);n!=null&&p(e,["voiceConfig"],W1(n));const i=m(t,["multiSpeakerVoiceConfig"]);i!=null&&p(e,["multiSpeakerVoiceConfig"],g6(i));const l=m(t,["languageCode"]);return l!=null&&p(e,["languageCode"],l),e}function y6(t){const e={},n=m(t,["fps"]);n!=null&&p(e,["fps"],n);const i=m(t,["endOffset"]);i!=null&&p(e,["endOffset"],i);const l=m(t,["startOffset"]);return l!=null&&p(e,["startOffset"],l),e}function v6(t){const e={};if(m(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(t,["data"]);n!=null&&p(e,["data"],n);const i=m(t,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function b6(t){const e={};if(m(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(t,["fileUri"]);n!=null&&p(e,["fileUri"],n);const i=m(t,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function w6(t){const e={},n=m(t,["videoMetadata"]);n!=null&&p(e,["videoMetadata"],y6(n));const i=m(t,["thought"]);i!=null&&p(e,["thought"],i);const l=m(t,["inlineData"]);l!=null&&p(e,["inlineData"],v6(l));const o=m(t,["fileData"]);o!=null&&p(e,["fileData"],b6(o));const u=m(t,["thoughtSignature"]);u!=null&&p(e,["thoughtSignature"],u);const f=m(t,["codeExecutionResult"]);f!=null&&p(e,["codeExecutionResult"],f);const g=m(t,["executableCode"]);g!=null&&p(e,["executableCode"],g);const h=m(t,["functionCall"]);h!=null&&p(e,["functionCall"],h);const x=m(t,["functionResponse"]);x!=null&&p(e,["functionResponse"],x);const v=m(t,["text"]);return v!=null&&p(e,["text"],v),e}function N6(t){const e={},n=m(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(o=>w6(o))),p(e,["parts"],l)}const i=m(t,["role"]);return i!=null&&p(e,["role"],i),e}function S6(t){const e={},n=m(t,["behavior"]);n!=null&&p(e,["behavior"],n);const i=m(t,["description"]);i!=null&&p(e,["description"],i);const l=m(t,["name"]);l!=null&&p(e,["name"],l);const o=m(t,["parameters"]);o!=null&&p(e,["parameters"],o);const u=m(t,["parametersJsonSchema"]);u!=null&&p(e,["parametersJsonSchema"],u);const f=m(t,["response"]);f!=null&&p(e,["response"],f);const g=m(t,["responseJsonSchema"]);return g!=null&&p(e,["responseJsonSchema"],g),e}function C6(t){const e={},n=m(t,["startTime"]);n!=null&&p(e,["startTime"],n);const i=m(t,["endTime"]);return i!=null&&p(e,["endTime"],i),e}function T6(t){const e={},n=m(t,["timeRangeFilter"]);return n!=null&&p(e,["timeRangeFilter"],C6(n)),e}function j6(t){const e={},n=m(t,["mode"]);n!=null&&p(e,["mode"],n);const i=m(t,["dynamicThreshold"]);return i!=null&&p(e,["dynamicThreshold"],i),e}function k6(t){const e={},n=m(t,["dynamicRetrievalConfig"]);return n!=null&&p(e,["dynamicRetrievalConfig"],j6(n)),e}function E6(){return{}}function A6(t){const e={},n=m(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(g=>S6(g))),p(e,["functionDeclarations"],f)}if(m(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=m(t,["googleSearch"]);i!=null&&p(e,["googleSearch"],T6(i));const l=m(t,["googleSearchRetrieval"]);if(l!=null&&p(e,["googleSearchRetrieval"],k6(l)),m(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(m(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");m(t,["urlContext"])!=null&&p(e,["urlContext"],E6());const u=m(t,["codeExecution"]);return u!=null&&p(e,["codeExecution"],u),e}function _6(t){const e={},n=m(t,["handle"]);if(n!=null&&p(e,["handle"],n),m(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function iy(){return{}}function M6(t){const e={},n=m(t,["disabled"]);n!=null&&p(e,["disabled"],n);const i=m(t,["startOfSpeechSensitivity"]);i!=null&&p(e,["startOfSpeechSensitivity"],i);const l=m(t,["endOfSpeechSensitivity"]);l!=null&&p(e,["endOfSpeechSensitivity"],l);const o=m(t,["prefixPaddingMs"]);o!=null&&p(e,["prefixPaddingMs"],o);const u=m(t,["silenceDurationMs"]);return u!=null&&p(e,["silenceDurationMs"],u),e}function R6(t){const e={},n=m(t,["automaticActivityDetection"]);n!=null&&p(e,["automaticActivityDetection"],M6(n));const i=m(t,["activityHandling"]);i!=null&&p(e,["activityHandling"],i);const l=m(t,["turnCoverage"]);return l!=null&&p(e,["turnCoverage"],l),e}function I6(t){const e={},n=m(t,["targetTokens"]);return n!=null&&p(e,["targetTokens"],n),e}function D6(t){const e={},n=m(t,["triggerTokens"]);n!=null&&p(e,["triggerTokens"],n);const i=m(t,["slidingWindow"]);return i!=null&&p(e,["slidingWindow"],I6(i)),e}function L6(t){const e={},n=m(t,["proactiveAudio"]);return n!=null&&p(e,["proactiveAudio"],n),e}function P6(t,e){const n={},i=m(t,["generationConfig"]);e!==void 0&&i!=null&&p(e,["setup","generationConfig"],i);const l=m(t,["responseModalities"]);e!==void 0&&l!=null&&p(e,["setup","generationConfig","responseModalities"],l);const o=m(t,["temperature"]);e!==void 0&&o!=null&&p(e,["setup","generationConfig","temperature"],o);const u=m(t,["topP"]);e!==void 0&&u!=null&&p(e,["setup","generationConfig","topP"],u);const f=m(t,["topK"]);e!==void 0&&f!=null&&p(e,["setup","generationConfig","topK"],f);const g=m(t,["maxOutputTokens"]);e!==void 0&&g!=null&&p(e,["setup","generationConfig","maxOutputTokens"],g);const h=m(t,["mediaResolution"]);e!==void 0&&h!=null&&p(e,["setup","generationConfig","mediaResolution"],h);const x=m(t,["seed"]);e!==void 0&&x!=null&&p(e,["setup","generationConfig","seed"],x);const v=m(t,["speechConfig"]);e!==void 0&&v!=null&&p(e,["setup","generationConfig","speechConfig"],x6(Xf(v)));const N=m(t,["enableAffectiveDialog"]);e!==void 0&&N!=null&&p(e,["setup","generationConfig","enableAffectiveDialog"],N);const w=m(t,["systemInstruction"]);e!==void 0&&w!=null&&p(e,["setup","systemInstruction"],N6(Zt(w)));const C=m(t,["tools"]);if(e!==void 0&&C!=null){let H=il(C);Array.isArray(H)&&(H=H.map(I=>A6(nl(I)))),p(e,["setup","tools"],H)}const j=m(t,["sessionResumption"]);e!==void 0&&j!=null&&p(e,["setup","sessionResumption"],_6(j));const k=m(t,["inputAudioTranscription"]);e!==void 0&&k!=null&&p(e,["setup","inputAudioTranscription"],iy());const E=m(t,["outputAudioTranscription"]);e!==void 0&&E!=null&&p(e,["setup","outputAudioTranscription"],iy());const L=m(t,["realtimeInputConfig"]);e!==void 0&&L!=null&&p(e,["setup","realtimeInputConfig"],R6(L));const D=m(t,["contextWindowCompression"]);e!==void 0&&D!=null&&p(e,["setup","contextWindowCompression"],D6(D));const O=m(t,["proactivity"]);return e!==void 0&&O!=null&&p(e,["setup","proactivity"],L6(O)),n}function O6(t,e){const n={},i=m(e,["model"]);i!=null&&p(n,["setup","model"],ht(t,i));const l=m(e,["config"]);return l!=null&&p(n,["config"],P6(l,n)),n}function B6(t,e,n){const i={},l=m(e,["expireTime"]);n!==void 0&&l!=null&&p(n,["expireTime"],l);const o=m(e,["newSessionExpireTime"]);n!==void 0&&o!=null&&p(n,["newSessionExpireTime"],o);const u=m(e,["uses"]);n!==void 0&&u!=null&&p(n,["uses"],u);const f=m(e,["liveConnectConstraints"]);n!==void 0&&f!=null&&p(n,["bidiGenerateContentSetup"],O6(t,f));const g=m(e,["lockAdditionalFields"]);return n!==void 0&&g!=null&&p(n,["fieldMask"],g),i}function U6(t,e){const n={},i=m(e,["config"]);return i!=null&&p(n,["config"],B6(t,i,n)),n}function z6(t){const e={},n=m(t,["name"]);return n!=null&&p(e,["name"],n),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function V6(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const i=t[n];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const l=Object.keys(i).map(o=>`${n}.${o}`);e.push(...l)}else e.push(n)}return e.join(",")}function $6(t,e){let n=null;const i=t.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const o=i.setup;typeof o=="object"&&o!==null?(t.bidiGenerateContentSetup=o,n=o):delete t.bidiGenerateContentSetup}else i!==void 0&&delete t.bidiGenerateContentSetup;const l=t.fieldMask;if(n){const o=V6(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)o?t.fieldMask=o:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&l!==null&&Array.isArray(l)&&l.length>0){const u=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let f=[];l.length>0&&(f=l.map(h=>u.includes(h)?`generationConfig.${h}`:h));const g=[];o&&g.push(o),f.length>0&&g.push(...f),g.length>0?t.fieldMask=g.join(","):delete t.fieldMask}else delete t.fieldMask}else l!==null&&Array.isArray(l)&&l.length>0?t.fieldMask=l.join(","):delete t.fieldMask;return t}class q6 extends Rs{constructor(e){super(),this.apiClient=e}async create(e){var n,i;let l,o="",u={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const f=U6(this.apiClient,e);o=Re("auth_tokens",f._url),u=f._query,delete f.config,delete f._url,delete f._query;const g=$6(f,e.config);return l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),l.then(h=>z6(h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function F6(t){const e={},n=m(t,["name"]);n!=null&&p(e,["_url","name"],n);const i=m(t,["config"]);return i!=null&&p(e,["config"],i),e}function H6(t,e){const n={},i=m(t,["pageSize"]);e!==void 0&&i!=null&&p(e,["_query","pageSize"],i);const l=m(t,["pageToken"]);e!==void 0&&l!=null&&p(e,["_query","pageToken"],l);const o=m(t,["filter"]);return e!==void 0&&o!=null&&p(e,["_query","filter"],o),n}function G6(t){const e={},n=m(t,["config"]);return n!=null&&p(e,["config"],H6(n,e)),e}function J6(t){const e={},n=m(t,["textInput"]);n!=null&&p(e,["textInput"],n);const i=m(t,["output"]);return i!=null&&p(e,["output"],i),e}function Y6(t){const e={};if(m(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=m(t,["examples"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>J6(l))),p(e,["examples","examples"],i)}return e}function Z6(t,e){const n={};if(m(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=m(t,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&p(e,["displayName"],i),m(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const l=m(t,["epochCount"]);e!==void 0&&l!=null&&p(e,["tuningTask","hyperparameters","epochCount"],l);const o=m(t,["learningRateMultiplier"]);if(o!=null&&p(n,["tuningTask","hyperparameters","learningRateMultiplier"],o),m(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(m(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const u=m(t,["batchSize"]);e!==void 0&&u!=null&&p(e,["tuningTask","hyperparameters","batchSize"],u);const f=m(t,["learningRate"]);return e!==void 0&&f!=null&&p(e,["tuningTask","hyperparameters","learningRate"],f),n}function Q6(t){const e={},n=m(t,["baseModel"]);n!=null&&p(e,["baseModel"],n);const i=m(t,["trainingDataset"]);i!=null&&p(e,["tuningTask","trainingData"],Y6(i));const l=m(t,["config"]);return l!=null&&p(e,["config"],Z6(l,e)),e}function K6(t){const e={},n=m(t,["name"]);n!=null&&p(e,["_url","name"],n);const i=m(t,["config"]);return i!=null&&p(e,["config"],i),e}function W6(t,e){const n={},i=m(t,["pageSize"]);e!==void 0&&i!=null&&p(e,["_query","pageSize"],i);const l=m(t,["pageToken"]);e!==void 0&&l!=null&&p(e,["_query","pageToken"],l);const o=m(t,["filter"]);return e!==void 0&&o!=null&&p(e,["_query","filter"],o),n}function X6(t){const e={},n=m(t,["config"]);return n!=null&&p(e,["config"],W6(n,e)),e}function ej(t,e){const n={},i=m(t,["gcsUri"]);if(e!==void 0&&i!=null&&p(e,["supervisedTuningSpec","trainingDatasetUri"],i),m(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function tj(t){const e={},n=m(t,["gcsUri"]);return n!=null&&p(e,["validationDatasetUri"],n),e}function nj(t,e){const n={},i=m(t,["validationDataset"]);e!==void 0&&i!=null&&p(e,["supervisedTuningSpec"],tj(i));const l=m(t,["tunedModelDisplayName"]);e!==void 0&&l!=null&&p(e,["tunedModelDisplayName"],l);const o=m(t,["description"]);e!==void 0&&o!=null&&p(e,["description"],o);const u=m(t,["epochCount"]);e!==void 0&&u!=null&&p(e,["supervisedTuningSpec","hyperParameters","epochCount"],u);const f=m(t,["learningRateMultiplier"]);e!==void 0&&f!=null&&p(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],f);const g=m(t,["exportLastCheckpointOnly"]);e!==void 0&&g!=null&&p(e,["supervisedTuningSpec","exportLastCheckpointOnly"],g);const h=m(t,["adapterSize"]);if(e!==void 0&&h!=null&&p(e,["supervisedTuningSpec","hyperParameters","adapterSize"],h),m(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(m(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return n}function ij(t){const e={},n=m(t,["baseModel"]);n!=null&&p(e,["baseModel"],n);const i=m(t,["trainingDataset"]);i!=null&&p(e,["supervisedTuningSpec","trainingDatasetUri"],ej(i,e));const l=m(t,["config"]);return l!=null&&p(e,["config"],nj(l,e)),e}function rj(t){const e={},n=m(t,["name"]);n!=null&&p(e,["model"],n);const i=m(t,["name"]);return i!=null&&p(e,["endpoint"],i),e}function X1(t){const e={},n=m(t,["name"]);n!=null&&p(e,["name"],n);const i=m(t,["state"]);i!=null&&p(e,["state"],P1(i));const l=m(t,["createTime"]);l!=null&&p(e,["createTime"],l);const o=m(t,["tuningTask","startTime"]);o!=null&&p(e,["startTime"],o);const u=m(t,["tuningTask","completeTime"]);u!=null&&p(e,["endTime"],u);const f=m(t,["updateTime"]);f!=null&&p(e,["updateTime"],f);const g=m(t,["description"]);g!=null&&p(e,["description"],g);const h=m(t,["baseModel"]);h!=null&&p(e,["baseModel"],h);const x=m(t,["_self"]);x!=null&&p(e,["tunedModel"],rj(x));const v=m(t,["distillationSpec"]);v!=null&&p(e,["distillationSpec"],v);const N=m(t,["experiment"]);N!=null&&p(e,["experiment"],N);const w=m(t,["labels"]);w!=null&&p(e,["labels"],w);const C=m(t,["pipelineJob"]);C!=null&&p(e,["pipelineJob"],C);const j=m(t,["serviceAccount"]);j!=null&&p(e,["serviceAccount"],j);const k=m(t,["tunedModelDisplayName"]);return k!=null&&p(e,["tunedModelDisplayName"],k),e}function sj(t){const e={},n=m(t,["nextPageToken"]);n!=null&&p(e,["nextPageToken"],n);const i=m(t,["tunedModels"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(o=>X1(o))),p(e,["tuningJobs"],l)}return e}function aj(t){const e={},n=m(t,["name"]);n!=null&&p(e,["name"],n);const i=m(t,["metadata"]);i!=null&&p(e,["metadata"],i);const l=m(t,["done"]);l!=null&&p(e,["done"],l);const o=m(t,["error"]);return o!=null&&p(e,["error"],o),e}function lj(t){const e={},n=m(t,["checkpointId"]);n!=null&&p(e,["checkpointId"],n);const i=m(t,["epoch"]);i!=null&&p(e,["epoch"],i);const l=m(t,["step"]);l!=null&&p(e,["step"],l);const o=m(t,["endpoint"]);return o!=null&&p(e,["endpoint"],o),e}function oj(t){const e={},n=m(t,["model"]);n!=null&&p(e,["model"],n);const i=m(t,["endpoint"]);i!=null&&p(e,["endpoint"],i);const l=m(t,["checkpoints"]);if(l!=null){let o=l;Array.isArray(o)&&(o=o.map(u=>lj(u))),p(e,["checkpoints"],o)}return e}function If(t){const e={},n=m(t,["name"]);n!=null&&p(e,["name"],n);const i=m(t,["state"]);i!=null&&p(e,["state"],P1(i));const l=m(t,["createTime"]);l!=null&&p(e,["createTime"],l);const o=m(t,["startTime"]);o!=null&&p(e,["startTime"],o);const u=m(t,["endTime"]);u!=null&&p(e,["endTime"],u);const f=m(t,["updateTime"]);f!=null&&p(e,["updateTime"],f);const g=m(t,["error"]);g!=null&&p(e,["error"],g);const h=m(t,["description"]);h!=null&&p(e,["description"],h);const x=m(t,["baseModel"]);x!=null&&p(e,["baseModel"],x);const v=m(t,["tunedModel"]);v!=null&&p(e,["tunedModel"],oj(v));const N=m(t,["supervisedTuningSpec"]);N!=null&&p(e,["supervisedTuningSpec"],N);const w=m(t,["tuningDataStats"]);w!=null&&p(e,["tuningDataStats"],w);const C=m(t,["encryptionSpec"]);C!=null&&p(e,["encryptionSpec"],C);const j=m(t,["partnerModelTuningSpec"]);j!=null&&p(e,["partnerModelTuningSpec"],j);const k=m(t,["distillationSpec"]);k!=null&&p(e,["distillationSpec"],k);const E=m(t,["experiment"]);E!=null&&p(e,["experiment"],E);const L=m(t,["labels"]);L!=null&&p(e,["labels"],L);const D=m(t,["pipelineJob"]);D!=null&&p(e,["pipelineJob"],D);const O=m(t,["serviceAccount"]);O!=null&&p(e,["serviceAccount"],O);const H=m(t,["tunedModelDisplayName"]);return H!=null&&p(e,["tunedModelDisplayName"],H),e}function cj(t){const e={},n=m(t,["nextPageToken"]);n!=null&&p(e,["nextPageToken"],n);const i=m(t,["tuningJobs"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(o=>If(o))),p(e,["tuningJobs"],l)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class uj extends Rs{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new tc(Ms.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(n),n),this.tune=async n=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(n);{const i=await this.tuneMldevInternal(n);let l="";return i.metadata!==void 0&&i.metadata.tunedModel!==void 0?l=i.metadata.tunedModel:i.name!==void 0&&i.name.includes("/operations/")&&(l=i.name.split("/operations/")[0]),{name:l,state:Tf.JOB_STATE_QUEUED}}}}async getInternal(e){var n,i,l,o;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=K6(e);return f=Re("{name}",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),u.then(x=>If(x))}else{const h=F6(e);return f=Re("{name}",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(l=e.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(x=>x.json()),u.then(x=>X1(x))}}async listInternal(e){var n,i,l,o;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=X6(e);return f=Re("tuningJobs",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),u.then(x=>{const v=cj(x),N=new Rx;return Object.assign(N,v),N})}else{const h=G6(e);return f=Re("tunedModels",h._url),g=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(l=e.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(x=>x.json()),u.then(x=>{const v=sj(x),N=new Rx;return Object.assign(N,v),N})}}async tuneInternal(e){var n,i;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=ij(e);return o=Re("tuningJobs",f._url),u=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>If(g))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,i;let l,o="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=Q6(e);return o=Re("tunedModels",f._url),u=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>aj(g))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class dj{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const fj=1024*1024*8,mj=3,hj=1e3,pj=2,_d="x-goog-upload-status";async function gj(t,e,n){var i,l,o;let u=0,f=0,g=new jf(new Response),h="upload";for(u=t.size;f<u;){const v=Math.min(fj,u-f),N=t.slice(f,f+v);f+v>=u&&(h+=", finalize");let w=0,C=hj;for(;w<mj&&(g=await n.request({path:"",body:N,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":h,"X-Goog-Upload-Offset":String(f),"Content-Length":String(v)}}}),!(!((i=g==null?void 0:g.headers)===null||i===void 0)&&i[_d]));)w++,await yj(C),C=C*pj;if(f+=v,((l=g==null?void 0:g.headers)===null||l===void 0?void 0:l[_d])!=="active")break;if(u<=f)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const x=await(g==null?void 0:g.json());if(((o=g==null?void 0:g.headers)===null||o===void 0?void 0:o[_d])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return x.file}async function xj(t){return{size:t.size,type:t.type}}function yj(t){return new Promise(e=>setTimeout(e,t))}class vj{async upload(e,n,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await gj(e,n,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await xj(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class bj{create(e,n,i){return new wj(e,n,i)}}class wj{constructor(e,n,i){this.url=e,this.headers=n,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ry="x-goog-api-key";class Nj{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(ry)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(ry,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Sj="gl-node/";class ev{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const i=N5(e,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion;const l=new Nj(this.apiKey);this.apiClient=new B3({auth:l,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:Sj+"web",uploader:new vj,downloader:new dj}),this.models=new n6(this.apiClient),this.live=new K3(this.apiClient,l,new bj),this.chats=new ZN(this.models,this.apiClient),this.caches=new GN(this.apiClient),this.files=new oS(this.apiClient),this.operations=new m6(this.apiClient),this.authTokens=new q6(this.apiClient),this.tunings=new uj(this.apiClient)}}var Mt=(t=>(t.Easy="easy",t.Normal="normal",t.Hard="hard",t))(Mt||{});const tv={easy:{trueFalse:5,multipleChoice:5,fillInTheBlanks:5,sentenceScramble:5,memoryCardGame:1},normal:{trueFalse:5,multipleChoice:5,fillInTheBlanks:5,sentenceScramble:5,memoryCardGame:1},hard:{trueFalse:5,multipleChoice:5,fillInTheBlanks:5,sentenceScramble:5,memoryCardGame:1}},yr={trueFalse:10,multipleChoice:10,fillInTheBlanks:10,sentenceScramble:10,memoryCardGame:2},rt=async(t,e)=>{const n=new ev({apiKey:e}),i="gemini-2.5-flash";try{const l=await n.models.generateContent({model:i,contents:t,config:{responseMimeType:"application/json"}});if(!l.text)throw new Error("AI 回傳內容為空，請重試或檢查 API 金鑰。");let o=l.text.trim();const u=/^```(\w*)?\s*\n?(.*?)\n?\s*```$/s,f=o.match(u);if(f&&f[2]&&(o=f[2].trim()),!o.startsWith("{")&&!o.startsWith("[")&&(o.includes("{")||o.includes("["))){const g=o.indexOf("{"),h=o.indexOf("[");let x=-1,v=-1;g!==-1&&(h===-1||g<h)?(x=g,v=o.lastIndexOf("}")):h!==-1&&(x=h,v=o.lastIndexOf("]")),x!==-1&&v!==-1&&v>x&&(o=o.substring(x,v+1))}try{return JSON.parse(o)}catch{throw console.error("AI 回傳原始內容 (JSON parse 失敗):",l.text),new Error("AI 模型傳回的資料格式無法解析 (可能不是有效的 JSON)。請嘗試修改您的主題或重試。")}}catch(l){let o="無法產生內容。";if(l instanceof Error&&(o+=` 詳細資料： ${l.message}`),l&&typeof l=="object"&&"message"in l){const u=l;u.message.includes("API key not valid")||u.message.includes("API_KEY_INVALID")?o="Gemini API 金鑰無效。請檢查您的設定。":u.message.includes("quota")||u.message.includes("RESOURCE_EXHAUSTED")?o="已超出 API 配額。請稍後再試。":(u.message.toLowerCase().includes("json")||u.message.includes("Unexpected token"))&&(o="AI 模型傳回的資料格式無法解析 (可能不是有效的 JSON)。請嘗試修改您的主題或重試。")}throw new Error(o)}},nv=async(t,e)=>{const n=`
    Please generate at least 3 (but more is better if appropriate) clear and distinct learning objectives for the topic: "${t}".
    The objectives should be based on scaffolding theory and gamification, and written in the primary language of the topic.
    For each objective, provide the objective statement, a detailed description, and a concrete teaching example (such as a sample sentence, scenario, or application).
    Output MUST be a valid JSON array of objects, e.g.:
    [
      { 
        "objective": "能夠理解${t}的基本概念", 
        "description": "此目標幫助學習者建立對${t}的基礎理解和認知框架...", 
        "teachingExample": "透過具體例子展示${t}的核心概念，例如..." 
      },
      { 
        "objective": "能夠應用${t}於實際情境", 
        "description": "培養學習者將理論知識轉化為實際應用的能力...", 
        "teachingExample": "提供真實情境讓學習者練習應用${t}，如..." 
      },
      { 
        "objective": "能夠辨識${t}常見的誤區", 
        "description": "幫助學習者識別和避免${t}學習中的常見錯誤...", 
        "teachingExample": "展示常見誤區的具體例子和正確理解方式..." 
      },
      //...or more items
    ]
    Do NOT include any explanation or extra text. Only output the JSON array.
  `;return await rt(n,e)},Cj=async(t,e,n)=>{const i=/english|英語|英文|grammar|vocabulary|pronunciation|speaking|listening|reading|writing/i.test(t),l=`
    Based on the following learning objectives: ${JSON.stringify(n)}
    Please break down the topic "${t}" into at least 3 (but more is better if appropriate) micro-units. For each, provide a sub-topic, a brief explanation, and a concrete teaching example.
    
    ${i?`
    SPECIAL REQUIREMENTS FOR ENGLISH LEARNING TOPICS:
    For each breakdown item, also include:
    - coreConcept: 該要點的核心學習概念 (core learning concept for this point)
    - teachingSentences: 3-5句教學例句 (array of 3-5 teaching example sentences)
    - teachingTips: 教學要點提示與說明 (teaching tips and explanations)
    
    Output format for English learning topics:
    [
      {
        "topic": "子主題A", 
        "details": "子主題A的簡要說明...", 
        "teachingExample": "子主題A的教學示例...",
        "coreConcept": "此要點的核心概念...",
        "teachingSentences": ["例句1", "例句2", "例句3", "例句4", "例句5"],
        "teachingTips": "教學要點與提示說明..."
      }
    ]
    `:`
    Standard output format:
    [
      { "topic": "子主題A", "details": "子主題A的簡要說明...", "teachingExample": "子主題A的教學示例..." }
    ]
    `}
    
    Do NOT include any explanation or extra text. Only output the JSON array.
  `;return await rt(l,e)},Tj=async(t,e,n)=>{const i=`
    Based on the following learning objectives: ${JSON.stringify(n)}
    Generate at least 3 (but more is better if appropriate) comprehensive analysis of common misconceptions or difficulties students may have with "${t}".
    
    Output MUST be a valid JSON array with the following comprehensive structure:
    [
      {
        "point": "易混淆點標題",
        "clarification": "詳細澄清說明",
        "teachingExample": "具體教學示例",
        "errorType": "誤區類型 (概念性/程序性/語言性/理解性)",
        "commonErrors": ["學生典型錯誤示例1", "學生典型錯誤示例2", "學生典型錯誤示例3"],
        "correctVsWrong": [
          {
            "correct": "正確示例",
            "wrong": "錯誤示例", 
            "explanation": "對比說明"
          }
        ],
        "preventionStrategy": "預防策略 - 如何防止學生犯錯",
        "correctionMethod": "糾正方法 - 發現錯誤後的補救措施",
        "practiceActivities": ["針對性練習活動1", "針對性練習活動2", "針對性練習活動3"]
      }
    ]
    
    Requirements:
    - Each confusing point should include ALL fields above
    - commonErrors: Provide at least 3 typical student mistakes
    - correctVsWrong: Provide at least 1 comparison (more if helpful)  
    - practiceActivities: Provide at least 3 targeted practice activities
    - All text should be in the primary language of the topic
    - Focus on practical teaching guidance that educators can immediately apply
    
    Do NOT include any explanation or extra text. Only output the JSON array.
  `;return await rt(i,e)},jj=async(t,e,n)=>{const i=`
    Based on the following learning objectives: ${JSON.stringify(n)}
    Suggest at least 3 (but more is better if appropriate) engaging, interactive classroom activities (preferably game-like) for the topic "${t}".
    For each activity, provide the following comprehensive fields:
      - title: 活動名稱/主題 (The name of the activity)
      - description: 活動的標題或核心概念 (Brief description of the core concept)
      - objective: 學習目標 (Main learning goal or purpose)
      - timing: 使用時機 (When to use: lesson introduction, during unit, after unit, review, etc.)
      - materials: 所需教具 (Required tools, materials, or props)
      - environment: 環境要求 (Seating arrangement, space needs, equipment conditions)
      - steps: 活動步驟 (Step-by-step process of teacher-student interactions as array)
      - assessmentPoints: 評估重點 (Learning effectiveness observation and assessment criteria as array)
    
    Output MUST be a valid JSON array of objects, e.g.:
    [
      {
        "title": "遊戲化活動1",
        "description": "活動1的核心概念與玩法簡述...",
        "objective": "活動1的學習目標...",
        "timing": "適用於單元導入/單元後/複習時等...",
        "materials": "所需教材、道具或工具...",
        "environment": "座位安排、空間需求、設備條件...",
        "steps": ["步驟1: 教師說明規則...", "步驟2: 學生分組...", "步驟3: 進行活動..."],
        "assessmentPoints": ["觀察學生參與度", "檢查概念理解程度", "評估協作能力"]
      },
      // ... more items
    ]
    Do NOT include any explanation or extra text. Only output the JSON array.
  `;return await rt(i,e)},kj=async(t,e,n)=>{const i=`
    Based on the following learning objectives: ${JSON.stringify(n)}
    Please generate quiz content for "${t}" in the following JSON structure (no explanation, no extra text):
    {
      "easy": {
        "trueFalse": [
          { "statement": "簡單判斷題1...", "isTrue": true, "explanation": "可選說明1" },
          { "statement": "簡單判斷題2...", "isTrue": false, "explanation": "可選說明2" }
          // ... 至少 5 題，若有更多更好
        ],
        "multipleChoice": [
          { "question": "簡單選擇題1...", "options": ["選項A", "選項B", "選項C"], "correctAnswerIndex": 0 },
          { "question": "簡單選擇題2...", "options": ["選項A", "選項B", "選項C"], "correctAnswerIndex": 1 }
          // ... 至少 5 題，若有更多更好
        ],
        "fillInTheBlanks": [
          { "sentenceWithBlank": "簡單填空題1...____...", "correctAnswer": "正確答案1" },
          { "sentenceWithBlank": "簡單填空題2...____...", "correctAnswer": "正確答案2" }
          // ... 至少 5 題，若有更多更好
        ],
        "sentenceScramble": [
          { "originalSentence": "簡單句子1...", "scrambledWords": ["...", "...", "..."] },
          { "originalSentence": "簡單句子2...", "scrambledWords": ["...", "...", "..."] }
          // ... 至少 5 題，若有更多更好
        ],
        "memoryCardGame": [
          {
            "pairs": [
              { "question": "卡片1正面", "answer": "卡片1背面" },
              { "question": "卡片2正面", "answer": "卡片2背面" },
              { "question": "卡片3正面", "answer": "卡片3背面" },
              { "question": "卡片4正面", "answer": "卡片4背面" },
              { "question": "卡片5正面", "answer": "卡片5背面" }
              // ... 至少 5 組配對，若有更多更好
            ],
            "instructions": "請將每個卡片正面與正確的背面配對。"
          }
        ]
      },
      "normal": { /* same structure as easy, memoryCardGame 只 1 題，pairs 至少 5 組 */ },
      "hard": { /* same structure as easy, memoryCardGame 只 1 題，pairs 至少 5 組 */ }
    }
    For each quiz type (trueFalse, multipleChoice, fillInTheBlanks, sentenceScramble), generate at least 5 questions per difficulty level (easy, normal, hard), but more is better if appropriate.
    For memoryCardGame, generate ONLY 1 question per difficulty, but the "pairs" array inside must contain at least 5 pairs (each pair is a related concept, word/definition, Q&A, or translation relevant to '${t}'), and more is better if appropriate.
    Each memoryCardGame question should include clear "instructions" for the matching task.
    All text must be in the primary language of the topic. Only output the JSON object, no explanation or extra text.
  `;return await rt(i,e)},Ej=async(t,e,n)=>{const i=`
    Based on the following learning objectives: ${JSON.stringify(n)}
    Please generate a short, natural English conversation (at least 3 lines, but more is better if appropriate, 2 speakers) about the topic "${t}" (use English translation if topic is not English).
    Output MUST be a valid JSON array, e.g.:
    [
      { "speaker": "Speaker A", "line": "Hello! Let's talk about ${t}." },
      { "speaker": "Speaker B", "line": "Great idea! What's the first thing we should discuss regarding ${t}?" },
      { "speaker": "Speaker A", "line": "Perhaps we can start with..." },
      { "speaker": "Speaker B", "line": "I think examples would help." }
    ]
    Do NOT include any explanation or extra text. Only output the JSON array.
  `;return await rt(i,e)},Aj=async(t,e,n)=>{const i=`
    Please generate at least 3 (but more is better if appropriate) clear and distinct learning objectives for the topic: "${t}" appropriate for learning level "${e.name}" (${e.description}).
    The objectives should be based on scaffolding theory and gamification, written in the primary language of the topic, and tailored to the learner's level and capabilities described in: "${e.description}".
    For each objective, provide the objective statement, a detailed description, and a concrete teaching example (such as a sample sentence, scenario, or application).
    Output MUST be a valid JSON array of objects, e.g.:
    [
      { 
        "objective": "能夠理解${t}在${e.name}程度的核心概念", 
        "description": "此目標針對${e.name}程度學習者的詳細描述...", 
        "teachingExample": "針對此目標的具體教學示例..." 
      },
      { 
        "objective": "能夠應用${t}的${e.name}級技能", 
        "description": "此目標的具體說明和期望成果...", 
        "teachingExample": "實際應用此技能的示例..." 
      },
      { 
        "objective": "能夠辨識${t}在此程度的常見誤區", 
        "description": "幫助學習者識別和避免常見錯誤...", 
        "teachingExample": "常見誤區的具體例子和正確做法..." 
      },
      //...or more items
    ]
    Do NOT include any explanation or extra text. Only output the JSON array.
  `;return await rt(i,n)},_j=async(t,e,n,i)=>{const l=/english|英語|英文|grammar|vocabulary|pronunciation|speaking|listening|reading|writing/i.test(t),o=`
    Based on the following learning objectives: ${JSON.stringify(i)}
    Please break down the topic "${t}" into at least 3 (but more is better if appropriate) micro-units appropriate for "${e.name}" level learners (${e.description}). For each, provide a sub-topic, a brief explanation, and a concrete teaching example.
    The content depth and complexity should match the level description: "${e.description}".
    
    ${l?`
    SPECIAL REQUIREMENTS FOR ENGLISH LEARNING TOPICS:
    For each breakdown item, also include:
    - coreConcept: 該要點的核心學習概念 (core learning concept for this point)
    - teachingSentences: 3-5句教學例句 (array of 3-5 teaching example sentences)
    - teachingTips: 教學要點提示與說明 (teaching tips and explanations)
    
    Output format for English learning topics:
    [
      {
        "topic": "適合${e.name}的子主題A", 
        "details": "子主題A針對${e.name}程度的簡要說明...", 
        "teachingExample": "子主題A適合此程度的教學示例...",
        "coreConcept": "此要點的核心概念...",
        "teachingSentences": ["例句1", "例句2", "例句3", "例句4", "例句5"],
        "teachingTips": "教學要點與提示說明..."
      }
    ]
    `:`
    Standard output format:
    [
      { "topic": "適合${e.name}的子主題A", "details": "子主題A針對${e.name}程度的簡要說明...", "teachingExample": "子主題A適合此程度的教學示例..." }
    ]
    `}
    
    Do NOT include any explanation or extra text. Only output the JSON array.
  `;return await rt(o,n)},Mj=async(t,e,n,i)=>{const l=`
    Based on the following learning objectives: ${JSON.stringify(i)}
    Generate at least 3 (but more is better if appropriate) comprehensive analysis of common misconceptions or difficulties that "${e.name}" level learners (${e.description}) may have with "${t}".
    
    Output MUST be a valid JSON array with the following comprehensive structure:
    [
      {
        "point": "適合${e.name}程度的易混淆點標題",
        "clarification": "針對${e.description}的澄清說明",
        "teachingExample": "適合此程度學習者的具體教學示例",
        "errorType": "誤區類型 (概念性/程序性/語言性/理解性)",
        "commonErrors": ["此程度學生的典型錯誤示例1", "此程度學生的典型錯誤示例2", "此程度學生的典型錯誤示例3"],
        "correctVsWrong": [
          {
            "correct": "適合${e.name}程度的正確示例",
            "wrong": "此程度學生常犯的錯誤示例", 
            "explanation": "適合此程度的對比說明"
          }
        ],
        "preventionStrategy": "針對${e.name}程度的預防策略",
        "correctionMethod": "適合此程度的糾正方法",
        "practiceActivities": ["適合此程度的練習活動1", "適合此程度的練習活動2", "適合此程度的練習活動3"]
      }
    ]
    
    Requirements:
    - All content should be appropriate for "${e.description}"
    - Each confusing point should include ALL fields above
    - commonErrors: Provide at least 3 typical student mistakes at this level
    - correctVsWrong: Provide at least 1 comparison (more if helpful)  
    - practiceActivities: Provide at least 3 level-appropriate targeted practice activities
    - All text should be in the primary language of the topic
    - Focus on confusion points specific to "${e.name}" level: "${e.description}"
    
    Do NOT include any explanation or extra text. Only output the JSON array.
  `;return await rt(l,n)},Rj=async(t,e,n,i)=>{const l=`
    Based on the following learning objectives: ${JSON.stringify(i)}
    Suggest at least 3 (but more is better if appropriate) engaging, interactive classroom activities (preferably game-like) for the topic "${t}" suitable for "${e.name}" level learners (${e.description}).
    Activities should match the complexity and capabilities described in: "${e.description}".
    For each activity, provide the following comprehensive fields:
      - title: 活動名稱/主題 (The name of the activity)
      - description: 活動的標題或核心概念 (Brief description of the core concept)
      - objective: 學習目標 (Main learning goal or purpose)
      - timing: 使用時機 (When to use: lesson introduction, during unit, after unit, review, etc.)
      - materials: 所需教具 (Required tools, materials, or props)
      - environment: 環境要求 (Seating arrangement, space needs, equipment conditions)
      - steps: 活動步驟 (Step-by-step process of teacher-student interactions as array)
      - assessmentPoints: 評估重點 (Learning effectiveness observation and assessment criteria as array)
    
    Output MUST be a valid JSON array of objects, e.g.:
    [
      {
        "title": "適合${e.name}的遊戲化活動1",
        "description": "活動1針對此程度的核心概念與玩法簡述...",
        "objective": "活動1符合${e.name}程度的學習目標...",
        "timing": "適用於單元導入/單元後/複習時等...",
        "materials": "此程度所需教材、道具或工具...",
        "environment": "座位安排、空間需求、設備條件...",
        "steps": ["步驟1: 教師說明規則...", "步驟2: 學生分組...", "步驟3: 進行活動..."],
        "assessmentPoints": ["觀察學生參與度", "檢查概念理解程度", "評估協作能力"]
      },
      // ... more items
    ]
    Do NOT include any explanation or extra text. Only output the JSON array.
  `;return await rt(l,n)},Ij=async(t,e,n,i)=>{const l=`
    基於主題「${t}」、選定的學習程度「${e.name}」(${e.description})，
    以及學習目標：${JSON.stringify(i)}
    
    請產生適合「${e.name}」程度學習者的互動測驗題目。
    題目難度和複雜度應符合：「${e.description}」。
    
    輸出必須是有效的 JSON 物件，格式如下：
    {
      "easy": {
        "trueFalse": [
          { "statement": "暖身判斷題1...", "isTrue": true, "explanation": "可選說明1" },
          { "statement": "暖身判斷題2...", "isTrue": false, "explanation": "可選說明2" }
          // ... 至少 5 題，若有更多更好
        ],
        "multipleChoice": [
          { "question": "暖身選擇題1...", "options": ["選項A", "選項B", "選項C"], "correctAnswerIndex": 0 },
          { "question": "暖身選擇題2...", "options": ["選項A", "選項B", "選項C"], "correctAnswerIndex": 1 }
          // ... 至少 5 題，若有更多更好
        ],
        "fillInTheBlanks": [
          { "sentenceWithBlank": "暖身填空題1...____...", "correctAnswer": "正確答案1" },
          { "sentenceWithBlank": "暖身填空題2...____...", "correctAnswer": "正確答案2" }
          // ... 至少 5 題，若有更多更好
        ],
        "sentenceScramble": [
          { "originalSentence": "暖身句子1...", "scrambledWords": ["...", "...", "..."] },
          { "originalSentence": "暖身句子2...", "scrambledWords": ["...", "...", "..."] }
          // ... 至少 5 題，若有更多更好
        ],
        "memoryCardGame": [
          {
            "pairs": [
              { "question": "卡片1正面", "answer": "卡片1背面" },
              { "question": "卡片2正面", "answer": "卡片2背面" },
              { "question": "卡片3正面", "answer": "卡片3背面" },
              { "question": "卡片4正面", "answer": "卡片4背面" },
              { "question": "卡片5正面", "answer": "卡片5背面" }
              // ... 至少 5 組配對，若有更多更好
            ],
            "instructions": "請將每個卡片正面與正確的背面配對。"
          }
        ]
      },
      "normal": { /* 符合所選程度的題目，結構同 easy，memoryCardGame 只 1 題，pairs 至少 5 組 */ },
      "hard": { /* 此程度的挑戰題目，結構同 easy，memoryCardGame 只 1 題，pairs 至少 5 組 */ }
    }
    
    對於每種測驗類型 (trueFalse, multipleChoice, fillInTheBlanks, sentenceScramble)，每個難度等級 (easy, normal, hard) 至少產生 5 題，若有更多更好。
    對於 memoryCardGame，每個難度只產生 1 題，但內部的 "pairs" 陣列必須包含至少 5 組配對（每組配對是與「${t}」相關的概念、詞彙/定義、問答或翻譯），若有更多更好。
    每個 memoryCardGame 題目都應包含清楚的 "instructions" 說明配對任務。
    所有文字使用主題的主要語言。請勿包含任何說明或額外文字，僅輸出 JSON 物件。
  `;return await rt(l,n)},Dj=async(t,e,n,i)=>{const l=`
    Based on the following learning objectives: ${JSON.stringify(i)}
    Please generate a short, natural English conversation (at least 3 lines, but more is better if appropriate, 2 speakers) about the topic "${t}" (use English translation if topic is not English) appropriate for "${e.name}" level learners (${e.description}).
    Language complexity and vocabulary should match: "${e.description}".
    Output MUST be a valid JSON array, e.g.:
    [
      { "speaker": "Speaker A", "line": "Hello! Let's talk about ${t}." },
      { "speaker": "Speaker B", "line": "Great idea! What's the first thing we should discuss regarding ${t}?" },
      { "speaker": "Speaker A", "line": "Perhaps we can start with..." },
      { "speaker": "Speaker B", "line": "I think examples would help." }
    ]
    Do NOT include any explanation or extra text. Only output the JSON array.
  `;return await rt(l,n)},iv=async(t,e,n)=>{const i=`
    Based on the topic "${t}" and learning objectives: ${JSON.stringify(n)}
    Please generate 3-4 learning levels that are specific to this topic. Each level should have a unique name, description, and order.
    The levels should progress from basic understanding to advanced mastery, tailored specifically to the subject matter.
    
    Output MUST be a valid JSON object with this exact structure:
    {
      "suggestedLevels": [
        {
          "id": "beginner",
          "name": "初學者",
          "description": "適合首次接觸${t}的學習者，著重基礎概念理解",
          "order": 1
        },
        {
          "id": "intermediate", 
          "name": "進階者",
          "description": "已具備基礎知識，能進行${t}的實際應用",
          "order": 2
        },
        {
          "id": "advanced",
          "name": "專精者", 
          "description": "深度掌握${t}，能分析複雜情況並提供解決方案",
          "order": 3
        }
      ],
      "defaultLevelId": "beginner"
    }
    
    Make sure to:
    1. Create level names and descriptions that are specific to the topic (not generic)
    2. Use appropriate terminology for the subject area
    3. Ensure descriptions explain what learners at each level can do
    4. Use the primary language of the topic for names and descriptions
    
    Do NOT include any explanation or extra text. Only output the JSON object.
  `;return await rt(i,e)},Lj=t=>{const e=["english","grammar","vocabulary","pronunciation","speaking","writing","reading","listening","conversation","toefl","ielts","toeic","english literature","business english","academic english","phrasal verbs","idioms","prepositions","tenses","articles","adjectives","adverbs","nouns","verbs","英語","英文","文法","單字","發音","口說","寫作","閱讀","聽力","對話","會話","托福","雅思","多益","商業英文","學術英文","片語動詞","慣用語","介系詞","時態","冠詞","形容詞","副詞","名詞","動詞"],n=t.toLowerCase();return e.some(i=>n.includes(i.toLowerCase()))},Pj=async(t,e)=>{if(!e)throw new Error("Gemini API 金鑰未正確設定或遺失。請檢查應用程式的環境設定。");const n=await nv(t,e);return await iv(t,e,n)},Oj=async(t,e,n)=>{if(!n)throw new Error("Gemini API 金鑰未正確設定或遺失。請檢查應用程式的環境設定。");const i=await Aj(t,e,n),[l,o,u,f,g,h]=await Promise.all([_j(t,e,n,i),Mj(t,e,n,i),Rj(t,e,n,i),Ij(t,e,n,i),Dj(t,e,n,i),im(t,n,i,e)]);return{learningObjectives:i,contentBreakdown:l,confusingPoints:o,classroomActivities:u,onlineInteractiveQuiz:f,englishConversation:g,writingPractice:h}},Bj=async(t,e,n,i)=>{if(!i)throw new Error("Gemini API 金鑰未正確設定或遺失。請檢查應用程式的環境設定。");const l=await Uj(t,e,n,i),[o,u,f,g,h,x]=await Promise.all([zj(t,e,n,i,l),Vj(t,e,n,i,l),$j(t,e,n,i,l),qj(t,e,n,i,l),Fj(t,e,n,i,l),im(t,i,l,e,n)]);return{learningObjectives:l,contentBreakdown:o,confusingPoints:u,classroomActivities:f,onlineInteractiveQuiz:g,englishConversation:h,writingPractice:x}},Uj=async(t,e,n,i)=>{const l=`
    Please generate at least 3 (but more is better if appropriate) clear and distinct learning objectives for the topic: "${t}" appropriate for learning level "${e.name}" (${e.description}) and English vocabulary level "${n.name}" (${n.wordCount} words: ${n.description}).
    The objectives should be based on scaffolding theory and gamification, written in the primary language of the topic, and tailored to both the learner's level and vocabulary constraints.
    For each objective, provide the objective statement, a detailed description, and a concrete teaching example (such as a sample sentence, scenario, or application).
    
    CRITICAL VOCABULARY CONSTRAINTS for English content:
    - All English text must use vocabulary within the ${n.wordCount} most common English words
    - Adjust language complexity to match ${n.description}
    - Avoid advanced vocabulary that exceeds this level
    
    Output MUST be a valid JSON array of objects, e.g.:
    [
      { 
        "objective": "能夠理解${t}在${e.name}程度的核心概念（英文內容限制在${n.wordCount}詞彙範圍）", 
        "description": "此目標針對${e.name}程度和${n.name}詞彙量學習者的詳細描述...", 
        "teachingExample": "使用${n.wordCount}詞彙範圍內的英文例句和教學示例..." 
      },
      { 
        "objective": "能夠應用${t}的${e.name}級技能（適合${n.name}程度學習者）", 
        "description": "培養在詞彙限制下的實際應用能力...", 
        "teachingExample": "提供符合${n.wordCount}詞彙量的實際應用情境..." 
      },
      { 
        "objective": "能夠辨識${t}在此程度和詞彙量的常見誤區", 
        "description": "幫助學習者識別和避免在此詞彙程度下的常見錯誤...", 
        "teachingExample": "使用簡單詞彙展示常見誤區和正確做法..." 
      },
      //...or more items
    ]
    Do NOT include any explanation or extra text. Only output the JSON array.
  `;return await rt(l,i)},zj=async(t,e,n,i,l)=>{const o=/english|英語|英文|grammar|vocabulary|pronunciation|speaking|listening|reading|writing/i.test(t),u=`
    Based on the following learning objectives: ${JSON.stringify(l)}
    Please break down the topic "${t}" into at least 3 (but more is better if appropriate) micro-units appropriate for "${e.name}" level learners (${e.description}) with English vocabulary level "${n.name}" (${n.wordCount} words: ${n.description}).
    
    CRITICAL VOCABULARY CONSTRAINTS for English content:
    - All English text must use vocabulary within the ${n.wordCount} most common English words
    - Teaching examples should match ${n.description}
    - Avoid complex words that exceed this vocabulary level
    - Sentence structures should be appropriate for ${n.name} learners
    
    ${o?`
    SPECIAL REQUIREMENTS FOR ENGLISH LEARNING TOPICS:
    For each breakdown item, also include:
    - coreConcept: 該要點的核心學習概念 (core learning concept for this point)
    - teachingSentences: 3-5句教學例句，使用${n.wordCount}詞彙範圍 (array of 3-5 teaching sentences using vocabulary within ${n.wordCount} words)
    - teachingTips: 教學要點提示與說明 (teaching tips and explanations)
    
    Output format for English learning topics:
    [
      {
        "topic": "適合${n.name}的子主題A", 
        "details": "子主題A針對${n.wordCount}詞彙量的簡要說明...", 
        "teachingExample": "子主題A使用${n.name}程度詞彙的教學示例...",
        "coreConcept": "此要點的核心概念...",
        "teachingSentences": ["Simple example 1", "Easy sentence 2", "Basic example 3"],
        "teachingTips": "教學要點與提示說明..."
      }
    ]
    `:`
    Standard output format:
    [
      { "topic": "適合${n.name}的子主題A", "details": "子主題A針對${n.wordCount}詞彙量的簡要說明...", "teachingExample": "子主題A使用${n.name}程度詞彙的教學示例..." }
    ]
    `}
    
    Do NOT include any explanation or extra text. Only output the JSON array.
  `;return await rt(u,i)},Vj=async(t,e,n,i,l)=>{const o=`
    Based on the following learning objectives: ${JSON.stringify(l)}
    Generate at least 3 (but more is better if appropriate) comprehensive analysis of common misconceptions or difficulties that "${e.name}" level learners (${e.description}) with English vocabulary level "${n.name}" (${n.wordCount} words: ${n.description}) may have with "${t}".
    
    CRITICAL VOCABULARY CONSTRAINTS for English content:
    - All explanations must use vocabulary within the ${n.wordCount} most common English words
    - Examples should be appropriate for ${n.description}
    - Focus on confusion points that arise specifically at this vocabulary level
    
    Output MUST be a valid JSON array with the following comprehensive structure:
    [
      {
        "point": "適合${n.name}詞彙程度的易混淆點標題",
        "clarification": "使用${n.wordCount}詞彙範圍的澄清說明",
        "teachingExample": "適合${n.name}程度的教學示例",
        "errorType": "誤區類型 (概念性/程序性/語言性/理解性)",
        "commonErrors": ["此詞彙程度學生的典型錯誤示例1", "此詞彙程度學生的典型錯誤示例2", "此詞彙程度學生的典型錯誤示例3"],
        "correctVsWrong": [
          {
            "correct": "使用${n.wordCount}詞彙範圍的正確示例",
            "wrong": "此詞彙程度學生常犯的錯誤示例",
            "explanation": "適合此詞彙程度的對比說明"
          }
        ],
        "preventionStrategy": "針對${n.name}詞彙程度的預防策略",
        "correctionMethod": "適合此詞彙程度的糾正方法",
        "practiceActivities": ["適合此詞彙程度的練習活動1", "適合此詞彙程度的練習活動2", "適合此詞彙程度的練習活動3"]
      }
    ]
    
    All English content must stay within the ${n.wordCount} word vocabulary limit and match ${e.description}.
    Do NOT include any explanation or extra text. Only output the JSON array.
  `;return await rt(o,i)},$j=async(t,e,n,i,l)=>{const o=`
    Based on the following learning objectives: ${JSON.stringify(l)}
    Suggest at least 3 (but more is better if appropriate) engaging, interactive classroom activities (preferably game-like) for the topic "${t}" suitable for "${e.name}" level learners (${e.description}) with English vocabulary level "${n.name}" (${n.wordCount} words: ${n.description}).
    
    CRITICAL VOCABULARY CONSTRAINTS for English content:
    - Activity instructions must use vocabulary within the ${n.wordCount} most common English words
    - Activity content should match ${n.description}
    - Consider vocabulary limitations when designing complexity
    
    For each activity, provide the following comprehensive fields:
      - title: 活動名稱/主題 (The name of the activity)
      - description: 活動的標題或核心概念 (Brief description of the core concept)
      - objective: 學習目標 (Main learning goal or purpose)
      - timing: 使用時機 (When to use: lesson introduction, during unit, after unit, review, etc.)
      - materials: 所需教具 (Required tools, materials, or props)
      - environment: 環境要求 (Seating arrangement, space needs, equipment conditions)
      - steps: 活動步驟 (Step-by-step process of teacher-student interactions as array)
      - assessmentPoints: 評估重點 (Learning effectiveness observation and assessment criteria as array)
    
    Output MUST be a valid JSON array of objects, e.g.:
    [
      {
        "title": "適合${n.name}的遊戲化活動1",
        "description": "活動1針對${n.wordCount}詞彙量的核心概念與玩法簡述...",
        "objective": "活動1符合${n.name}程度的學習目標...",
        "timing": "適用於單元導入/單元後/複習時等...",
        "materials": "適合此詞彙程度的教材、道具或工具...",
        "environment": "座位安排、空間需求、設備條件...",
        "steps": ["步驟1: 教師說明規則...", "步驟2: 學生分組...", "步驟3: 進行活動..."],
        "assessmentPoints": ["觀察學生參與度", "檢查概念理解程度", "評估協作能力"]
      },
      // ... more items
    ]
    Do NOT include any explanation or extra text. Only output the JSON array.
  `;return await rt(o,i)},qj=async(t,e,n,i,l)=>{const o=`
    Based on the following learning objectives: ${JSON.stringify(l)}
    Please generate quiz content for "${t}" suitable for learning level "${e.name}" (${e.description}) and English vocabulary level "${n.name}" (${n.wordCount} words: ${n.description}).
    
    CRITICAL VOCABULARY CONSTRAINTS for English content:
    - All English text in quiz questions, options, and examples must use vocabulary within the ${n.wordCount} most common English words
    - Sentence structures should be appropriate for ${n.description}
    - Avoid advanced vocabulary that exceeds this level
    
    Output in the following JSON structure (no explanation, no extra text):
    {
      "easy": {
        "trueFalse": [
          { "statement": "簡單判斷題1...", "isTrue": true, "explanation": "可選說明1" },
          { "statement": "簡單判斷題2...", "isTrue": false, "explanation": "可選說明2" }
          // ... 至少 5 題，若有更多更好
        ],
        "multipleChoice": [
          { "question": "簡單選擇題1...", "options": ["選項A", "選項B", "選項C"], "correctAnswerIndex": 0 },
          { "question": "簡單選擇題2...", "options": ["選項A", "選項B", "選項C"], "correctAnswerIndex": 1 }
          // ... 至少 5 題，若有更多更好
        ],
        "fillInTheBlanks": [
          { "sentenceWithBlank": "簡單填空題1...____...", "correctAnswer": "正確答案1" },
          { "sentenceWithBlank": "簡單填空題2...____...", "correctAnswer": "正確答案2" }
          // ... 至少 5 題，若有更多更好
        ],
        "sentenceScramble": [
          { "originalSentence": "簡單句子1...", "scrambledWords": ["...", "...", "..."] },
          { "originalSentence": "簡單句子2...", "scrambledWords": ["...", "...", "..."] }
          // ... 至少 5 題，若有更多更好
        ],
        "memoryCardGame": [
          {
            "pairs": [
              { "question": "卡片1正面", "answer": "卡片1背面" },
              { "question": "卡片2正面", "answer": "卡片2背面" },
              { "question": "卡片3正面", "answer": "卡片3背面" },
              { "question": "卡片4正面", "answer": "卡片4背面" },
              { "question": "卡片5正面", "answer": "卡片5背面" }
              // ... 至少 5 組配對，若有更多更好
            ],
            "instructions": "請將每個卡片正面與正確的背面配對。"
          }
        ]
      },
      "normal": { /* same structure as easy, memoryCardGame 只 1 題，pairs 至少 5 組 */ },
      "hard": { /* same structure as easy, memoryCardGame 只 1 題，pairs 至少 5 組 */ }
    }
    For each quiz type (trueFalse, multipleChoice, fillInTheBlanks, sentenceScramble), generate at least 5 questions per difficulty level (easy, normal, hard), but more is better if appropriate.
    For memoryCardGame, generate ONLY 1 question per difficulty, but the "pairs" array inside must contain at least 5 pairs (each pair is a related concept, word/definition, Q&A, or translation relevant to '${t}'), and more is better if appropriate.
    Each memoryCardGame question should include clear "instructions" for the matching task.
    All text must be in the primary language of the topic. For English learning topics, limit English vocabulary to ${n.wordCount} most common words. Only output the JSON object, no explanation or extra text.
  `;return await rt(o,i)},Fj=async(t,e,n,i,l)=>{const o=`
    Based on the following learning objectives: ${JSON.stringify(l)}
    Please generate a short, natural English conversation (at least 3 lines, but more is better if appropriate, 2 speakers) about the topic "${t}" (use English translation if topic is not English) appropriate for "${e.name}" level learners (${e.description}) with English vocabulary level "${n.name}" (${n.wordCount} words: ${n.description}).
    
    CRITICAL VOCABULARY CONSTRAINTS:
    - Use ONLY vocabulary within the ${n.wordCount} most common English words
    - Sentence structures must be appropriate for ${n.description}
    - Conversation complexity should match ${n.name} level
    - Avoid advanced vocabulary that exceeds this level
    - Keep sentences simple and clear for ${n.name} learners
    
    Output MUST be a valid JSON array, e.g.:
    [
      { "speaker": "Speaker A", "line": "Hello! Let's talk about ${t} using simple words for ${n.name} level." },
      { "speaker": "Speaker B", "line": "Great idea! What should we discuss first about ${t}?" },
      { "speaker": "Speaker A", "line": "Perhaps we can start with..." },
      { "speaker": "Speaker B", "line": "I think examples would help." }
    ]
    Do NOT include any explanation or extra text. Only output the JSON array.
  `;return await rt(o,i)},Hj=async(t,e)=>{if(!e)throw new Error("Gemini API 金鑰未正確設定或遺失。請檢查應用程式的環境設定。");const n=await nv(t,e),[i,l,o,u,f,g,h]=await Promise.all([Cj(t,e,n),Tj(t,e,n),jj(t,e,n),kj(t,e,n),Ej(t,e,n),iv(t,e,n),im(t,e,n)]);return{learningObjectives:n,contentBreakdown:i,confusingPoints:l,classroomActivities:o,onlineInteractiveQuiz:u,englishConversation:f,learningLevels:g,writingPractice:h}},Gj=t=>{const e=n=>({trueFalse:Math.max(0,Math.min(n.trueFalse,yr.trueFalse)),multipleChoice:Math.max(0,Math.min(n.multipleChoice,yr.multipleChoice)),fillInTheBlanks:Math.max(0,Math.min(n.fillInTheBlanks,yr.fillInTheBlanks)),sentenceScramble:Math.max(0,Math.min(n.sentenceScramble,yr.sentenceScramble)),memoryCardGame:Math.max(0,Math.min(n.memoryCardGame,yr.memoryCardGame))});return{easy:e(t.easy),normal:e(t.normal),hard:e(t.hard)}},Jj=async(t,e,n,i,l,o)=>{const u=Gj(i),f=async v=>{const N=u[v];let w="";l&&(w=`適合「${l.name}」程度學習者 (${l.description}) 的`);let C="";o&&(C=`
      CRITICAL VOCABULARY CONSTRAINTS for English content:
      - All English text must use vocabulary within the ${o.wordCount} most common English words
      - Examples should be appropriate for ${o.description}
      `);const j=`
      Based on the following learning objectives: ${JSON.stringify(n)}
      Please generate ${w}quiz content for "${t}" with the following specific quantities:
      
      - True/False questions: ${N.trueFalse} questions
      - Multiple choice questions: ${N.multipleChoice} questions  
      - Fill in the blanks questions: ${N.fillInTheBlanks} questions
      - Sentence scramble questions: ${N.sentenceScramble} questions
      - Memory card game questions: ${N.memoryCardGame} questions
      
      ${C}
      
      Output MUST be a valid JSON object with this exact structure:
      {
        "trueFalse": [${N.trueFalse>0?`
          { "statement": "是非題題目", "isTrue": true, "explanation": "可選說明" }
          // 總共 ${N.trueFalse} 題`:"// 空陣列，因為設定為 0 題"}],
        "multipleChoice": [${N.multipleChoice>0?`
          { "question": "選擇題題目", "options": ["選項A", "選項B", "選項C", "選項D"], "correctAnswerIndex": 0 }
          // 總共 ${N.multipleChoice} 題`:"// 空陣列，因為設定為 0 題"}],
        "fillInTheBlanks": [${N.fillInTheBlanks>0?`
          { "sentenceWithBlank": "填空題題目，空格用 ____ 表示", "correctAnswer": "正確答案" }
          // 總共 ${N.fillInTheBlanks} 題`:"// 空陣列，因為設定為 0 題"}],
        "sentenceScramble": [${N.sentenceScramble>0?`
          { "originalSentence": "正確的完整句子", "scrambledWords": ["打散", "的", "單字", "陣列"] }
          // 總共 ${N.sentenceScramble} 題`:"// 空陣列，因為設定為 0 題"}],
        "memoryCardGame": [${N.memoryCardGame>0?`
          { "pairs": [{"question": "卡片正面", "answer": "卡片背面"}, ...], "instructions": "遊戲說明" }
          // 總共 ${N.memoryCardGame} 題，每題至少包含 5 對卡片`:"// 空陣列，因為設定為 0 題"}]
      }
      
      IMPORTANT: 
      - Generate EXACTLY the number of questions specified for each type (supports up to 10 questions for most types, 2 for memory card games)
      - If a question type is set to 0, provide an empty array []
      - For memoryCardGame, each question should contain at least 5 pairs in the "pairs" array
      - Maximum limits: trueFalse/multipleChoice/fillInTheBlanks/sentenceScramble up to 10 questions, memoryCardGame up to 2 questions
      - All text must be in the primary language of the topic
      - Do NOT include any explanation or extra text, only output the JSON object
    `;return await rt(j,e)},[g,h,x]=await Promise.all([f("easy"),f("normal"),f("hard")]);return{easy:g,normal:h,hard:x}},Yj=async(t,e,n,i,l,o)=>await Jj(t,e,n,i,l,o),im=async(t,e,n,i,l)=>{const o=`
    Based on the topic "${t}" and learning objectives: ${JSON.stringify(n)}
    Generate 6 sentence-making practice prompts (2 easy, 2 normal, 2 hard difficulty).
    
    ${i?`The content should be suitable for "${i.name}" level learners (${i.description}).`:""}
    ${l?`
    VOCABULARY CONSTRAINTS for English content:
    - All instructions and keywords must use vocabulary within the ${l.wordCount} most common English words
    - Examples should be appropriate for ${l.description}
    `:""}
    
    Output MUST be a valid JSON array:
    [
      {
        "id": "sentence_1",
        "instruction": "造句指示說明",
        "keywords": ["關鍵詞1", "關鍵詞2", "關鍵詞3"],
        "exampleSentence": "範例句子",
        "hints": ["提示1", "提示2"],
        "difficulty": "easy"
      }
    ]
    
    Requirements:
    - Each prompt should include 2-4 keywords that must be used
    - Provide clear instructions in the primary language of the topic
    - Include helpful hints for sentence construction
    - Example sentences should demonstrate proper usage
    - Progressive difficulty from easy to hard
    
    Do NOT include explanation, only output the JSON array.
  `,u=`
    Based on the topic "${t}" and learning objectives: ${JSON.stringify(n)}
    Generate 6 writing practice prompts (2 easy, 2 normal, 2 hard difficulty).
    
    ${i?`The content should be suitable for "${i.name}" level learners (${i.description}).`:""}
    ${l?`
    VOCABULARY CONSTRAINTS for English content:
    - All instructions and suggested keywords must use vocabulary within the ${l.wordCount} most common English words
    - Writing requirements should match ${l.description}
    `:""}
    
    Output MUST be a valid JSON array:
    [
      {
        "id": "writing_1", 
        "title": "寫作題目標題",
        "instruction": "詳細的寫作指示",
        "structure": ["段落1：介紹", "段落2：主要內容", "段落3：結論"],
        "keywords": ["建議詞彙1", "建議詞彙2"],
        "minLength": 100,
        "maxLength": 300,
        "exampleOutline": "範例大綱結構",
        "difficulty": "easy"
      }
    ]
    
    Requirements:
    - Easy: 100-200 words, simple structure
    - Normal: 200-400 words, moderate complexity  
    - Hard: 300-600 words, complex structure
    - Provide clear writing guidelines and structure suggestions
    - Include relevant vocabulary recommendations
    - All text in the primary language of the topic
    
    Do NOT include explanation, only output the JSON array.
  `,[f,g]=await Promise.all([rt(o,e),rt(u,e)]);return{sentencePractice:f,writingPractice:g,instructions:"這裡提供了造句和寫作練習，幫助學習者提升語言表達能力。造句練習著重於詞彙運用，寫作練習則訓練文章結構和論述能力。完成後可以使用AI批改功能獲得即時回饋。"}},Zj=async(t,e,n,i,l)=>{const o=/[a-zA-Z]/.test(t),u=o?"English":"Chinese",f=`
    Please provide detailed feedback for this ${e} practice work:
    
    Original Prompt: ${JSON.stringify(n)}
    Student Work: "${t}"
    
    ${l&&o?`
    VOCABULARY LEVEL CONTEXT:
    - Target level: ${l.name} (${l.wordCount} words: ${l.description})
    - Evaluate if vocabulary usage matches this level
    `:""}
    
    Provide comprehensive feedback in JSON format:
    {
      "score": 85,
      "strengths": ["具體優點1", "具體優點2"],
      "improvements": ["改進建議1", "改進建議2"],
      "grammarCorrections": [
        {
          "original": "原文片段",
          "corrected": "修正後版本", 
          "explanation": "修正原因說明"
        }
      ],
      "vocabularyTips": ["詞彙使用建議1", "詞彙使用建議2"],
      "structureFeedback": "結構和組織回饋",
      "overallComment": "整體評語和鼓勵"
    }
    
    Evaluation Criteria:
    - Content relevance and completion of requirements
    - Grammar and language accuracy
    - Vocabulary usage and variety
    - Structure and organization (for writing)
    - Creativity and expression
    
    ${e==="sentence"?`
    For sentence practice:
    - Check if required keywords are used correctly
    - Evaluate sentence structure and grammar
    - Assess creativity in sentence construction
    `:`
    For writing practice:
    - Evaluate if word count requirements are met
    - Assess paragraph structure and flow
    - Check adherence to suggested outline
    - Evaluate argument development and coherence
    `}
    
    Provide feedback in Traditional Chinese for better understanding.
    Be encouraging and constructive. Score range: 0-100.
    
    Do NOT include explanation, only output the JSON object.
  `;return await rt(f,i)},Mo=async(t,e)=>{const n=`
    Transform the following teacher-oriented learning objective into student-friendly, engaging content suitable for interactive learning:
    
    Original Learning Objective:
    ${JSON.stringify(t)}
    
    Transform it into student-centered language that:
    1. Uses "你" (you) instead of "學生" (students)
    2. Makes it personally relevant and motivating
    3. Explains WHY this learning is important to the student
    4. Uses encouraging, accessible language
    5. Includes concrete examples that students can relate to
    6. Makes the learning goal feel achievable and exciting
    
    Output MUST be a valid JSON object with this structure:
    {
      "objective": "學習目標改寫為學生導向的語言",
      "description": "詳細說明為什麼你需要學會這個，以及學會後對你的好處",
      "teachingExample": "具體的、與學生生活相關的例子或應用情境",
      "personalRelevance": "這個學習與你的日常生活、未來發展的關係",
      "encouragement": "鼓勵學生的話語，讓學習感覺有趣且可達成"
    }
    
    Make the content engaging, personal, and motivational. Use Traditional Chinese.
    Do NOT include any explanation or extra text. Only output the JSON object.
  `;return await rt(n,e)},Ro=async(t,e)=>{const n=`
    Transform the following teacher-oriented content breakdown into student-friendly, digestible learning content:
    
    Original Content Breakdown:
    ${JSON.stringify(t)}
    
    Transform it into student-centered content that:
    1. Uses conversational, friendly tone
    2. Explains concepts in simple, relatable terms
    3. Connects to real-world applications students care about
    4. Includes step-by-step learning guidance
    5. Makes complex topics feel approachable
    6. Uses analogies and examples from student life
    
    Output MUST be a valid JSON object with this structure:
    {
      "title": "子主題標題用學生容易理解的語言表達",
      "introduction": "用友善的語調介紹這個概念，說明為什麼要學習它",
      "keyPoints": ["要點1用簡單語言解釋", "要點2用實際例子說明", "要點3連結到生活應用"],
      "realLifeExamples": ["生活中的例子1", "生活中的例子2", "生活中的例子3"],
      "learningTips": "學習這個概念的小技巧和方法",
      "nextSteps": "學會這個概念後，你可以進一步探索什麼",
      "encouragement": "給學生的鼓勵話語"
    }
    
    Make the content feel like a friendly tutor explaining concepts personally to the student.
    Use Traditional Chinese. Do NOT include any explanation or extra text. Only output the JSON object.
  `;return await rt(n,e)},Io=async(t,e)=>{const n=`
    Transform the following teacher-oriented confusing point analysis into student-friendly, helpful guidance:
    
    Original Confusing Point:
    ${JSON.stringify(t)}
    
    Transform it into student-centered guidance that:
    1. Acknowledges that confusion is normal and okay
    2. Explains the common mistake without making students feel bad
    3. Provides clear, memorable strategies to avoid the mistake
    4. Uses positive, encouraging language
    5. Includes memorable tricks or mnemonics
    6. Shows both wrong and right examples in a supportive way
    
    Output MUST be a valid JSON object with this structure:
    {
      "title": "易混淆概念的標題用友善語言表達",
      "normalizeConfusion": "告訴學生這種混淆很正常，不用擔心",
      "commonMistake": "用溫和的語言說明常見的錯誤想法",
      "whyItHappens": "解釋為什麼會有這種混淆（讓學生理解而不是感到愚蠢）",
      "clearExplanation": "用簡單明瞭的方式解釋正確概念",
      "rememberingTricks": ["記憶技巧1", "記憶技巧2", "記憶技巧3"],
      "practiceExamples": [
        {
          "situation": "情境描述",
          "wrongThinking": "錯誤的想法",
          "rightThinking": "正確的想法",
          "explanation": "為什麼這樣想是對的"
        }
      ],
      "confidenceBooster": "提升學生信心的話語，讓他們知道掌握這個概念是可以做到的"
    }
    
    Make the content supportive and empowering, helping students learn from mistakes without judgment.
    Use Traditional Chinese. Do NOT include any explanation or extra text. Only output the JSON object.
  `;return await rt(n,e)},Qj=async(t,e,n,i)=>{const l=`
    Based on the following transformed student-friendly content, generate quiz questions that help students practice and reinforce their understanding:
    
    Step Type: ${e}
    Content: ${JSON.stringify(t)}
    
    Generate EXACTLY the requested number of questions for each type:
    - True/False: ${i.trueFalse} questions
    - Multiple Choice: ${i.multipleChoice} questions  
    - Memory Card Game: ${i.memoryCardGame} pair set(s)
    
    Quiz Design Principles:
    1. Questions should directly test understanding of the content provided
    2. Use student-friendly language that matches the transformed content tone
    3. Make questions engaging and practical
    4. Include clear explanations for correct answers
    5. For memory card games, create concept-definition or question-answer pairs
    6. Avoid trick questions; focus on genuine comprehension
    
    Output MUST be a valid JSON object with this exact structure:
    {
      "trueFalse": [
        { 
          "statement": "清楚的是非判斷陳述句...", 
          "isTrue": true, 
          "explanation": "解釋為什麼這個陳述是正確/錯誤的..."
        }
        // exactly ${i.trueFalse} items
      ],
      "multipleChoice": [
        { 
          "question": "測試理解的選擇題問題...", 
          "options": ["選項A", "選項B", "選項C", "選項D"], 
          "correctAnswerIndex": 0,
          "explanation": "解釋為什麼這個答案是正確的..."
        }
        // exactly ${i.multipleChoice} items
      ],
      "memoryCardGame": [
        {
          "title": "配對遊戲標題",
          "pairs": [
            { "left": "概念或問題", "right": "定義或答案" },
            { "left": "概念或問題", "right": "定義或答案" },
            { "left": "概念或問題", "right": "定義或答案" },
            { "left": "概念或問題", "right": "定義或答案" },
            { "left": "概念或問題", "right": "定義或答案" }
            // at least 5 pairs per game
          ]
        }
        // exactly ${i.memoryCardGame} games
      ]
    }
    
    All content should be in Traditional Chinese and directly related to the provided learning content.
    Make questions that genuinely help students practice and remember the key concepts.
    Do NOT include any explanation or extra text outside the JSON structure.
  `;return await rt(l,n)},Kj=({topic:t,setTopic:e,onGenerate:n,onGenerateWithLevels:i,isLoading:l})=>{const o=f=>{f.preventDefault(),!l&&t.trim()&&n()},u=f=>{f.preventDefault(),!l&&t.trim()&&i&&i()};return a.jsxs("form",{onSubmit:o,className:"mb-8 p-6 bg-white shadow-lg rounded-xl",children:[a.jsx("label",{htmlFor:"topic-input",className:"block text-xl font-semibold text-slate-700 mb-3",children:"輸入學習主題"}),a.jsxs("div",{className:"flex flex-col space-y-3",children:[a.jsx("input",{id:"topic-input",type:"text",value:t,onChange:f=>e(f.target.value),placeholder:"例如：光合作用、JavaScript Promises、法國大革命",className:"w-full p-3 border border-slate-400 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-600 transition-shadow bg-slate-50 text-slate-800 placeholder-slate-500",disabled:l,"aria-label":"學習主題輸入欄位"}),a.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3",children:[i&&a.jsx("button",{type:"button",onClick:u,disabled:l||!t.trim(),className:"flex-1 px-6 py-3 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 transition-colors disabled:bg-slate-400 disabled:cursor-not-allowed flex items-center justify-center",children:l?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"產生中..."]}):"🎯 選擇程度後產生"}),a.jsx("button",{type:"submit",disabled:l||!t.trim(),className:"flex-1 px-6 py-3 bg-sky-600 text-white font-semibold rounded-lg hover:bg-sky-700 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-opacity-50 transition-colors disabled:bg-slate-400 disabled:cursor-not-allowed flex items-center justify-center","aria-live":"polite",children:l?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"產生中..."]}):"⚡ 直接產生內容"})]}),i&&a.jsxs("div",{className:"text-sm text-slate-600 bg-slate-50 p-3 rounded-lg",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"🎯 選擇程度後產生："})," 先獲得學習程度建議，選擇合適程度後產生針對性內容"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"⚡ 直接產生內容："})," 立即產生包含所有程度的完整學習內容"]})]})]})]})},sn=()=>a.jsxs("div",{className:"flex flex-col items-center justify-center space-y-2",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-4 border-b-4 border-sky-600"}),a.jsx("p",{className:"text-sky-700",children:"正在產生學習內容..."})]}),Dn=({title:t,icon:e,children:n,className:i})=>a.jsxs("div",{className:`bg-white shadow-lg rounded-xl p-6 mb-6 ${i||""}`,children:[a.jsxs("h2",{className:"text-2xl font-semibold text-sky-700 mb-4 flex items-center",children:[e&&a.jsx("span",{className:"mr-3 text-sky-600",children:e}),t]}),a.jsx("div",{className:"text-slate-700 space-y-3",children:n})]}),sc=async(t,e)=>{const n=new ev({apiKey:e}),i="gemini-2.5-flash";try{const l=await n.models.generateContent({model:i,contents:t,config:{responseMimeType:"application/json"}});if(!l.text)throw new Error("AI 回傳內容為空，請重試或檢查 API 金鑰。");let o=l.text.trim();const u=/^```(\w*)?\s*\n?(.*?)\n?\s*```$/s,f=o.match(u);if(f&&f[2]&&(o=f[2].trim()),!o.startsWith("{")&&!o.startsWith("[")&&(o.includes("{")||o.includes("["))){const g=o.indexOf("{"),h=o.indexOf("[");let x=-1,v=-1;g!==-1&&(h===-1||g<h)?(x=g,v=o.lastIndexOf("}")):h!==-1&&(x=h,v=o.lastIndexOf("]")),x!==-1&&v!==-1&&v>x&&(o=o.substring(x,v+1))}try{return JSON.parse(o)}catch{throw console.error("AI 回傳原始內容 (JSON parse 失敗):",l.text),new Error("AI 模型傳回的資料格式無法解析 (可能不是有效的 JSON)。請嘗試修改您的主題或重試。")}}catch(l){let o="無法產生診斷內容。";throw l instanceof Error&&(o+=` 詳細資料： ${l.message}`),new Error(o)}},Wj=t=>{const e=new Map;return t.forEach(n=>{e.has(n.questionType)||e.set(n.questionType,{questionType:n.questionType,totalQuestions:0,correctCount:0,accuracy:0,averageTime:0,commonErrors:[],difficultyBreakdown:{easy:{total:0,correct:0,accuracy:0},normal:{total:0,correct:0,accuracy:0},hard:{total:0,correct:0,accuracy:0}}})}),t.forEach(n=>{const i=e.get(n.questionType);i.totalQuestions++,n.isCorrect&&i.correctCount++;const l=i.difficultyBreakdown[n.difficulty];l.total++,n.isCorrect&&l.correct++,l.accuracy=l.total>0?Math.round(l.correct/l.total*100):0}),e.forEach(n=>{n.accuracy=n.totalQuestions>0?Math.round(n.correctCount/n.totalQuestions*100):0;const l=t.filter(o=>o.questionType===n.questionType).filter(o=>o.responseTime).map(o=>o.responseTime);n.averageTime=l.length>0?Math.round(l.reduce((o,u)=>o+u,0)/l.length):void 0}),Array.from(e.values())},rv=t=>{if(t.length===0)return 0;const e=t.filter(n=>n.isCorrect).length;return Math.round(e/t.length*100)},Xj=t=>t>=80?"advanced":t>=60?"intermediate":"beginner",ek=async(t,e,n,i)=>{const l=e.filter(h=>!h.isCorrect),o=e.filter(h=>h.isCorrect),u=l.map(h=>`
    題型: ${h.questionType}
    難度: ${h.difficulty}
    學生答案: ${JSON.stringify(h.userAnswer)}
    正確答案: ${JSON.stringify(h.correctAnswer)}
    嘗試次數: ${h.attempts||1}`).join(`
`),f=o.map(h=>`
    題型: ${h.questionType}
    難度: ${h.difficulty}
    學生答案: ${JSON.stringify(h.userAnswer)}`).join(`
`),g=`
    針對主題「${t}」的測驗表現進行學習診斷分析。
    
    總體表現：
    - 答對題数：${o.length}
    - 答錯題数：${l.length}
    - 正確率：${Math.round(o.length/e.length*100)}%
    
    答錯題目詳細分析：${u}
    
    答對題目詳細分析：${f}
    
    請提供以下 JSON 結構的分析（不要解釋，不要額外文字）：
    {
      "strengths": [
        {
          "area": "學生的具體強項領域",
          "description": "根據答對的題目類型和內容，詳細描述學生的優勢",
          "level": "good|excellent|outstanding",
          "examples": ["從答對題目中提取的具體表現例子"],
          "leverageOpportunities": ["如何利用此強項來改善弱點的具體建議"]
        }
      ],
      "weaknesses": [
        {
          "area": "根據錯誤題目整理出的知識漏洞領域",
          "description": "分析錯誤原因：是概念不清、計算錯誤、還是理解偏差？",
          "severity": "low|medium|high",
          "affectedTopics": ["具體受影響的知識點或技能"],
          "recommendedActions": ["針對此類錯誤的具體改進方法和練習建議"]
        }
      ],
      "learningStyle": "根據答題表現推測的學習風格（如：視覺型、邏輯型、記憶型等）",
      "cognitivePattern": "認知模式分析（如：敬重細節、善於整體把握等）"
    }
    
    請用繁體中文回答，並提供對學生和教師都有價值的教育洞察。特別要針對錯誤題目做出具體分析和改進建議。
  `;try{return await sc(g,i)}catch(h){return console.error("AI 學習分析生成失敗:",h),{strengths:[],weaknesses:[],learningStyle:"無法分析",cognitivePattern:"需要更多數據"}}},tk=async(t,e,n,i,l,o)=>{const u=`
    Generate personalized learning recommendations for a student based on their performance analysis.
    
    Context:
    - Topic: "${t}"
    - Overall Score: ${e}%
    - Learning Level: ${n}
    - Key Strengths: ${i.map(f=>f.area).join(", ")}
    - Areas for Improvement: ${l.map(f=>f.area).join(", ")}
    
    Please provide 3-5 personalized recommendations in the following JSON structure (no explanation, no extra text):
    {
      "recommendations": [
        {
          "category": "immediate|short-term|long-term",
          "priority": "high|medium|low",
          "title": "建議標題",
          "description": "詳細說明為什麼需要這個建議",
          "actionSteps": ["具體行動步驟1", "具體行動步驟2"],
          "expectedOutcome": "預期能達到的成果",
          "estimatedTime": "預估需要投入的時間",
          "resources": ["推薦的學習資源"]
        }
      ]
    }
    
    Focus on actionable, specific recommendations that consider the student's current level and identified strengths/weaknesses.
    Respond in Traditional Chinese (繁體中文).
  `;try{return(await sc(u,o)).recommendations||[]}catch(f){return console.error("AI 個人化建議生成失敗:",f),[]}},nk=async(t,e,n,i,l,o,u,f,g)=>{const x=((g==null?void 0:g.filter(N=>!N.isCorrect))||[]).map(N=>`
  - ${N.questionType} (難度: ${N.difficulty}): 你的答案「${JSON.stringify(N.userAnswer)}」，正確答案是「${JSON.stringify(N.correctAnswer)}」`).join(""),v=`
    為學生提供關於主題「${t}」的學習回饋和指導。
    
    表現概要：
    - 總分：${e}%
    - 學習水平：${n}
    - 主要強項：${l.map(N=>N.area).join("、")}
    - 需要改進的領域：${o.map(N=>N.area).join("、")}
    
    錯誤題目詳情：${x}
    
    請提供學生友善的回饋，使用以下 JSON 結構（不要解釋，不要額外文字）：
    {
      "encouragementMessage": "根據實際分數給出的鼓勵訊息，要具體且正面",
      "keyStrengths": ["從答對的題目中發現的具體強項", "另一個強項", "第三個強項"],
      "improvementAreas": ["根據錯誤題目整理的具體需加強領域", "另一個需加強領域"],
      "nextSteps": ["針對錯誤題目的具體改進行動", "強化練習建議", "補強知識漏洞的方法"],
      "studyTips": ["針對錯誤類型的實用學習技巧", "加強記憶的方法", "提高理解的策略"],
      "motivationalQuote": "激勵學生繼續努力的結尾話"
    }
    
    使用鼓勵、正向的語言，適合學生閱讀。重點關注成長心態和可實行的建議。
    請用繁體中文回答，特別要針對具體錯誤提供有針對性的改進建議。
  `;try{const N=await sc(v,u);return{studentId:f,overallScore:e,overallLevel:n,encouragementMessage:N.encouragementMessage||"你的學習表現很棒！",keyStrengths:N.keyStrengths||[],improvementAreas:N.improvementAreas||[],nextSteps:N.nextSteps||[],studyTips:N.studyTips||[],motivationalQuote:N.motivationalQuote||"持續努力，你會更進步！"}}catch(N){return console.error("AI 學生回饋生成失敗:",N),{studentId:f,overallScore:e,overallLevel:n,encouragementMessage:"你的學習表現很棒！繼續保持這個學習態度。",keyStrengths:["積極參與測驗","展現學習動機"],improvementAreas:["需要更多練習"],nextSteps:["重新檢視錯誤題目","加強基礎概念","定期練習"],studyTips:["制定規律的學習時間","多做類似練習題","請教老師或同學"],motivationalQuote:"每一次練習都讓你更接近目標！"}}},ik=async(t,e,n,i,l,o,u)=>{const g=((u==null?void 0:u.filter(x=>!x.isCorrect))||[]).map(x=>`
  - 題型: ${x.questionType}, 難度: ${x.difficulty}
    學生答案: ${JSON.stringify(x.userAnswer)}
    正確答案: ${JSON.stringify(x.correctAnswer)}
    嘗試次數: ${x.attempts||1}`).join(""),h=`
    為主題「${t}」提供教學建議，根據學生評量結果。
    
    表現概要：
    - 總體表現：${e}%
    - 強項：${i.map(x=>x.area).join("、")}
    - 需要支援的領域：${l.map(x=>x.area).join("、")}
    - 各題型表現：${n.map(x=>`${x.questionType}: ${x.accuracy}%`).join("、")}
    
    具體錯誤模式分析：${g}
    
    請提供教學建議，使用以下 JSON 結構（不要解釋，不要額外文字）：
    {
      "immediateInterventions": ["根據具體錯誤類型提供的立即介入措施", "針對知識漏洞的急需處理方法"],
      "instructionalStrategies": ["針對錯誤模式的教學策略", "加強理解的教學方法", "預防相似錯誤的策略"],
      "differentiation": ["根據錯誤類型設計的差異化教學", "適合不同學習風格的調整"],
      "parentGuidance": ["家長在家輔導的具體建議", "家庭練習的重點領域"]
    }
    
    重點在於實用、基於證據的教學策略，並針對識別出的強項和弱點提供具體建議。
    請用繁體中文回答，特別要針對學生的具體錯誤提供有針對性的教學建議。
  `;try{const x=await sc(h,o);return{immediateInterventions:x.immediateInterventions||[],instructionalStrategies:x.instructionalStrategies||[],differentiation:x.differentiation||[],parentGuidance:x.parentGuidance||[]}}catch(x){return console.error("AI 教學建議生成失敗:",x),{immediateInterventions:[],instructionalStrategies:[],differentiation:[],parentGuidance:[]}}},rk=async(t,e,n={includeDetailedAnalysis:!0,includeComparativeData:!1,includeVisualCharts:!1,language:"zh-TW",reportFormat:"standard"})=>{try{const i=Wj(t.responses),l=rv(t.responses),o=Xj(l),u=await ek(t.topic,t.responses,i,e),f=await tk(t.topic,l,o,u.strengths,u.weaknesses,e),g=await nk(t.topic,l,o,i,u.strengths,u.weaknesses,e,t.studentId,t.responses),h=await ik(t.topic,l,i,u.strengths,u.weaknesses,e,t.responses),x={studentId:t.studentId,assessmentDate:new Date().toISOString(),topic:t.topic,overallPerformance:{totalScore:l,level:o,timeSpent:t.endTime&&t.startTime?Math.round((new Date(t.endTime).getTime()-new Date(t.startTime).getTime())/6e4):0},performanceByType:i,learningAnalysis:u,teachingRecommendations:h,personalizedRecommendations:f,progressTracking:{keyMetrics:["正確率提升","回答速度","概念理解深度"],checkpoints:["一週後複習","兩週後小測驗","一個月後綜合評估"],reassessmentSuggestion:"建議在完成建議的學習活動後，於 2-3 週內進行重新評估"}};return{session:t,studentFeedback:g,teacherReport:x,rawData:{responses:t.responses,statistics:i}}}catch(i){throw console.error("生成學習診斷失敗:",i),new Error("無法生成學習診斷報告，請稍後重試")}},Yo=(t,e)=>({sessionId:`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,studentId:e,topic:t,startTime:new Date().toISOString(),responses:[],isCompleted:!1,metadata:{userAgent:navigator.userAgent,deviceType:/Mobi|Android/i.test(navigator.userAgent)?"mobile":"desktop"}}),Do=t=>({...t,endTime:new Date().toISOString(),isCompleted:!0}),Df=({className:t})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:t||"w-6 h-6",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.31M8.25 18.75a12.064 12.064 0 0 0 7.5 0M12 6.75a2.25 2.25 0 1 1 0 4.5 2.25 2.5 0 0 1 0-4.5ZM12 6.75V3.75m0 3a12.022 12.022 0 0 0-5.483 1.348M12 6.75a12.022 12.022 0 0 1 5.483 1.348"})}),Zo=({className:t})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:t||"w-6 h-6",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6-2.292m0 0V3.75m0 12.15V21"})}),Ja=({className:t})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:t||"w-6 h-6",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.25 7.756a4.5 4.5 0 1 0 0 8.488M7.5 10.5h5.25m-5.25 3h5.25M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),Nr=({className:t})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:t||"w-6 h-6",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),Sr=({className:t})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:t||"w-6 h-6",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),Pn=({className:t})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:t||"w-6 h-6",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.26 10.147a60.438 60.438 0 0 0-.491 6.347A48.627 48.627 0 0 1 12 20.904a48.627 48.627 0 0 1 8.232-4.41 60.46 60.46 0 0 0-.491-6.347m-15.482 0a50.57 50.57 0 0 0-2.658-.813A59.906 59.906 0 0 1 12 3.493a59.903 59.903 0 0 1 10.399 5.84c-.896.248-1.783.52-2.658.814m-15.482 0A50.697 50.697 0 0 1 12 13.489a50.702 50.702 0 0 1 7.74-3.342M6.75 15a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Zm0 0v-3.675A55.378 55.378 0 0 1 12 8.443m-7.007 11.55A5.981 5.981 0 0 0 6.75 15.75v-1.5"})}),sk=({className:t})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:t||"w-6 h-6",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m5.231 13.481L15 17.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Zm3.75 11.625a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z"})}),ak=({className:t})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:t||"w-6 h-6",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"})}),lk=({className:t})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:t||"w-6 h-6",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"})}),ok=({className:t})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:t||"w-6 h-6",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18.75a6 6 0 0 0 6-6v-1.5m-6 7.5a6 6 0 0 1-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15c-1.13 0-2.25-.264-3.25-.73A4.505 4.505 0 0 1 5.25 9.75V8.25A6.75 6.75 0 0 1 12 1.5a6.75 6.75 0 0 1 6.75 6.75v1.5a4.505 4.505 0 0 1-3.5 4.52M12 15V8.25"})}),ck=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:t||"w-6 h-6",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9.563C9 9.254 9.254 9 9.563 9h4.874c.309 0 .563.254.563.563v4.874c0 .309-.254.563-.563.563H9.563A.562.562 0 0 1 9 14.437V9.564Z"})]}),Lf=({className:t})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:t||"w-6 h-6",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193-.34.027-.68.052-1.02.072v3.091l-2.184-2.183a1.724 1.724 0 0 0-1.235-.517H7.72c-1.137 0-2.1-.847-2.193-1.98A11.974 11.974 0 0 1 5.5 13H4.75a2.25 2.25 0 0 1-2.25-2.25V6.75a2.25 2.25 0 0 1 2.25-2.25h4.718c.468 0 .92.052 1.354.143L12 6l2.454-2.454L16.5 6h1.252a2.25 2.25 0 0 1 2.25 2.25v.233Z"})}),Ns=({className:t})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:t||"w-6 h-6",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"})}),Pf=({className:t})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:t||"w-6 h-6",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),Md=({className:t})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:t||"w-6 h-6",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.217 10.907a2.25 2.25 0 1 0 0 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186 9.566-5.314m-9.566 7.5 9.566 5.314m0 0a2.25 2.25 0 1 0 3.935 2.186 2.25 2.25 0 0 0-3.935-2.186Zm0-11.314a2.25 2.25 0 1 0 3.935-2.186 2.25 2.25 0 0 0-3.935 2.186Z"})}),uk=({className:t})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:t||"w-6 h-6",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})}),sy=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:t||"w-6 h-6",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})]}),rm=({question:t,itemNumber:e,onAnswer:n})=>{const[i,l]=M.useState(null),[o,u]=M.useState(null),[f,g]=M.useState(0);M.useEffect(()=>{l(null),u(null),g(Date.now())},[t]);const h=x=>{l(x);const v=x===t.isTrue;let N=v?"答對了！":"答錯了。";v||(N+=` 正確答案是：${t.isTrue?"是 (True)":"非 (False)"}。`),u({isCorrect:v,message:N,explanation:t.explanation});const w=f>0?Date.now()-f:void 0;n&&n(x,v,w)};return a.jsxs("div",{className:"p-4 border border-slate-200 rounded-lg bg-slate-50 mb-3",children:[a.jsxs("p",{className:"font-medium text-slate-700 mb-2",children:[e,". ",t.statement||"題目載入中..."]}),a.jsxs("div",{className:"flex space-x-3 mb-3",children:[a.jsx("button",{onClick:()=>h(!0),className:`px-6 py-2 rounded-md font-medium transition-all
            ${i===!0?o!=null&&o.isCorrect?"bg-green-500 text-white ring-2 ring-green-300":"bg-red-500 text-white ring-2 ring-red-300":"bg-slate-200 hover:bg-slate-300 text-slate-700"}
          `,"aria-pressed":i===!0,disabled:o!==null,children:"是 (True)"}),a.jsx("button",{onClick:()=>h(!1),className:`px-6 py-2 rounded-md font-medium transition-all
            ${i===!1?o!=null&&o.isCorrect?"bg-green-500 text-white ring-2 ring-green-300":"bg-red-500 text-white ring-2 ring-red-300":"bg-slate-200 hover:bg-slate-300 text-slate-700"}
          `,"aria-pressed":i===!1,disabled:o!==null,children:"非 (False)"})]}),o&&a.jsxs("div",{className:`mt-2 p-2 rounded-md text-sm flex flex-col items-start ${o.isCorrect?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[a.jsxs("div",{className:"flex items-center",children:[o.isCorrect?a.jsx(Nr,{className:"w-5 h-5 mr-2"}):a.jsx(Sr,{className:"w-5 h-5 mr-2"}),o.message]}),o.explanation&&a.jsx("p",{className:"mt-1 pl-7 text-xs italic",children:o.explanation})]})]})},sm=({question:t,itemNumber:e,onAnswer:n})=>{const[i,l]=M.useState(null),[o,u]=M.useState(null),[f,g]=M.useState(0);M.useEffect(()=>{l(null),u(null),g(Date.now())},[t]);const h=()=>{if(i===null){u({isCorrect:!1,message:"請選擇一個選項。"});return}const x=i===t.correctAnswerIndex;u({isCorrect:x,message:x?"答對了！":`答錯了。正確答案是： ${(t.options||[])[t.correctAnswerIndex]||"未知"}`});const v=f>0?Date.now()-f:void 0;n&&n(i,x,v)};return a.jsxs("div",{className:"p-4 border border-slate-200 rounded-lg bg-slate-50 mb-3",children:[a.jsxs("p",{className:"font-medium text-slate-700 mb-2",children:[e,". ",t.question]}),a.jsx("div",{className:"space-y-2 mb-3",children:(t.options||[]).map((x,v)=>a.jsxs("label",{className:`flex items-center p-2 border rounded-md cursor-pointer hover:bg-sky-50 transition-colors ${i===v?"bg-sky-100 border-sky-500":"border-slate-300"} ${o!==null?"cursor-not-allowed opacity-70":""}`,children:[a.jsx("input",{type:"radio",name:`mcq-${e}-${t.question}`,value:v,checked:i===v,onChange:()=>{o===null&&l(v)},className:"mr-2 h-4 w-4 text-sky-600 focus:ring-sky-500 border-slate-400",disabled:o!==null}),x]},v))}),a.jsx("button",{onClick:h,className:"px-4 py-2 bg-sky-500 text-white rounded-md hover:bg-sky-600 transition-colors disabled:bg-slate-400",disabled:o!==null||i===null,children:"檢查答案"}),o&&a.jsxs("div",{className:`mt-2 p-2 rounded-md text-sm flex items-center ${o.isCorrect?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[o.isCorrect?a.jsx(Nr,{className:"w-5 h-5 mr-2"}):a.jsx(Sr,{className:"w-5 h-5 mr-2"}),o.message]})]})},sv=({question:t,itemNumber:e,onAnswer:n})=>{var v;const[i,l]=M.useState(""),[o,u]=M.useState(null),[f,g]=M.useState(0);M.useEffect(()=>{l(""),u(null),g(Date.now())},[t]);const h=N=>{if(N.preventDefault(),!i.trim()){u({isCorrect:!1,message:"請輸入答案。"});return}const w=i.trim().toLowerCase()===t.correctAnswer.toLowerCase();u({isCorrect:w,message:w?"答對了！":`答錯了。正確答案是： ${t.correctAnswer}`});const C=f>0?Date.now()-f:void 0;n&&n(i.trim(),w,C)},x=((v=t.sentenceWithBlank)==null?void 0:v.split("____"))||["",""];return a.jsxs("div",{className:"p-4 border border-slate-200 rounded-lg bg-slate-50 mb-3",children:[a.jsxs("form",{onSubmit:h,className:"space-y-2",children:[a.jsxs("label",{htmlFor:`fillblank-${e}-${t.sentenceWithBlank}`,className:"font-medium text-slate-700 mb-1 block",children:[e,". ",x[0],a.jsx("input",{id:`fillblank-${e}-${t.sentenceWithBlank}`,type:"text",value:i,onChange:N=>{o===null&&l(N.target.value)},className:"mx-1 p-1 border-b-2 border-slate-400 focus:border-sky-500 outline-none w-24 sm:w-32 bg-transparent",placeholder:"答案",disabled:o!==null}),x[1]]}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-sky-500 text-white rounded-md hover:bg-sky-600 transition-colors disabled:bg-slate-400",disabled:o!==null||!i.trim(),children:"檢查"})]}),o&&a.jsxs("div",{className:`mt-2 p-2 rounded-md text-sm flex items-center ${o.isCorrect?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[o.isCorrect?a.jsx(Nr,{className:"w-5 h-5 mr-2"}):a.jsx(Sr,{className:"w-5 h-5 mr-2"}),o.message]})]})},av=({question:t,itemNumber:e,onAnswer:n})=>{const[i,l]=M.useState([]),[o,u]=M.useState([]),[f,g]=M.useState(null),[h,x]=M.useState(0);M.useEffect(()=>{const j=t.scrambledWords||[];u([...j].sort(()=>Math.random()-.5)),l([]),g(null),x(Date.now())},[t]);const v=(j,k)=>{l([...i,j]);const E=[...o];E.splice(k,1),u(E),f&&g(null)},N=(j,k)=>{u([...o,j]);const E=[...i];E.splice(k,1),l(E),f&&g(null)},w=()=>{const j=t.scrambledWords||[];u([...j].sort(()=>Math.random()-.5)),l([]),f&&g(null)},C=()=>{const j=i.join(" ").trim(),k=D=>D.toLowerCase().replace(/[.,!?;:]/g,"").replace(/\s+/g," ").trim(),E=k(j)===k(t.originalSentence);g({isCorrect:E,message:E?"答對了！":`答錯了。正確句子是： "${t.originalSentence}"`});const L=h>0?Date.now()-h:void 0;n&&n(j,E,L)};return a.jsxs("div",{className:"p-4 border border-slate-200 rounded-lg bg-slate-50 mb-3",children:[a.jsxs("p",{className:"font-medium text-slate-700 mb-2",children:[e,". 請重組句子："]}),a.jsx("div",{className:"mb-3 p-3 border border-dashed border-slate-400 rounded-md min-h-[40px] bg-white flex flex-wrap gap-2",children:i.length>0?i.map((j,k)=>a.jsx("button",{onClick:()=>N(j,k),className:"px-2 py-1 bg-sky-200 text-sky-800 rounded-md hover:bg-sky-300 transition-colors",children:j},`${j}-${k}-constructed`)):a.jsx("span",{className:"text-slate-400 italic",children:"點擊下方詞彙來組成句子"})}),a.jsx("div",{className:"mb-3 flex flex-wrap gap-2",children:o.map((j,k)=>a.jsx("button",{onClick:()=>v(j,k),className:"px-2 py-1 bg-slate-200 text-slate-700 rounded-md hover:bg-slate-300 transition-colors",children:j},`${j}-${k}-available`))}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{onClick:C,className:"px-4 py-2 bg-sky-500 text-white rounded-md hover:bg-sky-600 transition-colors",children:"檢查句子"}),a.jsx("button",{onClick:w,className:"px-4 py-2 bg-slate-500 text-white rounded-md hover:bg-slate-600 transition-colors",children:"清除"})]}),f&&a.jsxs("div",{className:`mt-3 p-2 rounded-md text-sm flex items-center ${f.isCorrect?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[f.isCorrect?a.jsx(Nr,{className:"w-5 h-5 mr-2"}):a.jsx(Sr,{className:"w-5 h-5 mr-2"}),f.message]})]})};function dk(t){const e=[...t];for(let n=e.length-1;n>0;n--){const i=Math.floor(Math.random()*(n+1));[e[n],e[i]]=[e[i],e[n]]}return e}const am=({question:t,itemNumber:e,onAnswer:n})=>{const[i,l]=M.useState([]),[o,u]=M.useState([]),[f,g]=M.useState(0),[h,x]=M.useState(0),[v,N]=M.useState(!1),[w,C]=M.useState(0);M.useEffect(()=>{let E=0;const L=(t.pairs||[]).flatMap((D,O)=>[{id:E++,content:D.question,pairId:O,isFlipped:!1,isMatched:!1},{id:E++,content:D.answer,pairId:O,isFlipped:!1,isMatched:!1}]);l(dk(L)),u([]),g(0),x(0),N(!1),C(Date.now())},[t]);const j=E=>{if(i[E].isFlipped||i[E].isMatched||o.length===2||v)return;const L=i.map((O,H)=>H===E?{...O,isFlipped:!0}:O),D=[...o,E];if(l(L),u(D),D.length===2&&x(O=>O+1),D.length===2){const[O,H]=D;L[O].pairId===L[H].pairId?setTimeout(()=>{l(I=>I.map((R,q)=>q===O||q===H?{...R,isMatched:!0}:R)),u([]),g(I=>I+1)},600):setTimeout(()=>{l(I=>I.map((R,q)=>q===O||q===H?{...R,isFlipped:!1}:R)),u([])},900)}},k=f===(t.pairs||[]).length;return M.useEffect(()=>{if(k&&!v&&n){N(!0);const E=w>0?Date.now()-w:void 0;n(h,!0,E)}},[k,v,h,n,w]),a.jsxs("div",{className:"mb-4 p-4 border rounded bg-slate-50",children:[a.jsxs("div",{className:"font-semibold mb-2",children:[e,". 翻卡牌記憶遊戲"]}),t.instructions&&a.jsx("div",{className:"mb-2 text-sky-700 text-sm",children:t.instructions}),a.jsxs("div",{className:"mb-3 text-sm text-gray-600 flex justify-between items-center",children:[a.jsxs("span",{children:["配對進度: ",f,"/",(t.pairs||[]).length]}),a.jsxs("span",{children:["嘗試次數: ",h]}),k&&a.jsx("span",{className:"text-green-600 font-medium",children:"✅ 遊戲完成！"})]}),a.jsx("div",{className:"grid grid-cols-4 gap-3 max-w-xl mx-auto mb-2",children:i.map((E,L)=>a.jsxs("button",{className:`relative h-20 w-full rounded shadow border transition-transform duration-200 ${E.isMatched?"bg-green-200 border-green-400":"bg-white border-slate-300"} ${E.isFlipped||E.isMatched?"":"hover:scale-105"}`,onClick:()=>j(L),disabled:E.isFlipped||E.isMatched||o.length===2,style:{perspective:"600px"},children:[a.jsx("div",{className:`absolute inset-0 flex items-center justify-center text-base font-medium transition-all duration-300 ${E.isFlipped||E.isMatched?"opacity-100 rotate-y-0":"opacity-0 rotate-y-180"}`,style:{backfaceVisibility:"hidden",transform:E.isFlipped||E.isMatched?"rotateY(0deg)":"rotateY(180deg)"},children:E.content}),a.jsx("div",{className:`absolute inset-0 flex items-center justify-center text-2xl font-bold text-sky-600 transition-all duration-300 ${E.isFlipped||E.isMatched?"opacity-0 rotate-y-180":"opacity-100 rotate-y-0"}`,style:{backfaceVisibility:"hidden",transform:E.isFlipped||E.isMatched?"rotateY(180deg)":"rotateY(0deg)"},children:"?"})]},E.id))}),k&&a.jsx("div",{className:"text-green-600 font-semibold mt-2",children:"恭喜！全部配對成功！"})]})},rl="https://api.jsonbin.io/v3/b",Ds="$2a$10$0PieG5Wm.V.6svtN4PbaTuVxU4LY0nL2Vaz4N3g2aYlb0cL1NG4Qa";async function Qo(t){const n=await(await fetch(rl,{method:"POST",headers:{"Content-Type":"application/json","X-Master-Key":Ds,"X-Bin-Private":"false"},body:JSON.stringify(t)})).json();if(!n||!n.metadata||!n.metadata.id)throw new Error("無法取得 jsonbin id");return n.metadata.id}async function ac(t){const n=await(await fetch(`https://api.jsonbin.io/v3/b/${t}/latest`,{})).json();if(!n||!n.record)throw new Error("找不到對應的教學方案");return n.record}async function fk(t){const e={type:"quiz",quiz:t.quiz,topic:t.topic,apiKey:t.apiKey,metadata:t.metadata,createdAt:new Date().toISOString(),supportsDiagnostic:!!t.apiKey},i=await(await fetch(rl,{method:"POST",headers:{"Content-Type":"application/json","X-Master-Key":Ds,"X-Bin-Private":"false"},body:JSON.stringify(e)})).json();if(!i||!i.metadata||!i.metadata.id)throw new Error("無法儲存測驗內容");return i.metadata.id}async function mk(t){const n=await(await fetch(`https://api.jsonbin.io/v3/b/${t}/latest`,{})).json();if(!n||!n.record)throw new Error("找不到對應的測驗內容");const i=n.record;if(i.type!=="quiz")throw new Error("此連結不是測驗專用分享");return{quiz:i.quiz,topic:i.topic,apiKey:i.apiKey,supportsDiagnostic:i.supportsDiagnostic||!1,metadata:i.metadata}}async function hk(t){const e={type:"writing",writingPractice:t.writingPractice,topic:t.topic,metadata:t.metadata,createdAt:new Date().toISOString()},i=await(await fetch(rl,{method:"POST",headers:{"Content-Type":"application/json","X-Master-Key":Ds,"X-Bin-Private":"false"},body:JSON.stringify(e)})).json();if(!i||!i.metadata||!i.metadata.id)throw new Error("無法儲存寫作練習內容");return i.metadata.id}async function pk(t){const n=await(await fetch(`https://api.jsonbin.io/v3/b/${t}/latest`,{})).json();if(!n||!n.record)throw new Error("找不到對應的寫作練習內容");const i=n.record;if(i.type!=="writing")throw new Error("此連結不是寫作練習專用分享");return{writingPractice:i.writingPractice,topic:i.topic,metadata:i.metadata}}async function gk(t){const e={type:"student-results",...t,createdAt:new Date().toISOString()},i=await(await fetch(rl,{method:"POST",headers:{"Content-Type":"application/json","X-Master-Key":Ds,"X-Bin-Private":"false"},body:JSON.stringify(e)})).json();if(!i||!i.metadata||!i.metadata.id)throw new Error("無法儲存學生作答結果");return i.metadata.id}async function lv(t){const n=await(await fetch(`https://api.jsonbin.io/v3/b/${t}/latest`,{})).json();if(!n||!n.record)throw new Error("找不到對應的學生作答結果");const i=n.record;if(i.type!=="student-results")throw new Error("此連結不是學生作答結果專用分享");return{studentName:i.studentName,topic:i.topic,difficulty:i.difficulty,responses:i.responses,overallScore:i.overallScore,completedAt:i.completedAt,quizBinId:i.quizBinId,quizContent:i.quizContent,metadata:i.metadata,diagnosticReport:i.diagnosticReport}}async function xk(t,e){const l={type:"student-results",...{...await lv(t),diagnosticReport:{...e,generatedAt:new Date().toISOString(),resultsBinId:t},updatedAt:new Date().toISOString()}},u=await(await fetch(`https://api.jsonbin.io/v3/b/${t}`,{method:"PUT",headers:{"Content-Type":"application/json","X-Master-Key":Ds},body:JSON.stringify(l)})).json();if(!u||!u.metadata)throw new Error("無法更新學生作答結果")}async function ov(t){const e={type:"conversation-practice",practice:t.practice,metadata:t.metadata,createdAt:new Date().toISOString()},i=await(await fetch(rl,{method:"POST",headers:{"Content-Type":"application/json","X-Master-Key":Ds,"X-Bin-Private":"false"},body:JSON.stringify(e)})).json();if(!i||!i.metadata||!i.metadata.id)throw new Error("無法儲存英文對話練習內容");return i.metadata.id}async function yk(t){const n=await(await fetch(`https://api.jsonbin.io/v3/b/${t}/latest`,{})).json();if(!n||!n.record)throw new Error("找不到對應的分享內容");return n.record}const vk=({feedback:t,onContinueLearning:e,onRetakeQuiz:n,showActions:i=!0})=>{const l=h=>h>=80?"text-green-600 bg-green-100":h>=60?"text-yellow-600 bg-yellow-100":"text-red-600 bg-red-100",o=h=>h>=80?"border-green-200":h>=60?"border-yellow-200":"border-red-200",u=h=>{switch(h){case"advanced":return a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-8 h-8 text-green-600",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 18.75h-9m9 0a3 3 0 0 1 3 3h-15a3 3 0 0 1 3-3m9 0v-3.375c0-.621-.503-1.125-1.125-1.125h-.871M7.5 18.75v-3.375c0-.621.504-1.125 1.125-1.125h.872m5.007 0H9.497m5.007 0a7.454 7.454 0 0 1-.982-3.172M9.497 14.25a7.454 7.454 0 0 0 .981-3.172M5.25 4.236c-.982.143-1.954.317-2.916.52A6.003 6.003 0 0 0 7.73 9.728M5.25 4.236V4.5c0 2.108.966 3.99 2.48 5.228M5.25 4.236V2.721C7.456 2.41 9.71 2.25 12 2.25s4.544.16 6.75.471v1.515M7.73 9.728a6.726 6.726 0 0 0 2.748 1.35m8.272-6.842V4.5c0 2.108-.966 3.99-2.48 5.228m2.48-5.228V2.721A48.133 48.133 0 0 0 12 2.25c-2.291 0-4.544.16-6.75.471v1.515M7.73 9.728l3.75.814.97 4.286c.078.348.14.699.185 1.053m8.272-6.842-3.75.814-.97 4.286a24.216 24.216 0 0 1-.185 1.053M12 19.5a2.25 2.25 0 0 1-2.25-2.25V14.25m4.5 5.25a2.25 2.25 0 0 1 2.25-2.25V14.25"})});case"intermediate":return a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-8 h-8 text-yellow-600",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z"})});default:return a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-8 h-8 text-blue-600",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.26 10.147a60.438 60.438 0 0 0-.491 6.347A48.62 48.62 0 0 1 12 20.904a48.62 48.62 0 0 1 8.232-4.41 60.46 60.46 0 0 0-.491-6.347m-15.482 0a50.636 50.636 0 0 0-2.658-.813A59.906 59.906 0 0 1 12 3.493a59.903 59.903 0 0 1 10.399 5.84c-.896.248-1.783.52-2.658.814m-15.482 0A50.717 50.717 0 0 1 12 13.489a50.702 50.702 0 0 1 7.74-3.342M6.75 15a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Zm0 0v-3.675A55.378 55.378 0 0 1 12 8.443a55.381 55.381 0 0 1 5.25 2.882V15"})})}},f=h=>{switch(h){case"advanced":return"高級程度";case"intermediate":return"中級程度";default:return"初級程度"}},g=h=>{switch(h){case"advanced":return"你已經掌握了大部分概念，表現非常出色！";case"intermediate":return"你有良好的基礎，繼續努力就能更上一層樓！";default:return"這是一個很好的開始，繼續學習你會進步很快！"}};return a.jsxs("div",{className:"max-w-4xl mx-auto p-6 bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 rounded-xl shadow-lg",children:[a.jsxs("div",{className:`text-center mb-8 p-6 bg-white rounded-lg shadow-md border-2 ${o(t.overallScore)}`,children:[a.jsxs("div",{className:"flex items-center justify-center mb-4",children:[u(t.overallLevel),a.jsx("div",{className:"ml-4",children:a.jsxs("div",{className:`text-4xl font-bold px-4 py-2 rounded-full ${l(t.overallScore)}`,children:[t.overallScore,"分"]})})]}),a.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:f(t.overallLevel)}),a.jsx("p",{className:"text-lg text-gray-600",children:g(t.overallLevel)})]}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6 border-l-4 border-blue-500",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6 text-blue-500 mt-1 flex-shrink-0",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"})}),a.jsx("p",{className:"text-lg text-gray-700 leading-relaxed",children:t.encouragementMessage})]})}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("h3",{className:"text-xl font-bold text-green-700 mb-4 flex items-center gap-2",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12c0 1.268-.63 2.39-1.593 3.068a3.745 3.745 0 0 1-1.043 3.296 3.745 3.745 0 0 1-3.296 1.043A3.745 3.745 0 0 1 12 21c-1.268 0-2.39-.63-3.068-1.593a3.746 3.746 0 0 1-3.296-1.043 3.745 3.745 0 0 1-1.043-3.296A3.745 3.745 0 0 1 3 12c0-1.268.63-2.39 1.593-3.068a3.745 3.745 0 0 1 1.043-3.296 3.746 3.746 0 0 1 3.296-1.043A3.746 3.746 0 0 1 12 3c1.268 0 2.39.63 3.068 1.593a3.746 3.746 0 0 1 3.296 1.043 3.745 3.745 0 0 1 1.043 3.296A3.745 3.745 0 0 1 21 12Z"})}),"🌟 你的強項"]}),t.keyStrengths.length>0?a.jsx("ul",{className:"space-y-3",children:t.keyStrengths.map((h,x)=>a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"text-green-500 mt-1.5",children:"✓"}),a.jsx("span",{className:"text-gray-700",children:h})]},x))}):a.jsx("p",{className:"text-gray-500 italic",children:"繼續努力發掘你的學習強項！"})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("h3",{className:"text-xl font-bold text-orange-700 mb-4 flex items-center gap-2",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"})}),"💡 成長空間"]}),t.improvementAreas.length>0?a.jsx("ul",{className:"space-y-3",children:t.improvementAreas.map((h,x)=>a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"text-orange-500 mt-1.5",children:"→"}),a.jsx("span",{className:"text-gray-700",children:h})]},x))}):a.jsx("p",{className:"text-gray-500 italic",children:"你的表現很全面，繼續保持！"})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[a.jsxs("h3",{className:"text-xl font-bold text-blue-700 mb-4 flex items-center gap-2",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z"})}),"🎯 下一步行動"]}),t.nextSteps.length>0?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.nextSteps.map((h,x)=>a.jsxs("div",{className:"flex items-start gap-3 p-3 bg-blue-50 rounded-lg border border-blue-200",children:[a.jsx("span",{className:"bg-blue-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold flex-shrink-0 mt-0.5",children:x+1}),a.jsx("span",{className:"text-gray-700",children:h})]},x))}):a.jsx("p",{className:"text-gray-500 italic",children:"你已經準備好繼續下一個學習階段了！"})]}),a.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg shadow-md p-6 mb-6 border border-purple-200",children:[a.jsxs("h3",{className:"text-xl font-bold text-purple-700 mb-4 flex items-center gap-2",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"})}),"💎 學習小貼士"]}),t.studyTips.length>0?a.jsx("ul",{className:"space-y-2",children:t.studyTips.map((h,x)=>a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"text-purple-500 mt-1",children:"💡"}),a.jsx("span",{className:"text-gray-700",children:h})]},x))}):a.jsx("p",{className:"text-gray-500 italic",children:"繼續保持你的學習習慣！"})]}),a.jsxs("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-600 rounded-lg shadow-lg p-6 text-center text-white mb-6",children:[a.jsx("div",{className:"flex items-center justify-center mb-3",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-8 h-8",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z"})})}),a.jsxs("p",{className:"text-xl font-medium italic",children:['"',t.motivationalQuote,'"']})]}),i&&a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[a.jsxs("button",{onClick:e,className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-lg hover:from-blue-700 hover:to-indigo-700 transition-all transform hover:scale-105 shadow-md flex items-center justify-center gap-2 font-medium",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5 21 12l-7.5 7.5M3 12h16.5"})}),"繼續學習"]}),a.jsxs("button",{onClick:n,className:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all transform hover:scale-105 shadow-md flex items-center justify-center gap-2 font-medium",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"})}),"重新測驗"]})]})]})},bk=({report:t,onExportReport:e,onSaveReport:n,showExportOptions:i=!0})=>{const[l,o]=M.useState("overview"),u=w=>w>=80?"text-green-600 bg-green-50 border-green-200":w>=60?"text-yellow-600 bg-yellow-50 border-yellow-200":"text-red-600 bg-red-50 border-red-200",f=w=>{switch(w){case"high":return"text-red-600 bg-red-100 border-red-200";case"medium":return"text-yellow-600 bg-yellow-100 border-yellow-200";case"low":return"text-blue-600 bg-blue-100 border-blue-200"}},g=w=>{switch(w){case"outstanding":return"text-purple-600 bg-purple-100 border-purple-200";case"excellent":return"text-green-600 bg-green-100 border-green-200";case"good":return"text-blue-600 bg-blue-100 border-blue-200"}},h=w=>{switch(w){case"high":return"text-red-600 bg-red-50 border-l-red-500";case"medium":return"text-yellow-600 bg-yellow-50 border-l-yellow-500";case"low":return"text-green-600 bg-green-50 border-l-green-500"}},x=w=>({trueFalse:"是非題",multipleChoice:"選擇題",fillInTheBlanks:"填空題",sentenceScramble:"句子重組",memoryCardGame:"翻卡記憶"})[w]||w,v=w=>new Date(w).toLocaleDateString("zh-TW",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),N=[{key:"overview",label:"總覽",icon:"📊"},{key:"performance",label:"表現詳情",icon:"📈"},{key:"analysis",label:"學習分析",icon:"🔍"},{key:"recommendations",label:"個人化建議",icon:"💡"},{key:"teaching",label:"教學指導",icon:"🎯"}];return a.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-gray-50 min-h-screen",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"學習診斷報告"}),a.jsxs("p",{className:"text-gray-600",children:["主題：",a.jsx("span",{className:"font-semibold",children:t.topic})]}),a.jsxs("p",{className:"text-gray-600",children:["評估日期：",v(t.assessmentDate)]}),t.studentId&&a.jsxs("p",{className:"text-gray-600",children:["學生ID：",a.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:t.studentId})]})]}),i&&a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("button",{onClick:n,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0 1 11.186 0Z"})}),"儲存報告"]}),a.jsxs("button",{onClick:e,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"})}),"匯出報告"]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[a.jsx("h3",{className:"text-sm font-semibold text-blue-700 mb-1",children:"整體得分"}),a.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[t.overallPerformance.totalScore,"分"]})]}),a.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 border border-purple-200",children:[a.jsx("h3",{className:"text-sm font-semibold text-purple-700 mb-1",children:"學習水準"}),a.jsx("p",{className:"text-lg font-semibold text-purple-600 capitalize",children:t.overallPerformance.level})]}),a.jsxs("div",{className:"bg-green-50 rounded-lg p-4 border border-green-200",children:[a.jsx("h3",{className:"text-sm font-semibold text-green-700 mb-1",children:"強項數量"}),a.jsx("p",{className:"text-2xl font-bold text-green-600",children:t.learningAnalysis.strengths.length})]}),a.jsxs("div",{className:"bg-orange-50 rounded-lg p-4 border border-orange-200",children:[a.jsx("h3",{className:"text-sm font-semibold text-orange-700 mb-1",children:"改進領域"}),a.jsx("p",{className:"text-2xl font-bold text-orange-600",children:t.learningAnalysis.weaknesses.length})]})]})]}),a.jsx("div",{className:"bg-white rounded-lg shadow-md mb-6",children:a.jsx("div",{className:"flex overflow-x-auto",children:N.map(w=>a.jsxs("button",{onClick:()=>o(w.key),className:`flex-shrink-0 px-6 py-4 font-medium text-sm border-b-2 transition-colors ${l===w.key?"border-blue-500 text-blue-600 bg-blue-50":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx("span",{className:"mr-2",children:w.icon}),w.label]},w.key))})}),a.jsxs("div",{className:"space-y-6",children:[l==="overview"&&a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"整體表現"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"總分："}),a.jsxs("span",{className:"font-semibold",children:[t.overallPerformance.totalScore,"/100"]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"學習水準："}),a.jsx("span",{className:"font-semibold capitalize",children:t.overallPerformance.level})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"完成時間："}),a.jsxs("span",{className:"font-semibold",children:[t.overallPerformance.timeSpent," 分鐘"]})]}),t.overallPerformance.percentile&&a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"百分位數："}),a.jsxs("span",{className:"font-semibold",children:["前 ",100-t.overallPerformance.percentile,"%"]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"認知分析"}),a.jsxs("div",{className:"space-y-3",children:[t.learningAnalysis.learningStyle&&a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"學習風格："}),a.jsx("span",{className:"ml-2 font-semibold",children:t.learningAnalysis.learningStyle})]}),t.learningAnalysis.cognitivePattern&&a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"認知模式："}),a.jsx("span",{className:"ml-2 font-semibold",children:t.learningAnalysis.cognitivePattern})]}),a.jsx("div",{className:"pt-2",children:a.jsx("p",{className:"text-sm text-gray-500",children:"基於答題模式、反應時間和錯誤類型的綜合分析"})})]})]})]}),l==="performance"&&a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-6",children:"各題型表現分析"}),a.jsx("div",{className:"space-y-6",children:t.performanceByType.map(w=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:x(w.questionType)}),a.jsxs("div",{className:`px-3 py-1 rounded-full text-sm font-medium border ${u(w.accuracy)}`,children:[w.accuracy,"% 正確率"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-sm text-gray-600",children:"總題數"}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:w.totalQuestions})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-sm text-gray-600",children:"答對題數"}),a.jsx("p",{className:"text-2xl font-bold text-green-600",children:w.correctCount})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-sm text-gray-600",children:"平均時間"}),a.jsx("p",{className:"text-2xl font-bold text-blue-600",children:w.averageTime?`${Math.round(w.averageTime/1e3)}秒`:"N/A"})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg border border-green-200",children:[a.jsx("p",{className:"text-xs text-green-700 font-medium",children:"簡單"}),a.jsxs("p",{className:"text-lg font-bold text-green-600",children:[w.difficultyBreakdown.easy.accuracy,"%"]}),a.jsxs("p",{className:"text-xs text-gray-600",children:[w.difficultyBreakdown.easy.correct,"/",w.difficultyBreakdown.easy.total]})]}),a.jsxs("div",{className:"text-center p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:[a.jsx("p",{className:"text-xs text-yellow-700 font-medium",children:"普通"}),a.jsxs("p",{className:"text-lg font-bold text-yellow-600",children:[w.difficultyBreakdown.normal.accuracy,"%"]}),a.jsxs("p",{className:"text-xs text-gray-600",children:[w.difficultyBreakdown.normal.correct,"/",w.difficultyBreakdown.normal.total]})]}),a.jsxs("div",{className:"text-center p-3 bg-red-50 rounded-lg border border-red-200",children:[a.jsx("p",{className:"text-xs text-red-700 font-medium",children:"困難"}),a.jsxs("p",{className:"text-lg font-bold text-red-600",children:[w.difficultyBreakdown.hard.accuracy,"%"]}),a.jsxs("p",{className:"text-xs text-gray-600",children:[w.difficultyBreakdown.hard.correct,"/",w.difficultyBreakdown.hard.total]})]})]}),w.commonErrors.length>0&&a.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:[a.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"常見錯誤模式："}),a.jsx("ul",{className:"text-sm text-gray-600 space-y-1",children:w.commonErrors.map((C,j)=>a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"text-red-500 mt-1",children:"•"}),C]},j))})]})]},w.questionType))})]}),l==="analysis"&&a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("h3",{className:"text-xl font-bold text-green-700 mb-4 flex items-center gap-2",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 18.75h-9m9 0a3 3 0 0 1 3 3h-15a3 3 0 0 1 3-3m9 0v-3.375c0-.621-.503-1.125-1.125-1.125h-.871M7.5 18.75v-3.375c0-.621.504-1.125 1.125-1.125h.872m5.007 0H9.497m5.007 0a7.454 7.454 0 0 1-.982-3.172M9.497 14.25a7.454 7.454 0 0 0 .981-3.172M5.25 4.236c-.982.143-1.954.317-2.916.52A6.003 6.003 0 0 0 7.73 9.728M5.25 4.236V4.5c0 2.108.966 3.99 2.48 5.228M5.25 4.236V2.721C7.456 2.41 9.71 2.25 12 2.25s4.544.16 6.75.471v1.515M7.73 9.728a6.726 6.726 0 0 0 2.748 1.35m8.272-6.842V4.5c0 2.108-.966 3.99-2.48 5.228m2.48-5.228V2.721A48.133 48.133 0 0 0 12 2.25c-2.291 0-4.544.16-6.75.471v1.515M7.73 9.728l3.75.814.97 4.286c.078.348.14.699.185 1.053m8.272-6.842-3.75.814-.97 4.286a24.216 24.216 0 0 1-.185 1.053M12 19.5a2.25 2.25 0 0 1-2.25-2.25V14.25m4.5 5.25a2.25 2.25 0 0 1 2.25-2.25V14.25"})}),"學習強項"]}),a.jsx("div",{className:"space-y-4",children:t.learningAnalysis.strengths.map((w,C)=>a.jsxs("div",{className:`p-4 rounded-lg border ${g(w.level)}`,children:[a.jsx("h4",{className:"font-semibold mb-2",children:w.area}),a.jsx("p",{className:"text-sm mb-3",children:w.description}),w.examples.length>0&&a.jsxs("div",{className:"mb-3",children:[a.jsx("p",{className:"text-xs font-medium text-gray-700 mb-1",children:"表現實例："}),a.jsx("ul",{className:"text-xs space-y-1",children:w.examples.map((j,k)=>a.jsxs("li",{className:"flex items-start gap-1",children:[a.jsx("span",{className:"text-green-500 mt-1",children:"✓"}),j]},k))})]}),w.leverageOpportunities.length>0&&a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-medium text-gray-700 mb-1",children:"運用機會："}),a.jsx("ul",{className:"text-xs space-y-1",children:w.leverageOpportunities.map((j,k)=>a.jsxs("li",{className:"flex items-start gap-1",children:[a.jsx("span",{className:"text-blue-500 mt-1",children:"→"}),j]},k))})]})]},C))})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("h3",{className:"text-xl font-bold text-red-700 mb-4 flex items-center gap-2",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})}),"需要加強的領域"]}),a.jsx("div",{className:"space-y-4",children:t.learningAnalysis.weaknesses.map((w,C)=>a.jsxs("div",{className:`p-4 rounded-lg border ${f(w.severity)}`,children:[a.jsx("h4",{className:"font-semibold mb-2",children:w.area}),a.jsx("p",{className:"text-sm mb-3",children:w.description}),w.affectedTopics.length>0&&a.jsxs("div",{className:"mb-3",children:[a.jsx("p",{className:"text-xs font-medium text-gray-700 mb-1",children:"影響主題："}),a.jsx("div",{className:"flex flex-wrap gap-1",children:w.affectedTopics.map((j,k)=>a.jsx("span",{className:"text-xs px-2 py-1 bg-gray-200 rounded-full",children:j},k))})]}),w.recommendedActions.length>0&&a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-medium text-gray-700 mb-1",children:"建議行動："}),a.jsx("ul",{className:"text-xs space-y-1",children:w.recommendedActions.map((j,k)=>a.jsxs("li",{className:"flex items-start gap-1",children:[a.jsx("span",{className:"text-orange-500 mt-1",children:"•"}),j]},k))})]})]},C))})]})]}),l==="recommendations"&&a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsx("h3",{className:"text-xl font-bold text-blue-700 mb-6",children:"個人化學習建議"}),a.jsx("div",{className:"space-y-6",children:t.personalizedRecommendations.map((w,C)=>a.jsxs("div",{className:`p-6 rounded-lg border-l-4 ${h(w.priority)}`,children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-1",children:w.title}),a.jsxs("div",{className:"flex gap-2 text-xs",children:[a.jsx("span",{className:`px-2 py-1 rounded-full border ${w.category==="immediate"?"text-red-600 bg-red-100 border-red-200":w.category==="short-term"?"text-yellow-600 bg-yellow-100 border-yellow-200":"text-blue-600 bg-blue-100 border-blue-200"}`,children:w.category==="immediate"?"立即":w.category==="short-term"?"短期":"長期"}),a.jsx("span",{className:`px-2 py-1 rounded-full border ${w.priority==="high"?"text-red-600 bg-red-100 border-red-200":w.priority==="medium"?"text-yellow-600 bg-yellow-100 border-yellow-200":"text-green-600 bg-green-100 border-green-200"}`,children:w.priority==="high"?"高優先":w.priority==="medium"?"中優先":"低優先"})]})]}),a.jsx("span",{className:"text-sm text-gray-600 bg-gray-100 px-3 py-1 rounded-full",children:w.estimatedTime})]}),a.jsx("p",{className:"text-gray-700 mb-4",children:w.description}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"具體步驟："}),a.jsx("ol",{className:"text-sm space-y-1",children:w.actionSteps.map((j,k)=>a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"bg-blue-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5",children:k+1}),j]},k))})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"預期成果："}),a.jsx("p",{className:"text-sm text-gray-600 mb-3",children:w.expectedOutcome}),w.resources&&w.resources.length>0&&a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"推薦資源："}),a.jsx("ul",{className:"text-sm space-y-1",children:w.resources.map((j,k)=>a.jsxs("li",{className:"flex items-start gap-1",children:[a.jsx("span",{className:"text-green-500 mt-1",children:"📚"}),j]},k))})]})]})]})]},C))})]}),l==="teaching"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("h3",{className:"text-xl font-bold text-red-700 mb-4 flex items-center gap-2",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"})}),"立即介入建議"]}),a.jsx("ul",{className:"space-y-3",children:t.teachingRecommendations.immediateInterventions.map((w,C)=>a.jsxs("li",{className:"flex items-start gap-3 p-3 bg-red-50 rounded-lg border border-red-200",children:[a.jsx("span",{className:"bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold flex-shrink-0 mt-0.5",children:"!"}),a.jsx("span",{className:"text-gray-700",children:w})]},C))})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("h3",{className:"text-xl font-bold text-blue-700 mb-4 flex items-center gap-2",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.26 10.147a60.438 60.438 0 0 0-.491 6.347A48.62 48.62 0 0 1 12 20.904a48.62 48.62 0 0 1 8.232-4.41 60.46 60.46 0 0 0-.491-6.347m-15.482 0a50.636 50.636 0 0 0-2.658-.813A59.906 59.906 0 0 1 12 3.493a59.903 59.903 0 0 1 10.399 5.84c-.896.248-1.783.52-2.658.814m-15.482 0A50.717 50.717 0 0 1 12 13.489a50.702 50.702 0 0 1 7.74-3.342M6.75 15a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Zm0 0v-3.675A55.378 55.378 0 0 1 12 8.443a55.381 55.381 0 0 1 5.25 2.882V15"})}),"建議教學策略"]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.teachingRecommendations.instructionalStrategies.map((w,C)=>a.jsx("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"bg-blue-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold flex-shrink-0 mt-0.5",children:C+1}),a.jsx("span",{className:"text-gray-700",children:w})]})},C))})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("h3",{className:"text-xl font-bold text-purple-700 mb-4 flex items-center gap-2",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"})}),"差異化教學建議"]}),a.jsx("ul",{className:"space-y-3",children:t.teachingRecommendations.differentiation.map((w,C)=>a.jsxs("li",{className:"flex items-start gap-3 p-3 bg-purple-50 rounded-lg border border-purple-200",children:[a.jsx("span",{className:"bg-purple-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold flex-shrink-0 mt-0.5",children:"◆"}),a.jsx("span",{className:"text-gray-700",children:w})]},C))})]}),t.teachingRecommendations.parentGuidance&&t.teachingRecommendations.parentGuidance.length>0&&a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("h3",{className:"text-xl font-bold text-green-700 mb-4 flex items-center gap-2",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"})}),"家長指導建議"]}),a.jsx("ul",{className:"space-y-3",children:t.teachingRecommendations.parentGuidance.map((w,C)=>a.jsxs("li",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg border border-green-200",children:[a.jsx("span",{className:"bg-green-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold flex-shrink-0 mt-0.5",children:"♥"}),a.jsx("span",{className:"text-gray-700",children:w})]},C))})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("h3",{className:"text-xl font-bold text-indigo-700 mb-4 flex items-center gap-2",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 0 0 2.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 0 0-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75 2.25 2.25 0 0 0-.1-.664m-5.8 0A2.251 2.251 0 0 1 13.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25ZM6.75 12h.008v.008H6.75V12Zm0 3h.008v.008H6.75V15Zm0 3h.008v.008H6.75V18Z"})}),"進度追蹤與評估"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"關鍵指標"}),a.jsx("ul",{className:"text-sm space-y-1",children:t.progressTracking.keyMetrics.map((w,C)=>a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"w-2 h-2 bg-indigo-500 rounded-full"}),w]},C))})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"檢查點"}),a.jsx("ul",{className:"text-sm space-y-1",children:t.progressTracking.checkpoints.map((w,C)=>a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),w]},C))})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"重新評估"}),a.jsx("p",{className:"text-sm text-gray-600",children:t.progressTracking.reassessmentSuggestion})]})]})]})]})]})]})},lm=({topic:t,quizData:e,studentId:n,apiKey:i,mode:l="both",onClose:o,onRetakeQuiz:u,onContinueLearning:f,initialResponses:g=[],existingReport:h,resultsBinId:x,onReportSaved:v})=>{const[N,w]=M.useState(null),[C,j]=M.useState(!1),[k,E]=M.useState(null),[L,D]=M.useState(l==="teacher"?"teacher":"student"),[O,H]=M.useState(null),I=M.useCallback(async B=>{if(!i){E("需要 API Key 才能生成診斷報告");return}j(!0),E(null);try{const Y={...await rk(B,i,{includeDetailedAnalysis:!0,includeComparativeData:!1,includeVisualCharts:!1,language:"zh-TW",reportFormat:"standard"}),generatedAt:new Date().toISOString(),resultsBinId:x};if(w(Y),x)try{await xk(x,Y),console.log("診斷報告已自動儲存到學生作答結果"),v==null||v(Y)}catch(z){console.warn("儲存診斷報告失敗，但報告仍可正常顯示:",z)}}catch(ee){console.error("生成診斷報告失敗:",ee),E(ee instanceof Error?ee.message:"生成診斷報告時發生錯誤")}finally{j(!1)}},[i,x,v]);M.useEffect(()=>{if(h){w(h);const B=Yo(t,n);B.responses=g,H(Do(B))}else if(t&&g.length>0){const B=Yo(t,n);B.responses=g,H(Do(B)),I(B)}},[t,n,g,h,I]),M.useCallback(B=>{if(!O)return;const ee={...O,responses:[...O.responses,B]};H(ee)},[O]),M.useCallback(()=>{if(!O)return;const B=Do(O);H(B),I(B)},[O,I]);const R=M.useCallback(()=>{if(!N)return;const B={studentFeedback:N.studentFeedback,teacherReport:N.teacherReport,exportDate:new Date().toISOString()},ee=JSON.stringify(B,null,2),G="data:application/json;charset=utf-8,"+encodeURIComponent(ee),Y=`learning_diagnostic_${t}_${new Date().toISOString().split("T")[0]}.json`,z=document.createElement("a");z.setAttribute("href",G),z.setAttribute("download",Y),z.click()},[N,t]),q=M.useCallback(()=>{if(!N)return;const B=JSON.parse(localStorage.getItem("learningDiagnosticReports")||"[]");B.push({id:`report_${Date.now()}`,topic:t,studentId:n,createdAt:new Date().toISOString(),result:N}),localStorage.setItem("learningDiagnosticReports",JSON.stringify(B)),alert("診斷報告已儲存至本地")},[N,t,n]);return C?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(sn,{}),a.jsxs("div",{className:"mt-6 space-y-2",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"正在生成學習診斷報告"}),a.jsx("p",{className:"text-gray-600",children:"AI 正在分析您的答題情況..."}),a.jsx("div",{className:"flex items-center justify-center space-x-1 mt-4",children:a.jsxs("div",{className:"flex space-x-1",children:[a.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-bounce"}),a.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),a.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})]})]})}):k?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-50 to-pink-100 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full text-center",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-16 h-16 text-red-500 mx-auto mb-4",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"})}),a.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:"生成報告失敗"}),a.jsx("p",{className:"text-gray-600 mb-6",children:k}),a.jsxs("div",{className:"flex gap-3 justify-center",children:[a.jsx("button",{onClick:()=>O&&I(O),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"重新生成"}),o&&a.jsx("button",{onClick:o,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"關閉"})]})]})}):N?a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("div",{className:"bg-white shadow-sm border-b",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex justify-between items-center h-16",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:"學習診斷報告"}),l==="both"&&a.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[a.jsx("button",{onClick:()=>D("student"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${L==="student"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"學生版"}),a.jsx("button",{onClick:()=>D("teacher"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${L==="teacher"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"教師版"})]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[L==="teacher"&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:q,className:"px-3 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors flex items-center gap-2",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0 1 11.186 0Z"})}),"儲存"]}),a.jsxs("button",{onClick:R,className:"px-3 py-2 text-sm bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors flex items-center gap-2",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"})}),"匯出"]})]}),o&&a.jsx("button",{onClick:o,className:"px-3 py-2 text-sm bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors",children:"關閉"})]})]})})}),a.jsxs("div",{className:"py-8",children:[(l==="student"||l==="both"&&L==="student")&&a.jsx(vk,{feedback:N.studentFeedback,onContinueLearning:f,onRetakeQuiz:u,showActions:l!=="both"}),(l==="teacher"||l==="both"&&L==="teacher")&&a.jsx(bk,{report:N.teacherReport,onExportReport:R,onSaveReport:q,showExportOptions:l!=="both"})]}),l==="both"&&a.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t shadow-lg",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:a.jsxs("div",{className:"flex justify-center space-x-4",children:[a.jsxs("button",{onClick:u,className:"px-6 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors flex items-center gap-2 font-medium",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"})}),"重新測驗"]}),a.jsxs("button",{onClick:f,className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-lg hover:from-blue-700 hover:to-indigo-700 transition-all flex items-center gap-2 font-medium",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5 21 12l-7.5 7.5M3 12h16.5"})}),"繼續學習"]})]})})})]}):a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full text-center",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-16 h-16 text-gray-400 mx-auto mb-4",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})}),a.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:"等待診斷數據"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"請先完成測驗以生成學習診斷報告"}),o&&a.jsx("button",{onClick:o,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"關閉"})]})})},wk=({quizzes:t,topic:e,studentId:n,apiKey:i,onDiagnosticComplete:l,enableDiagnostic:o=!0})=>{const[u,f]=M.useState(Mt.Easy),[g,h]=M.useState(null),[x,v]=M.useState([]),[N,w]=M.useState(!1),[C,j]=M.useState(new Set),k=M.useRef(null);M.useEffect(()=>{if(o&&e&&!g){const Y=Yo(e,n);h(Y),k.current=Date.now()}},[e,n,o,g]);const E=()=>{if(!t||!q)return 0;let Y=0;return Object.values(q).forEach(z=>{Array.isArray(z)&&(Y+=z.length)}),Y},L=()=>{const Y=u.toLowerCase();return x.filter(z=>z.difficulty===Y).length},D=()=>{const Y=u.toLowerCase();return x.filter(z=>z.difficulty===Y)},O=M.useCallback((Y,z,$,Q,P,K)=>{if(!o||!g)return;const pe=k.current?Date.now()-k.current:void 0,X={questionId:Y,questionType:z,difficulty:$,userAnswer:Q,correctAnswer:P,isCorrect:K,responseTime:pe,attempts:1};v(S=>S.find(ie=>ie.questionId===Y)?S.map(ie=>ie.questionId===Y?{...X,attempts:(ie.attempts||0)+1}:ie):[...S,X]),j(S=>new Set([...S,Y])),k.current=Date.now()},[o,g]),H=M.useCallback(()=>{if(!g||!o)return;const Y=Do(g);Y.responses=x,h(Y),w(!0),l&&l({session:Y,responses:x})},[g,x,o,l]),I=M.useCallback(()=>{w(!1);const Y=u.toLowerCase();if(v(z=>z.filter($=>$.difficulty!==Y)),j(z=>{const $=new Set(z),Q=u.toLowerCase();return Array.from(z).forEach(P=>{P.startsWith(`${Q}-`)&&$.delete(P)}),$}),o){const z=Yo(e,n);h(z),k.current=Date.now()}},[o,e,n,u]),R=M.useCallback(()=>{w(!1)},[]);if(N&&o){const Y=u===Mt.Easy?"簡單":u===Mt.Normal?"普通":"困難";return a.jsx(lm,{topic:`${e} (${Y}難度)`,quizData:t,studentId:n,apiKey:i,mode:"both",onRetakeQuiz:I,onContinueLearning:R,onClose:()=>w(!1),initialResponses:D()})}if(!t)return a.jsx(Dn,{title:"線上互動測驗",icon:a.jsx(Ja,{}),children:"沒有可用的測驗資料。"});const q=t[u],B=[{key:Mt.Easy,label:"簡單"},{key:Mt.Normal,label:"普通"},{key:Mt.Hard,label:"困難"}],ee={trueFalse:"是非題",multipleChoice:"選擇題",fillInTheBlanks:"填空題",sentenceScramble:"句子重組",memoryCardGame:"翻卡牌記憶遊戲"},G=()=>{const Y=E(),z=L();return Y>0?z/Y*100:0};return a.jsxs(Dn,{title:"線上互動測驗",icon:a.jsx(Ja,{className:"w-7 h-7"}),children:[o&&a.jsxs("div",{className:"mb-6 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-200",children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-800",children:"學習診斷模式"}),a.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[a.jsxs("span",{className:"text-gray-600",children:["進度: ",L()," / ",E()]}),a.jsxs("button",{onClick:H,disabled:L()===0,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2 text-sm",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12c0 1.268-.63 2.39-1.593 3.068a3.745 3.745 0 0 1-1.043 3.296 3.745 3.745 0 0 1-3.296 1.043A3.745 3.745 0 0 1 12 21c-1.268 0-2.39-.63-3.068-1.593a3.746 3.746 0 0 1-3.296-1.043 3.745 3.745 0 0 1-1.043-3.296A3.745 3.745 0 0 1 3 12c0-1.268.63-2.39 1.593-3.068a3.745 3.745 0 0 1 1.043-3.296 3.746 3.746 0 0 1 3.296-1.043A3.746 3.746 0 0 1 12 3c1.268 0 2.39.63 3.068 1.593a3.746 3.746 0 0 1 3.296 1.043 3.745 3.745 0 0 1 1.043 3.296A3.745 3.745 0 0 1 21 12Z"})}),"生成學習診斷"]})]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:a.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-green-500 h-3 rounded-full transition-all duration-300 ease-out",style:{width:`${G()}%`}})}),a.jsx("p",{className:"text-xs text-gray-600 mt-2",children:"💡 完成題目後點擊「生成學習診斷」獲得個人化學習建議"})]}),a.jsx("div",{className:"mb-6",children:a.jsx("div",{className:"flex flex-wrap gap-2 border-b border-slate-300 pb-3 mb-4",children:B.map(({key:Y,label:z})=>a.jsx("button",{onClick:()=>f(Y),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors
                ${u===Y?"bg-sky-600 text-white shadow-md":"bg-slate-200 text-slate-700 hover:bg-slate-300"}`,children:z},Y))})}),q?Object.keys(ee).map(Y=>{if(!q.hasOwnProperty(Y))return null;const z=q[Y];return!z||z.length===0?null:a.jsxs("div",{className:"mb-8",children:[a.jsxs("h4",{className:"text-xl font-semibold text-slate-700 mb-3 border-b-2 border-sky-200 pb-1 flex items-center justify-between",children:[a.jsx("span",{children:ee[Y]}),o&&a.jsxs("span",{className:"text-sm text-gray-500 font-normal",children:["已答: ",x.filter($=>$.questionType===Y&&$.difficulty===u).length," / ",z.length]})]}),Y==="trueFalse"&&z.map(($,Q)=>{const P=`${u}-tf-${Q}`;return a.jsx("div",{className:C.has(P)?"opacity-75":"",children:a.jsx(rm,{question:$,itemNumber:Q+1,onAnswer:o?(K,pe)=>{O(P,"trueFalse",u,K,$.isTrue,pe)}:void 0})},P)}),Y==="multipleChoice"&&z.map(($,Q)=>{const P=`${u}-mc-${Q}`;return a.jsx("div",{className:C.has(P)?"opacity-75":"",children:a.jsx(sm,{question:$,itemNumber:Q+1,onAnswer:o?(K,pe)=>{O(P,"multipleChoice",u,K,$.correctAnswerIndex,pe)}:void 0})},P)}),Y==="fillInTheBlanks"&&z.map(($,Q)=>{const P=`${u}-fb-${Q}`;return a.jsx("div",{className:C.has(P)?"opacity-75":"",children:a.jsx(sv,{question:$,itemNumber:Q+1,onAnswer:o?(K,pe)=>{O(P,"fillInTheBlanks",u,K,$.correctAnswer,pe)}:void 0})},P)}),Y==="sentenceScramble"&&z.map(($,Q)=>{const P=`${u}-ss-${Q}`;return a.jsx("div",{className:C.has(P)?"opacity-75":"",children:a.jsx(av,{question:$,itemNumber:Q+1,onAnswer:o?(K,pe)=>{O(P,"sentenceScramble",u,K,$.originalSentence,pe)}:void 0})},P)}),Y==="memoryCardGame"&&z.map(($,Q)=>{const P=`${u}-mcg-${Q}`;return a.jsx("div",{className:C.has(P)?"opacity-75":"",children:a.jsx(am,{question:$,itemNumber:Q+1,onAnswer:o?(K,pe)=>{O(P,"memoryCardGame",u,K,$.pairs,pe)}:void 0})},P)})]},`${u}-${Y}`)}):a.jsx("p",{children:"此難度級別沒有找到測驗題目。"}),o&&L()>0&&a.jsx("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6 text-yellow-600 mt-0.5 flex-shrink-0",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-yellow-800 font-medium text-sm",children:"學習診斷提示"}),a.jsxs("p",{className:"text-yellow-700 text-sm mt-1",children:["您已完成 ",L()," 題測驗。點擊上方的「生成學習診斷」按鈕，AI 將為您分析學習狀況並提供個人化建議！"]})]})]})})]})},Nk=({dialogue:t})=>{const[e,n]=M.useState(null),[i,l]=M.useState(null),[o,u]=M.useState(!1),[f,g]=M.useState(""),[h,x]=M.useState(null),[v,N]=M.useState(!1),[w,C]=M.useState({tts:!0,sr:!0}),j=M.useRef(null),k=M.useRef(null);M.useEffect(()=>{const I="speechSynthesis"in window,R="SpeechRecognition"in window||"webkitSpeechRecognition"in window;if(C({tts:I,sr:R}),R){const q=window.SpeechRecognition||window.webkitSpeechRecognition;j.current=new q,j.current.continuous=!1,j.current.interimResults=!1,j.current.lang="en-US",j.current.onresult=B=>{const ee=B.results[0][0].transcript;g(ee),H(ee)},j.current.onerror=B=>{console.error("Speech recognition error:",B.error),x({type:"error",message:`語音辨識錯誤: ${B.error==="no-speech"?"未偵測到語音":B.error==="audio-capture"?"麥克風擷取失敗":B.error==="not-allowed"?"麥克風權限未授予":"發生錯誤"}`}),u(!1)},j.current.onend=()=>{u(!1)}}return()=>{window.speechSynthesis&&window.speechSynthesis.speaking&&window.speechSynthesis.cancel()}},[]);const E=(I,R)=>{if(!w.tts||!I)return;window.speechSynthesis.speaking&&window.speechSynthesis.cancel();const q=new SpeechSynthesisUtterance(I);q.lang="en-US";const B=window.speechSynthesis.getVoices(),ee=B.find(G=>G.lang.startsWith("en")&&G.name.includes("Google")&&G.localService)||B.find(G=>G.lang.startsWith("en")&&G.localService)||B.find(G=>G.lang.startsWith("en"));ee&&(q.voice=ee),q.onstart=()=>{N(!0),n(R)},q.onend=()=>{N(!1),n(null)},q.onerror=G=>{console.error("Speech synthesis error:",G),N(!1),n(null),x({type:"error",message:"語音播放失敗。"})},k.current=q,window.speechSynthesis.speak(q)},L=I=>{if(!(!w.sr||!j.current||o)){l(I),g(""),x(null),u(!0);try{j.current.start()}catch(R){console.error("Error starting recognition: ",R),u(!1),x({type:"error",message:"無法啟動語音辨識。"})}}},D=()=>{j.current&&o&&(j.current.stop(),u(!1))},O=I=>I.toLowerCase().replace(/[.,!?;:"']/g,"").trim(),H=I=>{if(i===null)return;const R=t[i].line;O(I)===O(R)?x({type:"success",message:`太棒了！發音正確: "${I}"`}):x({type:"error",message:`再試一次。您說的是: "${I}"，參考句: "${R}"`})};return!t||t.length===0?a.jsx(Dn,{title:"英文對話練習",icon:a.jsx(Lf,{className:"w-7 h-7"}),children:a.jsx("p",{className:"text-slate-600",children:"目前沒有可用的對話內容。"})}):a.jsxs(Dn,{title:"英文對話練習",icon:a.jsx(Lf,{className:"w-7 h-7"}),children:[!w.tts&&a.jsx("p",{className:"text-red-600 bg-red-100 p-2 rounded-md",children:"您的瀏覽器不支援語音合成 (TTS)。"}),!w.sr&&a.jsx("p",{className:"text-red-600 bg-red-100 p-2 rounded-md mt-2",children:"您的瀏覽器不支援語音辨識 (SR)。建議使用最新版 Chrome 或 Edge。"}),a.jsx("div",{className:"space-y-4",children:t.map((I,R)=>a.jsxs("div",{className:`p-3 rounded-lg ${I.speaker==="Speaker A"?"bg-sky-50":"bg-indigo-50"} border ${I.speaker==="Speaker A"?"border-sky-200":"border-indigo-200"}`,children:[a.jsxs("p",{className:"font-semibold text-sm mb-1 ${item.speaker === 'Speaker A' ? 'text-sky-700' : 'text-indigo-700'}",children:[I.speaker,":"]}),a.jsx("p",{className:"text-slate-800 mb-2",children:I.line}),a.jsxs("div",{className:"flex items-center space-x-2",children:[w.tts&&a.jsx("button",{onClick:()=>E(I.line,R),disabled:v&&e!==R,className:`p-1.5 rounded-full hover:bg-slate-200 transition-colors disabled:opacity-50 ${v&&e===R?"text-sky-500 animate-pulse":"text-slate-600"}`,"aria-label":`播放 ${I.speaker} 的話`,children:a.jsx(lk,{className:"w-5 h-5"})}),w.sr&&(o&&i===R?a.jsx("button",{onClick:D,className:"p-1.5 rounded-full text-red-600 hover:bg-red-100 transition-colors","aria-label":"停止錄音",children:a.jsx(ck,{className:"w-5 h-5"})}):a.jsx("button",{onClick:()=>L(R),disabled:o||v,className:"p-1.5 rounded-full text-slate-600 hover:bg-slate-200 transition-colors disabled:opacity-50","aria-label":`練習說出 ${I.speaker} 的話`,children:a.jsx(ok,{className:"w-5 h-5"})}))]}),i===R&&f&&a.jsxs("p",{className:"mt-2 text-sm text-slate-600 italic",children:['您說的是: "',f,'"']}),i===R&&h&&a.jsxs("div",{className:`mt-2 p-2 rounded-md text-sm flex items-start ${h.type==="success"?"bg-green-100 text-green-700":h.type==="error"?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700"}`,children:[h.type==="success"&&a.jsx(Nr,{className:"w-5 h-5 mr-2 flex-shrink-0"}),h.type==="error"&&a.jsx(Sr,{className:"w-5 h-5 mr-2 flex-shrink-0"}),a.jsx("span",{children:h.message})]})]},R))}),o&&a.jsx("p",{className:"mt-4 text-center text-sky-600 font-medium animate-pulse",children:"正在聆聽..."})]})},cv=({content:t,apiKey:e,vocabularyLevel:n,isStudentMode:i=!1})=>{const[l,o]=M.useState("sentence"),[u,f]=M.useState({}),[g,h]=M.useState({}),[x,v]=M.useState({}),N=M.useCallback((k,E)=>{f(L=>({...L,[k]:E}))},[]),w=M.useCallback(async(k,E)=>{if(!e){alert("需要 API Key 才能獲得 AI 批改回饋");return}const L=u[k.id];if(!(L!=null&&L.trim())){alert("請先完成您的作品再提交批改");return}v(D=>({...D,[k.id]:!0}));try{const D=await Zj(L,E,k,e,n);h(O=>({...O,[k.id]:D}))}catch(D){console.error("AI 批改失敗:",D),alert("AI 批改失敗，請檢查網路連線和 API Key 設定")}finally{v(D=>({...D,[k.id]:!1}))}},[e,u,n]),C=()=>a.jsx("div",{className:"space-y-6",children:t.sentencePractice.map((k,E)=>{var L;return a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border border-blue-200",children:[a.jsx("div",{className:"flex items-start justify-between mb-4",children:a.jsxs("div",{children:[a.jsxs("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:["造句練習 ",E+1,a.jsx("span",{className:`ml-2 px-2 py-1 text-xs rounded-full ${k.difficulty==="easy"?"bg-green-100 text-green-700":k.difficulty==="normal"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:k.difficulty==="easy"?"簡單":k.difficulty==="normal"?"普通":"困難"})]}),a.jsx("p",{className:"text-gray-700 mb-3",children:k.instruction}),k.keywords.length>0&&a.jsxs("div",{className:"mb-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"必須使用的關鍵詞："}),a.jsx("div",{className:"flex flex-wrap gap-2",children:k.keywords.map((D,O)=>a.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-sm",children:D},O))})]}),k.exampleSentence&&a.jsxs("div",{className:"mb-3 p-3 bg-gray-50 rounded-lg",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"範例句子："}),a.jsx("p",{className:"text-gray-700 italic",children:k.exampleSentence})]}),k.hints&&k.hints.length>0&&a.jsxs("div",{className:"mb-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"提示："}),a.jsx("ul",{className:"text-sm text-gray-600 space-y-1",children:k.hints.map((D,O)=>a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"text-blue-500 mt-1",children:"•"}),D]},O))})]})]})}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"您的造句："}),a.jsx("textarea",{value:u[k.id]||"",onChange:D=>N(k.id,D.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,placeholder:"請在此輸入您的造句..."}),a.jsxs("div",{className:"mt-3 flex justify-between items-center",children:[a.jsxs("span",{className:"text-sm text-gray-500",children:["字數: ",(u[k.id]||"").length]}),e&&a.jsx("button",{onClick:()=>w(k,"sentence"),disabled:!((L=u[k.id])!=null&&L.trim())||x[k.id],className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:x[k.id]?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"animate-spin",children:"⏳"}),"AI 批改中..."]}):a.jsxs(a.Fragment,{children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),"獲得 AI 批改"]})})]})]}),g[k.id]&&a.jsx(ay,{feedback:g[k.id]})]},k.id)})}),j=()=>a.jsx("div",{className:"space-y-6",children:t.writingPractice.map((k,E)=>{var L;return a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border border-purple-200",children:[a.jsxs("div",{className:"mb-4",children:[a.jsxs("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:[k.title,a.jsx("span",{className:`ml-2 px-2 py-1 text-xs rounded-full ${k.difficulty==="easy"?"bg-green-100 text-green-700":k.difficulty==="normal"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:k.difficulty==="easy"?"簡單":k.difficulty==="normal"?"普通":"困難"})]}),a.jsx("p",{className:"text-gray-700 mb-3",children:k.instruction}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"建議結構："}),a.jsx("ul",{className:"text-sm text-gray-600 space-y-1",children:k.structure.map((D,O)=>a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"text-purple-500 mt-1",children:"•"}),D]},O))})]}),a.jsxs("div",{children:[a.jsxs("p",{className:"text-sm font-medium text-gray-600 mb-2",children:["字數要求: ",k.minLength," - ",k.maxLength," 字"]}),k.keywords&&k.keywords.length>0&&a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"建議使用詞彙："}),a.jsx("div",{className:"flex flex-wrap gap-1",children:k.keywords.map((D,O)=>a.jsx("span",{className:"bg-purple-100 text-purple-800 px-2 py-1 rounded text-xs",children:D},O))})]})]})]}),k.exampleOutline&&a.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg mb-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"範例大綱："}),a.jsx("p",{className:"text-gray-700 text-sm",children:k.exampleOutline})]})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"您的寫作："}),a.jsx("textarea",{value:u[k.id]||"",onChange:D=>N(k.id,D.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",rows:8,placeholder:"請在此輸入您的文章..."}),a.jsxs("div",{className:"mt-3 flex justify-between items-center",children:[a.jsxs("div",{className:"text-sm text-gray-500",children:[a.jsxs("span",{children:["字數: ",(u[k.id]||"").length]}),a.jsx("span",{className:"ml-4",children:(u[k.id]||"").length<k.minLength?`還需 ${k.minLength-(u[k.id]||"").length} 字`:(u[k.id]||"").length>k.maxLength?`超出 ${(u[k.id]||"").length-k.maxLength} 字`:"符合字數要求"})]}),e&&a.jsx("button",{onClick:()=>w(k,"writing"),disabled:!((L=u[k.id])!=null&&L.trim())||x[k.id],className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:x[k.id]?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"animate-spin",children:"⏳"}),"AI 批改中..."]}):a.jsxs(a.Fragment,{children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),"獲得 AI 批改"]})})]})]}),g[k.id]&&a.jsx(ay,{feedback:g[k.id]})]},k.id)})});return a.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 rounded-lg p-6 mt-8",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-8 h-8 text-blue-600",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:"寫作練習與 AI 批改"}),a.jsx("p",{className:"text-gray-600 text-sm",children:t.instructions})]})]}),!i&&a.jsxs("div",{className:"text-sm text-gray-500 bg-white px-3 py-2 rounded-lg border",children:[a.jsxs("div",{children:["造句練習: ",t.sentencePractice.length," 題"]}),a.jsxs("div",{children:["寫作練習: ",t.writingPractice.length," 題"]})]})]}),a.jsxs("div",{className:"flex border-b border-gray-200 mb-6",children:[a.jsxs("button",{onClick:()=>o("sentence"),className:`px-6 py-3 font-medium text-sm border-b-2 transition-colors ${l==="sentence"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["提示造句 (",t.sentencePractice.length,")"]}),a.jsxs("button",{onClick:()=>o("writing"),className:`px-6 py-3 font-medium text-sm border-b-2 transition-colors ${l==="writing"?"border-purple-500 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["提示寫作 (",t.writingPractice.length,")"]})]}),l==="sentence"?C():j()]})},ay=({feedback:t})=>a.jsxs("div",{className:"mt-4 border-t pt-4 bg-gradient-to-r from-green-50 to-blue-50 rounded-lg p-4",children:[a.jsxs("h5",{className:"font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5 text-green-600",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.847a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.847.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456Z"})}),"AI 批改回饋",a.jsxs("div",{className:`ml-2 px-3 py-1 rounded-full text-sm font-bold ${t.score>=85?"bg-green-100 text-green-800":t.score>=70?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[t.score," 分"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[t.strengths.length>0&&a.jsxs("div",{children:[a.jsx("h6",{className:"font-medium text-green-700 mb-2",children:"✅ 優點"}),a.jsx("ul",{className:"space-y-1",children:t.strengths.map((e,n)=>a.jsxs("li",{className:"text-sm text-gray-700 flex items-start gap-2",children:[a.jsx("span",{className:"text-green-500 mt-1",children:"•"}),e]},n))})]}),t.improvements.length>0&&a.jsxs("div",{children:[a.jsx("h6",{className:"font-medium text-orange-700 mb-2",children:"💡 改進建議"}),a.jsx("ul",{className:"space-y-1",children:t.improvements.map((e,n)=>a.jsxs("li",{className:"text-sm text-gray-700 flex items-start gap-2",children:[a.jsx("span",{className:"text-orange-500 mt-1",children:"•"}),e]},n))})]})]}),t.grammarCorrections&&t.grammarCorrections.length>0&&a.jsxs("div",{className:"mb-4 p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:[a.jsx("h6",{className:"font-medium text-yellow-800 mb-2",children:"📝 語法修正"}),t.grammarCorrections.map((e,n)=>a.jsxs("div",{className:"mb-2 last:mb-0",children:[a.jsxs("div",{className:"text-sm",children:[a.jsx("span",{className:"text-red-600 line-through",children:e.original}),a.jsx("span",{className:"mx-2",children:"→"}),a.jsx("span",{className:"text-green-600 font-medium",children:e.corrected})]}),a.jsx("div",{className:"text-xs text-gray-600 mt-1",children:e.explanation})]},n))]}),t.vocabularyTips&&t.vocabularyTips.length>0&&a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{className:"font-medium text-blue-700 mb-2",children:"📚 詞彙建議"}),a.jsx("ul",{className:"space-y-1",children:t.vocabularyTips.map((e,n)=>a.jsxs("li",{className:"text-sm text-gray-700 flex items-start gap-2",children:[a.jsx("span",{className:"text-blue-500 mt-1",children:"•"}),e]},n))})]}),t.structureFeedback&&a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{className:"font-medium text-purple-700 mb-2",children:"🏗️ 結構回饋"}),a.jsx("p",{className:"text-sm text-gray-700",children:t.structureFeedback})]}),a.jsxs("div",{className:"border-t pt-3",children:[a.jsx("h6",{className:"font-medium text-gray-800 mb-2",children:"📋 整體評語"}),a.jsx("p",{className:"text-sm text-gray-700 bg-white p-3 rounded-lg border",children:t.overallComment})]})]}),Sk=t=>`
    <div class="tabs">
      <button class="tab-btn active" data-tab-target="easy-quiz-content" data-difficulty="easy">簡單</button>
      <button class="tab-btn" data-tab-target="normal-quiz-content" data-difficulty="normal">普通</button>
      <button class="tab-btn" data-tab-target="hard-quiz-content" data-difficulty="hard">困難</button>
    </div>
    <div id="easy-quiz-content" class="tab-content active">
      <!-- Content rendered by JS -->
      <div class="quiz-items-container" data-difficulty="easy"></div>
    </div>
    <div id="normal-quiz-content" class="tab-content">
      <!-- Content rendered by JS -->
      <div class="quiz-items-container" data-difficulty="normal"></div>
    </div>
    <div id="hard-quiz-content" class="tab-content">
      <!-- Content rendered by JS -->
      <div class="quiz-items-container" data-difficulty="hard"></div>
    </div>
    <script type="application/json" id="quizDataStore">
      ${t}
    <\/script>
  `,Ck=(t,e)=>{const n=t.learningObjectives&&t.learningObjectives.length>0?t.learningObjectives.map(C=>`
        <div class="objective-item" style="margin-bottom:20px; padding:16px; background:#f0fdf4; border-left:4px solid #10b981; border-radius:6px;">
          <h3 style="color:#059669; margin-bottom:8px; font-size:1.1em; font-weight:600;">${C.objective}</h3>
          <p style="color:#047857; margin-bottom:8px; line-height:1.6;">${C.description}</p>
          ${C.teachingExample?`
            <div style="background:#ecfdf5; border:1px solid #a7f3d0; padding:12px; border-radius:4px; margin-top:8px;">
              <strong style="color:#065f46; font-size:0.85em; display:block; margin-bottom:4px;">教學示例</strong>
              <span style="color:#047857; font-size:0.9em;">${C.teachingExample}</span>
            </div>`:""}
        </div>`).join(""):"<p>沒有提供教學目標。</p>",i=t.contentBreakdown&&t.contentBreakdown.length>0?t.contentBreakdown.map(C=>`
        <div class="breakdown-item" style="margin-bottom:24px; padding-bottom:20px; border-bottom:1px solid #e2e8f0;">
          <h3 style="color:#0369a1; margin-bottom:8px;">${C.topic}</h3>
          <p style="margin-bottom:12px; color:#475569;">${C.details}</p>
          
          ${C.coreConcept?`
            <div style="background:#eff6ff; border-left:4px solid #3b82f6; padding:12px; border-radius:4px; margin-bottom:12px;">
              <strong style="color:#1e40af; font-size:0.85em; display:block; margin-bottom:4px;">核心概念</strong>
              <span style="color:#1e3a8a; font-size:0.9em;">${C.coreConcept}</span>
            </div>`:""}
          
          ${C.teachingSentences&&C.teachingSentences.length>0?`
            <div style="background:#eef2ff; border-left:4px solid #6366f1; padding:12px; border-radius:4px; margin-bottom:12px;">
              <strong style="color:#4338ca; font-size:0.85em; display:block; margin-bottom:8px;">教學例句</strong>
              <div style="line-height:1.6;">
                ${C.teachingSentences.map((j,k)=>`
                  <div style="color:#312e81; font-size:0.9em; margin-bottom:4px;">
                    <span style="color:#6366f1; font-family:monospace;">${k+1}.</span> ${j}
                  </div>
                `).join("")}
              </div>
            </div>`:""}
          
          ${C.teachingTips?`
            <div style="background:#faf5ff; border-left:4px solid #8b5cf6; padding:12px; border-radius:4px; margin-bottom:12px;">
              <strong style="color:#7c3aed; font-size:0.85em; display:block; margin-bottom:4px;">教學要點提示</strong>
              <span style="color:#6b21a8; font-size:0.9em;">${C.teachingTips}</span>
            </div>`:""}
          
          ${C.teachingExample?`
            <div style="background:#f0f9ff; border-left:4px solid #0ea5e9; padding:12px; border-radius:4px;">
              <strong style="color:#0284c7; font-size:0.85em; display:block; margin-bottom:4px;">教學示例</strong>
              <span style="color:#0c4a6e; font-size:0.9em;">${C.teachingExample}</span>
            </div>`:""}
        </div>`).join(""):"<p>沒有提供內容分解。</p>",l=t.confusingPoints&&t.confusingPoints.length>0?t.confusingPoints.map(C=>`
        <div class="confusing-point-item" style="border:1px solid #e2e8f0; border-radius:8px; padding:20px; margin-bottom:24px; background:#fefefe;">
          <h3 style="color:#b91c1c; margin-bottom:12px; font-size:1.3em; font-weight:600;">${C.point}</h3>
          <p style="margin-bottom:16px; color:#475569; line-height:1.6;">${C.clarification}</p>
          
          ${C.errorType?`
          <div style="background:#fff7ed; border-left:4px solid #f97316; padding:12px; margin-bottom:12px; border-radius:4px;">
            <strong style="color:#c2410c; font-size:0.8em; display:block; margin-bottom:4px;">誤區類型</strong>
            <span style="color:#9a3412; font-size:0.9em;">${C.errorType}</span>
          </div>`:""}
          
          ${C.commonErrors&&C.commonErrors.length>0?`
          <div style="background:#fef2f2; border-left:4px solid #ef4444; padding:12px; margin-bottom:12px; border-radius:4px;">
            <strong style="color:#dc2626; font-size:0.8em; display:block; margin-bottom:8px;">常見錯誤示例</strong>
            <div style="margin-left:0;">
              ${C.commonErrors.map((j,k)=>`
                <div style="color:#991b1b; font-size:0.9em; margin-bottom:4px;">
                  <span style="color:#dc2626; font-family:monospace; margin-right:6px;">${k+1}.</span>${j}
                </div>
              `).join("")}
            </div>
          </div>`:""}
          
          ${C.correctVsWrong&&C.correctVsWrong.length>0?`
          <div style="background:#fefce8; border-left:4px solid #eab308; padding:12px; margin-bottom:12px; border-radius:4px;">
            <strong style="color:#a16207; font-size:0.8em; display:block; margin-bottom:8px;">正確與錯誤對比</strong>
            ${C.correctVsWrong.map((j,k)=>`
              <div style="border:1px solid #fde047; background:#fffbeb; padding:12px; margin-bottom:8px; border-radius:6px;">
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-bottom:8px;">
                  <div style="background:#f0fdf4; padding:10px; border-radius:4px; border:1px solid #bbf7d0;">
                    <strong style="color:#166534; font-size:0.8em; display:block; margin-bottom:4px;">✓ 正確</strong>
                    <span style="color:#15803d; font-size:0.9em;">${j.correct}</span>
                  </div>
                  <div style="background:#fef2f2; padding:10px; border-radius:4px; border:1px solid #fecaca;">
                    <strong style="color:#dc2626; font-size:0.8em; display:block; margin-bottom:4px;">✗ 錯誤</strong>
                    <span style="color:#991b1b; font-size:0.9em;">${j.wrong}</span>
                  </div>
                </div>
                <div style="background:#eff6ff; padding:10px; border-radius:4px; border:1px solid #bfdbfe;">
                  <strong style="color:#1d4ed8; font-size:0.8em; display:block; margin-bottom:4px;">說明</strong>
                  <span style="color:#1e40af; font-size:0.9em;">${j.explanation}</span>
                </div>
              </div>
            `).join("")}
          </div>`:""}
          
          ${C.preventionStrategy?`
          <div style="background:#eff6ff; border-left:4px solid #3b82f6; padding:12px; margin-bottom:12px; border-radius:4px;">
            <strong style="color:#1d4ed8; font-size:0.8em; display:block; margin-bottom:4px;">預防策略</strong>
            <span style="color:#1e40af; font-size:0.9em;">${C.preventionStrategy}</span>
          </div>`:""}
          
          ${C.correctionMethod?`
          <div style="background:#faf5ff; border-left:4px solid #a855f7; padding:12px; margin-bottom:12px; border-radius:4px;">
            <strong style="color:#7c3aed; font-size:0.8em; display:block; margin-bottom:4px;">糾正方法</strong>
            <span style="color:#6b21a8; font-size:0.9em;">${C.correctionMethod}</span>
          </div>`:""}
          
          ${C.practiceActivities&&C.practiceActivities.length>0?`
          <div style="background:#f0f9ff; border-left:4px solid #6366f1; padding:12px; margin-bottom:12px; border-radius:4px;">
            <strong style="color:#4338ca; font-size:0.8em; display:block; margin-bottom:8px;">練習建議</strong>
            <div style="margin-left:0;">
              ${C.practiceActivities.map((j,k)=>`
                <div style="color:#312e81; font-size:0.9em; margin-bottom:4px;">
                  <span style="color:#4338ca; font-family:monospace; margin-right:6px;">${k+1}.</span>${j}
                </div>
              `).join("")}
            </div>
          </div>`:""}
          
          ${C.teachingExample?`
          <div style="background:#f9fafb; border-left:4px solid #6b7280; padding:12px; border-radius:4px;">
            <strong style="color:#374151; font-size:0.8em; display:block; margin-bottom:4px;">教學示例</strong>
            <span style="color:#111827; font-size:0.9em;">${C.teachingExample}</span>
          </div>`:""}
        </div>`).join(""):"<p>沒有提供易混淆點。</p>",o=t.classroomActivities&&t.classroomActivities.length>0?t.classroomActivities.map(C=>`
        <div class="activity-item" style="border:1px solid #e0e7ef; border-radius:6px; padding:16px; margin-bottom:16px; background:#f8fafc;">
          <h3 style="color:#2563eb; margin-bottom:8px; font-size:1.2em;">${C.title}</h3>
          <p style="margin-bottom:12px; color:#475569;">${C.description}</p>
          
          <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-bottom:12px;">
            ${C.objective?`
              <div>
                <strong style="color:#0f172a;">學習目標：</strong>
                <p style="margin:4px 0 0 0; font-size:0.9em;">${C.objective}</p>
              </div>`:""}
            ${C.timing?`
              <div>
                <strong style="color:#0f172a;">使用時機：</strong>
                <p style="margin:4px 0 0 0; font-size:0.9em;">${C.timing}</p>
              </div>`:""}
            ${C.materials?`
            <div>
              <strong style="color:#0f172a;">所需教具：</strong>
              <p style="margin:4px 0 0 0; font-size:0.9em;">${C.materials}</p>
            </div>`:""}
            ${C.environment?`
            <div>
              <strong style="color:#0f172a;">環境要求：</strong>
              <p style="margin:4px 0 0 0; font-size:0.9em;">${C.environment}</p>
            </div>`:""}
          </div>
          
          ${C.steps&&C.steps.length>0?`
            <div style="margin-bottom:12px;">
              <strong style="color:#0f172a;">活動步驟：</strong>
              <ol style="margin:8px 0 0 20px; padding:0;">
                ${C.steps.map(j=>`<li style="margin-bottom:4px; font-size:0.9em;">${j}</li>`).join("")}
              </ol>
            </div>`:""}
          
          ${C.assessmentPoints&&C.assessmentPoints.length>0?`
            <div>
              <strong style="color:#0f172a;">評估重點：</strong>
              <ul style="margin:8px 0 0 20px; padding:0;">
                ${C.assessmentPoints.map(j=>`<li style="margin-bottom:4px; font-size:0.9em;">${j}</li>`).join("")}
              </ul>
            </div>`:""}
        </div>
      `).join(""):"<p>沒有提供課堂活動。</p>",u=t.englishConversation&&t.englishConversation.length>0?t.englishConversation.map(C=>`
        <div class="dialogue-line ${C.speaker==="Speaker A"?"speakerA":"speakerB"}">
          <span class="speaker">${C.speaker}:</span> ${C.line}
        </div>`).join("")+"<p><small><em>注意：互動式語音朗讀和練習功能僅在線上應用程式中提供。</em></small></p>":"<p>沒有提供英文對話內容。</p>",f=t.learningLevels&&t.learningLevels.suggestedLevels&&t.learningLevels.suggestedLevels.length>0?t.learningLevels.suggestedLevels.sort((C,j)=>C.order-j.order).map(C=>`
          <div class="level-item" style="border:1px solid #e0e7ef; border-radius:8px; padding:16px; margin-bottom:12px; background:${C.id===t.learningLevels.defaultLevelId?"#eff8ff":"#f8fafc"}; border-left: 4px solid ${C.id===t.learningLevels.defaultLevelId?"#0ea5e9":"#e2e8f0"};">
            <div style="display:flex; align-items:center; margin-bottom:8px;">
              <div style="width:32px; height:32px; border-radius:50%; background-color:${C.id===t.learningLevels.defaultLevelId?"#0ea5e9":"#94a3b8"}; color:white; display:flex; align-items:center; justify-content:center; font-weight:bold; margin-right:12px;">${C.order}</div>
              <h3 style="margin:0; color:${C.id===t.learningLevels.defaultLevelId?"#0c4a6e":"#334155"};">${C.name}</h3>
              ${C.id===t.learningLevels.defaultLevelId?'<span style="background:#dcfce7; color:#166534; padding:2px 8px; border-radius:4px; font-size:0.8em; margin-left:8px;">預設</span>':""}
            </div>
            <p style="margin:0; color:#64748b; line-height:1.5;">${C.description}</p>
          </div>
        `).join(""):"<p>沒有提供學習程度建議。</p>",g=JSON.stringify(t.onlineInteractiveQuiz||{}),h=Sk(g),x=`
    <!DOCTYPE html>
    <html lang="zh-Hant">
    <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>學習計畫：${e}</title>
      <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"; margin: 0; padding: 20px; line-height: 1.6; background-color: #f4f7f9; color: #333; }
        .container { max-width: 800px; margin: 0 auto; background-color: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1 { color: #2c3e50; text-align: center; border-bottom: 2px solid #3498db; padding-bottom: 10px; }
        h2 { color: #3498db; margin-top: 30px; border-bottom: 1px solid #eee; padding-bottom: 8px;}
        h3 { color: #2980b9; margin-top: 20px; }
        h4 { color: #16a085; margin-top:15px; font-size: 1.1em; margin-bottom: 10px; padding-bottom: 5px; border-bottom: 1px dashed #bdc3c7;}
        ul { list-style-type: disc; padding-left: 20px; }
        li { margin-bottom: 8px; }
        p { margin-bottom: 10px; }
        .section { margin-bottom: 25px; }
        .breakdown-item, .confusing-point-item { border-left: 3px solid #3498db; padding-left: 15px; margin-bottom: 15px; background-color: #fdfdfe; padding:10px; border-radius: 0 4px 4px 0;}
        .dialogue-line { margin-bottom: 8px; padding: 10px; border-radius: 5px; }
        .dialogue-line .speaker { font-weight: bold; color: #0056b3; }
        .dialogue-line.speakerA { background-color: #e7f3ff; border-left: 3px solid #79a6dc; }
        .dialogue-line.speakerB { background-color: #e6fff0; border-left: 3px solid #68d19a; }
        
        .tabs { display: flex; margin-bottom: 0; border-bottom: 1px solid #ccc;}
        .tabs button { padding: 10px 15px; cursor: pointer; border: 1px solid #ccc; background-color: #f0f0f0; margin-right: 0px; border-bottom: none; border-radius: 5px 5px 0 0; font-size: 1em;}
        .tabs button.active { background-color: #fff; border-bottom: 1px solid #fff; color: #3498db; font-weight: bold; position:relative; top:1px;}
        .tab-content { display: none; padding: 15px; border: 1px solid #ccc; border-top: none; background-color:#fff; border-radius: 0 0 5px 5px;}
        .tab-content.active { display: block; }

        .quiz-item { border: 1px solid #e0e0e0; padding: 15px; margin-bottom: 15px; border-radius: 5px; background: #f9f9f9; }
        .quiz-question { font-weight: 500; margin-bottom: 8px; color: #333; }
        .quiz-item p:first-child { margin-top: 0; }
        .quiz-feedback { padding: 8px; margin-top: 10px; border-radius: 4px; font-size: 0.9em; }
        .quiz-feedback.correct { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .quiz-feedback.incorrect { background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .quiz-feedback em { color: #555;}
        
        .tf-options button { margin-right: 10px; padding: 8px 12px; border-radius: 4px; border: 1px solid #ccc; cursor: pointer; }
        .tf-options button.selected.correct, .tf-options button.correct { background-color: #28a745; color: white; border-color: #28a745; }
        .tf-options button.selected.incorrect, .tf-options button.incorrect { background-color: #dc3545; color: white; border-color: #dc3545; }
        .tf-options button:disabled { opacity: 0.7; cursor: not-allowed; }

        .mc-options label { display: block; margin-bottom: 8px; padding: 8px; border: 1px solid #eee; border-radius: 4px; cursor: pointer; transition: background-color 0.2s, border-color 0.2s; }
        .mc-options label:hover { background-color: #f0f8ff; }
        .mc-options input[type="radio"] { margin-right: 8px; }
        .mc-options label.selected { background-color: #e0f0ff; border-color: #79a6dc; }
        .mc-options label.correct-answer { background-color: #d4edda !important; border-color: #c3e6cb !important; color: #155724;}
        .mc-options label.incorrect-selection { background-color: #f8d7da !important; border-color: #f5c6cb !important; color: #721c24;}
        .mc-options label.disabled { cursor: not-allowed; opacity: 0.7; }


        .fb-input { padding: 6px; border: 1px solid #ccc; border-radius: 4px; margin: 0 5px; min-width:100px; }
        .fb-input:disabled { background-color: #eee; }

        .ss-word-bank, .ss-constructed-sentence-area { display: flex; flex-wrap: wrap; gap: 8px; padding: 10px; border: 1px dashed #ccc; border-radius: 4px; min-height: 40px; margin-bottom: 10px; }
        .ss-word-bank { background-color: #f0f8ff; }
        .ss-constructed-sentence-area { background-color: #e6fff0; }
        .ss-word-bank button, .ss-constructed-sentence-area button { padding: 5px 10px; background-color: #add8e6; border: none; border-radius: 4px; cursor: pointer; font-size: 0.95em;}
        .ss-word-bank button:hover, .ss-constructed-sentence-area button:hover { background-color: #90cce0; }
        .ss-constructed-sentence-area button { background-color: #a2d2ff; }


        .quiz-item button.check-answer-btn, .quiz-item button.ss-action-btn {
          background-color: #3498db; color: white; border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 0.9em; margin-top: 10px; transition: background-color 0.2s;
        }
        .quiz-item button.check-answer-btn:hover, .quiz-item button.ss-action-btn:hover { background-color: #2980b9; }
        .quiz-item button.ss-action-btn.ss-clear { background-color: #e74c3c; margin-left: 5px;}
        .quiz-item button.ss-action-btn.ss-clear:hover { background-color: #c0392b; }
        .quiz-item button:disabled, .quiz-item button.check-answer-btn:disabled, .quiz-item button.ss-action-btn:disabled { background-color: #bdc3c7; cursor: not-allowed; opacity: 0.7;}
        
        footer { text-align: center; margin-top: 30px; padding-top: 15px; border-top: 1px solid #ddd; font-size: 0.9em; color: #777; }
      </style>
    </head>
    <body>
      <div class="container">
        <h1>學習計畫：${e}</h1>

        <div class="section">
          <h2>學習程度建議</h2>
          ${f}
        </div>

        <div class="section">
          <h2>教學目標設定</h2>
          ${n}
        </div>

        <div class="section">
          <h2>分解學習內容</h2>
          ${i}
        </div>

        <div class="section">
          <h2>易混淆點識別</h2>
          ${l}
        </div>

        <div class="section">
          <h2>課堂活動與遊戲設計</h2>
          ${o}
        </div>
        
        <div class="section">
          <h2>英文對話練習</h2>
          ${u}
        </div>

        <div class="section">
          <h2>線上互動測驗</h2>
          ${h}
        </div>
        
        <footer>
          <p>此學習計畫由 AI 產生。匯出時間：${new Date().toLocaleString()}</p>
        </footer>
      </div>

      <script>
        document.addEventListener('DOMContentLoaded', () => {
          const quizData = JSON.parse(document.getElementById('quizDataStore').textContent || '{}');
          let sentenceScrambleStates = {}; // To store dynamic state for sentence scramble

          const normalizeText = (str) => {
            if (typeof str !== 'string') return '';
            // Corrected regex for multiple spaces: s+ instead of \\s+
            return str.toLowerCase().replace(/[.,!?;:'"‘'""]/g, '').replace(/s+/g, ' ').trim();
          };

          const renderQuizzesForDifficulty = (difficulty) => {
            const container = document.querySelector(\`.quiz-items-container[data-difficulty="\${difficulty}"]\`);
            if (!container) return;
            container.innerHTML = ''; 
            sentenceScrambleStates[difficulty] = {}; // Reset states for this difficulty

            const difficultyData = quizData[difficulty];
            if (!difficultyData || Object.keys(difficultyData).every(type => !difficultyData[type] || difficultyData[type].length === 0)) {
              container.innerHTML = '<p>此難度沒有測驗資料。</p>';
              return;
            }

            let itemGlobalIndex = 0;
            const typeLabels = { trueFalse: "是非題", multipleChoice: "選擇題", fillInTheBlanks: "填空題", sentenceScramble: "句子重組"};

            const createHtml = (type, q, index) => {
              const questionId = \`\${difficulty}-\${type}-\${index}\`;
              let itemHtml = \`<div class="quiz-item \${type}-item" id="item-\${questionId}">\`;
              
              if (type === 'trueFalse') {
                itemHtml += \`<p class="quiz-question">\${itemGlobalIndex + 1}. \${q.statement}</p>\`;
                itemHtml += \`<div class="tf-options">\`;
                itemHtml += \`<button data-value="true" data-question-id="\${questionId}">是 (True)</button>\`;
                itemHtml += \`<button data-value="false" data-question-id="\${questionId}">非 (False)</button>\`;
                itemHtml += \`</div>\`;
              } else if (type === 'multipleChoice') {
                itemHtml += \`<p class="quiz-question">\${itemGlobalIndex + 1}. \${q.question}</p>\`;
                itemHtml += \`<div class="mc-options">\`;
                q.options.forEach((opt, optIndex) => {
                  itemHtml += \`<label><input type="radio" name="mc-\${questionId}" value="\${optIndex}"> \${String.fromCharCode(65 + optIndex)}. \${opt}</label>\`;
                });
                itemHtml += \`</div>\`;
                itemHtml += \`<button class="check-answer-btn mc-check" data-question-id="\${questionId}">檢查答案</button>\`;
              } else if (type === 'fillInTheBlanks') {
                itemHtml += \`<p class="quiz-question">\${itemGlobalIndex + 1}. \${q.sentenceWithBlank.replace('____', '<input type="text" class="fb-input" id="fb-input-\${questionId}" placeholder="答案">')}</p>\`;
                itemHtml += \`<button class="check-answer-btn fb-check" data-question-id="\${questionId}">檢查答案</button>\`;
              } else if (type === 'sentenceScramble') {
                sentenceScrambleStates[difficulty][questionId] = {
                    availableWords: q.scrambledWords.slice().sort(() => Math.random() - 0.5),
                    constructedWords: []
                };
                itemHtml += \`<p class="quiz-question">\${itemGlobalIndex + 1}. 請重組以下詞彙來形成一個正確的句子：</p>\`;
                itemHtml += \`<p class="ss-instruction">點擊下方詞彙將其加入您的句子，或點擊您句子中的詞彙將其移回詞彙庫。</p>\`
                itemHtml += \`<div class="ss-word-bank" id="ss-bank-\${questionId}">\`;
                sentenceScrambleStates[difficulty][questionId].availableWords.forEach(word => {
                   itemHtml += \`<button class="ss-word" data-word="\${word}" data-question-id="\${questionId}" data-source="bank">\${word}</button>\`;
                });
                itemHtml += \`</div>\`;
                itemHtml += \`<p class="quiz-question">您的句子：</p><div class="ss-constructed-sentence-area" id="ss-area-\${questionId}"></div>\`;
                itemHtml += \`<button class="check-answer-btn ss-check" data-question-id="\${questionId}">檢查句子</button>\`;
                itemHtml += \`<button class="ss-action-btn ss-clear" data-question-id="\${questionId}">清除</button>\`;
              }
              itemHtml += \`<div class="quiz-feedback" id="feedback-\${questionId}"></div></div>\`;
              itemGlobalIndex++;
              return itemHtml;
            };
            
            const quizTypes = ['trueFalse', 'multipleChoice', 'fillInTheBlanks', 'sentenceScramble'];
            let hasContentForDifficulty = false;

            quizTypes.forEach(type => {
              if (difficultyData[type] && difficultyData[type].length > 0) {
                hasContentForDifficulty = true;
                const typeHeader = document.createElement('h4');
                typeHeader.textContent = typeLabels[type];
                container.appendChild(typeHeader);
                difficultyData[type].forEach((q, i) => {
                  const questionElement = document.createElement('div');
                  questionElement.innerHTML = createHtml(type, q, i);
                  container.appendChild(questionElement.firstChild);
                });
              }
            });
             if (!hasContentForDifficulty) {
                 container.innerHTML = '<p>此難度沒有可用的測驗題目。</p>';
            }
          };

          const tabButtons = document.querySelectorAll('.tabs .tab-btn');
          const tabContents = document.querySelectorAll('.tab-content');

          tabButtons.forEach(button => {
            button.addEventListener('click', () => {
              tabButtons.forEach(btn => btn.classList.remove('active'));
              tabContents.forEach(content => content.classList.remove('active'));

              button.classList.add('active');
              const targetContentId = button.getAttribute('data-tab-target');
              document.getElementById(targetContentId).classList.add('active');
              
              const difficulty = button.getAttribute('data-difficulty');
              renderQuizzesForDifficulty(difficulty);
            });
          });
          
          // Initial render for the default active tab
          renderQuizzesForDifficulty('easy');


          // Event delegation for quiz interactions
          document.querySelector('.container').addEventListener('click', (event) => {
            const target = event.target;
            // Ensure target is an HTMLElement before trying to access attributes or match selectors
            if (!(target instanceof HTMLElement)) return;

            const questionId = target.getAttribute('data-question-id');
            if (!questionId) return;

            const [difficulty, type, indexStr] = questionId.split('-');
            const index = parseInt(indexStr);
            const questionData = quizData[difficulty]?.[type]?.[index];
            const feedbackEl = document.getElementById(\`feedback-\${questionId}\`);

            if (!questionData || !feedbackEl) return;

            // True/False
            if (target.matches('.tf-options button')) {
              const selectedValue = target.getAttribute('data-value') === 'true';
              const isCorrect = selectedValue === questionData.isTrue;
              feedbackEl.className = 'quiz-feedback ' + (isCorrect ? 'correct' : 'incorrect');
              let message = isCorrect ? '答對了！' : \`答錯了。正確答案是：\${questionData.isTrue ? '是 (True)' : '非 (False)'}\`;
              if (questionData.explanation) message += \` <em>\${questionData.explanation}</em>\`;
              feedbackEl.innerHTML = message;
              
              target.classList.add('selected', isCorrect ? 'correct' : 'incorrect');
              Array.from(target.parentElement.children).forEach(btn => btn.disabled = true);
            }

            // Multiple Choice Check
            else if (target.matches('.mc-check')) {
              const selectedRadio = document.querySelector(\`input[name="mc-\${questionId}"]:checked\`);
              if (!selectedRadio) {
                feedbackEl.className = 'quiz-feedback incorrect';
                feedbackEl.textContent = '請選擇一個選項。';
                return;
              }
              const selectedOptionIndex = parseInt(selectedRadio.value);
              const isCorrect = selectedOptionIndex === questionData.correctAnswerIndex;
              
              feedbackEl.className = 'quiz-feedback ' + (isCorrect ? 'correct' : 'incorrect');
              let message = isCorrect ? '答對了！' : \`答錯了。正確答案是：\${String.fromCharCode(65 + questionData.correctAnswerIndex)}. \${questionData.options[questionData.correctAnswerIndex]}\`;
              feedbackEl.innerHTML = message;

              // Visually mark options
              const optionLabels = document.querySelectorAll(\`#item-\${questionId} .mc-options label\`);
              optionLabels.forEach((label, idx) => {
                label.classList.add('disabled');
                const radioInLabel = label.querySelector('input');
                if (radioInLabel) radioInLabel.disabled = true;

                if (idx === questionData.correctAnswerIndex) {
                    label.classList.add('correct-answer');
                }
                if (idx === selectedOptionIndex && !isCorrect) {
                    label.classList.add('incorrect-selection');
                }
                 if (idx === selectedOptionIndex) {
                    label.classList.add('selected');
                }
              });
              target.disabled = true;
            }

            // Fill in the Blanks Check
            else if (target.matches('.fb-check')) {
              const inputEl = document.getElementById(\`fb-input-\${questionId}\`);
              // Add null check for inputEl
              if (!inputEl) {
                  console.error('Fill-in-the-blanks input element not found for ID:', \`fb-input-\${questionId}\`);
                  feedbackEl.className = 'quiz-feedback incorrect';
                  feedbackEl.textContent = '發生錯誤：找不到輸入欄位。';
                  return;
              }
              const userAnswer = inputEl.value.trim();
              if (userAnswer === '') {
                feedbackEl.className = 'quiz-feedback incorrect';
                feedbackEl.textContent = '請輸入答案。';
                return;
              }
              const isCorrect = normalizeText(userAnswer) === normalizeText(questionData.correctAnswer);
              feedbackEl.className = 'quiz-feedback ' + (isCorrect ? 'correct' : 'incorrect');
              feedbackEl.textContent = isCorrect ? '答對了！' : \`答錯了。正確答案是： "\${questionData.correctAnswer}"\`;
              inputEl.disabled = true;
              target.disabled = true;
            }
            
            // Sentence Scramble
            else if (target.matches('.ss-word') || target.matches('.ss-check') || target.matches('.ss-clear')) {
                const state = sentenceScrambleStates[difficulty][questionId];
                if (!state) return; // Should not happen if initialized correctly

                const bankEl = document.getElementById(\`ss-bank-\${questionId}\`);
                const areaEl = document.getElementById(\`ss-area-\${questionId}\`);
                
                if(!bankEl || !areaEl) return;


                const redrawScramble = () => {
                    bankEl.innerHTML = '';
                    state.availableWords.forEach(w => {
                        bankEl.innerHTML += \`<button class="ss-word" data-word="\${w}" data-question-id="\${questionId}" data-source="bank">\${w}</button>\`;
                    });
                    areaEl.innerHTML = '';
                    state.constructedWords.forEach(w => {
                        areaEl.innerHTML += \`<button class="ss-word" data-word="\${w}" data-question-id="\${questionId}" data-source="area">\${w}</button>\`;
                    });
                };

                if (target.matches('.ss-word')) {
                    const word = target.getAttribute('data-word');
                    const source = target.getAttribute('data-source');
                    if (source === 'bank') {
                        state.constructedWords.push(word);
                        // Correctly remove only one instance of the word from availableWords
                        const wordIndexInBank = state.availableWords.indexOf(word);
                        if (wordIndexInBank > -1) {
                            state.availableWords.splice(wordIndexInBank, 1);
                        }
                    } else { // source === 'area'
                        state.availableWords.push(word);
                        // Correctly remove only one instance of the word from constructedWords
                        const wordIndexInArea = state.constructedWords.indexOf(word);
                        if (wordIndexInArea > -1) {
                            state.constructedWords.splice(wordIndexInArea, 1);
                        }
                    }
                    redrawScramble();
                    feedbackEl.textContent = '';
                    feedbackEl.className = 'quiz-feedback';
                } else if (target.matches('.ss-check')) {
                    const userAnswer = state.constructedWords.join(' ').trim();
                    const isCorrect = normalizeText(userAnswer) === normalizeText(questionData.originalSentence);
                    feedbackEl.className = 'quiz-feedback ' + (isCorrect ? 'correct' : 'incorrect');
                    feedbackEl.textContent = isCorrect ? '答對了！' : \`答錯了。正確句子是： "\${questionData.originalSentence}"\`;
                    target.disabled = true;
                    const clearButton = document.querySelector(\`#item-\${questionId} .ss-clear\`);
                    if(clearButton) clearButton.disabled = true;
                    
                    bankEl.querySelectorAll('button').forEach(b => b.disabled = true);
                    areaEl.querySelectorAll('button').forEach(b => b.disabled = true);

                } else if (target.matches('.ss-clear')) {
                    state.availableWords = questionData.scrambledWords.slice().sort(() => Math.random() - 0.5);
                    state.constructedWords = [];
                    redrawScramble();
                    feedbackEl.textContent = '';
                    feedbackEl.className = 'quiz-feedback';
                }
            }

          });
        });
      <\/script>
    </body>
    </html>
  `,v=new Blob([x],{type:"text/html;charset=utf-8"}),N=URL.createObjectURL(v),w=document.createElement("a");w.href=N,w.download=`learning-plan-${e.replace(/\s+/g,"_")||"untitled"}.html`,document.body.appendChild(w),w.click(),document.body.removeChild(w),URL.revokeObjectURL(N)},om="AES-GCM",Tk=256,Of=12;async function uv(t,e){const n=new TextEncoder,i=await crypto.subtle.importKey("raw",n.encode(t),"PBKDF2",!1,["deriveKey"]);return crypto.subtle.deriveKey({name:"PBKDF2",salt:e,iterations:1e5,hash:"SHA-256"},i,{name:om,length:Tk},!1,["encrypt","decrypt"])}async function jk(t,e="ai-page-gen-2024"){try{const i=new TextEncoder().encode(t),l=crypto.getRandomValues(new Uint8Array(16)),o=crypto.getRandomValues(new Uint8Array(Of)),u=await uv(e,l),f=await crypto.subtle.encrypt({name:om,iv:o},u,i),g=new Uint8Array(l.length+o.length+f.byteLength);return g.set(l,0),g.set(o,l.length),g.set(new Uint8Array(f),l.length+o.length),Ek(g)}catch(n){throw console.error("加密 API Key 失敗:",n),new Error("加密失敗")}}async function kk(t,e="ai-page-gen-2024"){try{const n=Ak(t),i=n.slice(0,16),l=n.slice(16,16+Of),o=n.slice(16+Of),u=await uv(e,i),f=await crypto.subtle.decrypt({name:om,iv:l},u,o);return new TextDecoder().decode(f)}catch(n){throw console.error("解密 API Key 失敗:",n),new Error("解密失敗或數據已損壞")}}function Ek(t){const e=new Uint8Array(t);let n="";for(let i=0;i<e.byteLength;i++)n+=String.fromCharCode(e[i]);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function Ak(t){const e="=".repeat((4-t.length%4)%4),n=t.replace(/-/g,"+").replace(/_/g,"/")+e,i=atob(n),l=new Uint8Array(i.length);for(let o=0;o<i.length;o++)l[o]=i.charCodeAt(o);return l}function dv(){return typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof crypto.subtle.encrypt=="function"}async function ly(t){if(!dv())return console.warn("Web Crypto API 不支援，將使用明文傳輸（不建議）"),`apikey=${encodeURIComponent(t)}`;const e=await jk(t);return`enckey=${encodeURIComponent(e)}`}async function fv(t){const e=t.get("enckey");if(e&&dv())try{return await kk(decodeURIComponent(e))}catch(i){console.error("解密 API Key 失敗，嘗試使用明文參數:",i)}const n=t.get("apikey");return n?decodeURIComponent(n):null}const _k=({tabs:t,current:e,onChange:n,children:i})=>a.jsxs("div",{children:[a.jsx("div",{className:"flex border-b mb-4",children:t.map(l=>a.jsx("button",{className:`px-4 py-2 -mb-px border-b-2 font-medium transition-colors focus:outline-none ${e===l.key?"border-indigo-600 text-indigo-700 bg-white":"border-transparent text-slate-500 hover:text-indigo-600"}`,onClick:()=>n(l.key),type:"button",children:l.label},l.key))}),a.jsx("div",{children:i[t.findIndex(l=>l.key===e)]})]});class Mk{async generateConversationPractice(e,n){const i=this.buildConversationPrompt(e),l=await rt(i,n);return{id:`conv_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,...l}}buildConversationPrompt(e){return`
Generate an English conversation practice exercise with the following specifications:

Topic: "${e.topic}"
Scenario: "${e.scenario}"
Difficulty Level: ${e.difficulty}
Number of Participants: ${e.participantCount}
Target Duration: ${e.duration} minutes
${e.focusAreas?`Focus Areas: ${e.focusAreas.join(", ")}`:""}
${e.culturalContext?`Cultural Context: ${e.culturalContext}`:""}

Please generate a comprehensive conversation practice in the following JSON structure (output ONLY the JSON, no explanation):

{
  "title": "Conversation title in English",
  "scenario": "Detailed scenario description",
  "description": "What students will learn from this practice",
  "difficulty": "${e.difficulty}",
  "duration": ${e.duration},
  "participants": ["Role 1", "Role 2"${e.participantCount===3?', "Role 3"':""}],
  "dialogue": [
    {
      "id": "turn_001",
      "speaker": "Role name",
      "text": "English dialogue text",
      "translation": "Chinese translation",
      "pronunciation": "Phonetic transcription for difficult words",
      "keyWords": ["key", "vocabulary", "words"],
      "difficulty": "easy|normal|hard",
      "practicePoint": "What to focus on in this turn",
      "expectedResponseHints": ["Hint 1 for student response", "Hint 2"]
    }
    // Generate at least 8-12 dialogue turns for ${e.difficulty} level
    // Easy: 8-10 turns, Normal: 10-14 turns, Hard: 12-16 turns
  ],
  "vocabulary": [
    {
      "word": "vocabulary word",
      "pronunciation": "/fəˈnetɪk/",
      "meaning": "中文意思",
      "example": "Example sentence in English",
      "difficulty": "easy|normal|hard"
    }
    // Include at least 10-15 vocabulary items relevant to the conversation
  ],
  "practiceGoals": [
    "Learning objective 1",
    "Learning objective 2",
    "Learning objective 3"
    // At least 3-5 clear learning objectives
  ],
  "evaluationCriteria": {
    "pronunciation": 0.3,
    "grammar": 0.25,
    "fluency": 0.25,
    "appropriateness": 0.2
  },
  "culturalNotes": [
    "Cultural insight 1",
    "Cultural insight 2"
    // 2-4 cultural notes if relevant
  ],
  "commonMistakes": [
    "Common mistake 1 with correction",
    "Common mistake 2 with correction"
    // 3-5 common mistakes students might make
  ]
}

Requirements for dialogue generation:
1. Each dialogue turn should be natural and contextually appropriate
2. Include varied sentence structures appropriate for ${e.difficulty} level
3. Incorporate the vocabulary items naturally in the dialogue
4. Provide helpful hints for expected student responses
5. Progress the conversation logically toward a natural conclusion
6. Include appropriate greetings, transitions, and closings
7. For ${e.difficulty} level:
   - Easy: Simple present/past tense, basic vocabulary, short sentences
   - Normal: Mixed tenses, moderate vocabulary, compound sentences
   - Hard: Complex grammar, advanced vocabulary, sophisticated expressions

All text content should be natural English with accurate Chinese translations.
Focus on practical, real-world communication that students can apply.
`}async generateConversationFeedback(e,n,i,l){const o=`
Evaluate this English conversation practice response:

Context: ${i.practicePoint}
Expected Response Hints: ${i.expectedHints.join(", ")}
Difficulty Level: ${i.difficulty}

Original Prompt/Situation: "${e}"
Student Response: "${n}"

Please provide detailed feedback in the following JSON format (output ONLY JSON):

{
  "overallScore": [0-100 integer],
  "pronunciationScore": [0-100 integer, based on word choice and structure],
  "grammarScore": [0-100 integer],
  "fluencyScore": [0-100 integer, based on coherence and naturalness],
  "appropriatenessScore": [0-100 integer, based on context appropriateness],
  "feedback": [
    "Positive feedback point 1",
    "Positive feedback point 2",
    "Area for improvement 1",
    "Area for improvement 2"
  ],
  "suggestions": [
    "Specific suggestion 1",
    "Specific suggestion 2",
    "Alternative expression suggestion"
  ],
  "encouragement": "Encouraging message for the student"
}

Evaluation criteria:
- Pronunciation: Judge based on likely pronunciation of written response
- Grammar: Check sentence structure, tenses, word order
- Fluency: Assess naturalness and coherence of response  
- Appropriateness: How well the response fits the conversational context
- Be constructive and encouraging while providing specific improvement suggestions
- Consider the difficulty level when scoring (more lenient for easy level)
`;return await rt(o,l)}getConversationTemplates(){return[{category:"日常生活 (Daily Life)",scenarios:[{title:"在咖啡廳點餐",scenario:"Student plays customer ordering coffee and snacks",suggestedDifficulty:"easy",participants:["顧客","服務員"]},{title:"問路和指路",scenario:"Tourist asking for directions to nearby attractions",suggestedDifficulty:"easy",participants:["遊客","當地人"]},{title:"在超市購物",scenario:"Shopping for groceries and asking about products",suggestedDifficulty:"normal",participants:["顧客","店員"]}]},{category:"商務英文 (Business English)",scenarios:[{title:"工作面試",scenario:"Job interview for entry-level position",suggestedDifficulty:"hard",participants:["求職者","面試官"]},{title:"會議討論",scenario:"Team meeting discussing project progress",suggestedDifficulty:"hard",participants:["經理","員工A","員工B"]},{title:"客戶服務",scenario:"Handling customer complaints and inquiries",suggestedDifficulty:"normal",participants:["客服代表","顧客"]}]},{category:"旅遊英文 (Travel English)",scenarios:[{title:"機場報到",scenario:"Checking in at the airport and asking about flights",suggestedDifficulty:"normal",participants:["旅客","地勤人員"]},{title:"飯店住宿",scenario:"Checking into hotel and requesting services",suggestedDifficulty:"easy",participants:["房客","櫃台人員"]},{title:"觀光景點",scenario:"Visiting tourist attractions and asking about information",suggestedDifficulty:"normal",participants:["遊客","導遊"]}]},{category:"學術英文 (Academic English)",scenarios:[{title:"課堂討論",scenario:"Participating in classroom discussion about a topic",suggestedDifficulty:"hard",participants:["學生","教授"]},{title:"圖書館詢問",scenario:"Asking librarian for help finding resources",suggestedDifficulty:"normal",participants:["學生","圖書館員"]}]}]}getDifficultyLevels(){return[{level:"easy",description:"初級 - 適合英文基礎學習者",characteristics:["使用基本詞彙和簡單句型","現在式和過去式為主","對話內容直接明確","較短的對話輪次","日常生活場景"]},{level:"normal",description:"中級 - 適合有一定英文基礎的學習者",characteristics:["混合使用多種時態","中等難度詞彙","複合句和複雜句型","需要推理和延伸回應","工作和社交場景"]},{level:"hard",description:"高級 - 適合英文程度較好的學習者",characteristics:["高級詞彙和慣用語","複雜的語法結構","需要批判性思考","抽象概念討論","專業和學術場景"]}]}}const Lo=new Mk,Rk=({config:t,onConfigChange:e,onRegenerate:n,isGenerating:i})=>{const l={trueFalse:"是非題",multipleChoice:"選擇題",fillInTheBlanks:"填空題",sentenceScramble:"句子重組",memoryCardGame:"翻卡記憶"},o=(h,x)=>{const v=yr[h],N=Math.max(0,Math.min(v,x)),w={easy:{...t.easy,[h]:N},normal:{...t.normal,[h]:N},hard:{...t.hard,[h]:N}};e(w)},u=()=>{e(tv)},f=()=>{const h=Object.values(t.easy).reduce((N,w)=>N+w,0),x=Object.values(t.normal).reduce((N,w)=>N+w,0),v=Object.values(t.hard).reduce((N,w)=>N+w,0);return h+x+v},g=h=>t.easy[h]+t.normal[h]+t.hard[h];return a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6 border border-indigo-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-2 flex items-center gap-2",children:[a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6 text-indigo-600",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a6.759 6.759 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})]}),"測驗題數統一設定"]}),a.jsxs("p",{className:"text-sm text-gray-600",children:["一次設定所有難度的題目數量 • 總計: ",a.jsx("span",{className:"font-semibold text-indigo-600",children:f()})," 題"]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:u,className:"px-3 py-2 text-sm bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors",children:"重設預設"}),a.jsx("button",{onClick:n,disabled:i,className:"px-6 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-lg hover:from-indigo-700 hover:to-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all transform hover:scale-105 shadow-md flex items-center gap-2 font-medium",children:i?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"animate-spin",children:"⏳"}),"重新生成中..."]}):a.jsxs(a.Fragment,{children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"})}),"更新設定並重新出題"]})})]})]}),a.jsx("div",{className:"space-y-6",children:Object.keys(l).map(h=>{const x=yr[h],v=t.easy[h],N=g(h);return a.jsxs("div",{className:"bg-gradient-to-r from-slate-50 to-gray-50 rounded-lg p-5 border border-slate-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-3 h-3 bg-indigo-500 rounded-full"}),a.jsx("h4",{className:"font-semibold text-lg text-gray-800",children:l[h]}),a.jsxs("span",{className:"text-sm text-gray-500 bg-white px-2 py-1 rounded-full border",children:["限制: 0-",x," 題"]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"text-sm text-gray-600",children:["各難度: ",a.jsx("span",{className:"font-mono font-medium",children:v})," 題"]}),a.jsxs("div",{className:"text-xs text-indigo-600",children:["總計: ",a.jsx("span",{className:"font-semibold",children:N})," 題"]})]})]}),a.jsxs("div",{className:"flex items-center justify-center gap-4",children:[a.jsx("button",{onClick:()=>o(h,v-1),className:"w-10 h-10 rounded-full bg-red-100 hover:bg-red-200 flex items-center justify-center text-red-600 font-bold text-lg transition-colors shadow-sm",disabled:v<=0,children:"-"}),a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:"text-3xl font-bold text-gray-800 mb-1",children:v}),a.jsx("div",{className:"text-xs text-gray-500",children:"每個難度"})]}),a.jsx("button",{onClick:()=>o(h,v+1),className:"w-10 h-10 rounded-full bg-green-100 hover:bg-green-200 flex items-center justify-center text-green-600 font-bold text-lg transition-colors shadow-sm",disabled:v>=x,children:"+"})]}),a.jsxs("div",{className:"mt-4 flex justify-center gap-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center text-green-700 text-sm font-semibold mb-1",children:t.easy[h]}),a.jsx("div",{className:"text-xs text-green-700",children:"簡單"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center text-yellow-700 text-sm font-semibold mb-1",children:t.normal[h]}),a.jsx("div",{className:"text-xs text-yellow-700",children:"普通"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center text-red-700 text-sm font-semibold mb-1",children:t.hard[h]}),a.jsx("div",{className:"text-xs text-red-700",children:"困難"})]})]})]},h)})}),a.jsx("div",{className:"mt-6 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-200",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6 text-blue-600 mt-0.5 flex-shrink-0",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"})}),a.jsxs("div",{className:"text-sm text-blue-800",children:[a.jsx("p",{className:"font-medium mb-2",children:"📝 使用說明："}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-xs",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-blue-900 mb-1",children:"• 統一設定模式"}),a.jsx("p",{children:"調整題數會同時套用到簡單、普通、困難三種難度"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-blue-900 mb-1",children:"• 題數限制"}),a.jsx("p",{children:"一般題型: 0-10題 | 翻卡記憶: 0-2題"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-blue-900 mb-1",children:"• 跳過題型"}),a.jsx("p",{children:"設定為 0 題可完全跳過該種題型"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-blue-900 mb-1",children:"• 記憶卡遊戲"}),a.jsx("p",{children:"每題包含多對卡片，建議 1-2 題即可"})]})]})]})]})})]})};var hs={},Rd,oy;function Ik(){return oy||(oy=1,Rd=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),Rd}var Id={},Gi={},cy;function Cr(){if(cy)return Gi;cy=1;let t;const e=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return Gi.getSymbolSize=function(i){if(!i)throw new Error('"version" cannot be null or undefined');if(i<1||i>40)throw new Error('"version" should be in range from 1 to 40');return i*4+17},Gi.getSymbolTotalCodewords=function(i){return e[i]},Gi.getBCHDigit=function(n){let i=0;for(;n!==0;)i++,n>>>=1;return i},Gi.setToSJISFunction=function(i){if(typeof i!="function")throw new Error('"toSJISFunc" is not a valid function.');t=i},Gi.isKanjiModeEnabled=function(){return typeof t<"u"},Gi.toSJIS=function(i){return t(i)},Gi}var Dd={},uy;function cm(){return uy||(uy=1,function(t){t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2};function e(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+n)}}t.isValid=function(i){return i&&typeof i.bit<"u"&&i.bit>=0&&i.bit<4},t.from=function(i,l){if(t.isValid(i))return i;try{return e(i)}catch{return l}}}(Dd)),Dd}var Ld,dy;function Dk(){if(dy)return Ld;dy=1;function t(){this.buffer=[],this.length=0}return t.prototype={get:function(e){const n=Math.floor(e/8);return(this.buffer[n]>>>7-e%8&1)===1},put:function(e,n){for(let i=0;i<n;i++)this.putBit((e>>>n-i-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(e){const n=Math.floor(this.length/8);this.buffer.length<=n&&this.buffer.push(0),e&&(this.buffer[n]|=128>>>this.length%8),this.length++}},Ld=t,Ld}var Pd,fy;function Lk(){if(fy)return Pd;fy=1;function t(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}return t.prototype.set=function(e,n,i,l){const o=e*this.size+n;this.data[o]=i,l&&(this.reservedBit[o]=!0)},t.prototype.get=function(e,n){return this.data[e*this.size+n]},t.prototype.xor=function(e,n,i){this.data[e*this.size+n]^=i},t.prototype.isReserved=function(e,n){return this.reservedBit[e*this.size+n]},Pd=t,Pd}var Od={},my;function Pk(){return my||(my=1,function(t){const e=Cr().getSymbolSize;t.getRowColCoords=function(i){if(i===1)return[];const l=Math.floor(i/7)+2,o=e(i),u=o===145?26:Math.ceil((o-13)/(2*l-2))*2,f=[o-7];for(let g=1;g<l-1;g++)f[g]=f[g-1]-u;return f.push(6),f.reverse()},t.getPositions=function(i){const l=[],o=t.getRowColCoords(i),u=o.length;for(let f=0;f<u;f++)for(let g=0;g<u;g++)f===0&&g===0||f===0&&g===u-1||f===u-1&&g===0||l.push([o[f],o[g]]);return l}}(Od)),Od}var Bd={},hy;function Ok(){if(hy)return Bd;hy=1;const t=Cr().getSymbolSize,e=7;return Bd.getPositions=function(i){const l=t(i);return[[0,0],[l-e,0],[0,l-e]]},Bd}var Ud={},py;function Bk(){return py||(py=1,function(t){t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const e={N1:3,N2:3,N3:40,N4:10};t.isValid=function(l){return l!=null&&l!==""&&!isNaN(l)&&l>=0&&l<=7},t.from=function(l){return t.isValid(l)?parseInt(l,10):void 0},t.getPenaltyN1=function(l){const o=l.size;let u=0,f=0,g=0,h=null,x=null;for(let v=0;v<o;v++){f=g=0,h=x=null;for(let N=0;N<o;N++){let w=l.get(v,N);w===h?f++:(f>=5&&(u+=e.N1+(f-5)),h=w,f=1),w=l.get(N,v),w===x?g++:(g>=5&&(u+=e.N1+(g-5)),x=w,g=1)}f>=5&&(u+=e.N1+(f-5)),g>=5&&(u+=e.N1+(g-5))}return u},t.getPenaltyN2=function(l){const o=l.size;let u=0;for(let f=0;f<o-1;f++)for(let g=0;g<o-1;g++){const h=l.get(f,g)+l.get(f,g+1)+l.get(f+1,g)+l.get(f+1,g+1);(h===4||h===0)&&u++}return u*e.N2},t.getPenaltyN3=function(l){const o=l.size;let u=0,f=0,g=0;for(let h=0;h<o;h++){f=g=0;for(let x=0;x<o;x++)f=f<<1&2047|l.get(h,x),x>=10&&(f===1488||f===93)&&u++,g=g<<1&2047|l.get(x,h),x>=10&&(g===1488||g===93)&&u++}return u*e.N3},t.getPenaltyN4=function(l){let o=0;const u=l.data.length;for(let g=0;g<u;g++)o+=l.data[g];return Math.abs(Math.ceil(o*100/u/5)-10)*e.N4};function n(i,l,o){switch(i){case t.Patterns.PATTERN000:return(l+o)%2===0;case t.Patterns.PATTERN001:return l%2===0;case t.Patterns.PATTERN010:return o%3===0;case t.Patterns.PATTERN011:return(l+o)%3===0;case t.Patterns.PATTERN100:return(Math.floor(l/2)+Math.floor(o/3))%2===0;case t.Patterns.PATTERN101:return l*o%2+l*o%3===0;case t.Patterns.PATTERN110:return(l*o%2+l*o%3)%2===0;case t.Patterns.PATTERN111:return(l*o%3+(l+o)%2)%2===0;default:throw new Error("bad maskPattern:"+i)}}t.applyMask=function(l,o){const u=o.size;for(let f=0;f<u;f++)for(let g=0;g<u;g++)o.isReserved(g,f)||o.xor(g,f,n(l,g,f))},t.getBestMask=function(l,o){const u=Object.keys(t.Patterns).length;let f=0,g=1/0;for(let h=0;h<u;h++){o(h),t.applyMask(h,l);const x=t.getPenaltyN1(l)+t.getPenaltyN2(l)+t.getPenaltyN3(l)+t.getPenaltyN4(l);t.applyMask(h,l),x<g&&(g=x,f=h)}return f}}(Ud)),Ud}var So={},gy;function mv(){if(gy)return So;gy=1;const t=cm(),e=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],n=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return So.getBlocksCount=function(l,o){switch(o){case t.L:return e[(l-1)*4+0];case t.M:return e[(l-1)*4+1];case t.Q:return e[(l-1)*4+2];case t.H:return e[(l-1)*4+3];default:return}},So.getTotalCodewordsCount=function(l,o){switch(o){case t.L:return n[(l-1)*4+0];case t.M:return n[(l-1)*4+1];case t.Q:return n[(l-1)*4+2];case t.H:return n[(l-1)*4+3];default:return}},So}var zd={},Oa={},xy;function Uk(){if(xy)return Oa;xy=1;const t=new Uint8Array(512),e=new Uint8Array(256);return function(){let i=1;for(let l=0;l<255;l++)t[l]=i,e[i]=l,i<<=1,i&256&&(i^=285);for(let l=255;l<512;l++)t[l]=t[l-255]}(),Oa.log=function(i){if(i<1)throw new Error("log("+i+")");return e[i]},Oa.exp=function(i){return t[i]},Oa.mul=function(i,l){return i===0||l===0?0:t[e[i]+e[l]]},Oa}var yy;function zk(){return yy||(yy=1,function(t){const e=Uk();t.mul=function(i,l){const o=new Uint8Array(i.length+l.length-1);for(let u=0;u<i.length;u++)for(let f=0;f<l.length;f++)o[u+f]^=e.mul(i[u],l[f]);return o},t.mod=function(i,l){let o=new Uint8Array(i);for(;o.length-l.length>=0;){const u=o[0];for(let g=0;g<l.length;g++)o[g]^=e.mul(l[g],u);let f=0;for(;f<o.length&&o[f]===0;)f++;o=o.slice(f)}return o},t.generateECPolynomial=function(i){let l=new Uint8Array([1]);for(let o=0;o<i;o++)l=t.mul(l,new Uint8Array([1,e.exp(o)]));return l}}(zd)),zd}var Vd,vy;function Vk(){if(vy)return Vd;vy=1;const t=zk();function e(n){this.genPoly=void 0,this.degree=n,this.degree&&this.initialize(this.degree)}return e.prototype.initialize=function(i){this.degree=i,this.genPoly=t.generateECPolynomial(this.degree)},e.prototype.encode=function(i){if(!this.genPoly)throw new Error("Encoder not initialized");const l=new Uint8Array(i.length+this.degree);l.set(i);const o=t.mod(l,this.genPoly),u=this.degree-o.length;if(u>0){const f=new Uint8Array(this.degree);return f.set(o,u),f}return o},Vd=e,Vd}var $d={},qd={},Fd={},by;function hv(){return by||(by=1,Fd.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40}),Fd}var Fn={},wy;function pv(){if(wy)return Fn;wy=1;const t="[0-9]+",e="[A-Z $%*+\\-./:]+";let n="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";n=n.replace(/u/g,"\\u");const i="(?:(?![A-Z0-9 $%*+\\-./:]|"+n+`)(?:.|[\r
]))+`;Fn.KANJI=new RegExp(n,"g"),Fn.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),Fn.BYTE=new RegExp(i,"g"),Fn.NUMERIC=new RegExp(t,"g"),Fn.ALPHANUMERIC=new RegExp(e,"g");const l=new RegExp("^"+n+"$"),o=new RegExp("^"+t+"$"),u=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return Fn.testKanji=function(g){return l.test(g)},Fn.testNumeric=function(g){return o.test(g)},Fn.testAlphanumeric=function(g){return u.test(g)},Fn}var Ny;function Tr(){return Ny||(Ny=1,function(t){const e=hv(),n=pv();t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(o,u){if(!o.ccBits)throw new Error("Invalid mode: "+o);if(!e.isValid(u))throw new Error("Invalid version: "+u);return u>=1&&u<10?o.ccBits[0]:u<27?o.ccBits[1]:o.ccBits[2]},t.getBestModeForData=function(o){return n.testNumeric(o)?t.NUMERIC:n.testAlphanumeric(o)?t.ALPHANUMERIC:n.testKanji(o)?t.KANJI:t.BYTE},t.toString=function(o){if(o&&o.id)return o.id;throw new Error("Invalid mode")},t.isValid=function(o){return o&&o.bit&&o.ccBits};function i(l){if(typeof l!="string")throw new Error("Param is not a string");switch(l.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+l)}}t.from=function(o,u){if(t.isValid(o))return o;try{return i(o)}catch{return u}}}(qd)),qd}var Sy;function $k(){return Sy||(Sy=1,function(t){const e=Cr(),n=mv(),i=cm(),l=Tr(),o=hv(),u=7973,f=e.getBCHDigit(u);function g(N,w,C){for(let j=1;j<=40;j++)if(w<=t.getCapacity(j,C,N))return j}function h(N,w){return l.getCharCountIndicator(N,w)+4}function x(N,w){let C=0;return N.forEach(function(j){const k=h(j.mode,w);C+=k+j.getBitsLength()}),C}function v(N,w){for(let C=1;C<=40;C++)if(x(N,C)<=t.getCapacity(C,w,l.MIXED))return C}t.from=function(w,C){return o.isValid(w)?parseInt(w,10):C},t.getCapacity=function(w,C,j){if(!o.isValid(w))throw new Error("Invalid QR Code version");typeof j>"u"&&(j=l.BYTE);const k=e.getSymbolTotalCodewords(w),E=n.getTotalCodewordsCount(w,C),L=(k-E)*8;if(j===l.MIXED)return L;const D=L-h(j,w);switch(j){case l.NUMERIC:return Math.floor(D/10*3);case l.ALPHANUMERIC:return Math.floor(D/11*2);case l.KANJI:return Math.floor(D/13);case l.BYTE:default:return Math.floor(D/8)}},t.getBestVersionForData=function(w,C){let j;const k=i.from(C,i.M);if(Array.isArray(w)){if(w.length>1)return v(w,k);if(w.length===0)return 1;j=w[0]}else j=w;return g(j.mode,j.getLength(),k)},t.getEncodedBits=function(w){if(!o.isValid(w)||w<7)throw new Error("Invalid QR Code version");let C=w<<12;for(;e.getBCHDigit(C)-f>=0;)C^=u<<e.getBCHDigit(C)-f;return w<<12|C}}($d)),$d}var Hd={},Cy;function qk(){if(Cy)return Hd;Cy=1;const t=Cr(),e=1335,n=21522,i=t.getBCHDigit(e);return Hd.getEncodedBits=function(o,u){const f=o.bit<<3|u;let g=f<<10;for(;t.getBCHDigit(g)-i>=0;)g^=e<<t.getBCHDigit(g)-i;return(f<<10|g)^n},Hd}var Gd={},Jd,Ty;function Fk(){if(Ty)return Jd;Ty=1;const t=Tr();function e(n){this.mode=t.NUMERIC,this.data=n.toString()}return e.getBitsLength=function(i){return 10*Math.floor(i/3)+(i%3?i%3*3+1:0)},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(i){let l,o,u;for(l=0;l+3<=this.data.length;l+=3)o=this.data.substr(l,3),u=parseInt(o,10),i.put(u,10);const f=this.data.length-l;f>0&&(o=this.data.substr(l),u=parseInt(o,10),i.put(u,f*3+1))},Jd=e,Jd}var Yd,jy;function Hk(){if(jy)return Yd;jy=1;const t=Tr(),e=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function n(i){this.mode=t.ALPHANUMERIC,this.data=i}return n.getBitsLength=function(l){return 11*Math.floor(l/2)+6*(l%2)},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(l){let o;for(o=0;o+2<=this.data.length;o+=2){let u=e.indexOf(this.data[o])*45;u+=e.indexOf(this.data[o+1]),l.put(u,11)}this.data.length%2&&l.put(e.indexOf(this.data[o]),6)},Yd=n,Yd}var Zd,ky;function Gk(){if(ky)return Zd;ky=1;const t=Tr();function e(n){this.mode=t.BYTE,typeof n=="string"?this.data=new TextEncoder().encode(n):this.data=new Uint8Array(n)}return e.getBitsLength=function(i){return i*8},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(n){for(let i=0,l=this.data.length;i<l;i++)n.put(this.data[i],8)},Zd=e,Zd}var Qd,Ey;function Jk(){if(Ey)return Qd;Ey=1;const t=Tr(),e=Cr();function n(i){this.mode=t.KANJI,this.data=i}return n.getBitsLength=function(l){return l*13},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(i){let l;for(l=0;l<this.data.length;l++){let o=e.toSJIS(this.data[l]);if(o>=33088&&o<=40956)o-=33088;else if(o>=57408&&o<=60351)o-=49472;else throw new Error("Invalid SJIS character: "+this.data[l]+`
Make sure your charset is UTF-8`);o=(o>>>8&255)*192+(o&255),i.put(o,13)}},Qd=n,Qd}var Kd={exports:{}},Ay;function Yk(){return Ay||(Ay=1,function(t){var e={single_source_shortest_paths:function(n,i,l){var o={},u={};u[i]=0;var f=e.PriorityQueue.make();f.push(i,0);for(var g,h,x,v,N,w,C,j,k;!f.empty();){g=f.pop(),h=g.value,v=g.cost,N=n[h]||{};for(x in N)N.hasOwnProperty(x)&&(w=N[x],C=v+w,j=u[x],k=typeof u[x]>"u",(k||j>C)&&(u[x]=C,f.push(x,C),o[x]=h))}if(typeof l<"u"&&typeof u[l]>"u"){var E=["Could not find a path from ",i," to ",l,"."].join("");throw new Error(E)}return o},extract_shortest_path_from_predecessor_list:function(n,i){for(var l=[],o=i;o;)l.push(o),n[o],o=n[o];return l.reverse(),l},find_path:function(n,i,l){var o=e.single_source_shortest_paths(n,i,l);return e.extract_shortest_path_from_predecessor_list(o,l)},PriorityQueue:{make:function(n){var i=e.PriorityQueue,l={},o;n=n||{};for(o in i)i.hasOwnProperty(o)&&(l[o]=i[o]);return l.queue=[],l.sorter=n.sorter||i.default_sorter,l},default_sorter:function(n,i){return n.cost-i.cost},push:function(n,i){var l={value:n,cost:i};this.queue.push(l),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};t.exports=e}(Kd)),Kd.exports}var _y;function Zk(){return _y||(_y=1,function(t){const e=Tr(),n=Fk(),i=Hk(),l=Gk(),o=Jk(),u=pv(),f=Cr(),g=Yk();function h(E){return unescape(encodeURIComponent(E)).length}function x(E,L,D){const O=[];let H;for(;(H=E.exec(D))!==null;)O.push({data:H[0],index:H.index,mode:L,length:H[0].length});return O}function v(E){const L=x(u.NUMERIC,e.NUMERIC,E),D=x(u.ALPHANUMERIC,e.ALPHANUMERIC,E);let O,H;return f.isKanjiModeEnabled()?(O=x(u.BYTE,e.BYTE,E),H=x(u.KANJI,e.KANJI,E)):(O=x(u.BYTE_KANJI,e.BYTE,E),H=[]),L.concat(D,O,H).sort(function(R,q){return R.index-q.index}).map(function(R){return{data:R.data,mode:R.mode,length:R.length}})}function N(E,L){switch(L){case e.NUMERIC:return n.getBitsLength(E);case e.ALPHANUMERIC:return i.getBitsLength(E);case e.KANJI:return o.getBitsLength(E);case e.BYTE:return l.getBitsLength(E)}}function w(E){return E.reduce(function(L,D){const O=L.length-1>=0?L[L.length-1]:null;return O&&O.mode===D.mode?(L[L.length-1].data+=D.data,L):(L.push(D),L)},[])}function C(E){const L=[];for(let D=0;D<E.length;D++){const O=E[D];switch(O.mode){case e.NUMERIC:L.push([O,{data:O.data,mode:e.ALPHANUMERIC,length:O.length},{data:O.data,mode:e.BYTE,length:O.length}]);break;case e.ALPHANUMERIC:L.push([O,{data:O.data,mode:e.BYTE,length:O.length}]);break;case e.KANJI:L.push([O,{data:O.data,mode:e.BYTE,length:h(O.data)}]);break;case e.BYTE:L.push([{data:O.data,mode:e.BYTE,length:h(O.data)}])}}return L}function j(E,L){const D={},O={start:{}};let H=["start"];for(let I=0;I<E.length;I++){const R=E[I],q=[];for(let B=0;B<R.length;B++){const ee=R[B],G=""+I+B;q.push(G),D[G]={node:ee,lastCount:0},O[G]={};for(let Y=0;Y<H.length;Y++){const z=H[Y];D[z]&&D[z].node.mode===ee.mode?(O[z][G]=N(D[z].lastCount+ee.length,ee.mode)-N(D[z].lastCount,ee.mode),D[z].lastCount+=ee.length):(D[z]&&(D[z].lastCount=ee.length),O[z][G]=N(ee.length,ee.mode)+4+e.getCharCountIndicator(ee.mode,L))}}H=q}for(let I=0;I<H.length;I++)O[H[I]].end=0;return{map:O,table:D}}function k(E,L){let D;const O=e.getBestModeForData(E);if(D=e.from(L,O),D!==e.BYTE&&D.bit<O.bit)throw new Error('"'+E+'" cannot be encoded with mode '+e.toString(D)+`.
 Suggested mode is: `+e.toString(O));switch(D===e.KANJI&&!f.isKanjiModeEnabled()&&(D=e.BYTE),D){case e.NUMERIC:return new n(E);case e.ALPHANUMERIC:return new i(E);case e.KANJI:return new o(E);case e.BYTE:return new l(E)}}t.fromArray=function(L){return L.reduce(function(D,O){return typeof O=="string"?D.push(k(O,null)):O.data&&D.push(k(O.data,O.mode)),D},[])},t.fromString=function(L,D){const O=v(L,f.isKanjiModeEnabled()),H=C(O),I=j(H,D),R=g.find_path(I.map,"start","end"),q=[];for(let B=1;B<R.length-1;B++)q.push(I.table[R[B]].node);return t.fromArray(w(q))},t.rawSplit=function(L){return t.fromArray(v(L,f.isKanjiModeEnabled()))}}(Gd)),Gd}var My;function Qk(){if(My)return Id;My=1;const t=Cr(),e=cm(),n=Dk(),i=Lk(),l=Pk(),o=Ok(),u=Bk(),f=mv(),g=Vk(),h=$k(),x=qk(),v=Tr(),N=Zk();function w(I,R){const q=I.size,B=o.getPositions(R);for(let ee=0;ee<B.length;ee++){const G=B[ee][0],Y=B[ee][1];for(let z=-1;z<=7;z++)if(!(G+z<=-1||q<=G+z))for(let $=-1;$<=7;$++)Y+$<=-1||q<=Y+$||(z>=0&&z<=6&&($===0||$===6)||$>=0&&$<=6&&(z===0||z===6)||z>=2&&z<=4&&$>=2&&$<=4?I.set(G+z,Y+$,!0,!0):I.set(G+z,Y+$,!1,!0))}}function C(I){const R=I.size;for(let q=8;q<R-8;q++){const B=q%2===0;I.set(q,6,B,!0),I.set(6,q,B,!0)}}function j(I,R){const q=l.getPositions(R);for(let B=0;B<q.length;B++){const ee=q[B][0],G=q[B][1];for(let Y=-2;Y<=2;Y++)for(let z=-2;z<=2;z++)Y===-2||Y===2||z===-2||z===2||Y===0&&z===0?I.set(ee+Y,G+z,!0,!0):I.set(ee+Y,G+z,!1,!0)}}function k(I,R){const q=I.size,B=h.getEncodedBits(R);let ee,G,Y;for(let z=0;z<18;z++)ee=Math.floor(z/3),G=z%3+q-8-3,Y=(B>>z&1)===1,I.set(ee,G,Y,!0),I.set(G,ee,Y,!0)}function E(I,R,q){const B=I.size,ee=x.getEncodedBits(R,q);let G,Y;for(G=0;G<15;G++)Y=(ee>>G&1)===1,G<6?I.set(G,8,Y,!0):G<8?I.set(G+1,8,Y,!0):I.set(B-15+G,8,Y,!0),G<8?I.set(8,B-G-1,Y,!0):G<9?I.set(8,15-G-1+1,Y,!0):I.set(8,15-G-1,Y,!0);I.set(B-8,8,1,!0)}function L(I,R){const q=I.size;let B=-1,ee=q-1,G=7,Y=0;for(let z=q-1;z>0;z-=2)for(z===6&&z--;;){for(let $=0;$<2;$++)if(!I.isReserved(ee,z-$)){let Q=!1;Y<R.length&&(Q=(R[Y]>>>G&1)===1),I.set(ee,z-$,Q),G--,G===-1&&(Y++,G=7)}if(ee+=B,ee<0||q<=ee){ee-=B,B=-B;break}}}function D(I,R,q){const B=new n;q.forEach(function($){B.put($.mode.bit,4),B.put($.getLength(),v.getCharCountIndicator($.mode,I)),$.write(B)});const ee=t.getSymbolTotalCodewords(I),G=f.getTotalCodewordsCount(I,R),Y=(ee-G)*8;for(B.getLengthInBits()+4<=Y&&B.put(0,4);B.getLengthInBits()%8!==0;)B.putBit(0);const z=(Y-B.getLengthInBits())/8;for(let $=0;$<z;$++)B.put($%2?17:236,8);return O(B,I,R)}function O(I,R,q){const B=t.getSymbolTotalCodewords(R),ee=f.getTotalCodewordsCount(R,q),G=B-ee,Y=f.getBlocksCount(R,q),z=B%Y,$=Y-z,Q=Math.floor(B/Y),P=Math.floor(G/Y),K=P+1,pe=Q-P,X=new g(pe);let S=0;const V=new Array(Y),ie=new Array(Y);let _=0;const ve=new Uint8Array(I.buffer);for(let be=0;be<Y;be++){const Ve=be<$?P:K;V[be]=ve.slice(S,S+Ve),ie[be]=X.encode(V[be]),S+=Ve,_=Math.max(_,Ve)}const Se=new Uint8Array(B);let se=0,he,de;for(he=0;he<_;he++)for(de=0;de<Y;de++)he<V[de].length&&(Se[se++]=V[de][he]);for(he=0;he<pe;he++)for(de=0;de<Y;de++)Se[se++]=ie[de][he];return Se}function H(I,R,q,B){let ee;if(Array.isArray(I))ee=N.fromArray(I);else if(typeof I=="string"){let Q=R;if(!Q){const P=N.rawSplit(I);Q=h.getBestVersionForData(P,q)}ee=N.fromString(I,Q||40)}else throw new Error("Invalid data");const G=h.getBestVersionForData(ee,q);if(!G)throw new Error("The amount of data is too big to be stored in a QR Code");if(!R)R=G;else if(R<G)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+G+`.
`);const Y=D(R,q,ee),z=t.getSymbolSize(R),$=new i(z);return w($,R),C($),j($,R),E($,q,0),R>=7&&k($,R),L($,Y),isNaN(B)&&(B=u.getBestMask($,E.bind(null,$,q))),u.applyMask(B,$),E($,q,B),{modules:$,version:R,errorCorrectionLevel:q,maskPattern:B,segments:ee}}return Id.create=function(R,q){if(typeof R>"u"||R==="")throw new Error("No input text");let B=e.M,ee,G;return typeof q<"u"&&(B=e.from(q.errorCorrectionLevel,e.M),ee=h.from(q.version),G=u.from(q.maskPattern),q.toSJISFunc&&t.setToSJISFunction(q.toSJISFunc)),H(R,ee,B,G)},Id}var Wd={},Xd={},Ry;function gv(){return Ry||(Ry=1,function(t){function e(n){if(typeof n=="number"&&(n=n.toString()),typeof n!="string")throw new Error("Color should be defined as hex string");let i=n.slice().replace("#","").split("");if(i.length<3||i.length===5||i.length>8)throw new Error("Invalid hex color: "+n);(i.length===3||i.length===4)&&(i=Array.prototype.concat.apply([],i.map(function(o){return[o,o]}))),i.length===6&&i.push("F","F");const l=parseInt(i.join(""),16);return{r:l>>24&255,g:l>>16&255,b:l>>8&255,a:l&255,hex:"#"+i.slice(0,6).join("")}}t.getOptions=function(i){i||(i={}),i.color||(i.color={});const l=typeof i.margin>"u"||i.margin===null||i.margin<0?4:i.margin,o=i.width&&i.width>=21?i.width:void 0,u=i.scale||4;return{width:o,scale:o?4:u,margin:l,color:{dark:e(i.color.dark||"#000000ff"),light:e(i.color.light||"#ffffffff")},type:i.type,rendererOpts:i.rendererOpts||{}}},t.getScale=function(i,l){return l.width&&l.width>=i+l.margin*2?l.width/(i+l.margin*2):l.scale},t.getImageWidth=function(i,l){const o=t.getScale(i,l);return Math.floor((i+l.margin*2)*o)},t.qrToImageData=function(i,l,o){const u=l.modules.size,f=l.modules.data,g=t.getScale(u,o),h=Math.floor((u+o.margin*2)*g),x=o.margin*g,v=[o.color.light,o.color.dark];for(let N=0;N<h;N++)for(let w=0;w<h;w++){let C=(N*h+w)*4,j=o.color.light;if(N>=x&&w>=x&&N<h-x&&w<h-x){const k=Math.floor((N-x)/g),E=Math.floor((w-x)/g);j=v[f[k*u+E]?1:0]}i[C++]=j.r,i[C++]=j.g,i[C++]=j.b,i[C]=j.a}}}(Xd)),Xd}var Iy;function Kk(){return Iy||(Iy=1,function(t){const e=gv();function n(l,o,u){l.clearRect(0,0,o.width,o.height),o.style||(o.style={}),o.height=u,o.width=u,o.style.height=u+"px",o.style.width=u+"px"}function i(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}t.render=function(o,u,f){let g=f,h=u;typeof g>"u"&&(!u||!u.getContext)&&(g=u,u=void 0),u||(h=i()),g=e.getOptions(g);const x=e.getImageWidth(o.modules.size,g),v=h.getContext("2d"),N=v.createImageData(x,x);return e.qrToImageData(N.data,o,g),n(v,h,x),v.putImageData(N,0,0),h},t.renderToDataURL=function(o,u,f){let g=f;typeof g>"u"&&(!u||!u.getContext)&&(g=u,u=void 0),g||(g={});const h=t.render(o,u,g),x=g.type||"image/png",v=g.rendererOpts||{};return h.toDataURL(x,v.quality)}}(Wd)),Wd}var ef={},Dy;function Wk(){if(Dy)return ef;Dy=1;const t=gv();function e(l,o){const u=l.a/255,f=o+'="'+l.hex+'"';return u<1?f+" "+o+'-opacity="'+u.toFixed(2).slice(1)+'"':f}function n(l,o,u){let f=l+o;return typeof u<"u"&&(f+=" "+u),f}function i(l,o,u){let f="",g=0,h=!1,x=0;for(let v=0;v<l.length;v++){const N=Math.floor(v%o),w=Math.floor(v/o);!N&&!h&&(h=!0),l[v]?(x++,v>0&&N>0&&l[v-1]||(f+=h?n("M",N+u,.5+w+u):n("m",g,0),g=0,h=!1),N+1<o&&l[v+1]||(f+=n("h",x),x=0)):g++}return f}return ef.render=function(o,u,f){const g=t.getOptions(u),h=o.modules.size,x=o.modules.data,v=h+g.margin*2,N=g.color.light.a?"<path "+e(g.color.light,"fill")+' d="M0 0h'+v+"v"+v+'H0z"/>':"",w="<path "+e(g.color.dark,"stroke")+' d="'+i(x,h,g.margin)+'"/>',C='viewBox="0 0 '+v+" "+v+'"',k='<svg xmlns="http://www.w3.org/2000/svg" '+(g.width?'width="'+g.width+'" height="'+g.width+'" ':"")+C+' shape-rendering="crispEdges">'+N+w+`</svg>
`;return typeof f=="function"&&f(null,k),k},ef}var Ly;function Xk(){if(Ly)return hs;Ly=1;const t=Ik(),e=Qk(),n=Kk(),i=Wk();function l(o,u,f,g,h){const x=[].slice.call(arguments,1),v=x.length,N=typeof x[v-1]=="function";if(!N&&!t())throw new Error("Callback required as last argument");if(N){if(v<2)throw new Error("Too few arguments provided");v===2?(h=f,f=u,u=g=void 0):v===3&&(u.getContext&&typeof h>"u"?(h=g,g=void 0):(h=g,g=f,f=u,u=void 0))}else{if(v<1)throw new Error("Too few arguments provided");return v===1?(f=u,u=g=void 0):v===2&&!u.getContext&&(g=f,f=u,u=void 0),new Promise(function(w,C){try{const j=e.create(f,g);w(o(j,u,g))}catch(j){C(j)}})}try{const w=e.create(f,g);h(null,o(w,u,g))}catch(w){h(w)}}return hs.create=e.create,hs.toCanvas=l.bind(null,n.render),hs.toDataURL=l.bind(null,n.renderToDataURL),hs.toString=l.bind(null,function(o,u,f){return i.render(o,f)}),hs}var eE=Xk();const Py=tl(eE),ys=({url:t,title:e="QR Code",size:n=256,className:i="",showDownload:l=!0,onError:o})=>{const[u,f]=M.useState(""),[g,h]=M.useState(!0),[x,v]=M.useState(null),N=M.useRef(null);M.useEffect(()=>{t&&(async()=>{try{h(!0),v(null);const k={width:n,margin:2,color:{dark:"#000000",light:"#FFFFFF"},errorCorrectionLevel:"M"},E=await Py.toDataURL(t,k);f(E),N.current&&await Py.toCanvas(N.current,t,k)}catch(k){const E=k instanceof Error?k.message:"QR Code 生成失敗";v(E),o==null||o(E)}finally{h(!1)}})()},[t,n,o]);const w=()=>{if(N.current)try{const j=document.createElement("a");j.download=`qrcode-${Date.now()}.png`,j.href=N.current.toDataURL(),document.body.appendChild(j),j.click(),document.body.removeChild(j)}catch(j){console.error("下載 QR Code 失敗:",j)}},C=async()=>{if(N.current)try{N.current.toBlob(async j=>{if(j&&navigator.clipboard)try{await navigator.clipboard.write([new ClipboardItem({"image/png":j})]),alert("QR Code 已複製到剪貼簿！")}catch(k){console.error("複製圖片失敗:",k),alert("複製圖片失敗，請使用下載功能。")}})}catch(j){console.error("複製 QR Code 失敗:",j)}};return g?a.jsxs("div",{className:`flex flex-col items-center p-4 ${i}`,children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mb-3"}),a.jsx("p",{className:"text-sm text-gray-600",children:"生成 QR Code 中..."})]}):x?a.jsxs("div",{className:`flex flex-col items-center p-4 text-red-600 ${i}`,children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-8 h-8 mb-2",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"})}),a.jsx("p",{className:"text-sm text-center",children:x})]}):a.jsxs("div",{className:`flex flex-col items-center ${i}`,children:[e&&a.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3 text-center",children:e}),a.jsx("div",{className:"bg-white p-4 rounded-lg shadow-md border",children:a.jsx("img",{src:u,alt:`QR Code for ${e}`,className:"block",style:{width:n,height:n}})}),a.jsx("canvas",{ref:N,style:{display:"none"},width:n,height:n}),a.jsx("div",{className:"mt-3 max-w-xs w-full",children:a.jsx("p",{className:"text-xs text-gray-500 text-center break-all",children:t})}),l&&a.jsxs("div",{className:"mt-4 flex gap-2",children:[a.jsxs("button",{onClick:w,className:"flex items-center gap-2 px-3 py-2 bg-indigo-600 text-white text-sm rounded-lg hover:bg-indigo-700 transition-colors",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"})}),"下載"]}),a.jsxs("button",{onClick:C,className:"flex items-center gap-2 px-3 py-2 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 transition-colors",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"})}),"複製"]})]})]})},Oy=[{key:"objectives",label:"教學目標"},{key:"breakdown",label:"分解內容"},{key:"confusing",label:"易混淆點"},{key:"activities",label:"課堂活動"},{key:"conversation",label:"對話練習"},{key:"writing",label:"寫作練習"},{key:"quiz",label:"互動測驗"}],um=({content:t,topic:e,selectedLevel:n,selectedVocabularyLevel:i,apiKey:l,onContentUpdate:o})=>{const[u,f]=Be.useState(""),[g,h]=Be.useState(""),[x,v]=Be.useState(Oy[0].key),[N,w]=Be.useState(!1),[C,j]=Be.useState(""),[k,E]=Be.useState(""),[L,D]=Be.useState(!1),[O,H]=Be.useState(""),[I,R]=Be.useState(""),[q,B]=Be.useState(!1),[ee,G]=Be.useState(!1),[Y,z]=Be.useState(""),[$,Q]=Be.useState(""),[P,K]=Be.useState(!1),[pe,X]=Be.useState(!1),[S,V]=Be.useState(""),[ie,_]=Be.useState(""),[ve,Se]=Be.useState(!1),[se,he]=Be.useState(!1),[de,be]=Be.useState(""),[Ve,Ze]=Be.useState(""),[ut,gt]=Be.useState(!1),[Je,Gt]=Be.useState(tv),[xn,Rt]=Be.useState(!1),[wi,$e]=Be.useState(!1),ei=()=>{navigator.clipboard.writeText(JSON.stringify(t,null,2)).then(()=>{f("JSON 已複製到剪貼簿！"),setTimeout(()=>f(""),2e3)}).catch(J=>{f("複製失敗。"),console.error("Failed to copy: ",J),setTimeout(()=>f(""),2e3)})},Qe=()=>{try{Ck(t,e),h("HTML 檔案已開始下載！"),setTimeout(()=>h(""),3e3)}catch(J){console.error("Failed to export HTML:",J),h("匯出 HTML 失敗。"),setTimeout(()=>h(""),3e3)}},Bn=async()=>{w(!0),j(""),E("");try{const J={...t,topic:e,selectedLevel:n,selectedVocabularyLevel:i,sharedAt:new Date().toISOString()},oe=await Qo(J),ge=`${window.location.origin}/ai-page-gen/share?binId=${oe}`;E(ge)}catch(J){j(J.message||"分享失敗")}finally{w(!1)}},ln=async()=>{if(D(!0),H(""),R(""),!t.onlineInteractiveQuiz){H("沒有可分享的測驗內容"),D(!1);return}try{const J=await fk({quiz:t.onlineInteractiveQuiz,topic:e,apiKey:l,metadata:{selectedLevel:n==null?void 0:n.name,selectedVocabularyLevel:i==null?void 0:i.name,createdAt:new Date().toISOString(),supportsDiagnostic:!!l}});let oe=`${window.location.origin}/ai-page-gen/quiz?binId=${J}`;if(l)try{const ge=await ly(l);oe+=`&${ge}`}catch(ge){console.warn("加密 API Key 失敗，將不包含 API Key:",ge)}R(oe)}catch(J){H(J.message||"分享測驗失敗")}finally{D(!1)}},Ni=async()=>{if(G(!0),z(""),Q(""),!t.writingPractice){z("沒有可分享的寫作練習內容"),G(!1);return}try{const J=await hk({writingPractice:t.writingPractice,topic:e,metadata:{selectedLevel:n==null?void 0:n.name,selectedVocabularyLevel:i==null?void 0:i.name,createdAt:new Date().toISOString()}});let oe=`${window.location.origin}/ai-page-gen/writing?binId=${J}`;if(l)try{const ge=await ly(l);oe+=`&${ge}`}catch(ge){console.warn("加密 API Key 失敗，將不包含 API Key:",ge)}Q(oe)}catch(J){z(J.message||"分享寫作練習失敗")}finally{G(!1)}},fe=async()=>{X(!0),V(""),_("");try{const J={...t,topic:e,selectedLevel:n,selectedVocabularyLevel:i,sharedAt:new Date().toISOString()},oe=await Qo(J),ge=`${window.location.origin}/ai-page-gen/teacher-interactive-prep?binId=${oe}`;_(ge)}catch(J){V(J.message||"分享教材準備失敗")}finally{X(!1)}},Z=async()=>{if(!t.learningObjectives){alert("無法重新生成測驗：缺少學習目標");return}const J=localStorage.getItem("gemini_api_key")||localStorage.getItem("geminiApiKey")||l;if(!J){alert("請先設定 Gemini API 金鑰");return}Rt(!0);try{const oe=await Yj(e,J,t.learningObjectives,Je,n,i),ge={...t,onlineInteractiveQuiz:oe};o&&o(ge),$e(!1),alert("測驗已成功重新生成！")}catch(oe){console.error("重新生成測驗時發生錯誤:",oe),alert("重新生成測驗失敗: "+(oe.message||"未知錯誤"))}finally{Rt(!1)}},te=async()=>{var J;if(!l){be("請先設定 Gemini API 金鑰");return}if(!t.learningObjectives||t.learningObjectives.length===0){be("無法生成對話練習：缺少學習目標");return}he(!0),be(""),Ze("");try{const oe={topic:e,scenario:`Practice conversation based on learning objectives: ${t.learningObjectives.map(ot=>ot.objective).join(", ")}`,difficulty:(n==null?void 0:n.name)==="入門"?"easy":(n==null?void 0:n.name)==="進階"?"hard":"normal",participantCount:2,duration:10,focusAreas:t.learningObjectives.map(ot=>ot.objective),culturalContext:(J=t.contentBreakdown)==null?void 0:J.map(ot=>ot.details).join("; ")},Ne={practice:await Lo.generateConversationPractice(oe,l),metadata:{basedOnTopic:e,createdFrom:"lesson-plan",selectedLevel:n==null?void 0:n.name,selectedVocabularyLevel:i==null?void 0:i.name,createdAt:new Date().toISOString()}},Ee=await ov(Ne),Ke=`${window.location.origin}/ai-page-gen/conversation-practice/${Ee}`;Ze(Ke)}catch(oe){console.error("Failed to generate advanced conversation practice:",oe),be(oe.message||"生成進階對話練習失敗")}finally{he(!1)}};return a.jsxs("div",{className:"mt-8",children:[a.jsxs("div",{className:"flex flex-wrap justify-end items-center gap-2 mb-4",children:[a.jsxs("button",{onClick:ei,className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors flex items-center text-sm","aria-label":"複製產生的 JSON 內容",children:[a.jsx(ak,{className:"w-4 h-4 mr-2"})," 複製產生的 JSON"]}),a.jsxs("button",{onClick:Qe,className:"px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 transition-colors flex items-center text-sm","aria-label":"將學習內容匯出為 HTML 檔案",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4 mr-2",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"})}),"匯出為 HTML"]}),a.jsx("button",{onClick:Bn,className:"px-4 py-2 bg-purple-500 text-white rounded-md hover:bg-purple-600 transition-colors flex items-center text-sm disabled:opacity-60","aria-label":"分享教學方案",disabled:N,children:N?a.jsxs("span",{className:"flex items-center",children:[a.jsx("span",{className:"animate-spin mr-2",children:"⏳"})," 分享中..."]}):a.jsx("span",{children:"分享方案"})}),a.jsx("button",{onClick:fe,className:"px-4 py-2 bg-emerald-500 text-white rounded-md hover:bg-emerald-600 transition-colors flex items-center text-sm disabled:opacity-60","aria-label":"分享教材準備",disabled:pe,children:pe?a.jsxs("span",{className:"flex items-center",children:[a.jsx("span",{className:"animate-spin mr-2",children:"⏳"})," 分享中..."]}):a.jsxs("span",{className:"flex items-center",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4 mr-2",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"})}),"教材準備"]})}),u&&a.jsx("span",{className:"text-sm text-green-600",children:u}),g&&a.jsx("span",{className:"text-sm text-blue-600",children:g}),C&&a.jsx("span",{className:"text-sm text-red-600",children:C}),S&&a.jsx("span",{className:"text-sm text-red-600",children:S})]}),k&&a.jsxs("div",{className:"mb-4 p-4 bg-purple-50 border border-purple-200 rounded-lg",children:[a.jsx("p",{className:"text-sm text-purple-700 mb-2",children:"方案分享連結已生成："}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"text",value:k,readOnly:!0,className:"flex-1 px-3 py-2 bg-white border border-purple-300 rounded text-sm",onClick:()=>navigator.clipboard.writeText(k)}),a.jsx("button",{onClick:()=>navigator.clipboard.writeText(k),className:"px-3 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 text-sm",children:"複製"})]})]}),ie&&a.jsxs("div",{className:"mb-4 p-4 bg-emerald-50 border border-emerald-200 rounded-lg",children:[a.jsx("p",{className:"text-sm text-emerald-700 mb-2",children:"教材準備連結已生成："}),a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx("input",{type:"text",value:ie,readOnly:!0,className:"flex-1 px-3 py-2 bg-white border border-emerald-300 rounded text-sm",onClick:()=>navigator.clipboard.writeText(ie)}),a.jsx("button",{onClick:()=>navigator.clipboard.writeText(ie),className:"px-3 py-2 bg-emerald-600 text-white rounded hover:bg-emerald-700 text-sm",children:"複製"}),a.jsxs("button",{onClick:()=>Se(!ve),className:"px-3 py-2 bg-emerald-600 text-white rounded hover:bg-emerald-700 text-sm flex items-center gap-1",children:[a.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 3.75 9.375v-4.5ZM3.75 14.625c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5a1.125 1.125 0 0 1-1.125-1.125v-4.5ZM13.5 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 13.5 9.375v-4.5Z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 6.75h.75v.75h-.75v-.75ZM6.75 16.5h.75v.75h-.75v-.75ZM16.5 6.75h.75v.75h-.75v-.75ZM13.5 13.5h.75v.75h-.75v-.75ZM13.5 19.5h.75v.75h-.75v-.75ZM19.5 13.5h.75v.75h-.75v-.75ZM19.5 19.5h.75v.75h-.75v-.75ZM16.5 16.5h.75v.75h-.75v-.75Z"})]}),"QR"]})]}),ve&&a.jsx("div",{className:"mt-4 flex justify-center",children:a.jsx(ys,{url:ie,title:"教材準備分享 QR Code",size:200,className:"bg-white p-4 rounded-lg shadow-sm"})}),a.jsx("div",{className:"text-xs text-emerald-600 bg-emerald-100 px-3 py-2 rounded-lg",children:"💡 教師可以通過此連結準備互動教材，包含內容轉換、檢查和發布功能"})]}),a.jsx("div",{className:"mb-8 p-6 bg-gradient-to-r from-indigo-50 to-blue-50 border border-indigo-200 rounded-lg shadow-sm",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx(Df,{className:"w-5 h-5 text-indigo-600 flex-shrink-0"}),a.jsx("span",{className:"text-sm font-medium text-indigo-600",children:"學習主題"})]}),a.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-0 truncate",children:e})]}),(n||i)&&a.jsxs("div",{className:"flex gap-3 ml-6 flex-shrink-0",children:[n&&a.jsxs("div",{className:"bg-white px-3 py-2 rounded-lg shadow-sm border border-indigo-100",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx(Pn,{className:"w-4 h-4 text-indigo-500"}),a.jsx("span",{className:"text-xs font-medium text-indigo-600",children:"學習程度"})]}),a.jsx("div",{className:"text-sm font-semibold text-gray-900",children:n.name}),a.jsx("div",{className:"text-xs text-gray-500 truncate max-w-32",title:n.description,children:n.description.length>20?n.description.substring(0,20)+"...":n.description})]}),i&&a.jsxs("div",{className:"bg-white px-3 py-2 rounded-lg shadow-sm border border-blue-100",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx(Zo,{className:"w-4 h-4 text-blue-500"}),a.jsx("span",{className:"text-xs font-medium text-blue-600",children:"詞彙程度"})]}),a.jsx("div",{className:"text-sm font-semibold text-gray-900",children:i.name}),a.jsxs("div",{className:"text-xs text-gray-500",children:[i.wordCount," 詞彙"]})]})]})]})}),a.jsxs(_k,{tabs:Oy,current:x,onChange:v,children:[a.jsx(Dn,{title:"教學目標設定",icon:a.jsx(Pn,{className:"w-7 h-7"}),children:t.learningObjectives&&t.learningObjectives.length>0?t.learningObjectives.map((J,oe)=>a.jsxs("div",{className:"mb-4 pb-4 border-b border-slate-200 last:border-b-0 last:pb-0",children:[a.jsx("h4",{className:"font-semibold text-lg text-green-800 mb-1",children:J.objective}),a.jsx("p",{className:"text-slate-700 mb-2",children:J.description}),J.teachingExample&&a.jsxs("div",{className:"bg-green-50 border-l-4 border-green-400 p-3 rounded-md mt-2",children:[a.jsx("span",{className:"block text-xs font-semibold text-green-700 mb-1",children:"教學示例"}),a.jsx("span",{className:"text-green-900 text-sm",children:J.teachingExample})]})]},oe)):a.jsx("p",{children:"沒有提供教學目標。"})}),a.jsx(Dn,{title:"分解學習內容",icon:a.jsx(Zo,{className:"w-7 h-7"}),children:t.contentBreakdown&&t.contentBreakdown.length>0?t.contentBreakdown.map((J,oe)=>a.jsxs("div",{className:"mb-6 pb-6 border-b border-slate-200 last:border-b-0 last:pb-0",children:[a.jsx("h4",{className:"font-semibold text-lg text-sky-800 mb-1",children:J.topic}),a.jsx("p",{className:"text-slate-700 mb-3",children:J.details}),J.coreConcept&&a.jsxs("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-3 rounded-md mb-3",children:[a.jsx("span",{className:"block text-xs font-semibold text-blue-700 mb-1",children:"核心概念"}),a.jsx("span",{className:"text-blue-900 text-sm",children:J.coreConcept})]}),J.teachingSentences&&J.teachingSentences.length>0&&a.jsxs("div",{className:"bg-indigo-50 border-l-4 border-indigo-400 p-3 rounded-md mb-3",children:[a.jsx("span",{className:"block text-xs font-semibold text-indigo-700 mb-2",children:"教學例句"}),a.jsx("div",{className:"space-y-1",children:J.teachingSentences.map((ge,Ne)=>a.jsxs("div",{className:"text-indigo-900 text-sm",children:[a.jsxs("span",{className:"font-mono text-indigo-600",children:[Ne+1,"."]})," ",ge]},Ne))})]}),J.teachingTips&&a.jsxs("div",{className:"bg-purple-50 border-l-4 border-purple-400 p-3 rounded-md mb-3",children:[a.jsx("span",{className:"block text-xs font-semibold text-purple-700 mb-1",children:"教學要點提示"}),a.jsx("span",{className:"text-purple-900 text-sm",children:J.teachingTips})]}),J.teachingExample&&a.jsxs("div",{className:"bg-sky-50 border-l-4 border-sky-400 p-3 rounded-md",children:[a.jsx("span",{className:"block text-xs font-semibold text-sky-700 mb-1",children:"教學示例"}),a.jsx("span",{className:"text-sky-900 text-sm",children:J.teachingExample})]})]},oe)):a.jsx("p",{children:"沒有提供內容分解。"})}),a.jsx(Dn,{title:"易混淆點識別",icon:a.jsx(Df,{className:"w-7 h-7"}),children:t.confusingPoints&&t.confusingPoints.length>0?t.confusingPoints.map((J,oe)=>a.jsxs("div",{className:"mb-6 pb-6 border-b border-slate-200 last:border-b-0 last:pb-0",children:[a.jsx("h4",{className:"font-semibold text-lg text-red-700 mb-2",children:J.point}),a.jsx("p",{className:"text-slate-700 mb-3",children:J.clarification}),J.errorType&&a.jsxs("div",{className:"bg-orange-50 border-l-4 border-orange-400 p-3 rounded-md mb-3",children:[a.jsx("span",{className:"block text-xs font-semibold text-orange-700 mb-1",children:"誤區類型"}),a.jsx("span",{className:"text-orange-900 text-sm",children:J.errorType})]}),J.commonErrors&&J.commonErrors.length>0&&a.jsxs("div",{className:"bg-red-50 border-l-4 border-red-400 p-3 rounded-md mb-3",children:[a.jsx("span",{className:"block text-xs font-semibold text-red-700 mb-2",children:"常見錯誤示例"}),a.jsx("div",{className:"space-y-1",children:J.commonErrors.map((ge,Ne)=>a.jsxs("div",{className:"text-red-900 text-sm",children:[a.jsxs("span",{className:"font-mono text-red-600",children:[Ne+1,"."]})," ",ge]},Ne))})]}),J.correctVsWrong&&J.correctVsWrong.length>0&&a.jsxs("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-3 rounded-md mb-3",children:[a.jsx("span",{className:"block text-xs font-semibold text-yellow-700 mb-2",children:"正確與錯誤對比"}),a.jsx("div",{className:"space-y-3",children:J.correctVsWrong.map((ge,Ne)=>a.jsxs("div",{className:"border border-yellow-200 rounded-md p-2 bg-white",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-2",children:[a.jsxs("div",{className:"bg-green-50 p-2 rounded border border-green-200",children:[a.jsx("span",{className:"block text-xs font-semibold text-green-700 mb-1",children:"✓ 正確"}),a.jsx("span",{className:"text-green-900 text-sm",children:ge.correct})]}),a.jsxs("div",{className:"bg-red-50 p-2 rounded border border-red-200",children:[a.jsx("span",{className:"block text-xs font-semibold text-red-700 mb-1",children:"✗ 錯誤"}),a.jsx("span",{className:"text-red-900 text-sm",children:ge.wrong})]})]}),a.jsxs("div",{className:"bg-blue-50 p-2 rounded border border-blue-200",children:[a.jsx("span",{className:"block text-xs font-semibold text-blue-700 mb-1",children:"說明"}),a.jsx("span",{className:"text-blue-900 text-sm",children:ge.explanation})]})]},Ne))})]}),J.preventionStrategy&&a.jsxs("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-3 rounded-md mb-3",children:[a.jsx("span",{className:"block text-xs font-semibold text-blue-700 mb-1",children:"預防策略"}),a.jsx("span",{className:"text-blue-900 text-sm",children:J.preventionStrategy})]}),J.correctionMethod&&a.jsxs("div",{className:"bg-purple-50 border-l-4 border-purple-400 p-3 rounded-md mb-3",children:[a.jsx("span",{className:"block text-xs font-semibold text-purple-700 mb-1",children:"糾正方法"}),a.jsx("span",{className:"text-purple-900 text-sm",children:J.correctionMethod})]}),J.practiceActivities&&J.practiceActivities.length>0&&a.jsxs("div",{className:"bg-indigo-50 border-l-4 border-indigo-400 p-3 rounded-md mb-3",children:[a.jsx("span",{className:"block text-xs font-semibold text-indigo-700 mb-2",children:"練習建議"}),a.jsx("div",{className:"space-y-1",children:J.practiceActivities.map((ge,Ne)=>a.jsxs("div",{className:"text-indigo-900 text-sm",children:[a.jsxs("span",{className:"font-mono text-indigo-600",children:[Ne+1,"."]})," ",ge]},Ne))})]}),J.teachingExample&&a.jsxs("div",{className:"bg-gray-50 border-l-4 border-gray-400 p-3 rounded-md",children:[a.jsx("span",{className:"block text-xs font-semibold text-gray-700 mb-1",children:"教學示例"}),a.jsx("span",{className:"text-gray-900 text-sm",children:J.teachingExample})]})]},oe)):a.jsx("p",{children:"沒有提供易混淆點。"})}),a.jsx(Dn,{title:"課堂活動與遊戲設計",icon:a.jsx(sk,{className:"w-7 h-7"}),children:t.classroomActivities&&t.classroomActivities.length>0?a.jsx("div",{className:"space-y-6",children:t.classroomActivities.map((J,oe)=>a.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm hover:shadow-md transition-shadow duration-200",children:[a.jsxs("div",{className:"bg-gradient-to-r from-sky-50 to-blue-50 px-6 py-4 border-b border-slate-200 rounded-t-xl",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-sky-500 text-white rounded-full font-bold text-sm",children:oe+1}),a.jsx("h4",{className:"font-bold text-xl text-sky-800",children:J.title})]}),a.jsx("p",{className:"mt-3 text-slate-700 leading-relaxed",children:J.description})]}),a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[J.objective&&a.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),a.jsx("span",{className:"font-semibold text-green-800 text-sm",children:"學習目標"})]}),a.jsx("p",{className:"text-green-900 text-sm leading-relaxed",children:J.objective})]}),J.timing&&a.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),a.jsx("span",{className:"font-semibold text-purple-800 text-sm",children:"使用時機"})]}),a.jsx("p",{className:"text-purple-900 text-sm leading-relaxed",children:J.timing})]}),J.materials&&a.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full"}),a.jsx("span",{className:"font-semibold text-orange-800 text-sm",children:"所需教具"})]}),a.jsx("p",{className:"text-orange-900 text-sm leading-relaxed",children:J.materials})]}),J.environment&&a.jsxs("div",{className:"bg-teal-50 border border-teal-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("div",{className:"w-2 h-2 bg-teal-500 rounded-full"}),a.jsx("span",{className:"font-semibold text-teal-800 text-sm",children:"環境要求"})]}),a.jsx("p",{className:"text-teal-900 text-sm leading-relaxed",children:J.environment})]})]}),J.steps&&J.steps.length>0&&a.jsx("div",{className:"mb-6",children:a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-5 h-5 text-blue-600",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 6.75h12M8.25 12h12m-12 5.25h12M3.75 6.75h.007v.008H3.75V6.75Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0ZM3.75 12h.007v.008H3.75V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm-.375 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})}),a.jsx("span",{className:"font-semibold text-blue-800",children:"活動步驟"})]}),a.jsx("div",{className:"space-y-3",children:J.steps.map((ge,Ne)=>a.jsxs("div",{className:"flex gap-3",children:[a.jsx("div",{className:"flex items-center justify-center w-6 h-6 bg-blue-500 text-white rounded-full font-semibold text-xs flex-shrink-0 mt-0.5",children:Ne+1}),a.jsx("p",{className:"text-blue-900 text-sm leading-relaxed flex-1",children:ge})]},Ne))})]})}),J.assessmentPoints&&J.assessmentPoints.length>0&&a.jsx("div",{children:a.jsxs("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-5 h-5 text-indigo-600",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12c0 1.268-.63 2.39-1.593 3.068a3.745 3.745 0 0 1-1.043 3.296 3.745 3.745 0 0 1-3.296 1.043A3.745 3.745 0 0 1 12 21c-1.268 0-2.39-.63-3.068-1.593a3.746 3.746 0 0 1-3.296-1.043 3.745 3.745 0 0 1-1.043-3.296A3.745 3.745 0 0 1 3 12c0-1.268.63-2.39 1.593-3.068a3.745 3.745 0 0 1 1.043-3.296 3.746 3.746 0 0 1 3.296-1.043A3.746 3.746 0 0 1 12 3c1.268 0 2.39.63 3.068 1.593a3.746 3.746 0 0 1 3.296 1.043 3.746 3.746 0 0 1 1.043 3.296A3.745 3.745 0 0 1 21 12Z"})}),a.jsx("span",{className:"font-semibold text-indigo-800",children:"評估重點"})]}),a.jsx("div",{className:"space-y-2",children:J.assessmentPoints.map((ge,Ne)=>a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-2 h-2 bg-indigo-500 rounded-full mt-2 flex-shrink-0"}),a.jsx("p",{className:"text-indigo-900 text-sm leading-relaxed",children:ge})]},Ne))})]})})]})]},oe))}):a.jsx("p",{children:"沒有提供課堂活動。"})}),a.jsx(Dn,{title:"對話練習",icon:a.jsx(Lf,{className:"w-7 h-7"}),children:t.englishConversation&&t.englishConversation.length>0?a.jsxs("div",{children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"基礎對話練習"}),a.jsx(Nk,{dialogue:t.englishConversation})]}),l&&a.jsxs("div",{className:"border-t pt-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"進階互動對話練習"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"基於教案內容生成豐富的對話練習，包含語音識別和AI評估"})]}),a.jsx("button",{onClick:te,className:"px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors flex items-center gap-2 text-sm",disabled:se||!l,children:se?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"生成中..."]}):a.jsxs(a.Fragment,{children:[a.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M12 18.75a6 6 0 0 0 6-6v-1.5m-6 7.5a6 6 0 0 1-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 0 1-3-3V4.5a3 3 0 1 1 6 0v8.25a3 3 0 0 1-3 3Z"})}),"生成進階對話練習"]})})]}),de&&a.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:de}),Ve&&a.jsxs("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-lg",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-green-800 mb-1",children:"進階對話練習已生成！"}),a.jsx("div",{className:"text-xs text-green-600",children:"學生可使用此連結進行互動對話練習"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>navigator.clipboard.writeText(Ve),className:"px-3 py-1 bg-green-600 text-white text-xs rounded hover:bg-green-700",children:"複製連結"}),a.jsx("button",{onClick:()=>gt(!ut),className:"px-3 py-1 bg-green-600 text-white text-xs rounded hover:bg-green-700",children:"QR Code"})]})]}),ut&&a.jsx("div",{className:"mt-4 pt-4 border-t border-green-200",children:a.jsx(ys,{url:Ve,title:`${e} - 進階對話練習`})})]})]})]}):a.jsxs("div",{className:"text-center py-8",children:[a.jsx("p",{className:"text-gray-600 mb-4",children:"沒有提供基礎對話練習。"}),l&&a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"您可以基於教案內容生成進階對話練習"}),a.jsx("button",{onClick:te,className:"px-6 py-3 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors flex items-center gap-2 mx-auto",disabled:se,children:se?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"生成中..."]}):a.jsxs(a.Fragment,{children:[a.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M12 18.75a6 6 0 0 0 6-6v-1.5m-6 7.5a6 6 0 0 1-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 0 1-3-3V4.5a3 3 0 1 1 6 0v8.25a3 3 0 0 1-3 3Z"})}),"生成進階對話練習"]})}),de&&a.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm max-w-md mx-auto",children:de}),Ve&&a.jsxs("div",{className:"mt-4 p-4 bg-green-50 border border-green-200 rounded-lg max-w-md mx-auto",children:[a.jsx("div",{className:"text-sm font-medium text-green-800 mb-2",children:"進階對話練習已生成！"}),a.jsxs("div",{className:"flex gap-2 justify-center",children:[a.jsx("button",{onClick:()=>navigator.clipboard.writeText(Ve),className:"px-3 py-1 bg-green-600 text-white text-xs rounded hover:bg-green-700",children:"複製連結"}),a.jsx("button",{onClick:()=>gt(!ut),className:"px-3 py-1 bg-green-600 text-white text-xs rounded hover:bg-green-700",children:"QR Code"})]}),ut&&a.jsx("div",{className:"mt-4 pt-4 border-t border-green-200",children:a.jsx(ys,{url:Ve,title:`${e} - 進階對話練習`})})]})]})]})}),t.writingPractice?a.jsxs("div",{children:[a.jsx("div",{className:"flex justify-end mb-4",children:a.jsx("button",{onClick:Ni,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2 text-sm",disabled:ee,children:ee?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"animate-spin",children:"⏳"}),"分享中..."]}):a.jsxs(a.Fragment,{children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.217 10.907a2.25 2.25 0 1 0 0 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186 9.566-5.314m-9.566 7.5 9.566 5.314m0 0a2.25 2.25 0 1 0 3.935 2.186 2.25 2.25 0 0 0-3.935-2.186Zm0-12.814a2.25 2.25 0 1 0 3.935-2.186 2.25 2.25 0 0 0-3.935 2.186Z"})}),"分享寫作練習"]})})}),Y&&a.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-lg",children:Y}),$&&a.jsxs("div",{className:"mb-4 p-4 bg-purple-50 border border-purple-200 rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("p",{className:"text-sm text-purple-700",children:"寫作練習分享連結已生成："}),l&&a.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-700 text-xs rounded-full",children:"含 AI 批改"})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("input",{type:"text",value:$,readOnly:!0,className:"w-full px-3 py-2 bg-white border border-purple-300 rounded text-sm",onClick:()=>navigator.clipboard.writeText($)}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[a.jsx("button",{onClick:()=>navigator.clipboard.writeText($),className:"flex-1 px-3 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 text-sm transition-colors",children:"複製連結"}),a.jsxs("button",{onClick:()=>K(!P),className:"flex-1 px-3 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm flex items-center justify-center gap-1 transition-colors",children:[a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 3.75 9.375v-4.5ZM3.75 14.625c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5a1.125 1.125 0 0 1-1.125-1.125v-4.5ZM13.5 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 13.5 9.375v-4.5Z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 6.75h.75v.75h-.75v-.75ZM6.75 16.5h.75v.75h-.75v-.75ZM16.5 6.75h.75v.75h-.75v-.75ZM13.5 13.5H8.25v1.5H13.5V13.5ZM13.5 16.5H8.25V18H13.5v-1.5ZM16.5 16.5h1.5V18h-1.5v-1.5ZM16.5 13.5h1.5v1.5h-1.5v-1.5Z"})]}),"顯示 QR Code"]})]})]}),P&&a.jsx("div",{className:"mt-4 flex justify-center",children:a.jsx(ys,{url:$,title:"寫作練習分享 QR Code",size:200,className:"bg-white p-4 rounded-lg shadow-sm"})}),l&&a.jsx("p",{className:"text-xs text-purple-600 mt-2",children:"💡 此連結包含您的 API Key，學生可直接使用 AI 批改功能"})]}),a.jsx(cv,{content:t.writingPractice,apiKey:l,vocabularyLevel:i||void 0})]}):a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 text-center border border-gray-200",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-16 h-16 text-gray-400 mx-auto mb-4",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"})}),a.jsx("h4",{className:"text-lg font-semibold text-gray-700 mb-2",children:"沒有提供寫作練習"}),a.jsx("p",{className:"text-gray-500",children:"此主題沒有生成寫作練習內容"})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex flex-wrap justify-end items-center gap-2 mb-4",children:[a.jsx("button",{onClick:ln,className:"px-4 py-2 bg-orange-500 text-white rounded-md hover:bg-orange-600 transition-colors flex items-center text-sm disabled:opacity-60","aria-label":"分享測驗給學生",disabled:L,children:L?a.jsxs("span",{className:"flex items-center",children:[a.jsx("span",{className:"animate-spin mr-2",children:"⏳"})," 分享中..."]}):a.jsxs("span",{className:"flex items-center",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4 mr-2",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"})}),"分享測驗"]})}),a.jsxs("button",{onClick:()=>$e(!wi),className:"px-4 py-2 bg-teal-500 text-white rounded-md hover:bg-teal-600 transition-colors flex items-center text-sm","aria-label":"測驗設定",children:[a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4 mr-2",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a6.759 6.759 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})]}),"測驗設定"]})]}),O&&a.jsx("span",{className:"text-sm text-red-600",children:O}),I&&a.jsxs("div",{className:"mb-4 p-4 bg-orange-50 border border-orange-200 rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("p",{className:"text-sm text-orange-700",children:"測驗分享連結已生成："}),l&&a.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-700 text-xs rounded-full",children:"含 AI 診斷"})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("input",{type:"text",value:I,readOnly:!0,className:"w-full px-3 py-2 bg-white border border-orange-300 rounded text-sm",onClick:()=>navigator.clipboard.writeText(I)}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[a.jsxs("button",{onClick:()=>navigator.clipboard.writeText(I),className:"flex-1 px-3 py-2 bg-orange-600 text-white rounded hover:bg-orange-700 text-sm flex items-center justify-center gap-1",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"})}),"複製連結"]}),a.jsxs("button",{onClick:()=>B(!q),className:"flex-1 px-3 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm flex items-center justify-center gap-1",children:[a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 3.75 9.375v-4.5ZM3.75 14.625c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5a1.125 1.125 0 0 1-1.125-1.125v-4.5ZM13.5 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 13.5 9.375v-4.5Z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 6.75h.75v.75h-.75v-.75ZM6.75 16.5h.75v.75h-.75v-.75ZM16.5 6.75h.75v.75h-.75v-.75ZM13.5 13.5H8.25v1.5H13.5V13.5ZM13.5 16.5H8.25V18H13.5v-1.5ZM16.5 16.5h1.5V18h-1.5v-1.5ZM16.5 13.5h1.5v1.5h-1.5v-1.5Z"})]}),"顯示 QR Code"]})]})]}),q&&a.jsx("div",{className:"mt-4 flex justify-center",children:a.jsx(ys,{url:I,title:"測驗分享 QR Code",size:200,className:"bg-white p-4 rounded-lg shadow-sm"})}),l&&a.jsx("p",{className:"text-xs text-orange-600 mt-2",children:"💡 此連結包含您的 API Key，學生可直接使用 AI 學習診斷功能"})]}),wi&&a.jsx(Rk,{config:Je,onConfigChange:Gt,onRegenerate:Z,isGenerating:xn}),a.jsx(wk,{quizzes:t.onlineInteractiveQuiz,topic:e,apiKey:l,enableDiagnostic:!!l})]})]})]})},tE=({learningLevels:t,onLevelSelect:e,onGenerateWithLevel:n,selectedLevelId:i,isLoading:l=!1})=>{var h;const[o,u]=M.useState(i||t.defaultLevelId),f=x=>{u(x.id),e==null||e(x)},g=[...t.suggestedLevels].sort((x,v)=>x.order-v.order);return a.jsx(Dn,{title:"學習程度建議",icon:a.jsx(Pn,{className:"w-7 h-7"}),children:a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"根據學習主題自動生成的程度建議，選擇最適合的學習等級："}),a.jsx("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3",children:g.map(x=>a.jsxs("div",{className:`
                relative p-4 rounded-lg border-2 cursor-pointer transition-all duration-200
                ${o===x.id?"border-sky-500 bg-sky-50 shadow-md":"border-slate-300 bg-white hover:border-sky-300 hover:shadow-sm"}
              `,onClick:()=>f(x),children:[a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx("div",{className:`
                  flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold
                  ${o===x.id?"bg-sky-500 text-white":"bg-slate-200 text-slate-700"}
                `,children:x.order}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:`
                    text-lg font-semibold mb-2
                    ${o===x.id?"text-sky-700":"text-slate-700"}
                  `,children:x.name}),a.jsx("p",{className:`
                    text-sm leading-relaxed
                    ${o===x.id?"text-sky-600":"text-slate-600"}
                  `,children:x.description})]})]}),o===x.id&&a.jsx("div",{className:"absolute top-2 right-2",children:a.jsx("div",{className:"w-3 h-3 bg-sky-500 rounded-full flex items-center justify-center",children:a.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full"})})})]},x.id))}),a.jsxs("div",{className:"mt-4 space-y-3",children:[a.jsx("div",{className:"p-3 bg-slate-50 rounded-lg",children:a.jsxs("div",{className:"flex items-center space-x-2 text-sm text-slate-600",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),a.jsxs("span",{children:["已選擇：",a.jsx("strong",{children:(h=g.find(x=>x.id===o))==null?void 0:h.name})]})]})}),n&&a.jsx("div",{className:"flex justify-center",children:a.jsx("button",{onClick:()=>{const x=g.find(v=>v.id===o);x&&n(x)},disabled:l,className:"px-8 py-3 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 transition-colors disabled:bg-slate-400 disabled:cursor-not-allowed flex items-center",children:l?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"產生內容中..."]}):a.jsxs(a.Fragment,{children:[a.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"開始產生學習內容"]})})})]})]})})},tf=[{id:"beginner",name:"初級 (100-500詞)",wordCount:500,description:"適合英語初學者，使用最基本的日常詞彙"},{id:"elementary",name:"基礎 (500-1000詞)",wordCount:1e3,description:"掌握基本會話詞彙，能進行簡單交流"},{id:"pre-intermediate",name:"初中級 (1000-2000詞)",wordCount:2e3,description:"能理解日常生活和工作中的常見詞彙"},{id:"intermediate",name:"中級 (2000-3500詞)",wordCount:3500,description:"能處理較複雜的文本和學術內容"},{id:"upper-intermediate",name:"中高級 (3500-5000詞)",wordCount:5e3,description:"能理解專業文章和較複雜的語言結構"},{id:"advanced",name:"高級 (5000-7000詞)",wordCount:7e3,description:"具備高水平的英語理解和表達能力"}],nE=({onVocabularyLevelSelect:t,selectedLevel:e,isVisible:n=!0})=>{var u,f;const[i,l]=M.useState((e==null?void 0:e.id)||"intermediate"),o=g=>{l(g.id),t(g)};return n?a.jsx(Dn,{title:"選擇英語單字程度",icon:a.jsx(Zo,{className:"w-7 h-7"}),children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-sm text-slate-600",children:"請選擇您的英語單字量範圍，系統會根據此程度調整教學內容的複雜度："}),a.jsx("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3",children:tf.map(g=>a.jsxs("div",{className:`
                relative p-4 rounded-lg border-2 cursor-pointer transition-all duration-200
                ${i===g.id?"border-green-500 bg-green-50 shadow-md":"border-slate-300 bg-white hover:border-green-300 hover:shadow-sm"}
              `,onClick:()=>o(g),children:[a.jsxs("div",{className:"flex flex-col space-y-2",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:`
                    flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold
                    ${i===g.id?"bg-green-500 text-white":"bg-slate-200 text-slate-700"}
                  `,children:g.wordCount>=1e3?`${g.wordCount/1e3}k`:g.wordCount}),a.jsx("h4",{className:`
                    text-sm font-semibold
                    ${i===g.id?"text-green-700":"text-slate-700"}
                  `,children:g.name})]}),a.jsx("p",{className:`
                  text-xs leading-relaxed
                  ${i===g.id?"text-green-600":"text-slate-600"}
                `,children:g.description})]}),i===g.id&&a.jsx("div",{className:"absolute top-2 right-2",children:a.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full flex items-center justify-center",children:a.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full"})})})]},g.id))}),a.jsx("div",{className:"p-3 bg-slate-50 rounded-lg",children:a.jsxs("div",{className:"flex items-center space-x-2 text-sm text-slate-600",children:[a.jsx(Zo,{className:"w-4 h-4"}),a.jsxs("span",{children:["已選擇：",a.jsx("strong",{children:(u=tf.find(g=>g.id===i))==null?void 0:u.name}),"（",(f=tf.find(g=>g.id===i))==null?void 0:f.wordCount," 詞彙）"]})]})})]})}):null},xv=({isOpen:t,onSave:e})=>{const[n,i]=M.useState("");return t?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full",children:[a.jsx("h2",{className:"text-xl font-bold mb-4 text-sky-700",children:"請輸入 Gemini API 金鑰"}),a.jsx("input",{type:"password",className:"w-full border border-slate-300 rounded px-3 py-2 mb-4 focus:outline-none focus:ring-2 focus:ring-sky-400",placeholder:"請貼上您的 Gemini API Key...",value:n,onChange:l=>i(l.target.value)}),a.jsx("button",{className:"w-full bg-sky-600 hover:bg-sky-700 text-white font-semibold py-2 rounded transition",onClick:()=>{n.trim()&&(e(n.trim()),i(""))},children:"儲存金鑰"}),a.jsx("p",{className:"text-xs text-slate-500 mt-3",children:"您的金鑰只會儲存在本機瀏覽器，不會上傳到伺服器。"})]})}):null};var Ba={},By;function iE(){if(By)return Ba;By=1,Object.defineProperty(Ba,"__esModule",{value:!0}),Ba.parse=u,Ba.serialize=h;const t=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,n=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,i=/^[\u0020-\u003A\u003D-\u007E]*$/,l=Object.prototype.toString,o=(()=>{const N=function(){};return N.prototype=Object.create(null),N})();function u(N,w){const C=new o,j=N.length;if(j<2)return C;const k=(w==null?void 0:w.decode)||x;let E=0;do{const L=N.indexOf("=",E);if(L===-1)break;const D=N.indexOf(";",E),O=D===-1?j:D;if(L>O){E=N.lastIndexOf(";",L-1)+1;continue}const H=f(N,E,L),I=g(N,L,H),R=N.slice(H,I);if(C[R]===void 0){let q=f(N,L+1,O),B=g(N,O,q);const ee=k(N.slice(q,B));C[R]=ee}E=O+1}while(E<j);return C}function f(N,w,C){do{const j=N.charCodeAt(w);if(j!==32&&j!==9)return w}while(++w<C);return C}function g(N,w,C){for(;w>C;){const j=N.charCodeAt(--w);if(j!==32&&j!==9)return w+1}return C}function h(N,w,C){const j=(C==null?void 0:C.encode)||encodeURIComponent;if(!t.test(N))throw new TypeError(`argument name is invalid: ${N}`);const k=j(w);if(!e.test(k))throw new TypeError(`argument val is invalid: ${w}`);let E=N+"="+k;if(!C)return E;if(C.maxAge!==void 0){if(!Number.isInteger(C.maxAge))throw new TypeError(`option maxAge is invalid: ${C.maxAge}`);E+="; Max-Age="+C.maxAge}if(C.domain){if(!n.test(C.domain))throw new TypeError(`option domain is invalid: ${C.domain}`);E+="; Domain="+C.domain}if(C.path){if(!i.test(C.path))throw new TypeError(`option path is invalid: ${C.path}`);E+="; Path="+C.path}if(C.expires){if(!v(C.expires)||!Number.isFinite(C.expires.valueOf()))throw new TypeError(`option expires is invalid: ${C.expires}`);E+="; Expires="+C.expires.toUTCString()}if(C.httpOnly&&(E+="; HttpOnly"),C.secure&&(E+="; Secure"),C.partitioned&&(E+="; Partitioned"),C.priority)switch(typeof C.priority=="string"?C.priority.toLowerCase():void 0){case"low":E+="; Priority=Low";break;case"medium":E+="; Priority=Medium";break;case"high":E+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${C.priority}`)}if(C.sameSite)switch(typeof C.sameSite=="string"?C.sameSite.toLowerCase():C.sameSite){case!0:case"strict":E+="; SameSite=Strict";break;case"lax":E+="; SameSite=Lax";break;case"none":E+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${C.sameSite}`)}return E}function x(N){if(N.indexOf("%")===-1)return N;try{return decodeURIComponent(N)}catch{return N}}function v(N){return l.call(N)==="[object Date]"}return Ba}iE();var Uy="popstate";function rE(t={}){function e(i,l){let{pathname:o,search:u,hash:f}=i.location;return Bf("",{pathname:o,search:u,hash:f},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function n(i,l){return typeof l=="string"?l:Xa(l)}return aE(e,n,null,t)}function vt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function On(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function sE(){return Math.random().toString(36).substring(2,10)}function zy(t,e){return{usr:t.state,key:t.key,idx:e}}function Bf(t,e,n=null,i){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?Ls(e):e,state:n,key:e&&e.key||i||sE()}}function Xa({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Ls(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let i=t.indexOf("?");i>=0&&(e.search=t.substring(i),t=t.substring(0,i)),t&&(e.pathname=t)}return e}function aE(t,e,n,i={}){let{window:l=document.defaultView,v5Compat:o=!1}=i,u=l.history,f="POP",g=null,h=x();h==null&&(h=0,u.replaceState({...u.state,idx:h},""));function x(){return(u.state||{idx:null}).idx}function v(){f="POP";let k=x(),E=k==null?null:k-h;h=k,g&&g({action:f,location:j.location,delta:E})}function N(k,E){f="PUSH";let L=Bf(j.location,k,E);h=x()+1;let D=zy(L,h),O=j.createHref(L);try{u.pushState(D,"",O)}catch(H){if(H instanceof DOMException&&H.name==="DataCloneError")throw H;l.location.assign(O)}o&&g&&g({action:f,location:j.location,delta:1})}function w(k,E){f="REPLACE";let L=Bf(j.location,k,E);h=x();let D=zy(L,h),O=j.createHref(L);u.replaceState(D,"",O),o&&g&&g({action:f,location:j.location,delta:0})}function C(k){return lE(k)}let j={get action(){return f},get location(){return t(l,u)},listen(k){if(g)throw new Error("A history only accepts one active listener");return l.addEventListener(Uy,v),g=k,()=>{l.removeEventListener(Uy,v),g=null}},createHref(k){return e(l,k)},createURL:C,encodeLocation(k){let E=C(k);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:N,replace:w,go(k){return u.go(k)}};return j}function lE(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),vt(n,"No window.location.(origin|href) available to create URL");let i=typeof t=="string"?t:Xa(t);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=n+i),new URL(i,n)}function yv(t,e,n="/"){return oE(t,e,n,!1)}function oE(t,e,n,i){let l=typeof e=="string"?Ls(e):e,o=vi(l.pathname||"/",n);if(o==null)return null;let u=vv(t);cE(u);let f=null;for(let g=0;f==null&&g<u.length;++g){let h=bE(o);f=yE(u[g],h,i)}return f}function vv(t,e=[],n=[],i=""){let l=(o,u,f)=>{let g={relativePath:f===void 0?o.path||"":f,caseSensitive:o.caseSensitive===!0,childrenIndex:u,route:o};g.relativePath.startsWith("/")&&(vt(g.relativePath.startsWith(i),`Absolute route path "${g.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),g.relativePath=g.relativePath.slice(i.length));let h=xi([i,g.relativePath]),x=n.concat(g);o.children&&o.children.length>0&&(vt(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${h}".`),vv(o.children,e,x,h)),!(o.path==null&&!o.index)&&e.push({path:h,score:gE(h,o.index),routesMeta:x})};return t.forEach((o,u)=>{var f;if(o.path===""||!((f=o.path)!=null&&f.includes("?")))l(o,u);else for(let g of bv(o.path))l(o,u,g)}),e}function bv(t){let e=t.split("/");if(e.length===0)return[];let[n,...i]=e,l=n.endsWith("?"),o=n.replace(/\?$/,"");if(i.length===0)return l?[o,""]:[o];let u=bv(i.join("/")),f=[];return f.push(...u.map(g=>g===""?o:[o,g].join("/"))),l&&f.push(...u),f.map(g=>t.startsWith("/")&&g===""?"/":g)}function cE(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:xE(e.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}var uE=/^:[\w-]+$/,dE=3,fE=2,mE=1,hE=10,pE=-2,Vy=t=>t==="*";function gE(t,e){let n=t.split("/"),i=n.length;return n.some(Vy)&&(i+=pE),e&&(i+=fE),n.filter(l=>!Vy(l)).reduce((l,o)=>l+(uE.test(o)?dE:o===""?mE:hE),i)}function xE(t,e){return t.length===e.length&&t.slice(0,-1).every((i,l)=>i===e[l])?t[t.length-1]-e[e.length-1]:0}function yE(t,e,n=!1){let{routesMeta:i}=t,l={},o="/",u=[];for(let f=0;f<i.length;++f){let g=i[f],h=f===i.length-1,x=o==="/"?e:e.slice(o.length)||"/",v=Ko({path:g.relativePath,caseSensitive:g.caseSensitive,end:h},x),N=g.route;if(!v&&h&&n&&!i[i.length-1].route.index&&(v=Ko({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},x)),!v)return null;Object.assign(l,v.params),u.push({params:l,pathname:xi([o,v.pathname]),pathnameBase:CE(xi([o,v.pathnameBase])),route:N}),v.pathnameBase!=="/"&&(o=xi([o,v.pathnameBase]))}return u}function Ko(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,i]=vE(t.path,t.caseSensitive,t.end),l=e.match(n);if(!l)return null;let o=l[0],u=o.replace(/(.)\/+$/,"$1"),f=l.slice(1);return{params:i.reduce((h,{paramName:x,isOptional:v},N)=>{if(x==="*"){let C=f[N]||"";u=o.slice(0,o.length-C.length).replace(/(.)\/+$/,"$1")}const w=f[N];return v&&!w?h[x]=void 0:h[x]=(w||"").replace(/%2F/g,"/"),h},{}),pathname:o,pathnameBase:u,pattern:t}}function vE(t,e=!1,n=!0){On(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let i=[],l="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,f,g)=>(i.push({paramName:f,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(i.push({paramName:"*"}),l+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?l+="\\/*$":t!==""&&t!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,e?void 0:"i"),i]}function bE(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return On(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function vi(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,i=t.charAt(n);return i&&i!=="/"?null:t.slice(n)||"/"}function wE(t,e="/"){let{pathname:n,search:i="",hash:l=""}=typeof t=="string"?Ls(t):t;return{pathname:n?n.startsWith("/")?n:NE(n,e):e,search:TE(i),hash:jE(l)}}function NE(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(l=>{l===".."?n.length>1&&n.pop():l!=="."&&n.push(l)}),n.length>1?n.join("/"):"/"}function nf(t,e,n,i){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function SE(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function wv(t){let e=SE(t);return e.map((n,i)=>i===e.length-1?n.pathname:n.pathnameBase)}function Nv(t,e,n,i=!1){let l;typeof t=="string"?l=Ls(t):(l={...t},vt(!l.pathname||!l.pathname.includes("?"),nf("?","pathname","search",l)),vt(!l.pathname||!l.pathname.includes("#"),nf("#","pathname","hash",l)),vt(!l.search||!l.search.includes("#"),nf("#","search","hash",l)));let o=t===""||l.pathname==="",u=o?"/":l.pathname,f;if(u==null)f=n;else{let v=e.length-1;if(!i&&u.startsWith("..")){let N=u.split("/");for(;N[0]==="..";)N.shift(),v-=1;l.pathname=N.join("/")}f=v>=0?e[v]:"/"}let g=wE(l,f),h=u&&u!=="/"&&u.endsWith("/"),x=(o||u===".")&&n.endsWith("/");return!g.pathname.endsWith("/")&&(h||x)&&(g.pathname+="/"),g}var xi=t=>t.join("/").replace(/\/\/+/g,"/"),CE=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),TE=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,jE=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function kE(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var Sv=["POST","PUT","PATCH","DELETE"];new Set(Sv);var EE=["GET",...Sv];new Set(EE);var Ps=M.createContext(null);Ps.displayName="DataRouter";var lc=M.createContext(null);lc.displayName="DataRouterState";var Cv=M.createContext({isTransitioning:!1});Cv.displayName="ViewTransition";var AE=M.createContext(new Map);AE.displayName="Fetchers";var _E=M.createContext(null);_E.displayName="Await";var Wn=M.createContext(null);Wn.displayName="Navigation";var sl=M.createContext(null);sl.displayName="Location";var Xn=M.createContext({outlet:null,matches:[],isDataRoute:!1});Xn.displayName="Route";var dm=M.createContext(null);dm.displayName="RouteError";function ME(t,{relative:e}={}){vt(al(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=M.useContext(Wn),{hash:l,pathname:o,search:u}=ll(t,{relative:e}),f=o;return n!=="/"&&(f=o==="/"?n:xi([n,o])),i.createHref({pathname:f,search:u,hash:l})}function al(){return M.useContext(sl)!=null}function Wi(){return vt(al(),"useLocation() may be used only in the context of a <Router> component."),M.useContext(sl).location}var Tv="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function jv(t){M.useContext(Wn).static||M.useLayoutEffect(t)}function fm(){let{isDataRoute:t}=M.useContext(Xn);return t?HE():RE()}function RE(){vt(al(),"useNavigate() may be used only in the context of a <Router> component.");let t=M.useContext(Ps),{basename:e,navigator:n}=M.useContext(Wn),{matches:i}=M.useContext(Xn),{pathname:l}=Wi(),o=JSON.stringify(wv(i)),u=M.useRef(!1);return jv(()=>{u.current=!0}),M.useCallback((g,h={})=>{if(On(u.current,Tv),!u.current)return;if(typeof g=="number"){n.go(g);return}let x=Nv(g,JSON.parse(o),l,h.relative==="path");t==null&&e!=="/"&&(x.pathname=x.pathname==="/"?e:xi([e,x.pathname])),(h.replace?n.replace:n.push)(x,h.state,h)},[e,n,o,l,t])}M.createContext(null);function IE(){let{matches:t}=M.useContext(Xn),e=t[t.length-1];return e?e.params:{}}function ll(t,{relative:e}={}){let{matches:n}=M.useContext(Xn),{pathname:i}=Wi(),l=JSON.stringify(wv(n));return M.useMemo(()=>Nv(t,JSON.parse(l),i,e==="path"),[t,l,i,e])}function DE(t,e){return kv(t,e)}function kv(t,e,n,i){var E;vt(al(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=M.useContext(Wn),{matches:o}=M.useContext(Xn),u=o[o.length-1],f=u?u.params:{},g=u?u.pathname:"/",h=u?u.pathnameBase:"/",x=u&&u.route;{let L=x&&x.path||"";Ev(g,!x||L.endsWith("*")||L.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${g}" (under <Route path="${L}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${L}"> to <Route path="${L==="/"?"*":`${L}/*`}">.`)}let v=Wi(),N;if(e){let L=typeof e=="string"?Ls(e):e;vt(h==="/"||((E=L.pathname)==null?void 0:E.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${L.pathname}" was given in the \`location\` prop.`),N=L}else N=v;let w=N.pathname||"/",C=w;if(h!=="/"){let L=h.replace(/^\//,"").split("/");C="/"+w.replace(/^\//,"").split("/").slice(L.length).join("/")}let j=yv(t,{pathname:C});On(x||j!=null,`No routes matched location "${N.pathname}${N.search}${N.hash}" `),On(j==null||j[j.length-1].route.element!==void 0||j[j.length-1].route.Component!==void 0||j[j.length-1].route.lazy!==void 0,`Matched leaf route at location "${N.pathname}${N.search}${N.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let k=UE(j&&j.map(L=>Object.assign({},L,{params:Object.assign({},f,L.params),pathname:xi([h,l.encodeLocation?l.encodeLocation(L.pathname).pathname:L.pathname]),pathnameBase:L.pathnameBase==="/"?h:xi([h,l.encodeLocation?l.encodeLocation(L.pathnameBase).pathname:L.pathnameBase])})),o,n,i);return e&&k?M.createElement(sl.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...N},navigationType:"POP"}},k):k}function LE(){let t=FE(),e=kE(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:i},o={padding:"2px 4px",backgroundColor:i},u=null;return console.error("Error handled by React Router default ErrorBoundary:",t),u=M.createElement(M.Fragment,null,M.createElement("p",null,"💿 Hey developer 👋"),M.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",M.createElement("code",{style:o},"ErrorBoundary")," or"," ",M.createElement("code",{style:o},"errorElement")," prop on your route.")),M.createElement(M.Fragment,null,M.createElement("h2",null,"Unexpected Application Error!"),M.createElement("h3",{style:{fontStyle:"italic"}},e),n?M.createElement("pre",{style:l},n):null,u)}var PE=M.createElement(LE,null),OE=class extends M.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?M.createElement(Xn.Provider,{value:this.props.routeContext},M.createElement(dm.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function BE({routeContext:t,match:e,children:n}){let i=M.useContext(Ps);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),M.createElement(Xn.Provider,{value:t},n)}function UE(t,e=[],n=null,i=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let l=t,o=n==null?void 0:n.errors;if(o!=null){let g=l.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);vt(g>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),l=l.slice(0,Math.min(l.length,g+1))}let u=!1,f=-1;if(n)for(let g=0;g<l.length;g++){let h=l[g];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(f=g),h.route.id){let{loaderData:x,errors:v}=n,N=h.route.loader&&!x.hasOwnProperty(h.route.id)&&(!v||v[h.route.id]===void 0);if(h.route.lazy||N){u=!0,f>=0?l=l.slice(0,f+1):l=[l[0]];break}}}return l.reduceRight((g,h,x)=>{let v,N=!1,w=null,C=null;n&&(v=o&&h.route.id?o[h.route.id]:void 0,w=h.route.errorElement||PE,u&&(f<0&&x===0?(Ev("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),N=!0,C=null):f===x&&(N=!0,C=h.route.hydrateFallbackElement||null)));let j=e.concat(l.slice(0,x+1)),k=()=>{let E;return v?E=w:N?E=C:h.route.Component?E=M.createElement(h.route.Component,null):h.route.element?E=h.route.element:E=g,M.createElement(BE,{match:h,routeContext:{outlet:g,matches:j,isDataRoute:n!=null},children:E})};return n&&(h.route.ErrorBoundary||h.route.errorElement||x===0)?M.createElement(OE,{location:n.location,revalidation:n.revalidation,component:w,error:v,children:k(),routeContext:{outlet:null,matches:j,isDataRoute:!0}}):k()},null)}function mm(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function zE(t){let e=M.useContext(Ps);return vt(e,mm(t)),e}function VE(t){let e=M.useContext(lc);return vt(e,mm(t)),e}function $E(t){let e=M.useContext(Xn);return vt(e,mm(t)),e}function hm(t){let e=$E(t),n=e.matches[e.matches.length-1];return vt(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function qE(){return hm("useRouteId")}function FE(){var i;let t=M.useContext(dm),e=VE("useRouteError"),n=hm("useRouteError");return t!==void 0?t:(i=e.errors)==null?void 0:i[n]}function HE(){let{router:t}=zE("useNavigate"),e=hm("useNavigate"),n=M.useRef(!1);return jv(()=>{n.current=!0}),M.useCallback(async(l,o={})=>{On(n.current,Tv),n.current&&(typeof l=="number"?t.navigate(l):await t.navigate(l,{fromRouteId:e,...o}))},[t,e])}var $y={};function Ev(t,e,n){!e&&!$y[t]&&($y[t]=!0,On(!1,n))}M.memo(GE);function GE({routes:t,future:e,state:n}){return kv(t,void 0,n,e)}function kn(t){vt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function JE({basename:t="/",children:e=null,location:n,navigationType:i="POP",navigator:l,static:o=!1}){vt(!al(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=t.replace(/^\/*/,"/"),f=M.useMemo(()=>({basename:u,navigator:l,static:o,future:{}}),[u,l,o]);typeof n=="string"&&(n=Ls(n));let{pathname:g="/",search:h="",hash:x="",state:v=null,key:N="default"}=n,w=M.useMemo(()=>{let C=vi(g,u);return C==null?null:{location:{pathname:C,search:h,hash:x,state:v,key:N},navigationType:i}},[u,g,h,x,v,N,i]);return On(w!=null,`<Router basename="${u}"> is not able to match the URL "${g}${h}${x}" because it does not start with the basename, so the <Router> won't render anything.`),w==null?null:M.createElement(Wn.Provider,{value:f},M.createElement(sl.Provider,{children:e,value:w}))}function YE({children:t,location:e}){return DE(Uf(t),e)}function Uf(t,e=[]){let n=[];return M.Children.forEach(t,(i,l)=>{if(!M.isValidElement(i))return;let o=[...e,l];if(i.type===M.Fragment){n.push.apply(n,Uf(i.props.children,o));return}vt(i.type===kn,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),vt(!i.props.index||!i.props.children,"An index route cannot have child routes.");let u={id:i.props.id||o.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(u.children=Uf(i.props.children,o)),n.push(u)}),n}var Po="get",Oo="application/x-www-form-urlencoded";function oc(t){return t!=null&&typeof t.tagName=="string"}function ZE(t){return oc(t)&&t.tagName.toLowerCase()==="button"}function QE(t){return oc(t)&&t.tagName.toLowerCase()==="form"}function KE(t){return oc(t)&&t.tagName.toLowerCase()==="input"}function WE(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function XE(t,e){return t.button===0&&(!e||e==="_self")&&!WE(t)}function zf(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let i=t[n];return e.concat(Array.isArray(i)?i.map(l=>[n,l]):[[n,i]])},[]))}function eA(t,e){let n=zf(t);return e&&e.forEach((i,l)=>{n.has(l)||e.getAll(l).forEach(o=>{n.append(l,o)})}),n}var Co=null;function tA(){if(Co===null)try{new FormData(document.createElement("form"),0),Co=!1}catch{Co=!0}return Co}var nA=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function rf(t){return t!=null&&!nA.has(t)?(On(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Oo}"`),null):t}function iA(t,e){let n,i,l,o,u;if(QE(t)){let f=t.getAttribute("action");i=f?vi(f,e):null,n=t.getAttribute("method")||Po,l=rf(t.getAttribute("enctype"))||Oo,o=new FormData(t)}else if(ZE(t)||KE(t)&&(t.type==="submit"||t.type==="image")){let f=t.form;if(f==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=t.getAttribute("formaction")||f.getAttribute("action");if(i=g?vi(g,e):null,n=t.getAttribute("formmethod")||f.getAttribute("method")||Po,l=rf(t.getAttribute("formenctype"))||rf(f.getAttribute("enctype"))||Oo,o=new FormData(f,t),!tA()){let{name:h,type:x,value:v}=t;if(x==="image"){let N=h?`${h}.`:"";o.append(`${N}x`,"0"),o.append(`${N}y`,"0")}else h&&o.append(h,v)}}else{if(oc(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Po,i=null,l=Oo,u=t}return o&&l==="text/plain"&&(u=o,o=void 0),{action:i,method:n.toLowerCase(),encType:l,formData:o,body:u}}function pm(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function rA(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function sA(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function aA(t,e,n){let i=await Promise.all(t.map(async l=>{let o=e.routes[l.route.id];if(o){let u=await rA(o,n);return u.links?u.links():[]}return[]}));return uA(i.flat(1).filter(sA).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function qy(t,e,n,i,l,o){let u=(g,h)=>n[h]?g.route.id!==n[h].route.id:!0,f=(g,h)=>{var x;return n[h].pathname!==g.pathname||((x=n[h].route.path)==null?void 0:x.endsWith("*"))&&n[h].params["*"]!==g.params["*"]};return o==="assets"?e.filter((g,h)=>u(g,h)||f(g,h)):o==="data"?e.filter((g,h)=>{var v;let x=i.routes[g.route.id];if(!x||!x.hasLoader)return!1;if(u(g,h)||f(g,h))return!0;if(g.route.shouldRevalidate){let N=g.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:((v=n[0])==null?void 0:v.params)||{},nextUrl:new URL(t,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof N=="boolean")return N}return!0}):[]}function lA(t,e,{includeHydrateFallback:n}={}){return oA(t.map(i=>{let l=e.routes[i.route.id];if(!l)return[];let o=[l.module];return l.clientActionModule&&(o=o.concat(l.clientActionModule)),l.clientLoaderModule&&(o=o.concat(l.clientLoaderModule)),n&&l.hydrateFallbackModule&&(o=o.concat(l.hydrateFallbackModule)),l.imports&&(o=o.concat(l.imports)),o}).flat(1))}function oA(t){return[...new Set(t)]}function cA(t){let e={},n=Object.keys(t).sort();for(let i of n)e[i]=t[i];return e}function uA(t,e){let n=new Set;return new Set(e),t.reduce((i,l)=>{let o=JSON.stringify(cA(l));return n.has(o)||(n.add(o),i.push({key:o,link:l})),i},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var dA=new Set([100,101,204,205]);function fA(t,e){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname="_root.data":e&&vi(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.data`:n.pathname=`${n.pathname.replace(/\/$/,"")}.data`,n}function Av(){let t=M.useContext(Ps);return pm(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function mA(){let t=M.useContext(lc);return pm(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var gm=M.createContext(void 0);gm.displayName="FrameworkContext";function _v(){let t=M.useContext(gm);return pm(t,"You must render this element inside a <HydratedRouter> element"),t}function hA(t,e){let n=M.useContext(gm),[i,l]=M.useState(!1),[o,u]=M.useState(!1),{onFocus:f,onBlur:g,onMouseEnter:h,onMouseLeave:x,onTouchStart:v}=e,N=M.useRef(null);M.useEffect(()=>{if(t==="render"&&u(!0),t==="viewport"){let j=E=>{E.forEach(L=>{u(L.isIntersecting)})},k=new IntersectionObserver(j,{threshold:.5});return N.current&&k.observe(N.current),()=>{k.disconnect()}}},[t]),M.useEffect(()=>{if(i){let j=setTimeout(()=>{u(!0)},100);return()=>{clearTimeout(j)}}},[i]);let w=()=>{l(!0)},C=()=>{l(!1),u(!1)};return n?t!=="intent"?[o,N,{}]:[o,N,{onFocus:Ua(f,w),onBlur:Ua(g,C),onMouseEnter:Ua(h,w),onMouseLeave:Ua(x,C),onTouchStart:Ua(v,w)}]:[!1,N,{}]}function Ua(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function pA({page:t,...e}){let{router:n}=Av(),i=M.useMemo(()=>yv(n.routes,t,n.basename),[n.routes,t,n.basename]);return i?M.createElement(xA,{page:t,matches:i,...e}):null}function gA(t){let{manifest:e,routeModules:n}=_v(),[i,l]=M.useState([]);return M.useEffect(()=>{let o=!1;return aA(t,e,n).then(u=>{o||l(u)}),()=>{o=!0}},[t,e,n]),i}function xA({page:t,matches:e,...n}){let i=Wi(),{manifest:l,routeModules:o}=_v(),{basename:u}=Av(),{loaderData:f,matches:g}=mA(),h=M.useMemo(()=>qy(t,e,g,l,i,"data"),[t,e,g,l,i]),x=M.useMemo(()=>qy(t,e,g,l,i,"assets"),[t,e,g,l,i]),v=M.useMemo(()=>{if(t===i.pathname+i.search+i.hash)return[];let C=new Set,j=!1;if(e.forEach(E=>{var D;let L=l.routes[E.route.id];!L||!L.hasLoader||(!h.some(O=>O.route.id===E.route.id)&&E.route.id in f&&((D=o[E.route.id])!=null&&D.shouldRevalidate)||L.hasClientLoader?j=!0:C.add(E.route.id))}),C.size===0)return[];let k=fA(t,u);return j&&C.size>0&&k.searchParams.set("_routes",e.filter(E=>C.has(E.route.id)).map(E=>E.route.id).join(",")),[k.pathname+k.search]},[u,f,i,l,h,e,t,o]),N=M.useMemo(()=>lA(x,l),[x,l]),w=gA(x);return M.createElement(M.Fragment,null,v.map(C=>M.createElement("link",{key:C,rel:"prefetch",as:"fetch",href:C,...n})),N.map(C=>M.createElement("link",{key:C,rel:"modulepreload",href:C,...n})),w.map(({key:C,link:j})=>M.createElement("link",{key:C,...j})))}function yA(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var Mv=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Mv&&(window.__reactRouterVersion="7.6.2")}catch{}function vA({basename:t,children:e,window:n}){let i=M.useRef();i.current==null&&(i.current=rE({window:n,v5Compat:!0}));let l=i.current,[o,u]=M.useState({action:l.action,location:l.location}),f=M.useCallback(g=>{M.startTransition(()=>u(g))},[u]);return M.useLayoutEffect(()=>l.listen(f),[l,f]),M.createElement(JE,{basename:t,children:e,location:o.location,navigationType:o.action,navigator:l})}var Rv=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Iv=M.forwardRef(function({onClick:e,discover:n="render",prefetch:i="none",relative:l,reloadDocument:o,replace:u,state:f,target:g,to:h,preventScrollReset:x,viewTransition:v,...N},w){let{basename:C}=M.useContext(Wn),j=typeof h=="string"&&Rv.test(h),k,E=!1;if(typeof h=="string"&&j&&(k=h,Mv))try{let B=new URL(window.location.href),ee=h.startsWith("//")?new URL(B.protocol+h):new URL(h),G=vi(ee.pathname,C);ee.origin===B.origin&&G!=null?h=G+ee.search+ee.hash:E=!0}catch{On(!1,`<Link to="${h}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let L=ME(h,{relative:l}),[D,O,H]=hA(i,N),I=SA(h,{replace:u,state:f,target:g,preventScrollReset:x,relative:l,viewTransition:v});function R(B){e&&e(B),B.defaultPrevented||I(B)}let q=M.createElement("a",{...N,...H,href:k||L,onClick:E||o?e:R,ref:yA(w,O),target:g,"data-discover":!j&&n==="render"?"true":void 0});return D&&!j?M.createElement(M.Fragment,null,q,M.createElement(pA,{page:L})):q});Iv.displayName="Link";var bA=M.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:i="",end:l=!1,style:o,to:u,viewTransition:f,children:g,...h},x){let v=ll(u,{relative:h.relative}),N=Wi(),w=M.useContext(lc),{navigator:C,basename:j}=M.useContext(Wn),k=w!=null&&EA(v)&&f===!0,E=C.encodeLocation?C.encodeLocation(v).pathname:v.pathname,L=N.pathname,D=w&&w.navigation&&w.navigation.location?w.navigation.location.pathname:null;n||(L=L.toLowerCase(),D=D?D.toLowerCase():null,E=E.toLowerCase()),D&&j&&(D=vi(D,j)||D);const O=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let H=L===E||!l&&L.startsWith(E)&&L.charAt(O)==="/",I=D!=null&&(D===E||!l&&D.startsWith(E)&&D.charAt(E.length)==="/"),R={isActive:H,isPending:I,isTransitioning:k},q=H?e:void 0,B;typeof i=="function"?B=i(R):B=[i,H?"active":null,I?"pending":null,k?"transitioning":null].filter(Boolean).join(" ");let ee=typeof o=="function"?o(R):o;return M.createElement(Iv,{...h,"aria-current":q,className:B,ref:x,style:ee,to:u,viewTransition:f},typeof g=="function"?g(R):g)});bA.displayName="NavLink";var wA=M.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:i,replace:l,state:o,method:u=Po,action:f,onSubmit:g,relative:h,preventScrollReset:x,viewTransition:v,...N},w)=>{let C=jA(),j=kA(f,{relative:h}),k=u.toLowerCase()==="get"?"get":"post",E=typeof f=="string"&&Rv.test(f),L=D=>{if(g&&g(D),D.defaultPrevented)return;D.preventDefault();let O=D.nativeEvent.submitter,H=(O==null?void 0:O.getAttribute("formmethod"))||u;C(O||D.currentTarget,{fetcherKey:e,method:H,navigate:n,replace:l,state:o,relative:h,preventScrollReset:x,viewTransition:v})};return M.createElement("form",{ref:w,method:k,action:j,onSubmit:i?g:L,...N,"data-discover":!E&&t==="render"?"true":void 0})});wA.displayName="Form";function NA(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Dv(t){let e=M.useContext(Ps);return vt(e,NA(t)),e}function SA(t,{target:e,replace:n,state:i,preventScrollReset:l,relative:o,viewTransition:u}={}){let f=fm(),g=Wi(),h=ll(t,{relative:o});return M.useCallback(x=>{if(XE(x,e)){x.preventDefault();let v=n!==void 0?n:Xa(g)===Xa(h);f(t,{replace:v,state:i,preventScrollReset:l,relative:o,viewTransition:u})}},[g,f,h,n,i,e,t,l,o,u])}function jr(t){On(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=M.useRef(zf(t)),n=M.useRef(!1),i=Wi(),l=M.useMemo(()=>eA(i.search,n.current?null:e.current),[i.search]),o=fm(),u=M.useCallback((f,g)=>{const h=zf(typeof f=="function"?f(l):f);n.current=!0,o("?"+h,g)},[o,l]);return[l,u]}var CA=0,TA=()=>`__${String(++CA)}__`;function jA(){let{router:t}=Dv("useSubmit"),{basename:e}=M.useContext(Wn),n=qE();return M.useCallback(async(i,l={})=>{let{action:o,method:u,encType:f,formData:g,body:h}=iA(i,e);if(l.navigate===!1){let x=l.fetcherKey||TA();await t.fetch(x,n,l.action||o,{preventScrollReset:l.preventScrollReset,formData:g,body:h,formMethod:l.method||u,formEncType:l.encType||f,flushSync:l.flushSync})}else await t.navigate(l.action||o,{preventScrollReset:l.preventScrollReset,formData:g,body:h,formMethod:l.method||u,formEncType:l.encType||f,replace:l.replace,state:l.state,fromRouteId:n,flushSync:l.flushSync,viewTransition:l.viewTransition})},[t,e,n])}function kA(t,{relative:e}={}){let{basename:n}=M.useContext(Wn),i=M.useContext(Xn);vt(i,"useFormAction must be used inside a RouteContext");let[l]=i.matches.slice(-1),o={...ll(t||".",{relative:e})},u=Wi();if(t==null){o.search=u.search;let f=new URLSearchParams(o.search),g=f.getAll("index");if(g.some(x=>x==="")){f.delete("index"),g.filter(v=>v).forEach(v=>f.append("index",v));let x=f.toString();o.search=x?`?${x}`:""}}return(!t||t===".")&&l.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(o.pathname=o.pathname==="/"?n:xi([n,o.pathname])),Xa(o)}function EA(t,e={}){let n=M.useContext(Cv);vt(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=Dv("useViewTransitionState"),l=ll(t,{relative:e.relative});if(!n.isTransitioning)return!1;let o=vi(n.currentLocation.pathname,i)||n.currentLocation.pathname,u=vi(n.nextLocation.pathname,i)||n.nextLocation.pathname;return Ko(l.pathname,u)!=null||Ko(l.pathname,o)!=null}[...dA];class AA{constructor(){this.dbName="AILearningPageGenerator",this.version=1,this.storeName="lessonPlans",this.db=null}async init(){return new Promise((e,n)=>{const i=indexedDB.open(this.dbName,this.version);i.onerror=()=>{n(new Error("Failed to open IndexedDB"))},i.onsuccess=l=>{this.db=l.target.result,e()},i.onupgradeneeded=l=>{const o=l.target.result;if(!o.objectStoreNames.contains(this.storeName)){const u=o.createObjectStore(this.storeName,{keyPath:"id"});u.createIndex("topic","topic",{unique:!1}),u.createIndex("createdAt","createdAt",{unique:!1}),u.createIndex("lastAccessedAt","lastAccessedAt",{unique:!1})}}})}async ensureDB(){if(this.db||await this.init(),!this.db)throw new Error("Database not initialized");return this.db}async saveLessonPlan(e){const n=await this.ensureDB();return new Promise((i,l)=>{const f=n.transaction([this.storeName],"readwrite").objectStore(this.storeName).put(e);f.onsuccess=()=>i(),f.onerror=()=>l(new Error("Failed to save lesson plan"))})}async getAllLessonPlans(){const e=await this.ensureDB();return new Promise((n,i)=>{const f=e.transaction([this.storeName],"readonly").objectStore(this.storeName).index("lastAccessedAt").openCursor(null,"prev"),g=[];f.onsuccess=h=>{const x=h.target.result;x?(g.push(x.value),x.continue()):n(g)},f.onerror=()=>i(new Error("Failed to get lesson plans"))})}async getLessonPlan(e){const n=await this.ensureDB();return new Promise((i,l)=>{const f=n.transaction([this.storeName],"readonly").objectStore(this.storeName).get(e);f.onsuccess=()=>{const g=f.result;i(g||null)},f.onerror=()=>l(new Error("Failed to get lesson plan"))})}async updateLastAccessed(e){const n=await this.getLessonPlan(e);n&&(n.lastAccessedAt=new Date().toISOString(),await this.saveLessonPlan(n))}async deleteLessonPlan(e){const n=await this.ensureDB();return new Promise((i,l)=>{const f=n.transaction([this.storeName],"readwrite").objectStore(this.storeName).delete(e);f.onsuccess=()=>i(),f.onerror=()=>l(new Error("Failed to delete lesson plan"))})}async searchLessonPlans(e){const n=await this.getAllLessonPlans(),i=e.toLowerCase();return n.filter(l=>l.topic.toLowerCase().includes(i))}async getSharedLessonPlans(){return(await this.getAllLessonPlans()).filter(n=>{var i;return((i=n.metadata)==null?void 0:i.isShared)===!0})}async getLocalLessonPlans(){return(await this.getAllLessonPlans()).filter(n=>{var i;return!((i=n.metadata)!=null&&i.isShared)})}async cleanupOldLessonPlans(e=50){const n=await this.getAllLessonPlans();if(n.length>e){const i=n.slice(e);for(const l of i)await this.deleteLessonPlan(l.id)}}async getStorageStats(){var n,i;const e=await this.getAllLessonPlans();return{totalCount:e.length,totalSizeEstimate:JSON.stringify(e).length,oldestPlan:(n=e[e.length-1])==null?void 0:n.topic,newestPlan:(i=e[0])==null?void 0:i.topic}}}const zt=new AA,_A=t=>{const e=Date.now(),n=Math.random().toString(36).substr(2,9);return`lesson_${e}_${n}`},MA=(t,e)=>{const n=new Date().toISOString();return{id:_A(),topic:t,createdAt:n,lastAccessedAt:n,content:e,metadata:{totalSections:[e.learningObjectives,e.contentBreakdown,e.confusionPoints,e.classroomActivities,e.quiz,e.writingPractice].filter(Boolean).length,hasQuiz:!!e.quiz,hasWriting:!!e.writingPractice}}},RA=({quiz:t,topic:e,apiKey:n,supportsDiagnostic:i=!1,quizBinId:l})=>{const[o,u]=M.useState(Mt.Easy),[f,g]=M.useState([]),[h,x]=M.useState(!1),[v,N]=M.useState(""),[w,C]=M.useState(!1),[j,k]=M.useState(""),[E,L]=M.useState(!1),[D,O]=M.useState(!1),H=M.useCallback((z,$,Q,P,K,pe)=>{if(!i)return;const X=`${o}-${z}-${$}`,S={questionId:X,questionType:z,difficulty:o.toLowerCase(),userAnswer:Q,correctAnswer:P,isCorrect:K,responseTime:pe,attempts:1};g(V=>{const ie=V.findIndex(_=>_.questionId===X);if(ie>=0){const _=[...V];return _[ie]={..._[ie],userAnswer:Q,isCorrect:K,attempts:(_[ie].attempts||1)+1},_}return[...V,S]})},[o,i]),I=(z,$)=>{switch(z){case"trueFalse":return $.isTrue;case"multipleChoice":return $.options[$.correctAnswerIndex];case"fillInTheBlanks":return $.correctAnswers;case"sentenceScramble":return $.originalSentence;case"memoryCardGame":return $.pairs;default:return null}},R=()=>{const z=o.toLowerCase();return f.filter($=>$.difficulty===z)},q=M.useCallback(async()=>{const z=R();if(z.length===0){alert("請先完成一些題目再分享結果！");return}if(!v.trim()){L(!0);return}C(!0);try{const $=rv(z),Q=o===Mt.Easy?"簡單":o===Mt.Normal?"普通":"困難",P=(t==null?void 0:t[o])||{},K=await gk({studentName:v.trim(),topic:e,difficulty:Q,responses:z,overallScore:$,completedAt:new Date().toISOString(),quizBinId:l,quizContent:P,metadata:{totalQuestions:z.length,correctAnswers:z.filter(S=>S.isCorrect).length,selectedDifficulty:o}}),X=`${window.location.origin}/ai-page-gen/student-results?binId=${K}`;k(X),navigator.clipboard&&window.isSecureContext?(await navigator.clipboard.writeText(X),alert("作答結果已分享！連結已複製到剪貼簿，可以傳送給老師。")):alert("作答結果已分享！請複製下方連結傳送給老師。")}catch($){console.error("分享失敗:",$),alert("分享失敗，請稍後再試。")}finally{C(!1)}},[R,v,e,o,l]);if(h&&i&&n&&R().length>0)return a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50",children:[a.jsx("div",{className:"bg-white shadow-sm border-b",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(Ns,{className:"w-8 h-8 text-indigo-600"}),a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"學習診斷報告"}),a.jsxs("span",{className:"px-3 py-1 bg-indigo-100 text-indigo-800 text-sm font-medium rounded-full",children:[o===Mt.Easy?"簡單":o===Mt.Normal?"普通":"困難"," 難度"]})]}),a.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[a.jsx(Pn,{className:"w-5 h-5"}),a.jsx("span",{className:"text-lg font-medium",children:e})]})]})}),a.jsx("div",{className:"max-w-4xl mx-auto px-4 py-8",children:a.jsx(lm,{topic:`${e} (${o===Mt.Easy?"簡單":o===Mt.Normal?"普通":"困難"}難度)`,apiKey:n,mode:"student",initialResponses:R(),onClose:()=>x(!1),onRetakeQuiz:()=>{const z=o.toLowerCase();g($=>$.filter(Q=>Q.difficulty!==z)),x(!1)},onContinueLearning:()=>x(!1)})})]});if(!t)return a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Ja,{className:"w-16 h-16 text-slate-400 mx-auto mb-4"}),a.jsx("p",{className:"text-slate-600 text-lg",children:"沒有可用的測驗資料"})]});const B=t[o],ee=[{key:Mt.Easy,label:"簡單",color:"bg-green-500 hover:bg-green-600"},{key:Mt.Normal,label:"普通",color:"bg-yellow-500 hover:bg-yellow-600"},{key:Mt.Hard,label:"困難",color:"bg-red-500 hover:bg-red-600"}],G={trueFalse:"是非題",multipleChoice:"選擇題",fillInTheBlanks:"填空題",sentenceScramble:"句子重組",memoryCardGame:"翻卡牌記憶遊戲"},Y=(z,$)=>{if(!$||$.length===0)return null;const Q=P=>i?(K,pe,X)=>{const S=I(z,$[P]);H(z,P,K,S,pe,X)}:void 0;switch(z){case"trueFalse":return a.jsx("div",{className:"space-y-4",children:$.map((P,K)=>a.jsx(rm,{question:P,itemNumber:K+1,onAnswer:Q(K)},`${o}-tf-${K}`))});case"multipleChoice":return a.jsx("div",{className:"space-y-4",children:$.map((P,K)=>a.jsx(sm,{question:P,itemNumber:K+1,onAnswer:Q(K)},`${o}-mc-${K}`))});case"fillInTheBlanks":return a.jsx("div",{className:"space-y-4",children:$.map((P,K)=>a.jsx(sv,{question:P,itemNumber:K+1,onAnswer:Q(K)},`${o}-fb-${K}`))});case"sentenceScramble":return a.jsx("div",{className:"space-y-4",children:$.map((P,K)=>a.jsx(av,{question:P,itemNumber:K+1,onAnswer:Q(K)},`${o}-ss-${K}`))});case"memoryCardGame":return a.jsx("div",{className:"space-y-4",children:$.map((P,K)=>a.jsx(am,{question:P,itemNumber:K+1,onAnswer:Q(K)},`${o}-mcg-${K}`))});default:return null}};return a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50",children:[a.jsx("div",{className:"bg-white shadow-sm border-b",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(Ja,{className:"w-8 h-8 text-indigo-600"}),a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"互動測驗"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[a.jsx(Pn,{className:"w-5 h-5"}),a.jsx("span",{className:"text-lg font-medium",children:e}),i&&a.jsx("span",{className:"ml-2 px-2 py-1 bg-green-100 text-green-700 text-xs rounded-full",children:"支援 AI 診斷"})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[i&&R().length>0&&a.jsxs("button",{onClick:()=>x(!0),className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:[a.jsx(Ns,{className:"w-5 h-5"}),"查看學習診斷 (",R().length,")"]}),R().length>0&&a.jsxs("button",{onClick:q,disabled:w,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.217 10.907a2.25 2.25 0 1 0 0 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186 9.566-5.314m-9.566 7.5 9.566 5.314m0 0a2.25 2.25 0 1 0 3.935 2.186 2.25 2.25 0 0 0-3.935-2.186Zm0-11.314a2.25 2.25 0 1 0 3.935-2.186 2.25 2.25 0 0 0-3.935 2.186Z"})}),w?"分享中...":`分享結果給老師 (${R().length})`]})]})]})]})}),a.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[i&&a.jsx("div",{className:"mb-6 p-4 bg-blue-50 border-l-4 border-blue-400 rounded-r-lg",children:a.jsxs("div",{className:"flex items-start",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx(Ns,{className:"w-5 h-5 text-blue-400 mt-0.5"})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm text-blue-700 font-medium",children:"此測驗支援 AI 學習診斷功能"}),a.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"完成題目後可查看個人化學習建議。您的答題資料僅用於生成學習診斷報告。"})]})]})}),a.jsxs("div",{className:"mb-8",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"選擇難度等級"}),a.jsx("div",{className:"flex flex-wrap gap-3",children:ee.map(({key:z,label:$,color:Q})=>a.jsx("button",{onClick:()=>u(z),className:`px-6 py-3 rounded-lg text-white font-medium transition-all transform hover:scale-105 shadow-md
                  ${o===z?`${Q} ring-4 ring-opacity-50`:"bg-gray-400 hover:bg-gray-500"}
                `,children:$},z))})]}),B&&a.jsx("div",{className:"space-y-8",children:Object.keys(G).map(z=>{const $=B[z],Q=Y(z,$);return Q?a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-6 pb-3 border-b border-gray-200",children:[a.jsx("div",{className:"w-3 h-3 bg-indigo-500 rounded-full"}),a.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:G[z]})]}),Q]},z):null})}),(!B||Object.values(B).every(z=>!z||z.length===0))&&a.jsx("div",{className:"text-center py-12",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8",children:[a.jsx(Ja,{className:"w-16 h-16 text-slate-400 mx-auto mb-4"}),a.jsx("p",{className:"text-slate-600 text-lg",children:"此難度等級暫無測驗題目"}),a.jsx("p",{className:"text-slate-500 text-sm mt-2",children:"請選擇其他難度等級"})]})})]}),E&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:z=>{z.target===z.currentTarget&&L(!1)},children:a.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"分享作答結果給老師"}),a.jsx("button",{onClick:()=>L(!1),className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"關閉",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsx("p",{className:"text-gray-600 mb-4",children:"請輸入您的姓名，讓老師知道這是誰的作答結果："}),a.jsx("input",{type:"text",value:v,onChange:z=>N(z.target.value),placeholder:"請輸入姓名",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent mb-4",onKeyPress:z=>z.key==="Enter"&&q()}),a.jsxs("div",{className:"flex gap-3 justify-end",children:[a.jsx("button",{onClick:()=>L(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"取消"}),a.jsx("button",{onClick:q,disabled:!v.trim()||w,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:w?"分享中...":"分享結果"})]})]})}),j&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:z=>{z.target===z.currentTarget&&(k(""),O(!1))},children:a.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"✅ 作答結果已分享成功！"}),a.jsx("button",{onClick:()=>{k(""),O(!1)},className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"關閉",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsx("p",{className:"text-gray-600 mb-4",children:"請將下方連結傳送給您的老師，老師可以查看您的作答結果並提供學習建議："}),a.jsx("div",{className:"bg-gray-50 p-3 rounded-lg mb-4",children:a.jsxs("div",{className:"space-y-3",children:[a.jsx("input",{type:"text",value:j,readOnly:!0,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded text-sm"}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[a.jsx("button",{onClick:async()=>{navigator.clipboard&&window.isSecureContext&&(await navigator.clipboard.writeText(j),alert("連結已複製到剪貼簿！"))},className:"flex-1 px-3 py-2 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 transition-colors",children:"複製連結"}),a.jsxs("button",{onClick:()=>O(!D),className:"flex-1 px-3 py-2 bg-green-600 text-white rounded text-sm hover:bg-green-700 transition-colors flex items-center justify-center gap-1",children:[a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 3.75 9.375v-4.5ZM3.75 14.625c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5a1.125 1.125 0 0 1-1.125-1.125v-4.5ZM13.5 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 13.5 9.375v-4.5Z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 6.75h.75v.75h-.75v-.75ZM6.75 16.5h.75v.75h-.75v-.75ZM16.5 6.75h.75v.75h-.75v-.75ZM13.5 13.5H8.25v1.5H13.5V13.5ZM13.5 16.5H8.25V18H13.5v-1.5ZM16.5 16.5h1.5V18h-1.5v-1.5ZM16.5 13.5h1.5v1.5h-1.5v-1.5Z"})]}),"顯示 QR Code"]})]})]})}),D&&a.jsx("div",{className:"mb-4 flex justify-center",children:a.jsx(ys,{url:j,title:"作答結果分享 QR Code",size:200,className:"bg-white"})}),a.jsx("div",{className:"bg-blue-50 p-3 rounded-lg mb-4",children:a.jsxs("p",{className:"text-sm text-blue-700",children:["💡 ",a.jsx("strong",{children:"給老師的說明："}),a.jsx("br",{}),"老師打開連結後可以看到 ",v," 在「",e,"」(",o===Mt.Easy?"簡單":o===Mt.Normal?"普通":"困難","難度) 的作答結果，並可使用 AI 進行詳細的學習分析。"]})}),a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{onClick:()=>{k(""),O(!1)},className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"關閉"})})]})}),a.jsx("footer",{className:"bg-white border-t mt-12 py-6",children:a.jsx("div",{className:"max-w-4xl mx-auto px-4 text-center",children:a.jsx("p",{className:"text-sm text-gray-500",children:"由 AI 學習頁面產生器創建 • 祝你學習愉快！"})})})]})},IA=()=>{const[t]=jr(),e=t.get("binId"),[n,i]=Be.useState(null),[l,o]=Be.useState(""),[u,f]=Be.useState(""),[g,h]=Be.useState(!1),[x,v]=Be.useState(!1),[N,w]=Be.useState("");return Be.useEffect(()=>{if(!e){w("缺少測驗ID參數");return}(async()=>{v(!0);try{const j=await mk(e);i(j.quiz),o(j.topic);let k=j.apiKey||"";try{const E=await fv(t);E&&(k=E,console.log("使用 URL 中的 API Key 進行學習診斷"))}catch(E){console.warn("解析 URL API Key 失敗:",E)}f(k),h(!!k)}catch(j){w(j.message||"載入測驗失敗")}finally{v(!1)}})()},[e,t]),x?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(sn,{}),a.jsx("p",{className:"mt-4 text-gray-600",children:"載入測驗中..."})]})}):N?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 flex items-center justify-center",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md mx-4 text-center",children:[a.jsx("div",{className:"text-red-500 text-6xl mb-4",children:"⚠️"}),a.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"測驗載入失敗"}),a.jsx("p",{className:"text-gray-600 mb-4",children:N}),a.jsx("p",{className:"text-sm text-gray-500",children:"請確認連結是否正確，或聯繫您的老師"})]})}):!n||!l?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 flex items-center justify-center",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md mx-4 text-center",children:[a.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:"🔍"}),a.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"找不到測驗內容"}),a.jsx("p",{className:"text-gray-600",children:"請檢查連結是否正確"})]})}):a.jsx(RA,{quiz:n,topic:l,apiKey:u,supportsDiagnostic:g,quizBinId:e})},DA=()=>{const[t]=jr(),[e,n]=M.useState(null),[i,l]=M.useState(!0),[o,u]=M.useState(null),[f,g]=M.useState(""),[h,x]=M.useState("manual"),v=t.get("binId");M.useEffect(()=>{(async()=>{if(!v){u("缺少內容 ID"),l(!1);return}try{l(!0);const C=await pk(v);n(C.writingPractice);try{const j=await fv(t);j&&(g(j),x("url"),localStorage.setItem("geminiApiKey",j),console.log("使用 URL 中的 API Key 進行 AI 批改"))}catch(j){console.warn("解析 URL API Key 失敗:",j)}}catch(C){console.error("載入分享內容失敗:",C),u("載入分享內容失敗，請檢查連結是否正確")}finally{l(!1)}})()},[v,t]),M.useEffect(()=>{if(!f){const w=localStorage.getItem("geminiApiKey");w&&(g(w),x("localStorage"))}},[]);const N=w=>{w.preventDefault();const C=f.trim();C&&(localStorage.setItem("geminiApiKey",C),g(C),x("manual"))};return i?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-100 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(sn,{}),a.jsx("p",{className:"mt-4 text-gray-600",children:"載入寫作練習內容中..."})]})}):o?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-100 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full text-center",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-16 h-16 text-red-500 mx-auto mb-4",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"})}),a.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:"載入失敗"}),a.jsx("p",{className:"text-gray-600 mb-6",children:o}),a.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"重新載入"})]})}):a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-100",children:a.jsxs("div",{className:"container mx-auto px-4 py-8",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-8",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"flex items-center justify-center mb-4",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-12 h-12 text-blue-600",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"})})}),a.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"📝 寫作練習平台"}),a.jsx("p",{className:"text-gray-600",children:"完成練習後可獲得 AI 即時批改回饋"})]}),!f&&a.jsxs("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[a.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6 text-yellow-600 mt-0.5 flex-shrink-0",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-yellow-800 mb-1",children:"設定 API Key 以使用 AI 批改功能"}),a.jsxs("p",{className:"text-sm text-yellow-700 mb-3",children:["輸入您的 Google Gemini API Key 來啟用 AI 自動批改功能。",a.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"underline ml-1",children:"點此取得 API Key"})]})]})]}),a.jsxs("form",{onSubmit:N,className:"flex gap-3",children:[a.jsx("input",{type:"password",value:f,onChange:w=>g(w.target.value),placeholder:"請輸入您的 Gemini API Key",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),a.jsx("button",{type:"submit",disabled:!f.trim(),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"設定"})]})]}),f&&a.jsx("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2 text-green-700",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-medium",children:"API Key 已設定，可以使用 AI 批改功能"}),h==="url"&&a.jsxs("div",{className:"text-xs text-green-600 mt-1 flex items-center gap-1",children:[a.jsx("span",{children:"🔗"}),a.jsx("span",{children:"來自分享連結 - 老師已為您配置好 AI 功能"})]}),h==="localStorage"&&a.jsxs("div",{className:"text-xs text-green-600 mt-1 flex items-center gap-1",children:[a.jsx("span",{children:"💾"}),a.jsx("span",{children:"來自本地存儲"})]})]})]}),a.jsx("button",{onClick:()=>{localStorage.removeItem("geminiApiKey"),g(""),x("manual")},className:"text-sm text-green-600 hover:text-green-800 underline",children:"重新設定"})]})})]}),e&&a.jsx(cv,{content:e,apiKey:f,isStudentMode:!0}),a.jsxs("div",{className:"mt-8 text-center text-sm text-gray-500",children:[a.jsx("p",{children:"🤖 本平台使用 Google Gemini AI 提供智能批改回饋"}),a.jsx("p",{className:"mt-1",children:"💡 建議：完成練習後點擊「獲得 AI 批改」按鈕，即可獲得詳細的學習建議"})]})]})})},LA=({responses:t,quizContent:e})=>{const n=(u,f)=>{if(!e)return null;const g=u.questionType,h=e[g];if(!h||!Array.isArray(h))return null;let x=f;if(u.questionId&&typeof u.questionId=="string"){const v=u.questionId.match(/\d+$/);v&&(x=parseInt(v[0]))}return h[x]||null},i=(u,f)=>{var g,h;if(!u)return a.jsx("div",{className:"text-gray-400 italic",children:"找不到原始題目"});switch(f){case"trueFalse":return a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"font-medium",children:"📝 題目陳述:"}),a.jsx("div",{className:"bg-blue-50 p-3 rounded text-gray-800",children:u.statement}),u.explanation&&a.jsxs("div",{className:"text-sm text-gray-600",children:[a.jsx("div",{className:"font-medium",children:"說明: "}),a.jsx("div",{children:u.explanation})]})]});case"multipleChoice":return a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"font-medium",children:"❓ 題目:"}),a.jsx("div",{className:"bg-blue-50 p-3 rounded text-gray-800",children:u.question}),a.jsx("div",{className:"font-medium",children:"選項:"}),a.jsx("div",{className:"space-y-1",children:(g=u.options)==null?void 0:g.map((x,v)=>a.jsxs("div",{className:`p-2 rounded text-sm ${v===u.correctAnswerIndex?"bg-green-100 border border-green-300":"bg-gray-50"}`,children:[String.fromCharCode(65+v),". ",x,v===u.correctAnswerIndex&&a.jsx("span",{className:"ml-2 text-green-600",children:"✓ 正確答案"})]},v))})]});case"fillInTheBlanks":return a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"font-medium",children:"✏️ 填空題:"}),a.jsx("div",{className:"bg-blue-50 p-3 rounded text-gray-800",children:u.sentence}),a.jsxs("div",{className:"text-sm text-green-700",children:[a.jsx("span",{className:"font-medium",children:"正確答案: "}),Array.isArray(u.correctAnswers)?u.correctAnswers.join(", "):u.correctAnswers]})]});case"sentenceScramble":return a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"font-medium",children:"🔀 句子重組:"}),a.jsx("div",{className:"text-sm text-gray-600",children:"打亂的詞組:"}),a.jsx("div",{className:"bg-yellow-50 p-2 rounded text-sm",children:Array.isArray(u.scrambledWords)?u.scrambledWords.join(" | "):"無詞組資料"}),a.jsxs("div",{className:"text-sm text-green-700",children:[a.jsx("span",{className:"font-medium",children:"正確順序: "}),u.correctSentence]})]});case"memoryCardGame":return a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"font-medium",children:"🃏 記憶卡遊戲:"}),u.instructions&&a.jsx("div",{className:"text-sm text-sky-700 bg-sky-50 p-2 rounded",children:u.instructions}),a.jsx("div",{className:"space-y-1",children:(h=u.pairs)==null?void 0:h.map((x,v)=>a.jsxs("div",{className:"flex items-center justify-between bg-purple-50 p-2 rounded text-sm",children:[a.jsxs("span",{children:["🃏 ",x.question]}),a.jsx("span",{className:"text-purple-600",children:"↔️"}),a.jsxs("span",{children:["🃊 ",x.answer]})]},v))})]});default:return a.jsx("pre",{className:"text-xs bg-gray-100 p-2 rounded",children:JSON.stringify(u,null,2)})}},l=(u,f)=>f==="memoryCardGame"&&typeof u=="number"?`完成遊戲，總嘗試次數: ${u}`:f==="multipleChoice"&&typeof u=="number"?`選項 ${String.fromCharCode(65+u)} (${u})`:typeof u=="object"?JSON.stringify(u,null,2):String(u),o={trueFalse:"是非題",multipleChoice:"選擇題",fillInTheBlanks:"填空題",sentenceScramble:"句子重組",memoryCardGame:"翽卡配對遊戲"};return a.jsx("div",{className:"space-y-6",children:t.map((u,f)=>{const g=n(u,f);return a.jsxs("div",{className:`p-6 rounded-lg border-2 ${u.isCorrect?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[u.isCorrect?a.jsx(Nr,{className:"w-5 h-5 text-green-600"}):a.jsx(Sr,{className:"w-5 h-5 text-red-600"}),a.jsxs("span",{className:"font-bold text-lg text-gray-800",children:["第 ",f+1," 題 - ",o[u.questionType]||u.questionType]})]}),a.jsx("div",{className:"text-sm text-gray-500",children:u.attempts&&u.attempts>1&&`嘗試 ${u.attempts} 次`})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"📖 原始題目內容:"}),a.jsx("div",{className:"border-l-4 border-blue-300 pl-4",children:i(g,u.questionType)})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 pt-4 border-t border-gray-200",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"👨‍🎓 學生作答:"}),a.jsx("div",{className:"bg-white p-3 rounded border",children:l(u.userAnswer,u.questionType)})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:u.isCorrect?"✅ 答題正確":"❌ 答題錯誤"}),a.jsx("div",{className:`p-3 rounded border ${u.isCorrect?"bg-green-100 border-green-300":"bg-red-100 border-red-300"}`,children:u.isCorrect?"學生答案正確！":"需要進一步指導"})]})]})]},u.questionId||f)})})},PA=()=>{var I,R;const[t]=jr(),e=t.get("binId"),[n,i]=M.useState(null),[l,o]=M.useState(!0),[u,f]=M.useState(null),[g,h]=M.useState(""),[x,v]=M.useState(!1),[N,w]=M.useState(!1),[C,j]=M.useState(!1);M.useEffect(()=>{(async()=>{if(!e){f("缺少學生作答結果ID參數"),o(!1);return}try{o(!0);const B=await lv(e);i(B),v(!!B.diagnosticReport)}catch(B){console.error("載入學生作答結果失敗:",B),f(B instanceof Error?B.message:"載入學生作答結果失敗")}finally{o(!1)}})()},[e]),M.useEffect(()=>{const q=localStorage.getItem("geminiApiKey")||localStorage.getItem("gemini_api_key");q?(h(q),console.log("已從 localStorage 讀取 API Key")):console.log("未找到已存儲的 API Key")},[]);const k=q=>{q.preventDefault();const B=g.trim();B&&(localStorage.setItem("geminiApiKey",B),h(B),j(!1))},E=()=>{if(!g){j(!0);return}w(!0)},L=()=>{n!=null&&n.diagnosticReport&&w(!0)};if(l)return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-100 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(sn,{}),a.jsx("p",{className:"mt-4 text-gray-600",children:"載入學生作答結果中..."})]})});if(u)return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-50 to-pink-100 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full text-center",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-16 h-16 text-red-500 mx-auto mb-4",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"})}),a.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:"載入失敗"}),a.jsx("p",{className:"text-gray-600 mb-6",children:u}),a.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"重新載入"})]})});if(N&&n)return a.jsx(lm,{topic:`${n.topic} (${n.difficulty}難度) - ${n.studentName}`,apiKey:g,mode:"teacher",initialResponses:n.responses,quizData:n.quizContent?{topic:n.topic,[((R=(I=n.metadata)==null?void 0:I.selectedDifficulty)==null?void 0:R.toLowerCase())||"normal"]:n.quizContent}:void 0,existingReport:n.diagnosticReport,resultsBinId:e,onClose:()=>w(!1),onReportSaved:q=>{i(B=>B?{...B,diagnosticReport:q}:null),v(!0)}});if(!n)return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full text-center",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-16 h-16 text-gray-400 mx-auto mb-4",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})}),a.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:"找不到學生作答結果"}),a.jsx("p",{className:"text-gray-600",children:"請檢查連結是否正確"})]})});const D=n.responses.filter(q=>q.isCorrect).length,O=n.responses.length,H=new Date(n.completedAt).toLocaleString("zh-TW");return a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-100",children:[a.jsx("div",{className:"bg-white shadow-sm border-b",children:a.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(Pn,{className:"w-8 h-8 text-blue-600"}),a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"學生作答結果檢視"})]}),a.jsx("div",{className:"flex items-center gap-2 text-gray-600",children:a.jsx("span",{className:"text-lg font-medium",children:"教師版分析工具"})})]})}),a.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-8",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:["📝 ",n.studentName||"匿名學生"," 的作答結果"]}),a.jsxs("div",{className:"flex items-center gap-4 text-gray-600",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Pn,{className:"w-4 h-4"}),a.jsxs("span",{children:["主題：",n.topic]})]}),a.jsx("div",{className:"flex items-center gap-1",children:a.jsxs("span",{children:["難度：",n.difficulty]})}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Pf,{className:"w-4 h-4"}),a.jsxs("span",{children:["完成時間：",H]})]})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"text-3xl font-bold text-blue-600 mb-1",children:[n.overallScore,"%"]}),a.jsxs("div",{className:"text-sm text-gray-600",children:[D,"/",O," 答對"]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[a.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Nr,{className:"w-8 h-8 text-green-600"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-green-700",children:D}),a.jsx("div",{className:"text-sm text-green-600",children:"答對題數"})]})]})}),a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Sr,{className:"w-8 h-8 text-red-600"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-red-700",children:O-D}),a.jsx("div",{className:"text-sm text-red-600",children:"答錯題數"})]})]})}),a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Ns,{className:"w-8 h-8 text-blue-600"}),a.jsxs("div",{children:[a.jsxs("div",{className:"text-2xl font-bold text-blue-700",children:[n.overallScore,"%"]}),a.jsx("div",{className:"text-sm text-blue-600",children:"總體正確率"})]})]})})]}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"flex gap-4 items-center",children:[x?a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("button",{onClick:L,className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-lg hover:from-green-700 hover:to-emerald-700 transition-all font-medium",children:[a.jsx(Ns,{className:"w-5 h-5"}),"查看 AI 診斷報告"]}),a.jsx("button",{onClick:E,className:"flex items-center gap-2 px-4 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-lg hover:from-indigo-700 hover:to-purple-700 transition-all font-medium text-sm",children:"🔄 重新生成"})]}):a.jsxs("button",{onClick:E,className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-lg hover:from-indigo-700 hover:to-purple-700 transition-all font-medium",children:[a.jsx(Ns,{className:"w-5 h-5"}),"生成 AI 學習診斷報告"]}),g?a.jsx("div",{className:"text-sm text-green-600 flex items-center gap-1",children:"✅ API Key 已設定，可使用 AI 診斷功能"}):a.jsx("div",{className:"text-sm text-amber-600 flex items-center gap-1",children:"⚠️ 需要設定 API Key 才能使用 AI 診斷功能"})]}),a.jsx("div",{className:"text-xs text-gray-500",children:x?a.jsx("span",{children:"📊 已儲存診斷報告，可隨時查看或重新生成新的分析"}):g?a.jsx("span",{children:"💡 小提示：如需更更換 API Key，請點擊上方按鈕後在彈出視窗中重新設定"}):null})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[a.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"📋 詳細作答記錄 (含原始題目)"}),a.jsx(LA,{responses:n.responses,quizContent:n.quizContent})]})]}),C&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:q=>{q.target===q.currentTarget&&j(!1)},children:a.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"設定 API Key"}),a.jsx("button",{onClick:()=>j(!1),className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"關閉",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsxs("p",{className:"text-gray-600 mb-4",children:["要使用 AI 學習診斷功能，請輸入您的 Google Gemini API Key。",a.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"underline text-blue-600 ml-1",children:"點此取得 API Key"})]}),a.jsxs("form",{onSubmit:k,children:[a.jsx("input",{type:"password",value:g,onChange:q=>h(q.target.value),placeholder:"請輸入您的 Gemini API Key",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent mb-4"}),a.jsxs("div",{className:"flex gap-3 justify-end",children:[a.jsx("button",{type:"button",onClick:()=>j(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"取消"}),a.jsx("button",{type:"submit",disabled:!g.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"設定"})]})]})]})})]})},OA=()=>{const[t,e]=M.useState([]),[n,i]=M.useState(!0),[l,o]=M.useState(null),[u,f]=M.useState(""),[g,h]=M.useState(null),[x,v]=M.useState("list"),[N,w]=M.useState(null),[C,j]=M.useState(null);M.useEffect(()=>{const R=localStorage.getItem("gemini_api_key")||localStorage.getItem("geminiApiKey");j(R),k()},[]);const k=async()=>{try{i(!0),o(null),await zt.init();const R=await zt.getAllLessonPlans();e(R)}catch(R){console.error("載入教案失敗:",R),o("載入教案失敗，請重試。")}finally{i(!1)}},E=async()=>{if(!u.trim()){await k();return}try{i(!0);const R=await zt.searchLessonPlans(u);e(R)}catch(R){console.error("搜索失敗:",R),o("搜索失敗，請重試。")}finally{i(!1)}},L=async R=>{h(R),v("view");try{await zt.updateLastAccessed(R.id)}catch(q){console.error("更新訪問時間失敗:",q)}},D=async R=>{if(!C){alert("請先設定 API Key 才能分享教案。");return}w(R.id);try{const q={...R.content,topic:R.topic,selectedLevel:R.content.selectedLevel||null,selectedVocabularyLevel:R.content.selectedVocabularyLevel||null},B=await Qo(q,C,!0),ee=`${window.location.origin}/ai-page-gen/share?binId=${B}`;if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(ee),alert("分享連結已複製到剪貼簿！");else{const G=document.createElement("textarea");G.value=ee,document.body.appendChild(G),G.select(),document.execCommand("copy"),document.body.removeChild(G),alert(`分享連結已複製！\\n${ee}`)}await zt.updateLastAccessed(R.id)}catch(q){console.error("分享失敗:",q),alert("分享失敗，請稍後再試。")}finally{w(null)}},O=async R=>{if(confirm(`確定要刪除教案「${R.topic}」嗎？此操作無法復原。`))try{await zt.deleteLessonPlan(R.id),await k()}catch(q){console.error("刪除失敗:",q),alert("刪除失敗，請重試。")}},H=R=>new Date(R).toLocaleString("zh-TW",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),I=u.trim()?t.filter(R=>R.topic.toLowerCase().includes(u.toLowerCase())):t;return x==="view"&&g?a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50",children:[a.jsx("div",{className:"bg-white shadow-sm border-b sticky top-0 z-10",children:a.jsx("div",{className:"max-w-6xl mx-auto px-4 py-4",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("button",{onClick:()=>{v("list"),h(null)},className:"flex items-center gap-2 px-3 py-2 text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"})}),"返回教案列表"]}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h1",{className:"text-xl font-bold text-gray-900",children:g.topic}),a.jsxs("p",{className:"text-sm text-gray-600",children:["創建於 ",H(g.createdAt)]})]}),a.jsxs("button",{onClick:()=>D(g),disabled:N===g.id,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[N===g.id?a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):a.jsx(Md,{className:"w-4 h-4"}),"分享教案"]})]})})}),a.jsx("div",{className:"max-w-6xl mx-auto px-4 py-8",children:a.jsx(um,{content:g.content,topic:g.topic,selectedLevel:g.content.selectedLevel||null,selectedVocabularyLevel:g.content.selectedVocabularyLevel||null,apiKey:C||void 0,onContentUpdate:async R=>{const q={...g,content:R,lastAccessedAt:new Date().toISOString()};h(q);try{await zt.saveLessonPlan(q),console.log("教案已更新到 IndexedDB")}catch(B){console.error("更新教案到 IndexedDB 失敗:",B)}}})})]}):a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50",children:[a.jsx("div",{className:"bg-white shadow-sm border-b",children:a.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx(Pn,{className:"w-8 h-8 text-indigo-600"}),a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"我的教案庫"})]}),a.jsx("p",{className:"text-gray-600",children:"管理您之前生成的所有教案，隨時查看和分享"})]})}),a.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-8",children:a.jsxs("div",{className:"flex gap-3",children:[a.jsx("input",{type:"text",value:u,onChange:R=>f(R.target.value),placeholder:"搜索教案主題...",className:"flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",onKeyPress:R=>R.key==="Enter"&&E()}),a.jsx("button",{onClick:E,className:"px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:"搜索"}),a.jsx("button",{onClick:k,className:"px-4 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"重置"})]})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-indigo-100 rounded-lg",children:a.jsx(Pn,{className:"w-6 h-6 text-indigo-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.length}),a.jsx("p",{className:"text-gray-600",children:"總教案數"})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:a.jsx(Pf,{className:"w-6 h-6 text-green-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.filter(R=>{var q;return(q=R.metadata)==null?void 0:q.hasQuiz}).length}),a.jsx("p",{className:"text-gray-600",children:"包含測驗"})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6 text-purple-600",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"})})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.filter(R=>{var q;return(q=R.metadata)==null?void 0:q.hasWriting}).length}),a.jsx("p",{className:"text-gray-600",children:"包含寫作"})]})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:u.trim()?`搜索結果 (${I.length})`:"所有教案"})}),n?a.jsxs("div",{className:"p-8 text-center",children:[a.jsx(sn,{}),a.jsx("p",{className:"mt-4 text-gray-600",children:"載入中..."})]}):l?a.jsxs("div",{className:"p-8 text-center",children:[a.jsx("p",{className:"text-red-600 mb-4",children:l}),a.jsx("button",{onClick:k,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:"重試"})]}):I.length===0?a.jsxs("div",{className:"p-8 text-center",children:[a.jsx(Pn,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600 text-lg mb-2",children:u.trim()?"未找到匹配的教案":"還沒有保存的教案"}),a.jsx("p",{className:"text-gray-500",children:u.trim()?"嘗試其他關鍵詞":"生成第一個教案來開始使用！"})]}):a.jsx("div",{className:"divide-y divide-gray-200",children:I.map(R=>{var q,B,ee,G;return a.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:R.topic}),((q=R.metadata)==null?void 0:q.isShared)&&a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[a.jsx(Md,{className:"w-3 h-3"}),"分享的教案"]})]}),a.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-2",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Pf,{className:"w-4 h-4"}),"創建：",H(R.createdAt)]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(sy,{className:"w-4 h-4"}),"訪問：",H(R.lastAccessedAt)]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("span",{className:"px-2 py-1 bg-indigo-100 text-indigo-800 text-xs font-medium rounded-full",children:[((B=R.metadata)==null?void 0:B.totalSections)||0," 個部分"]}),((ee=R.metadata)==null?void 0:ee.hasQuiz)&&a.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs font-medium rounded-full",children:"包含測驗"}),((G=R.metadata)==null?void 0:G.hasWriting)&&a.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 text-xs font-medium rounded-full",children:"包含寫作"})]})]}),a.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[a.jsxs("button",{onClick:()=>L(R),className:"flex items-center gap-2 px-3 py-2 text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",children:[a.jsx(sy,{className:"w-4 h-4"}),"查看"]}),a.jsxs("a",{href:`/ai-page-gen/teacher-interactive-prep?contentId=${R.id}`,className:"flex items-center gap-2 px-3 py-2 text-emerald-600 hover:bg-emerald-50 rounded-lg transition-colors",target:"_blank",rel:"noopener noreferrer",children:[a.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a6.759 6.759 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})]}),"準備互動教材"]}),a.jsxs("button",{onClick:()=>D(R),disabled:N===R.id,className:"flex items-center gap-2 px-3 py-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[N===R.id?a.jsx("div",{className:"w-4 h-4 border-2 border-green-600 border-t-transparent rounded-full animate-spin"}):a.jsx(Md,{className:"w-4 h-4"}),"分享"]}),a.jsxs("button",{onClick:()=>O(R),className:"flex items-center gap-2 px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[a.jsx(uk,{className:"w-4 h-4"}),"刪除"]})]})]})},R.id)})})]})]})]})};function BA(t,e){const n={};return(t[t.length-1]===""?[...t,""]:t).join((n.padRight?" ":"")+","+(n.padLeft===!1?"":" ")).trim()}const UA=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,zA=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,VA={};function Fy(t,e){return(VA.jsx?zA:UA).test(t)}const $A=/[ \t\n\f\r]/g;function qA(t){return typeof t=="object"?t.type==="text"?Hy(t.value):!1:Hy(t)}function Hy(t){return t.replace($A,"")===""}class ol{constructor(e,n,i){this.normal=n,this.property=e,i&&(this.space=i)}}ol.prototype.normal={};ol.prototype.property={};ol.prototype.space=void 0;function Lv(t,e){const n={},i={};for(const l of t)Object.assign(n,l.property),Object.assign(i,l.normal);return new ol(n,i,e)}function Vf(t){return t.toLowerCase()}class an{constructor(e,n){this.attribute=n,this.property=e}}an.prototype.attribute="";an.prototype.booleanish=!1;an.prototype.boolean=!1;an.prototype.commaOrSpaceSeparated=!1;an.prototype.commaSeparated=!1;an.prototype.defined=!1;an.prototype.mustUseProperty=!1;an.prototype.number=!1;an.prototype.overloadedBoolean=!1;an.prototype.property="";an.prototype.spaceSeparated=!1;an.prototype.space=void 0;let FA=0;const Oe=kr(),kt=kr(),$f=kr(),xe=kr(),ft=kr(),Ss=kr(),pn=kr();function kr(){return 2**++FA}const qf=Object.freeze(Object.defineProperty({__proto__:null,boolean:Oe,booleanish:kt,commaOrSpaceSeparated:pn,commaSeparated:Ss,number:xe,overloadedBoolean:$f,spaceSeparated:ft},Symbol.toStringTag,{value:"Module"})),sf=Object.keys(qf);class xm extends an{constructor(e,n,i,l){let o=-1;if(super(e,n),Gy(this,"space",l),typeof i=="number")for(;++o<sf.length;){const u=sf[o];Gy(this,sf[o],(i&qf[u])===qf[u])}}}xm.prototype.defined=!0;function Gy(t,e,n){n&&(t[e]=n)}function Os(t){const e={},n={};for(const[i,l]of Object.entries(t.properties)){const o=new xm(i,t.transform(t.attributes||{},i),l,t.space);t.mustUseProperty&&t.mustUseProperty.includes(i)&&(o.mustUseProperty=!0),e[i]=o,n[Vf(i)]=i,n[Vf(o.attribute)]=i}return new ol(e,n,t.space)}const Pv=Os({properties:{ariaActiveDescendant:null,ariaAtomic:kt,ariaAutoComplete:null,ariaBusy:kt,ariaChecked:kt,ariaColCount:xe,ariaColIndex:xe,ariaColSpan:xe,ariaControls:ft,ariaCurrent:null,ariaDescribedBy:ft,ariaDetails:null,ariaDisabled:kt,ariaDropEffect:ft,ariaErrorMessage:null,ariaExpanded:kt,ariaFlowTo:ft,ariaGrabbed:kt,ariaHasPopup:null,ariaHidden:kt,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:ft,ariaLevel:xe,ariaLive:null,ariaModal:kt,ariaMultiLine:kt,ariaMultiSelectable:kt,ariaOrientation:null,ariaOwns:ft,ariaPlaceholder:null,ariaPosInSet:xe,ariaPressed:kt,ariaReadOnly:kt,ariaRelevant:null,ariaRequired:kt,ariaRoleDescription:ft,ariaRowCount:xe,ariaRowIndex:xe,ariaRowSpan:xe,ariaSelected:kt,ariaSetSize:xe,ariaSort:null,ariaValueMax:xe,ariaValueMin:xe,ariaValueNow:xe,ariaValueText:null,role:null},transform(t,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()}});function Ov(t,e){return e in t?t[e]:e}function Bv(t,e){return Ov(t,e.toLowerCase())}const HA=Os({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Ss,acceptCharset:ft,accessKey:ft,action:null,allow:null,allowFullScreen:Oe,allowPaymentRequest:Oe,allowUserMedia:Oe,alt:null,as:null,async:Oe,autoCapitalize:null,autoComplete:ft,autoFocus:Oe,autoPlay:Oe,blocking:ft,capture:null,charSet:null,checked:Oe,cite:null,className:ft,cols:xe,colSpan:null,content:null,contentEditable:kt,controls:Oe,controlsList:ft,coords:xe|Ss,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Oe,defer:Oe,dir:null,dirName:null,disabled:Oe,download:$f,draggable:kt,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Oe,formTarget:null,headers:ft,height:xe,hidden:$f,high:xe,href:null,hrefLang:null,htmlFor:ft,httpEquiv:ft,id:null,imageSizes:null,imageSrcSet:null,inert:Oe,inputMode:null,integrity:null,is:null,isMap:Oe,itemId:null,itemProp:ft,itemRef:ft,itemScope:Oe,itemType:ft,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Oe,low:xe,manifest:null,max:null,maxLength:xe,media:null,method:null,min:null,minLength:xe,multiple:Oe,muted:Oe,name:null,nonce:null,noModule:Oe,noValidate:Oe,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Oe,optimum:xe,pattern:null,ping:ft,placeholder:null,playsInline:Oe,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Oe,referrerPolicy:null,rel:ft,required:Oe,reversed:Oe,rows:xe,rowSpan:xe,sandbox:ft,scope:null,scoped:Oe,seamless:Oe,selected:Oe,shadowRootClonable:Oe,shadowRootDelegatesFocus:Oe,shadowRootMode:null,shape:null,size:xe,sizes:null,slot:null,span:xe,spellCheck:kt,src:null,srcDoc:null,srcLang:null,srcSet:null,start:xe,step:null,style:null,tabIndex:xe,target:null,title:null,translate:null,type:null,typeMustMatch:Oe,useMap:null,value:kt,width:xe,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:ft,axis:null,background:null,bgColor:null,border:xe,borderColor:null,bottomMargin:xe,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Oe,declare:Oe,event:null,face:null,frame:null,frameBorder:null,hSpace:xe,leftMargin:xe,link:null,longDesc:null,lowSrc:null,marginHeight:xe,marginWidth:xe,noResize:Oe,noHref:Oe,noShade:Oe,noWrap:Oe,object:null,profile:null,prompt:null,rev:null,rightMargin:xe,rules:null,scheme:null,scrolling:kt,standby:null,summary:null,text:null,topMargin:xe,valueType:null,version:null,vAlign:null,vLink:null,vSpace:xe,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Oe,disableRemotePlayback:Oe,prefix:null,property:null,results:xe,security:null,unselectable:null},space:"html",transform:Bv}),GA=Os({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:pn,accentHeight:xe,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:xe,amplitude:xe,arabicForm:null,ascent:xe,attributeName:null,attributeType:null,azimuth:xe,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:xe,by:null,calcMode:null,capHeight:xe,className:ft,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:xe,diffuseConstant:xe,direction:null,display:null,dur:null,divisor:xe,dominantBaseline:null,download:Oe,dx:null,dy:null,edgeMode:null,editable:null,elevation:xe,enableBackground:null,end:null,event:null,exponent:xe,externalResourcesRequired:null,fill:null,fillOpacity:xe,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Ss,g2:Ss,glyphName:Ss,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:xe,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:xe,horizOriginX:xe,horizOriginY:xe,id:null,ideographic:xe,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:xe,k:xe,k1:xe,k2:xe,k3:xe,k4:xe,kernelMatrix:pn,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:xe,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:xe,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:xe,overlineThickness:xe,paintOrder:null,panose1:null,path:null,pathLength:xe,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:ft,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:xe,pointsAtY:xe,pointsAtZ:xe,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:pn,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:pn,rev:pn,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:pn,requiredFeatures:pn,requiredFonts:pn,requiredFormats:pn,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:xe,specularExponent:xe,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:xe,strikethroughThickness:xe,string:null,stroke:null,strokeDashArray:pn,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:xe,strokeOpacity:xe,strokeWidth:null,style:null,surfaceScale:xe,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:pn,tabIndex:xe,tableValues:null,target:null,targetX:xe,targetY:xe,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:pn,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:xe,underlineThickness:xe,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:xe,values:null,vAlphabetic:xe,vMathematical:xe,vectorEffect:null,vHanging:xe,vIdeographic:xe,version:null,vertAdvY:xe,vertOriginX:xe,vertOriginY:xe,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:xe,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:Ov}),Uv=Os({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(t,e){return"xlink:"+e.slice(5).toLowerCase()}}),zv=Os({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:Bv}),Vv=Os({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(t,e){return"xml:"+e.slice(3).toLowerCase()}}),JA={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},YA=/[A-Z]/g,Jy=/-[a-z]/g,ZA=/^data[-\w.:]+$/i;function QA(t,e){const n=Vf(e);let i=e,l=an;if(n in t.normal)return t.property[t.normal[n]];if(n.length>4&&n.slice(0,4)==="data"&&ZA.test(e)){if(e.charAt(4)==="-"){const o=e.slice(5).replace(Jy,WA);i="data"+o.charAt(0).toUpperCase()+o.slice(1)}else{const o=e.slice(4);if(!Jy.test(o)){let u=o.replace(YA,KA);u.charAt(0)!=="-"&&(u="-"+u),e="data"+u}}l=xm}return new l(i,e)}function KA(t){return"-"+t.toLowerCase()}function WA(t){return t.charAt(1).toUpperCase()}const XA=Lv([Pv,HA,Uv,zv,Vv],"html"),ym=Lv([Pv,GA,Uv,zv,Vv],"svg");function e_(t){return t.join(" ").trim()}var ps={},af,Yy;function t_(){if(Yy)return af;Yy=1;var t=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,e=/\n/g,n=/^\s*/,i=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,l=/^:\s*/,o=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,u=/^[;\s]*/,f=/^\s+|\s+$/g,g=`
`,h="/",x="*",v="",N="comment",w="declaration";af=function(j,k){if(typeof j!="string")throw new TypeError("First argument must be a string");if(!j)return[];k=k||{};var E=1,L=1;function D(z){var $=z.match(e);$&&(E+=$.length);var Q=z.lastIndexOf(g);L=~Q?z.length-Q:L+z.length}function O(){var z={line:E,column:L};return function($){return $.position=new H(z),q(),$}}function H(z){this.start=z,this.end={line:E,column:L},this.source=k.source}H.prototype.content=j;function I(z){var $=new Error(k.source+":"+E+":"+L+": "+z);if($.reason=z,$.filename=k.source,$.line=E,$.column=L,$.source=j,!k.silent)throw $}function R(z){var $=z.exec(j);if($){var Q=$[0];return D(Q),j=j.slice(Q.length),$}}function q(){R(n)}function B(z){var $;for(z=z||[];$=ee();)$!==!1&&z.push($);return z}function ee(){var z=O();if(!(h!=j.charAt(0)||x!=j.charAt(1))){for(var $=2;v!=j.charAt($)&&(x!=j.charAt($)||h!=j.charAt($+1));)++$;if($+=2,v===j.charAt($-1))return I("End of comment missing");var Q=j.slice(2,$-2);return L+=2,D(Q),j=j.slice($),L+=2,z({type:N,comment:Q})}}function G(){var z=O(),$=R(i);if($){if(ee(),!R(l))return I("property missing ':'");var Q=R(o),P=z({type:w,property:C($[0].replace(t,v)),value:Q?C(Q[0].replace(t,v)):v});return R(u),P}}function Y(){var z=[];B(z);for(var $;$=G();)$!==!1&&(z.push($),B(z));return z}return q(),Y()};function C(j){return j?j.replace(f,v):v}return af}var Zy;function n_(){if(Zy)return ps;Zy=1;var t=ps&&ps.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(ps,"__esModule",{value:!0}),ps.default=n;var e=t(t_());function n(i,l){var o=null;if(!i||typeof i!="string")return o;var u=(0,e.default)(i),f=typeof l=="function";return u.forEach(function(g){if(g.type==="declaration"){var h=g.property,x=g.value;f?l(h,x,g):x&&(o=o||{},o[h]=x)}}),o}return ps}var za={},Qy;function i_(){if(Qy)return za;Qy=1,Object.defineProperty(za,"__esModule",{value:!0}),za.camelCase=void 0;var t=/^--[a-zA-Z0-9_-]+$/,e=/-([a-z])/g,n=/^[^-]+$/,i=/^-(webkit|moz|ms|o|khtml)-/,l=/^-(ms)-/,o=function(h){return!h||n.test(h)||t.test(h)},u=function(h,x){return x.toUpperCase()},f=function(h,x){return"".concat(x,"-")},g=function(h,x){return x===void 0&&(x={}),o(h)?h:(h=h.toLowerCase(),x.reactCompat?h=h.replace(l,f):h=h.replace(i,f),h.replace(e,u))};return za.camelCase=g,za}var Va,Ky;function r_(){if(Ky)return Va;Ky=1;var t=Va&&Va.__importDefault||function(l){return l&&l.__esModule?l:{default:l}},e=t(n_()),n=i_();function i(l,o){var u={};return!l||typeof l!="string"||(0,e.default)(l,function(f,g){f&&g&&(u[(0,n.camelCase)(f,o)]=g)}),u}return i.default=i,Va=i,Va}var s_=r_();const a_=tl(s_),$v=qv("end"),vm=qv("start");function qv(t){return e;function e(n){const i=n&&n.position&&n.position[t]||{};if(typeof i.line=="number"&&i.line>0&&typeof i.column=="number"&&i.column>0)return{line:i.line,column:i.column,offset:typeof i.offset=="number"&&i.offset>-1?i.offset:void 0}}}function l_(t){const e=vm(t),n=$v(t);if(e&&n)return{start:e,end:n}}function Ya(t){return!t||typeof t!="object"?"":"position"in t||"type"in t?Wy(t.position):"start"in t||"end"in t?Wy(t):"line"in t||"column"in t?Ff(t):""}function Ff(t){return Xy(t&&t.line)+":"+Xy(t&&t.column)}function Wy(t){return Ff(t&&t.start)+"-"+Ff(t&&t.end)}function Xy(t){return t&&typeof t=="number"?t:1}class Ht extends Error{constructor(e,n,i){super(),typeof n=="string"&&(i=n,n=void 0);let l="",o={},u=!1;if(n&&("line"in n&&"column"in n?o={place:n}:"start"in n&&"end"in n?o={place:n}:"type"in n?o={ancestors:[n],place:n.position}:o={...n}),typeof e=="string"?l=e:!o.cause&&e&&(u=!0,l=e.message,o.cause=e),!o.ruleId&&!o.source&&typeof i=="string"){const g=i.indexOf(":");g===-1?o.ruleId=i:(o.source=i.slice(0,g),o.ruleId=i.slice(g+1))}if(!o.place&&o.ancestors&&o.ancestors){const g=o.ancestors[o.ancestors.length-1];g&&(o.place=g.position)}const f=o.place&&"start"in o.place?o.place.start:o.place;this.ancestors=o.ancestors||void 0,this.cause=o.cause||void 0,this.column=f?f.column:void 0,this.fatal=void 0,this.file="",this.message=l,this.line=f?f.line:void 0,this.name=Ya(o.place)||"1:1",this.place=o.place||void 0,this.reason=this.message,this.ruleId=o.ruleId||void 0,this.source=o.source||void 0,this.stack=u&&o.cause&&typeof o.cause.stack=="string"?o.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}Ht.prototype.file="";Ht.prototype.name="";Ht.prototype.reason="";Ht.prototype.message="";Ht.prototype.stack="";Ht.prototype.column=void 0;Ht.prototype.line=void 0;Ht.prototype.ancestors=void 0;Ht.prototype.cause=void 0;Ht.prototype.fatal=void 0;Ht.prototype.place=void 0;Ht.prototype.ruleId=void 0;Ht.prototype.source=void 0;const bm={}.hasOwnProperty,o_=new Map,c_=/[A-Z]/g,u_=new Set(["table","tbody","thead","tfoot","tr"]),d_=new Set(["td","th"]),Fv="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function f_(t,e){if(!e||e.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const n=e.filePath||void 0;let i;if(e.development){if(typeof e.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");i=b_(n,e.jsxDEV)}else{if(typeof e.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof e.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");i=v_(n,e.jsx,e.jsxs)}const l={Fragment:e.Fragment,ancestors:[],components:e.components||{},create:i,elementAttributeNameCase:e.elementAttributeNameCase||"react",evaluater:e.createEvaluater?e.createEvaluater():void 0,filePath:n,ignoreInvalidStyle:e.ignoreInvalidStyle||!1,passKeys:e.passKeys!==!1,passNode:e.passNode||!1,schema:e.space==="svg"?ym:XA,stylePropertyNameCase:e.stylePropertyNameCase||"dom",tableCellAlignToStyle:e.tableCellAlignToStyle!==!1},o=Hv(l,t,void 0);return o&&typeof o!="string"?o:l.create(t,l.Fragment,{children:o||void 0},void 0)}function Hv(t,e,n){if(e.type==="element")return m_(t,e,n);if(e.type==="mdxFlowExpression"||e.type==="mdxTextExpression")return h_(t,e);if(e.type==="mdxJsxFlowElement"||e.type==="mdxJsxTextElement")return g_(t,e,n);if(e.type==="mdxjsEsm")return p_(t,e);if(e.type==="root")return x_(t,e,n);if(e.type==="text")return y_(t,e)}function m_(t,e,n){const i=t.schema;let l=i;e.tagName.toLowerCase()==="svg"&&i.space==="html"&&(l=ym,t.schema=l),t.ancestors.push(e);const o=Jv(t,e.tagName,!1),u=w_(t,e);let f=Nm(t,e);return u_.has(e.tagName)&&(f=f.filter(function(g){return typeof g=="string"?!qA(g):!0})),Gv(t,u,o,e),wm(u,f),t.ancestors.pop(),t.schema=i,t.create(e,o,u,n)}function h_(t,e){if(e.data&&e.data.estree&&t.evaluater){const i=e.data.estree.body[0];return i.type,t.evaluater.evaluateExpression(i.expression)}el(t,e.position)}function p_(t,e){if(e.data&&e.data.estree&&t.evaluater)return t.evaluater.evaluateProgram(e.data.estree);el(t,e.position)}function g_(t,e,n){const i=t.schema;let l=i;e.name==="svg"&&i.space==="html"&&(l=ym,t.schema=l),t.ancestors.push(e);const o=e.name===null?t.Fragment:Jv(t,e.name,!0),u=N_(t,e),f=Nm(t,e);return Gv(t,u,o,e),wm(u,f),t.ancestors.pop(),t.schema=i,t.create(e,o,u,n)}function x_(t,e,n){const i={};return wm(i,Nm(t,e)),t.create(e,t.Fragment,i,n)}function y_(t,e){return e.value}function Gv(t,e,n,i){typeof n!="string"&&n!==t.Fragment&&t.passNode&&(e.node=i)}function wm(t,e){if(e.length>0){const n=e.length>1?e:e[0];n&&(t.children=n)}}function v_(t,e,n){return i;function i(l,o,u,f){const h=Array.isArray(u.children)?n:e;return f?h(o,u,f):h(o,u)}}function b_(t,e){return n;function n(i,l,o,u){const f=Array.isArray(o.children),g=vm(i);return e(l,o,u,f,{columnNumber:g?g.column-1:void 0,fileName:t,lineNumber:g?g.line:void 0},void 0)}}function w_(t,e){const n={};let i,l;for(l in e.properties)if(l!=="children"&&bm.call(e.properties,l)){const o=S_(t,l,e.properties[l]);if(o){const[u,f]=o;t.tableCellAlignToStyle&&u==="align"&&typeof f=="string"&&d_.has(e.tagName)?i=f:n[u]=f}}if(i){const o=n.style||(n.style={});o[t.stylePropertyNameCase==="css"?"text-align":"textAlign"]=i}return n}function N_(t,e){const n={};for(const i of e.attributes)if(i.type==="mdxJsxExpressionAttribute")if(i.data&&i.data.estree&&t.evaluater){const o=i.data.estree.body[0];o.type;const u=o.expression;u.type;const f=u.properties[0];f.type,Object.assign(n,t.evaluater.evaluateExpression(f.argument))}else el(t,e.position);else{const l=i.name;let o;if(i.value&&typeof i.value=="object")if(i.value.data&&i.value.data.estree&&t.evaluater){const f=i.value.data.estree.body[0];f.type,o=t.evaluater.evaluateExpression(f.expression)}else el(t,e.position);else o=i.value===null?!0:i.value;n[l]=o}return n}function Nm(t,e){const n=[];let i=-1;const l=t.passKeys?new Map:o_;for(;++i<e.children.length;){const o=e.children[i];let u;if(t.passKeys){const g=o.type==="element"?o.tagName:o.type==="mdxJsxFlowElement"||o.type==="mdxJsxTextElement"?o.name:void 0;if(g){const h=l.get(g)||0;u=g+"-"+h,l.set(g,h+1)}}const f=Hv(t,o,u);f!==void 0&&n.push(f)}return n}function S_(t,e,n){const i=QA(t.schema,e);if(!(n==null||typeof n=="number"&&Number.isNaN(n))){if(Array.isArray(n)&&(n=i.commaSeparated?BA(n):e_(n)),i.property==="style"){let l=typeof n=="object"?n:C_(t,String(n));return t.stylePropertyNameCase==="css"&&(l=T_(l)),["style",l]}return[t.elementAttributeNameCase==="react"&&i.space?JA[i.property]||i.property:i.attribute,n]}}function C_(t,e){try{return a_(e,{reactCompat:!0})}catch(n){if(t.ignoreInvalidStyle)return{};const i=n,l=new Ht("Cannot parse `style` attribute",{ancestors:t.ancestors,cause:i,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw l.file=t.filePath||void 0,l.url=Fv+"#cannot-parse-style-attribute",l}}function Jv(t,e,n){let i;if(!n)i={type:"Literal",value:e};else if(e.includes(".")){const l=e.split(".");let o=-1,u;for(;++o<l.length;){const f=Fy(l[o])?{type:"Identifier",name:l[o]}:{type:"Literal",value:l[o]};u=u?{type:"MemberExpression",object:u,property:f,computed:!!(o&&f.type==="Literal"),optional:!1}:f}i=u}else i=Fy(e)&&!/^[a-z]/.test(e)?{type:"Identifier",name:e}:{type:"Literal",value:e};if(i.type==="Literal"){const l=i.value;return bm.call(t.components,l)?t.components[l]:l}if(t.evaluater)return t.evaluater.evaluateExpression(i);el(t)}function el(t,e){const n=new Ht("Cannot handle MDX estrees without `createEvaluater`",{ancestors:t.ancestors,place:e,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw n.file=t.filePath||void 0,n.url=Fv+"#cannot-handle-mdx-estrees-without-createevaluater",n}function T_(t){const e={};let n;for(n in t)bm.call(t,n)&&(e[j_(n)]=t[n]);return e}function j_(t){let e=t.replace(c_,k_);return e.slice(0,3)==="ms-"&&(e="-"+e),e}function k_(t){return"-"+t.toLowerCase()}const lf={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},E_={};function A_(t,e){const n=E_,i=typeof n.includeImageAlt=="boolean"?n.includeImageAlt:!0,l=typeof n.includeHtml=="boolean"?n.includeHtml:!0;return Yv(t,i,l)}function Yv(t,e,n){if(__(t)){if("value"in t)return t.type==="html"&&!n?"":t.value;if(e&&"alt"in t&&t.alt)return t.alt;if("children"in t)return e1(t.children,e,n)}return Array.isArray(t)?e1(t,e,n):""}function e1(t,e,n){const i=[];let l=-1;for(;++l<t.length;)i[l]=Yv(t[l],e,n);return i.join("")}function __(t){return!!(t&&typeof t=="object")}const t1=document.createElement("i");function Sm(t){const e="&"+t+";";t1.innerHTML=e;const n=t1.textContent;return n.charCodeAt(n.length-1)===59&&t!=="semi"||n===e?!1:n}function Kn(t,e,n,i){const l=t.length;let o=0,u;if(e<0?e=-e>l?0:l+e:e=e>l?l:e,n=n>0?n:0,i.length<1e4)u=Array.from(i),u.unshift(e,n),t.splice(...u);else for(n&&t.splice(e,n);o<i.length;)u=i.slice(o,o+1e4),u.unshift(e,0),t.splice(...u),o+=1e4,e+=1e4}function En(t,e){return t.length>0?(Kn(t,t.length,0,e),t):e}const n1={}.hasOwnProperty;function M_(t){const e={};let n=-1;for(;++n<t.length;)R_(e,t[n]);return e}function R_(t,e){let n;for(n in e){const l=(n1.call(t,n)?t[n]:void 0)||(t[n]={}),o=e[n];let u;if(o)for(u in o){n1.call(l,u)||(l[u]=[]);const f=o[u];I_(l[u],Array.isArray(f)?f:f?[f]:[])}}}function I_(t,e){let n=-1;const i=[];for(;++n<e.length;)(e[n].add==="after"?t:i).push(e[n]);Kn(t,0,0,i)}function Zv(t,e){const n=Number.parseInt(t,e);return n<9||n===11||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||(n&65535)===65535||(n&65535)===65534||n>1114111?"�":String.fromCodePoint(n)}function Cs(t){return t.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Gn=Xi(/[A-Za-z]/),gn=Xi(/[\dA-Za-z]/),D_=Xi(/[#-'*+\--9=?A-Z^-~]/);function Hf(t){return t!==null&&(t<32||t===127)}const Gf=Xi(/\d/),L_=Xi(/[\dA-Fa-f]/),P_=Xi(/[!-/:-@[-`{-~]/);function Ie(t){return t!==null&&t<-2}function rn(t){return t!==null&&(t<0||t===32)}function tt(t){return t===-2||t===-1||t===32}const O_=Xi(new RegExp("\\p{P}|\\p{S}","u")),B_=Xi(/\s/);function Xi(t){return e;function e(n){return n!==null&&n>-1&&t.test(String.fromCharCode(n))}}function Bs(t){const e=[];let n=-1,i=0,l=0;for(;++n<t.length;){const o=t.charCodeAt(n);let u="";if(o===37&&gn(t.charCodeAt(n+1))&&gn(t.charCodeAt(n+2)))l=2;else if(o<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(o))||(u=String.fromCharCode(o));else if(o>55295&&o<57344){const f=t.charCodeAt(n+1);o<56320&&f>56319&&f<57344?(u=String.fromCharCode(o,f),l=1):u="�"}else u=String.fromCharCode(o);u&&(e.push(t.slice(i,n),encodeURIComponent(u)),i=n+l+1,u=""),l&&(n+=l,l=0)}return e.join("")+t.slice(i)}function mt(t,e,n,i){const l=i?i-1:Number.POSITIVE_INFINITY;let o=0;return u;function u(g){return tt(g)?(t.enter(n),f(g)):e(g)}function f(g){return tt(g)&&o++<l?(t.consume(g),f):(t.exit(n),e(g))}}const U_={tokenize:z_};function z_(t){const e=t.attempt(this.parser.constructs.contentInitial,i,l);let n;return e;function i(f){if(f===null){t.consume(f);return}return t.enter("lineEnding"),t.consume(f),t.exit("lineEnding"),mt(t,e,"linePrefix")}function l(f){return t.enter("paragraph"),o(f)}function o(f){const g=t.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=g),n=g,u(f)}function u(f){if(f===null){t.exit("chunkText"),t.exit("paragraph"),t.consume(f);return}return Ie(f)?(t.consume(f),t.exit("chunkText"),o):(t.consume(f),u)}}const V_={tokenize:$_},i1={tokenize:q_};function $_(t){const e=this,n=[];let i=0,l,o,u;return f;function f(D){if(i<n.length){const O=n[i];return e.containerState=O[1],t.attempt(O[0].continuation,g,h)(D)}return h(D)}function g(D){if(i++,e.containerState._closeFlow){e.containerState._closeFlow=void 0,l&&L();const O=e.events.length;let H=O,I;for(;H--;)if(e.events[H][0]==="exit"&&e.events[H][1].type==="chunkFlow"){I=e.events[H][1].end;break}E(i);let R=O;for(;R<e.events.length;)e.events[R][1].end={...I},R++;return Kn(e.events,H+1,0,e.events.slice(O)),e.events.length=R,h(D)}return f(D)}function h(D){if(i===n.length){if(!l)return N(D);if(l.currentConstruct&&l.currentConstruct.concrete)return C(D);e.interrupt=!!(l.currentConstruct&&!l._gfmTableDynamicInterruptHack)}return e.containerState={},t.check(i1,x,v)(D)}function x(D){return l&&L(),E(i),N(D)}function v(D){return e.parser.lazy[e.now().line]=i!==n.length,u=e.now().offset,C(D)}function N(D){return e.containerState={},t.attempt(i1,w,C)(D)}function w(D){return i++,n.push([e.currentConstruct,e.containerState]),N(D)}function C(D){if(D===null){l&&L(),E(0),t.consume(D);return}return l=l||e.parser.flow(e.now()),t.enter("chunkFlow",{_tokenizer:l,contentType:"flow",previous:o}),j(D)}function j(D){if(D===null){k(t.exit("chunkFlow"),!0),E(0),t.consume(D);return}return Ie(D)?(t.consume(D),k(t.exit("chunkFlow")),i=0,e.interrupt=void 0,f):(t.consume(D),j)}function k(D,O){const H=e.sliceStream(D);if(O&&H.push(null),D.previous=o,o&&(o.next=D),o=D,l.defineSkip(D.start),l.write(H),e.parser.lazy[D.start.line]){let I=l.events.length;for(;I--;)if(l.events[I][1].start.offset<u&&(!l.events[I][1].end||l.events[I][1].end.offset>u))return;const R=e.events.length;let q=R,B,ee;for(;q--;)if(e.events[q][0]==="exit"&&e.events[q][1].type==="chunkFlow"){if(B){ee=e.events[q][1].end;break}B=!0}for(E(i),I=R;I<e.events.length;)e.events[I][1].end={...ee},I++;Kn(e.events,q+1,0,e.events.slice(R)),e.events.length=I}}function E(D){let O=n.length;for(;O-- >D;){const H=n[O];e.containerState=H[1],H[0].exit.call(e,t)}n.length=D}function L(){l.write([null]),o=void 0,l=void 0,e.containerState._closeFlow=void 0}}function q_(t,e,n){return mt(t,t.attempt(this.parser.constructs.document,e,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function r1(t){if(t===null||rn(t)||B_(t))return 1;if(O_(t))return 2}function Cm(t,e,n){const i=[];let l=-1;for(;++l<t.length;){const o=t[l].resolveAll;o&&!i.includes(o)&&(e=o(e,n),i.push(o))}return e}const Jf={name:"attention",resolveAll:F_,tokenize:H_};function F_(t,e){let n=-1,i,l,o,u,f,g,h,x;for(;++n<t.length;)if(t[n][0]==="enter"&&t[n][1].type==="attentionSequence"&&t[n][1]._close){for(i=n;i--;)if(t[i][0]==="exit"&&t[i][1].type==="attentionSequence"&&t[i][1]._open&&e.sliceSerialize(t[i][1]).charCodeAt(0)===e.sliceSerialize(t[n][1]).charCodeAt(0)){if((t[i][1]._close||t[n][1]._open)&&(t[n][1].end.offset-t[n][1].start.offset)%3&&!((t[i][1].end.offset-t[i][1].start.offset+t[n][1].end.offset-t[n][1].start.offset)%3))continue;g=t[i][1].end.offset-t[i][1].start.offset>1&&t[n][1].end.offset-t[n][1].start.offset>1?2:1;const v={...t[i][1].end},N={...t[n][1].start};s1(v,-g),s1(N,g),u={type:g>1?"strongSequence":"emphasisSequence",start:v,end:{...t[i][1].end}},f={type:g>1?"strongSequence":"emphasisSequence",start:{...t[n][1].start},end:N},o={type:g>1?"strongText":"emphasisText",start:{...t[i][1].end},end:{...t[n][1].start}},l={type:g>1?"strong":"emphasis",start:{...u.start},end:{...f.end}},t[i][1].end={...u.start},t[n][1].start={...f.end},h=[],t[i][1].end.offset-t[i][1].start.offset&&(h=En(h,[["enter",t[i][1],e],["exit",t[i][1],e]])),h=En(h,[["enter",l,e],["enter",u,e],["exit",u,e],["enter",o,e]]),h=En(h,Cm(e.parser.constructs.insideSpan.null,t.slice(i+1,n),e)),h=En(h,[["exit",o,e],["enter",f,e],["exit",f,e],["exit",l,e]]),t[n][1].end.offset-t[n][1].start.offset?(x=2,h=En(h,[["enter",t[n][1],e],["exit",t[n][1],e]])):x=0,Kn(t,i-1,n-i+3,h),n=i+h.length-x-2;break}}for(n=-1;++n<t.length;)t[n][1].type==="attentionSequence"&&(t[n][1].type="data");return t}function H_(t,e){const n=this.parser.constructs.attentionMarkers.null,i=this.previous,l=r1(i);let o;return u;function u(g){return o=g,t.enter("attentionSequence"),f(g)}function f(g){if(g===o)return t.consume(g),f;const h=t.exit("attentionSequence"),x=r1(g),v=!x||x===2&&l||n.includes(g),N=!l||l===2&&x||n.includes(i);return h._open=!!(o===42?v:v&&(l||!N)),h._close=!!(o===42?N:N&&(x||!v)),e(g)}}function s1(t,e){t.column+=e,t.offset+=e,t._bufferIndex+=e}const G_={name:"autolink",tokenize:J_};function J_(t,e,n){let i=0;return l;function l(w){return t.enter("autolink"),t.enter("autolinkMarker"),t.consume(w),t.exit("autolinkMarker"),t.enter("autolinkProtocol"),o}function o(w){return Gn(w)?(t.consume(w),u):w===64?n(w):h(w)}function u(w){return w===43||w===45||w===46||gn(w)?(i=1,f(w)):h(w)}function f(w){return w===58?(t.consume(w),i=0,g):(w===43||w===45||w===46||gn(w))&&i++<32?(t.consume(w),f):(i=0,h(w))}function g(w){return w===62?(t.exit("autolinkProtocol"),t.enter("autolinkMarker"),t.consume(w),t.exit("autolinkMarker"),t.exit("autolink"),e):w===null||w===32||w===60||Hf(w)?n(w):(t.consume(w),g)}function h(w){return w===64?(t.consume(w),x):D_(w)?(t.consume(w),h):n(w)}function x(w){return gn(w)?v(w):n(w)}function v(w){return w===46?(t.consume(w),i=0,x):w===62?(t.exit("autolinkProtocol").type="autolinkEmail",t.enter("autolinkMarker"),t.consume(w),t.exit("autolinkMarker"),t.exit("autolink"),e):N(w)}function N(w){if((w===45||gn(w))&&i++<63){const C=w===45?N:v;return t.consume(w),C}return n(w)}}const cc={partial:!0,tokenize:Y_};function Y_(t,e,n){return i;function i(o){return tt(o)?mt(t,l,"linePrefix")(o):l(o)}function l(o){return o===null||Ie(o)?e(o):n(o)}}const Qv={continuation:{tokenize:Q_},exit:K_,name:"blockQuote",tokenize:Z_};function Z_(t,e,n){const i=this;return l;function l(u){if(u===62){const f=i.containerState;return f.open||(t.enter("blockQuote",{_container:!0}),f.open=!0),t.enter("blockQuotePrefix"),t.enter("blockQuoteMarker"),t.consume(u),t.exit("blockQuoteMarker"),o}return n(u)}function o(u){return tt(u)?(t.enter("blockQuotePrefixWhitespace"),t.consume(u),t.exit("blockQuotePrefixWhitespace"),t.exit("blockQuotePrefix"),e):(t.exit("blockQuotePrefix"),e(u))}}function Q_(t,e,n){const i=this;return l;function l(u){return tt(u)?mt(t,o,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(u):o(u)}function o(u){return t.attempt(Qv,e,n)(u)}}function K_(t){t.exit("blockQuote")}const Kv={name:"characterEscape",tokenize:W_};function W_(t,e,n){return i;function i(o){return t.enter("characterEscape"),t.enter("escapeMarker"),t.consume(o),t.exit("escapeMarker"),l}function l(o){return P_(o)?(t.enter("characterEscapeValue"),t.consume(o),t.exit("characterEscapeValue"),t.exit("characterEscape"),e):n(o)}}const Wv={name:"characterReference",tokenize:X_};function X_(t,e,n){const i=this;let l=0,o,u;return f;function f(v){return t.enter("characterReference"),t.enter("characterReferenceMarker"),t.consume(v),t.exit("characterReferenceMarker"),g}function g(v){return v===35?(t.enter("characterReferenceMarkerNumeric"),t.consume(v),t.exit("characterReferenceMarkerNumeric"),h):(t.enter("characterReferenceValue"),o=31,u=gn,x(v))}function h(v){return v===88||v===120?(t.enter("characterReferenceMarkerHexadecimal"),t.consume(v),t.exit("characterReferenceMarkerHexadecimal"),t.enter("characterReferenceValue"),o=6,u=L_,x):(t.enter("characterReferenceValue"),o=7,u=Gf,x(v))}function x(v){if(v===59&&l){const N=t.exit("characterReferenceValue");return u===gn&&!Sm(i.sliceSerialize(N))?n(v):(t.enter("characterReferenceMarker"),t.consume(v),t.exit("characterReferenceMarker"),t.exit("characterReference"),e)}return u(v)&&l++<o?(t.consume(v),x):n(v)}}const a1={partial:!0,tokenize:tM},l1={concrete:!0,name:"codeFenced",tokenize:eM};function eM(t,e,n){const i=this,l={partial:!0,tokenize:H};let o=0,u=0,f;return g;function g(I){return h(I)}function h(I){const R=i.events[i.events.length-1];return o=R&&R[1].type==="linePrefix"?R[2].sliceSerialize(R[1],!0).length:0,f=I,t.enter("codeFenced"),t.enter("codeFencedFence"),t.enter("codeFencedFenceSequence"),x(I)}function x(I){return I===f?(u++,t.consume(I),x):u<3?n(I):(t.exit("codeFencedFenceSequence"),tt(I)?mt(t,v,"whitespace")(I):v(I))}function v(I){return I===null||Ie(I)?(t.exit("codeFencedFence"),i.interrupt?e(I):t.check(a1,j,O)(I)):(t.enter("codeFencedFenceInfo"),t.enter("chunkString",{contentType:"string"}),N(I))}function N(I){return I===null||Ie(I)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),v(I)):tt(I)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),mt(t,w,"whitespace")(I)):I===96&&I===f?n(I):(t.consume(I),N)}function w(I){return I===null||Ie(I)?v(I):(t.enter("codeFencedFenceMeta"),t.enter("chunkString",{contentType:"string"}),C(I))}function C(I){return I===null||Ie(I)?(t.exit("chunkString"),t.exit("codeFencedFenceMeta"),v(I)):I===96&&I===f?n(I):(t.consume(I),C)}function j(I){return t.attempt(l,O,k)(I)}function k(I){return t.enter("lineEnding"),t.consume(I),t.exit("lineEnding"),E}function E(I){return o>0&&tt(I)?mt(t,L,"linePrefix",o+1)(I):L(I)}function L(I){return I===null||Ie(I)?t.check(a1,j,O)(I):(t.enter("codeFlowValue"),D(I))}function D(I){return I===null||Ie(I)?(t.exit("codeFlowValue"),L(I)):(t.consume(I),D)}function O(I){return t.exit("codeFenced"),e(I)}function H(I,R,q){let B=0;return ee;function ee(Q){return I.enter("lineEnding"),I.consume(Q),I.exit("lineEnding"),G}function G(Q){return I.enter("codeFencedFence"),tt(Q)?mt(I,Y,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(Q):Y(Q)}function Y(Q){return Q===f?(I.enter("codeFencedFenceSequence"),z(Q)):q(Q)}function z(Q){return Q===f?(B++,I.consume(Q),z):B>=u?(I.exit("codeFencedFenceSequence"),tt(Q)?mt(I,$,"whitespace")(Q):$(Q)):q(Q)}function $(Q){return Q===null||Ie(Q)?(I.exit("codeFencedFence"),R(Q)):q(Q)}}}function tM(t,e,n){const i=this;return l;function l(u){return u===null?n(u):(t.enter("lineEnding"),t.consume(u),t.exit("lineEnding"),o)}function o(u){return i.parser.lazy[i.now().line]?n(u):e(u)}}const of={name:"codeIndented",tokenize:iM},nM={partial:!0,tokenize:rM};function iM(t,e,n){const i=this;return l;function l(h){return t.enter("codeIndented"),mt(t,o,"linePrefix",5)(h)}function o(h){const x=i.events[i.events.length-1];return x&&x[1].type==="linePrefix"&&x[2].sliceSerialize(x[1],!0).length>=4?u(h):n(h)}function u(h){return h===null?g(h):Ie(h)?t.attempt(nM,u,g)(h):(t.enter("codeFlowValue"),f(h))}function f(h){return h===null||Ie(h)?(t.exit("codeFlowValue"),u(h)):(t.consume(h),f)}function g(h){return t.exit("codeIndented"),e(h)}}function rM(t,e,n){const i=this;return l;function l(u){return i.parser.lazy[i.now().line]?n(u):Ie(u)?(t.enter("lineEnding"),t.consume(u),t.exit("lineEnding"),l):mt(t,o,"linePrefix",5)(u)}function o(u){const f=i.events[i.events.length-1];return f&&f[1].type==="linePrefix"&&f[2].sliceSerialize(f[1],!0).length>=4?e(u):Ie(u)?l(u):n(u)}}const sM={name:"codeText",previous:lM,resolve:aM,tokenize:oM};function aM(t){let e=t.length-4,n=3,i,l;if((t[n][1].type==="lineEnding"||t[n][1].type==="space")&&(t[e][1].type==="lineEnding"||t[e][1].type==="space")){for(i=n;++i<e;)if(t[i][1].type==="codeTextData"){t[n][1].type="codeTextPadding",t[e][1].type="codeTextPadding",n+=2,e-=2;break}}for(i=n-1,e++;++i<=e;)l===void 0?i!==e&&t[i][1].type!=="lineEnding"&&(l=i):(i===e||t[i][1].type==="lineEnding")&&(t[l][1].type="codeTextData",i!==l+2&&(t[l][1].end=t[i-1][1].end,t.splice(l+2,i-l-2),e-=i-l-2,i=l+2),l=void 0);return t}function lM(t){return t!==96||this.events[this.events.length-1][1].type==="characterEscape"}function oM(t,e,n){let i=0,l,o;return u;function u(v){return t.enter("codeText"),t.enter("codeTextSequence"),f(v)}function f(v){return v===96?(t.consume(v),i++,f):(t.exit("codeTextSequence"),g(v))}function g(v){return v===null?n(v):v===32?(t.enter("space"),t.consume(v),t.exit("space"),g):v===96?(o=t.enter("codeTextSequence"),l=0,x(v)):Ie(v)?(t.enter("lineEnding"),t.consume(v),t.exit("lineEnding"),g):(t.enter("codeTextData"),h(v))}function h(v){return v===null||v===32||v===96||Ie(v)?(t.exit("codeTextData"),g(v)):(t.consume(v),h)}function x(v){return v===96?(t.consume(v),l++,x):l===i?(t.exit("codeTextSequence"),t.exit("codeText"),e(v)):(o.type="codeTextData",h(v))}}class cM{constructor(e){this.left=e?[...e]:[],this.right=[]}get(e){if(e<0||e>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+e+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return e<this.left.length?this.left[e]:this.right[this.right.length-e+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(e,n){const i=n??Number.POSITIVE_INFINITY;return i<this.left.length?this.left.slice(e,i):e>this.left.length?this.right.slice(this.right.length-i+this.left.length,this.right.length-e+this.left.length).reverse():this.left.slice(e).concat(this.right.slice(this.right.length-i+this.left.length).reverse())}splice(e,n,i){const l=n||0;this.setCursor(Math.trunc(e));const o=this.right.splice(this.right.length-l,Number.POSITIVE_INFINITY);return i&&$a(this.left,i),o.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(e){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(e)}pushMany(e){this.setCursor(Number.POSITIVE_INFINITY),$a(this.left,e)}unshift(e){this.setCursor(0),this.right.push(e)}unshiftMany(e){this.setCursor(0),$a(this.right,e.reverse())}setCursor(e){if(!(e===this.left.length||e>this.left.length&&this.right.length===0||e<0&&this.left.length===0))if(e<this.left.length){const n=this.left.splice(e,Number.POSITIVE_INFINITY);$a(this.right,n.reverse())}else{const n=this.right.splice(this.left.length+this.right.length-e,Number.POSITIVE_INFINITY);$a(this.left,n.reverse())}}}function $a(t,e){let n=0;if(e.length<1e4)t.push(...e);else for(;n<e.length;)t.push(...e.slice(n,n+1e4)),n+=1e4}function Xv(t){const e={};let n=-1,i,l,o,u,f,g,h;const x=new cM(t);for(;++n<x.length;){for(;n in e;)n=e[n];if(i=x.get(n),n&&i[1].type==="chunkFlow"&&x.get(n-1)[1].type==="listItemPrefix"&&(g=i[1]._tokenizer.events,o=0,o<g.length&&g[o][1].type==="lineEndingBlank"&&(o+=2),o<g.length&&g[o][1].type==="content"))for(;++o<g.length&&g[o][1].type!=="content";)g[o][1].type==="chunkText"&&(g[o][1]._isInFirstContentOfListItem=!0,o++);if(i[0]==="enter")i[1].contentType&&(Object.assign(e,uM(x,n)),n=e[n],h=!0);else if(i[1]._container){for(o=n,l=void 0;o--;)if(u=x.get(o),u[1].type==="lineEnding"||u[1].type==="lineEndingBlank")u[0]==="enter"&&(l&&(x.get(l)[1].type="lineEndingBlank"),u[1].type="lineEnding",l=o);else if(!(u[1].type==="linePrefix"||u[1].type==="listItemIndent"))break;l&&(i[1].end={...x.get(l)[1].start},f=x.slice(l,n),f.unshift(i),x.splice(l,n-l+1,f))}}return Kn(t,0,Number.POSITIVE_INFINITY,x.slice(0)),!h}function uM(t,e){const n=t.get(e)[1],i=t.get(e)[2];let l=e-1;const o=[];let u=n._tokenizer;u||(u=i.parser[n.contentType](n.start),n._contentTypeTextTrailing&&(u._contentTypeTextTrailing=!0));const f=u.events,g=[],h={};let x,v,N=-1,w=n,C=0,j=0;const k=[j];for(;w;){for(;t.get(++l)[1]!==w;);o.push(l),w._tokenizer||(x=i.sliceStream(w),w.next||x.push(null),v&&u.defineSkip(w.start),w._isInFirstContentOfListItem&&(u._gfmTasklistFirstContentOfListItem=!0),u.write(x),w._isInFirstContentOfListItem&&(u._gfmTasklistFirstContentOfListItem=void 0)),v=w,w=w.next}for(w=n;++N<f.length;)f[N][0]==="exit"&&f[N-1][0]==="enter"&&f[N][1].type===f[N-1][1].type&&f[N][1].start.line!==f[N][1].end.line&&(j=N+1,k.push(j),w._tokenizer=void 0,w.previous=void 0,w=w.next);for(u.events=[],w?(w._tokenizer=void 0,w.previous=void 0):k.pop(),N=k.length;N--;){const E=f.slice(k[N],k[N+1]),L=o.pop();g.push([L,L+E.length-1]),t.splice(L,2,E)}for(g.reverse(),N=-1;++N<g.length;)h[C+g[N][0]]=C+g[N][1],C+=g[N][1]-g[N][0]-1;return h}const dM={resolve:mM,tokenize:hM},fM={partial:!0,tokenize:pM};function mM(t){return Xv(t),t}function hM(t,e){let n;return i;function i(f){return t.enter("content"),n=t.enter("chunkContent",{contentType:"content"}),l(f)}function l(f){return f===null?o(f):Ie(f)?t.check(fM,u,o)(f):(t.consume(f),l)}function o(f){return t.exit("chunkContent"),t.exit("content"),e(f)}function u(f){return t.consume(f),t.exit("chunkContent"),n.next=t.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,l}}function pM(t,e,n){const i=this;return l;function l(u){return t.exit("chunkContent"),t.enter("lineEnding"),t.consume(u),t.exit("lineEnding"),mt(t,o,"linePrefix")}function o(u){if(u===null||Ie(u))return n(u);const f=i.events[i.events.length-1];return!i.parser.constructs.disable.null.includes("codeIndented")&&f&&f[1].type==="linePrefix"&&f[2].sliceSerialize(f[1],!0).length>=4?e(u):t.interrupt(i.parser.constructs.flow,n,e)(u)}}function eb(t,e,n,i,l,o,u,f,g){const h=g||Number.POSITIVE_INFINITY;let x=0;return v;function v(E){return E===60?(t.enter(i),t.enter(l),t.enter(o),t.consume(E),t.exit(o),N):E===null||E===32||E===41||Hf(E)?n(E):(t.enter(i),t.enter(u),t.enter(f),t.enter("chunkString",{contentType:"string"}),j(E))}function N(E){return E===62?(t.enter(o),t.consume(E),t.exit(o),t.exit(l),t.exit(i),e):(t.enter(f),t.enter("chunkString",{contentType:"string"}),w(E))}function w(E){return E===62?(t.exit("chunkString"),t.exit(f),N(E)):E===null||E===60||Ie(E)?n(E):(t.consume(E),E===92?C:w)}function C(E){return E===60||E===62||E===92?(t.consume(E),w):w(E)}function j(E){return!x&&(E===null||E===41||rn(E))?(t.exit("chunkString"),t.exit(f),t.exit(u),t.exit(i),e(E)):x<h&&E===40?(t.consume(E),x++,j):E===41?(t.consume(E),x--,j):E===null||E===32||E===40||Hf(E)?n(E):(t.consume(E),E===92?k:j)}function k(E){return E===40||E===41||E===92?(t.consume(E),j):j(E)}}function tb(t,e,n,i,l,o){const u=this;let f=0,g;return h;function h(w){return t.enter(i),t.enter(l),t.consume(w),t.exit(l),t.enter(o),x}function x(w){return f>999||w===null||w===91||w===93&&!g||w===94&&!f&&"_hiddenFootnoteSupport"in u.parser.constructs?n(w):w===93?(t.exit(o),t.enter(l),t.consume(w),t.exit(l),t.exit(i),e):Ie(w)?(t.enter("lineEnding"),t.consume(w),t.exit("lineEnding"),x):(t.enter("chunkString",{contentType:"string"}),v(w))}function v(w){return w===null||w===91||w===93||Ie(w)||f++>999?(t.exit("chunkString"),x(w)):(t.consume(w),g||(g=!tt(w)),w===92?N:v)}function N(w){return w===91||w===92||w===93?(t.consume(w),f++,v):v(w)}}function nb(t,e,n,i,l,o){let u;return f;function f(N){return N===34||N===39||N===40?(t.enter(i),t.enter(l),t.consume(N),t.exit(l),u=N===40?41:N,g):n(N)}function g(N){return N===u?(t.enter(l),t.consume(N),t.exit(l),t.exit(i),e):(t.enter(o),h(N))}function h(N){return N===u?(t.exit(o),g(u)):N===null?n(N):Ie(N)?(t.enter("lineEnding"),t.consume(N),t.exit("lineEnding"),mt(t,h,"linePrefix")):(t.enter("chunkString",{contentType:"string"}),x(N))}function x(N){return N===u||N===null||Ie(N)?(t.exit("chunkString"),h(N)):(t.consume(N),N===92?v:x)}function v(N){return N===u||N===92?(t.consume(N),x):x(N)}}function Za(t,e){let n;return i;function i(l){return Ie(l)?(t.enter("lineEnding"),t.consume(l),t.exit("lineEnding"),n=!0,i):tt(l)?mt(t,i,n?"linePrefix":"lineSuffix")(l):e(l)}}const gM={name:"definition",tokenize:yM},xM={partial:!0,tokenize:vM};function yM(t,e,n){const i=this;let l;return o;function o(w){return t.enter("definition"),u(w)}function u(w){return tb.call(i,t,f,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(w)}function f(w){return l=Cs(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)),w===58?(t.enter("definitionMarker"),t.consume(w),t.exit("definitionMarker"),g):n(w)}function g(w){return rn(w)?Za(t,h)(w):h(w)}function h(w){return eb(t,x,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(w)}function x(w){return t.attempt(xM,v,v)(w)}function v(w){return tt(w)?mt(t,N,"whitespace")(w):N(w)}function N(w){return w===null||Ie(w)?(t.exit("definition"),i.parser.defined.push(l),e(w)):n(w)}}function vM(t,e,n){return i;function i(f){return rn(f)?Za(t,l)(f):n(f)}function l(f){return nb(t,o,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(f)}function o(f){return tt(f)?mt(t,u,"whitespace")(f):u(f)}function u(f){return f===null||Ie(f)?e(f):n(f)}}const bM={name:"hardBreakEscape",tokenize:wM};function wM(t,e,n){return i;function i(o){return t.enter("hardBreakEscape"),t.consume(o),l}function l(o){return Ie(o)?(t.exit("hardBreakEscape"),e(o)):n(o)}}const NM={name:"headingAtx",resolve:SM,tokenize:CM};function SM(t,e){let n=t.length-2,i=3,l,o;return t[i][1].type==="whitespace"&&(i+=2),n-2>i&&t[n][1].type==="whitespace"&&(n-=2),t[n][1].type==="atxHeadingSequence"&&(i===n-1||n-4>i&&t[n-2][1].type==="whitespace")&&(n-=i+1===n?2:4),n>i&&(l={type:"atxHeadingText",start:t[i][1].start,end:t[n][1].end},o={type:"chunkText",start:t[i][1].start,end:t[n][1].end,contentType:"text"},Kn(t,i,n-i+1,[["enter",l,e],["enter",o,e],["exit",o,e],["exit",l,e]])),t}function CM(t,e,n){let i=0;return l;function l(x){return t.enter("atxHeading"),o(x)}function o(x){return t.enter("atxHeadingSequence"),u(x)}function u(x){return x===35&&i++<6?(t.consume(x),u):x===null||rn(x)?(t.exit("atxHeadingSequence"),f(x)):n(x)}function f(x){return x===35?(t.enter("atxHeadingSequence"),g(x)):x===null||Ie(x)?(t.exit("atxHeading"),e(x)):tt(x)?mt(t,f,"whitespace")(x):(t.enter("atxHeadingText"),h(x))}function g(x){return x===35?(t.consume(x),g):(t.exit("atxHeadingSequence"),f(x))}function h(x){return x===null||x===35||rn(x)?(t.exit("atxHeadingText"),f(x)):(t.consume(x),h)}}const TM=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],o1=["pre","script","style","textarea"],jM={concrete:!0,name:"htmlFlow",resolveTo:AM,tokenize:_M},kM={partial:!0,tokenize:RM},EM={partial:!0,tokenize:MM};function AM(t){let e=t.length;for(;e--&&!(t[e][0]==="enter"&&t[e][1].type==="htmlFlow"););return e>1&&t[e-2][1].type==="linePrefix"&&(t[e][1].start=t[e-2][1].start,t[e+1][1].start=t[e-2][1].start,t.splice(e-2,2)),t}function _M(t,e,n){const i=this;let l,o,u,f,g;return h;function h(_){return x(_)}function x(_){return t.enter("htmlFlow"),t.enter("htmlFlowData"),t.consume(_),v}function v(_){return _===33?(t.consume(_),N):_===47?(t.consume(_),o=!0,j):_===63?(t.consume(_),l=3,i.interrupt?e:S):Gn(_)?(t.consume(_),u=String.fromCharCode(_),k):n(_)}function N(_){return _===45?(t.consume(_),l=2,w):_===91?(t.consume(_),l=5,f=0,C):Gn(_)?(t.consume(_),l=4,i.interrupt?e:S):n(_)}function w(_){return _===45?(t.consume(_),i.interrupt?e:S):n(_)}function C(_){const ve="CDATA[";return _===ve.charCodeAt(f++)?(t.consume(_),f===ve.length?i.interrupt?e:Y:C):n(_)}function j(_){return Gn(_)?(t.consume(_),u=String.fromCharCode(_),k):n(_)}function k(_){if(_===null||_===47||_===62||rn(_)){const ve=_===47,Se=u.toLowerCase();return!ve&&!o&&o1.includes(Se)?(l=1,i.interrupt?e(_):Y(_)):TM.includes(u.toLowerCase())?(l=6,ve?(t.consume(_),E):i.interrupt?e(_):Y(_)):(l=7,i.interrupt&&!i.parser.lazy[i.now().line]?n(_):o?L(_):D(_))}return _===45||gn(_)?(t.consume(_),u+=String.fromCharCode(_),k):n(_)}function E(_){return _===62?(t.consume(_),i.interrupt?e:Y):n(_)}function L(_){return tt(_)?(t.consume(_),L):ee(_)}function D(_){return _===47?(t.consume(_),ee):_===58||_===95||Gn(_)?(t.consume(_),O):tt(_)?(t.consume(_),D):ee(_)}function O(_){return _===45||_===46||_===58||_===95||gn(_)?(t.consume(_),O):H(_)}function H(_){return _===61?(t.consume(_),I):tt(_)?(t.consume(_),H):D(_)}function I(_){return _===null||_===60||_===61||_===62||_===96?n(_):_===34||_===39?(t.consume(_),g=_,R):tt(_)?(t.consume(_),I):q(_)}function R(_){return _===g?(t.consume(_),g=null,B):_===null||Ie(_)?n(_):(t.consume(_),R)}function q(_){return _===null||_===34||_===39||_===47||_===60||_===61||_===62||_===96||rn(_)?H(_):(t.consume(_),q)}function B(_){return _===47||_===62||tt(_)?D(_):n(_)}function ee(_){return _===62?(t.consume(_),G):n(_)}function G(_){return _===null||Ie(_)?Y(_):tt(_)?(t.consume(_),G):n(_)}function Y(_){return _===45&&l===2?(t.consume(_),P):_===60&&l===1?(t.consume(_),K):_===62&&l===4?(t.consume(_),V):_===63&&l===3?(t.consume(_),S):_===93&&l===5?(t.consume(_),X):Ie(_)&&(l===6||l===7)?(t.exit("htmlFlowData"),t.check(kM,ie,z)(_)):_===null||Ie(_)?(t.exit("htmlFlowData"),z(_)):(t.consume(_),Y)}function z(_){return t.check(EM,$,ie)(_)}function $(_){return t.enter("lineEnding"),t.consume(_),t.exit("lineEnding"),Q}function Q(_){return _===null||Ie(_)?z(_):(t.enter("htmlFlowData"),Y(_))}function P(_){return _===45?(t.consume(_),S):Y(_)}function K(_){return _===47?(t.consume(_),u="",pe):Y(_)}function pe(_){if(_===62){const ve=u.toLowerCase();return o1.includes(ve)?(t.consume(_),V):Y(_)}return Gn(_)&&u.length<8?(t.consume(_),u+=String.fromCharCode(_),pe):Y(_)}function X(_){return _===93?(t.consume(_),S):Y(_)}function S(_){return _===62?(t.consume(_),V):_===45&&l===2?(t.consume(_),S):Y(_)}function V(_){return _===null||Ie(_)?(t.exit("htmlFlowData"),ie(_)):(t.consume(_),V)}function ie(_){return t.exit("htmlFlow"),e(_)}}function MM(t,e,n){const i=this;return l;function l(u){return Ie(u)?(t.enter("lineEnding"),t.consume(u),t.exit("lineEnding"),o):n(u)}function o(u){return i.parser.lazy[i.now().line]?n(u):e(u)}}function RM(t,e,n){return i;function i(l){return t.enter("lineEnding"),t.consume(l),t.exit("lineEnding"),t.attempt(cc,e,n)}}const IM={name:"htmlText",tokenize:DM};function DM(t,e,n){const i=this;let l,o,u;return f;function f(S){return t.enter("htmlText"),t.enter("htmlTextData"),t.consume(S),g}function g(S){return S===33?(t.consume(S),h):S===47?(t.consume(S),H):S===63?(t.consume(S),D):Gn(S)?(t.consume(S),q):n(S)}function h(S){return S===45?(t.consume(S),x):S===91?(t.consume(S),o=0,C):Gn(S)?(t.consume(S),L):n(S)}function x(S){return S===45?(t.consume(S),w):n(S)}function v(S){return S===null?n(S):S===45?(t.consume(S),N):Ie(S)?(u=v,K(S)):(t.consume(S),v)}function N(S){return S===45?(t.consume(S),w):v(S)}function w(S){return S===62?P(S):S===45?N(S):v(S)}function C(S){const V="CDATA[";return S===V.charCodeAt(o++)?(t.consume(S),o===V.length?j:C):n(S)}function j(S){return S===null?n(S):S===93?(t.consume(S),k):Ie(S)?(u=j,K(S)):(t.consume(S),j)}function k(S){return S===93?(t.consume(S),E):j(S)}function E(S){return S===62?P(S):S===93?(t.consume(S),E):j(S)}function L(S){return S===null||S===62?P(S):Ie(S)?(u=L,K(S)):(t.consume(S),L)}function D(S){return S===null?n(S):S===63?(t.consume(S),O):Ie(S)?(u=D,K(S)):(t.consume(S),D)}function O(S){return S===62?P(S):D(S)}function H(S){return Gn(S)?(t.consume(S),I):n(S)}function I(S){return S===45||gn(S)?(t.consume(S),I):R(S)}function R(S){return Ie(S)?(u=R,K(S)):tt(S)?(t.consume(S),R):P(S)}function q(S){return S===45||gn(S)?(t.consume(S),q):S===47||S===62||rn(S)?B(S):n(S)}function B(S){return S===47?(t.consume(S),P):S===58||S===95||Gn(S)?(t.consume(S),ee):Ie(S)?(u=B,K(S)):tt(S)?(t.consume(S),B):P(S)}function ee(S){return S===45||S===46||S===58||S===95||gn(S)?(t.consume(S),ee):G(S)}function G(S){return S===61?(t.consume(S),Y):Ie(S)?(u=G,K(S)):tt(S)?(t.consume(S),G):B(S)}function Y(S){return S===null||S===60||S===61||S===62||S===96?n(S):S===34||S===39?(t.consume(S),l=S,z):Ie(S)?(u=Y,K(S)):tt(S)?(t.consume(S),Y):(t.consume(S),$)}function z(S){return S===l?(t.consume(S),l=void 0,Q):S===null?n(S):Ie(S)?(u=z,K(S)):(t.consume(S),z)}function $(S){return S===null||S===34||S===39||S===60||S===61||S===96?n(S):S===47||S===62||rn(S)?B(S):(t.consume(S),$)}function Q(S){return S===47||S===62||rn(S)?B(S):n(S)}function P(S){return S===62?(t.consume(S),t.exit("htmlTextData"),t.exit("htmlText"),e):n(S)}function K(S){return t.exit("htmlTextData"),t.enter("lineEnding"),t.consume(S),t.exit("lineEnding"),pe}function pe(S){return tt(S)?mt(t,X,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(S):X(S)}function X(S){return t.enter("htmlTextData"),u(S)}}const Tm={name:"labelEnd",resolveAll:BM,resolveTo:UM,tokenize:zM},LM={tokenize:VM},PM={tokenize:$M},OM={tokenize:qM};function BM(t){let e=-1;const n=[];for(;++e<t.length;){const i=t[e][1];if(n.push(t[e]),i.type==="labelImage"||i.type==="labelLink"||i.type==="labelEnd"){const l=i.type==="labelImage"?4:2;i.type="data",e+=l}}return t.length!==n.length&&Kn(t,0,t.length,n),t}function UM(t,e){let n=t.length,i=0,l,o,u,f;for(;n--;)if(l=t[n][1],o){if(l.type==="link"||l.type==="labelLink"&&l._inactive)break;t[n][0]==="enter"&&l.type==="labelLink"&&(l._inactive=!0)}else if(u){if(t[n][0]==="enter"&&(l.type==="labelImage"||l.type==="labelLink")&&!l._balanced&&(o=n,l.type!=="labelLink")){i=2;break}}else l.type==="labelEnd"&&(u=n);const g={type:t[o][1].type==="labelLink"?"link":"image",start:{...t[o][1].start},end:{...t[t.length-1][1].end}},h={type:"label",start:{...t[o][1].start},end:{...t[u][1].end}},x={type:"labelText",start:{...t[o+i+2][1].end},end:{...t[u-2][1].start}};return f=[["enter",g,e],["enter",h,e]],f=En(f,t.slice(o+1,o+i+3)),f=En(f,[["enter",x,e]]),f=En(f,Cm(e.parser.constructs.insideSpan.null,t.slice(o+i+4,u-3),e)),f=En(f,[["exit",x,e],t[u-2],t[u-1],["exit",h,e]]),f=En(f,t.slice(u+1)),f=En(f,[["exit",g,e]]),Kn(t,o,t.length,f),t}function zM(t,e,n){const i=this;let l=i.events.length,o,u;for(;l--;)if((i.events[l][1].type==="labelImage"||i.events[l][1].type==="labelLink")&&!i.events[l][1]._balanced){o=i.events[l][1];break}return f;function f(N){return o?o._inactive?v(N):(u=i.parser.defined.includes(Cs(i.sliceSerialize({start:o.end,end:i.now()}))),t.enter("labelEnd"),t.enter("labelMarker"),t.consume(N),t.exit("labelMarker"),t.exit("labelEnd"),g):n(N)}function g(N){return N===40?t.attempt(LM,x,u?x:v)(N):N===91?t.attempt(PM,x,u?h:v)(N):u?x(N):v(N)}function h(N){return t.attempt(OM,x,v)(N)}function x(N){return e(N)}function v(N){return o._balanced=!0,n(N)}}function VM(t,e,n){return i;function i(v){return t.enter("resource"),t.enter("resourceMarker"),t.consume(v),t.exit("resourceMarker"),l}function l(v){return rn(v)?Za(t,o)(v):o(v)}function o(v){return v===41?x(v):eb(t,u,f,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(v)}function u(v){return rn(v)?Za(t,g)(v):x(v)}function f(v){return n(v)}function g(v){return v===34||v===39||v===40?nb(t,h,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(v):x(v)}function h(v){return rn(v)?Za(t,x)(v):x(v)}function x(v){return v===41?(t.enter("resourceMarker"),t.consume(v),t.exit("resourceMarker"),t.exit("resource"),e):n(v)}}function $M(t,e,n){const i=this;return l;function l(f){return tb.call(i,t,o,u,"reference","referenceMarker","referenceString")(f)}function o(f){return i.parser.defined.includes(Cs(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)))?e(f):n(f)}function u(f){return n(f)}}function qM(t,e,n){return i;function i(o){return t.enter("reference"),t.enter("referenceMarker"),t.consume(o),t.exit("referenceMarker"),l}function l(o){return o===93?(t.enter("referenceMarker"),t.consume(o),t.exit("referenceMarker"),t.exit("reference"),e):n(o)}}const FM={name:"labelStartImage",resolveAll:Tm.resolveAll,tokenize:HM};function HM(t,e,n){const i=this;return l;function l(f){return t.enter("labelImage"),t.enter("labelImageMarker"),t.consume(f),t.exit("labelImageMarker"),o}function o(f){return f===91?(t.enter("labelMarker"),t.consume(f),t.exit("labelMarker"),t.exit("labelImage"),u):n(f)}function u(f){return f===94&&"_hiddenFootnoteSupport"in i.parser.constructs?n(f):e(f)}}const GM={name:"labelStartLink",resolveAll:Tm.resolveAll,tokenize:JM};function JM(t,e,n){const i=this;return l;function l(u){return t.enter("labelLink"),t.enter("labelMarker"),t.consume(u),t.exit("labelMarker"),t.exit("labelLink"),o}function o(u){return u===94&&"_hiddenFootnoteSupport"in i.parser.constructs?n(u):e(u)}}const cf={name:"lineEnding",tokenize:YM};function YM(t,e){return n;function n(i){return t.enter("lineEnding"),t.consume(i),t.exit("lineEnding"),mt(t,e,"linePrefix")}}const Bo={name:"thematicBreak",tokenize:ZM};function ZM(t,e,n){let i=0,l;return o;function o(h){return t.enter("thematicBreak"),u(h)}function u(h){return l=h,f(h)}function f(h){return h===l?(t.enter("thematicBreakSequence"),g(h)):i>=3&&(h===null||Ie(h))?(t.exit("thematicBreak"),e(h)):n(h)}function g(h){return h===l?(t.consume(h),i++,g):(t.exit("thematicBreakSequence"),tt(h)?mt(t,f,"whitespace")(h):f(h))}}const nn={continuation:{tokenize:XM},exit:t7,name:"list",tokenize:WM},QM={partial:!0,tokenize:n7},KM={partial:!0,tokenize:e7};function WM(t,e,n){const i=this,l=i.events[i.events.length-1];let o=l&&l[1].type==="linePrefix"?l[2].sliceSerialize(l[1],!0).length:0,u=0;return f;function f(w){const C=i.containerState.type||(w===42||w===43||w===45?"listUnordered":"listOrdered");if(C==="listUnordered"?!i.containerState.marker||w===i.containerState.marker:Gf(w)){if(i.containerState.type||(i.containerState.type=C,t.enter(C,{_container:!0})),C==="listUnordered")return t.enter("listItemPrefix"),w===42||w===45?t.check(Bo,n,h)(w):h(w);if(!i.interrupt||w===49)return t.enter("listItemPrefix"),t.enter("listItemValue"),g(w)}return n(w)}function g(w){return Gf(w)&&++u<10?(t.consume(w),g):(!i.interrupt||u<2)&&(i.containerState.marker?w===i.containerState.marker:w===41||w===46)?(t.exit("listItemValue"),h(w)):n(w)}function h(w){return t.enter("listItemMarker"),t.consume(w),t.exit("listItemMarker"),i.containerState.marker=i.containerState.marker||w,t.check(cc,i.interrupt?n:x,t.attempt(QM,N,v))}function x(w){return i.containerState.initialBlankLine=!0,o++,N(w)}function v(w){return tt(w)?(t.enter("listItemPrefixWhitespace"),t.consume(w),t.exit("listItemPrefixWhitespace"),N):n(w)}function N(w){return i.containerState.size=o+i.sliceSerialize(t.exit("listItemPrefix"),!0).length,e(w)}}function XM(t,e,n){const i=this;return i.containerState._closeFlow=void 0,t.check(cc,l,o);function l(f){return i.containerState.furtherBlankLines=i.containerState.furtherBlankLines||i.containerState.initialBlankLine,mt(t,e,"listItemIndent",i.containerState.size+1)(f)}function o(f){return i.containerState.furtherBlankLines||!tt(f)?(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,u(f)):(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,t.attempt(KM,e,u)(f))}function u(f){return i.containerState._closeFlow=!0,i.interrupt=void 0,mt(t,t.attempt(nn,e,n),"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(f)}}function e7(t,e,n){const i=this;return mt(t,l,"listItemIndent",i.containerState.size+1);function l(o){const u=i.events[i.events.length-1];return u&&u[1].type==="listItemIndent"&&u[2].sliceSerialize(u[1],!0).length===i.containerState.size?e(o):n(o)}}function t7(t){t.exit(this.containerState.type)}function n7(t,e,n){const i=this;return mt(t,l,"listItemPrefixWhitespace",i.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function l(o){const u=i.events[i.events.length-1];return!tt(o)&&u&&u[1].type==="listItemPrefixWhitespace"?e(o):n(o)}}const c1={name:"setextUnderline",resolveTo:i7,tokenize:r7};function i7(t,e){let n=t.length,i,l,o;for(;n--;)if(t[n][0]==="enter"){if(t[n][1].type==="content"){i=n;break}t[n][1].type==="paragraph"&&(l=n)}else t[n][1].type==="content"&&t.splice(n,1),!o&&t[n][1].type==="definition"&&(o=n);const u={type:"setextHeading",start:{...t[i][1].start},end:{...t[t.length-1][1].end}};return t[l][1].type="setextHeadingText",o?(t.splice(l,0,["enter",u,e]),t.splice(o+1,0,["exit",t[i][1],e]),t[i][1].end={...t[o][1].end}):t[i][1]=u,t.push(["exit",u,e]),t}function r7(t,e,n){const i=this;let l;return o;function o(h){let x=i.events.length,v;for(;x--;)if(i.events[x][1].type!=="lineEnding"&&i.events[x][1].type!=="linePrefix"&&i.events[x][1].type!=="content"){v=i.events[x][1].type==="paragraph";break}return!i.parser.lazy[i.now().line]&&(i.interrupt||v)?(t.enter("setextHeadingLine"),l=h,u(h)):n(h)}function u(h){return t.enter("setextHeadingLineSequence"),f(h)}function f(h){return h===l?(t.consume(h),f):(t.exit("setextHeadingLineSequence"),tt(h)?mt(t,g,"lineSuffix")(h):g(h))}function g(h){return h===null||Ie(h)?(t.exit("setextHeadingLine"),e(h)):n(h)}}const s7={tokenize:a7};function a7(t){const e=this,n=t.attempt(cc,i,t.attempt(this.parser.constructs.flowInitial,l,mt(t,t.attempt(this.parser.constructs.flow,l,t.attempt(dM,l)),"linePrefix")));return n;function i(o){if(o===null){t.consume(o);return}return t.enter("lineEndingBlank"),t.consume(o),t.exit("lineEndingBlank"),e.currentConstruct=void 0,n}function l(o){if(o===null){t.consume(o);return}return t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),e.currentConstruct=void 0,n}}const l7={resolveAll:rb()},o7=ib("string"),c7=ib("text");function ib(t){return{resolveAll:rb(t==="text"?u7:void 0),tokenize:e};function e(n){const i=this,l=this.parser.constructs[t],o=n.attempt(l,u,f);return u;function u(x){return h(x)?o(x):f(x)}function f(x){if(x===null){n.consume(x);return}return n.enter("data"),n.consume(x),g}function g(x){return h(x)?(n.exit("data"),o(x)):(n.consume(x),g)}function h(x){if(x===null)return!0;const v=l[x];let N=-1;if(v)for(;++N<v.length;){const w=v[N];if(!w.previous||w.previous.call(i,i.previous))return!0}return!1}}}function rb(t){return e;function e(n,i){let l=-1,o;for(;++l<=n.length;)o===void 0?n[l]&&n[l][1].type==="data"&&(o=l,l++):(!n[l]||n[l][1].type!=="data")&&(l!==o+2&&(n[o][1].end=n[l-1][1].end,n.splice(o+2,l-o-2),l=o+2),o=void 0);return t?t(n,i):n}}function u7(t,e){let n=0;for(;++n<=t.length;)if((n===t.length||t[n][1].type==="lineEnding")&&t[n-1][1].type==="data"){const i=t[n-1][1],l=e.sliceStream(i);let o=l.length,u=-1,f=0,g;for(;o--;){const h=l[o];if(typeof h=="string"){for(u=h.length;h.charCodeAt(u-1)===32;)f++,u--;if(u)break;u=-1}else if(h===-2)g=!0,f++;else if(h!==-1){o++;break}}if(e._contentTypeTextTrailing&&n===t.length&&(f=0),f){const h={type:n===t.length||g||f<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:o?u:i.start._bufferIndex+u,_index:i.start._index+o,line:i.end.line,column:i.end.column-f,offset:i.end.offset-f},end:{...i.end}};i.end={...h.start},i.start.offset===i.end.offset?Object.assign(i,h):(t.splice(n,0,["enter",h,e],["exit",h,e]),n+=2)}n++}return t}const d7={42:nn,43:nn,45:nn,48:nn,49:nn,50:nn,51:nn,52:nn,53:nn,54:nn,55:nn,56:nn,57:nn,62:Qv},f7={91:gM},m7={[-2]:of,[-1]:of,32:of},h7={35:NM,42:Bo,45:[c1,Bo],60:jM,61:c1,95:Bo,96:l1,126:l1},p7={38:Wv,92:Kv},g7={[-5]:cf,[-4]:cf,[-3]:cf,33:FM,38:Wv,42:Jf,60:[G_,IM],91:GM,92:[bM,Kv],93:Tm,95:Jf,96:sM},x7={null:[Jf,l7]},y7={null:[42,95]},v7={null:[]},b7=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:y7,contentInitial:f7,disable:v7,document:d7,flow:h7,flowInitial:m7,insideSpan:x7,string:p7,text:g7},Symbol.toStringTag,{value:"Module"}));function w7(t,e,n){let i={_bufferIndex:-1,_index:0,line:n&&n.line||1,column:n&&n.column||1,offset:n&&n.offset||0};const l={},o=[];let u=[],f=[];const g={attempt:R(H),check:R(I),consume:L,enter:D,exit:O,interrupt:R(I,{interrupt:!0})},h={code:null,containerState:{},defineSkip:j,events:[],now:C,parser:t,previous:null,sliceSerialize:N,sliceStream:w,write:v};let x=e.tokenize.call(h,g);return e.resolveAll&&o.push(e),h;function v(G){return u=En(u,G),k(),u[u.length-1]!==null?[]:(q(e,0),h.events=Cm(o,h.events,h),h.events)}function N(G,Y){return S7(w(G),Y)}function w(G){return N7(u,G)}function C(){const{_bufferIndex:G,_index:Y,line:z,column:$,offset:Q}=i;return{_bufferIndex:G,_index:Y,line:z,column:$,offset:Q}}function j(G){l[G.line]=G.column,ee()}function k(){let G;for(;i._index<u.length;){const Y=u[i._index];if(typeof Y=="string")for(G=i._index,i._bufferIndex<0&&(i._bufferIndex=0);i._index===G&&i._bufferIndex<Y.length;)E(Y.charCodeAt(i._bufferIndex));else E(Y)}}function E(G){x=x(G)}function L(G){Ie(G)?(i.line++,i.column=1,i.offset+=G===-3?2:1,ee()):G!==-1&&(i.column++,i.offset++),i._bufferIndex<0?i._index++:(i._bufferIndex++,i._bufferIndex===u[i._index].length&&(i._bufferIndex=-1,i._index++)),h.previous=G}function D(G,Y){const z=Y||{};return z.type=G,z.start=C(),h.events.push(["enter",z,h]),f.push(z),z}function O(G){const Y=f.pop();return Y.end=C(),h.events.push(["exit",Y,h]),Y}function H(G,Y){q(G,Y.from)}function I(G,Y){Y.restore()}function R(G,Y){return z;function z($,Q,P){let K,pe,X,S;return Array.isArray($)?ie($):"tokenize"in $?ie([$]):V($);function V(se){return he;function he(de){const be=de!==null&&se[de],Ve=de!==null&&se.null,Ze=[...Array.isArray(be)?be:be?[be]:[],...Array.isArray(Ve)?Ve:Ve?[Ve]:[]];return ie(Ze)(de)}}function ie(se){return K=se,pe=0,se.length===0?P:_(se[pe])}function _(se){return he;function he(de){return S=B(),X=se,se.partial||(h.currentConstruct=se),se.name&&h.parser.constructs.disable.null.includes(se.name)?Se():se.tokenize.call(Y?Object.assign(Object.create(h),Y):h,g,ve,Se)(de)}}function ve(se){return G(X,S),Q}function Se(se){return S.restore(),++pe<K.length?_(K[pe]):P}}}function q(G,Y){G.resolveAll&&!o.includes(G)&&o.push(G),G.resolve&&Kn(h.events,Y,h.events.length-Y,G.resolve(h.events.slice(Y),h)),G.resolveTo&&(h.events=G.resolveTo(h.events,h))}function B(){const G=C(),Y=h.previous,z=h.currentConstruct,$=h.events.length,Q=Array.from(f);return{from:$,restore:P};function P(){i=G,h.previous=Y,h.currentConstruct=z,h.events.length=$,f=Q,ee()}}function ee(){i.line in l&&i.column<2&&(i.column=l[i.line],i.offset+=l[i.line]-1)}}function N7(t,e){const n=e.start._index,i=e.start._bufferIndex,l=e.end._index,o=e.end._bufferIndex;let u;if(n===l)u=[t[n].slice(i,o)];else{if(u=t.slice(n,l),i>-1){const f=u[0];typeof f=="string"?u[0]=f.slice(i):u.shift()}o>0&&u.push(t[l].slice(0,o))}return u}function S7(t,e){let n=-1;const i=[];let l;for(;++n<t.length;){const o=t[n];let u;if(typeof o=="string")u=o;else switch(o){case-5:{u="\r";break}case-4:{u=`
`;break}case-3:{u=`\r
`;break}case-2:{u=e?" ":"	";break}case-1:{if(!e&&l)continue;u=" ";break}default:u=String.fromCharCode(o)}l=o===-2,i.push(u)}return i.join("")}function C7(t){const i={constructs:M_([b7,...(t||{}).extensions||[]]),content:l(U_),defined:[],document:l(V_),flow:l(s7),lazy:{},string:l(o7),text:l(c7)};return i;function l(o){return u;function u(f){return w7(i,o,f)}}}function T7(t){for(;!Xv(t););return t}const u1=/[\0\t\n\r]/g;function j7(){let t=1,e="",n=!0,i;return l;function l(o,u,f){const g=[];let h,x,v,N,w;for(o=e+(typeof o=="string"?o.toString():new TextDecoder(u||void 0).decode(o)),v=0,e="",n&&(o.charCodeAt(0)===65279&&v++,n=void 0);v<o.length;){if(u1.lastIndex=v,h=u1.exec(o),N=h&&h.index!==void 0?h.index:o.length,w=o.charCodeAt(N),!h){e=o.slice(v);break}if(w===10&&v===N&&i)g.push(-3),i=void 0;else switch(i&&(g.push(-5),i=void 0),v<N&&(g.push(o.slice(v,N)),t+=N-v),w){case 0:{g.push(65533),t++;break}case 9:{for(x=Math.ceil(t/4)*4,g.push(-2);t++<x;)g.push(-1);break}case 10:{g.push(-4),t=1;break}default:i=!0,t=1}v=N+1}return f&&(i&&g.push(-5),e&&g.push(e),g.push(null)),g}}const k7=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function E7(t){return t.replace(k7,A7)}function A7(t,e,n){if(e)return e;if(n.charCodeAt(0)===35){const l=n.charCodeAt(1),o=l===120||l===88;return Zv(n.slice(o?2:1),o?16:10)}return Sm(n)||t}const sb={}.hasOwnProperty;function _7(t,e,n){return typeof e!="string"&&(n=e,e=void 0),M7(n)(T7(C7(n).document().write(j7()(t,e,!0))))}function M7(t){const e={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:o($e),autolinkProtocol:B,autolinkEmail:B,atxHeading:o(Gt),blockQuote:o(Ve),characterEscape:B,characterReference:B,codeFenced:o(Ze),codeFencedFenceInfo:u,codeFencedFenceMeta:u,codeIndented:o(Ze,u),codeText:o(ut,u),codeTextData:B,data:B,codeFlowValue:B,definition:o(gt),definitionDestinationString:u,definitionLabelString:u,definitionTitleString:u,emphasis:o(Je),hardBreakEscape:o(xn),hardBreakTrailing:o(xn),htmlFlow:o(Rt,u),htmlFlowData:B,htmlText:o(Rt,u),htmlTextData:B,image:o(wi),label:u,link:o($e),listItem:o(Qe),listItemValue:N,listOrdered:o(ei,v),listUnordered:o(ei),paragraph:o(Bn),reference:_,referenceString:u,resourceDestinationString:u,resourceTitleString:u,setextHeading:o(Gt),strong:o(ln),thematicBreak:o(fe)},exit:{atxHeading:g(),atxHeadingSequence:H,autolink:g(),autolinkEmail:be,autolinkProtocol:de,blockQuote:g(),characterEscapeValue:ee,characterReferenceMarkerHexadecimal:Se,characterReferenceMarkerNumeric:Se,characterReferenceValue:se,characterReference:he,codeFenced:g(k),codeFencedFence:j,codeFencedFenceInfo:w,codeFencedFenceMeta:C,codeFlowValue:ee,codeIndented:g(E),codeText:g(Q),codeTextData:ee,data:ee,definition:g(),definitionDestinationString:O,definitionLabelString:L,definitionTitleString:D,emphasis:g(),hardBreakEscape:g(Y),hardBreakTrailing:g(Y),htmlFlow:g(z),htmlFlowData:ee,htmlText:g($),htmlTextData:ee,image:g(K),label:X,labelText:pe,lineEnding:G,link:g(P),listItem:g(),listOrdered:g(),listUnordered:g(),paragraph:g(),referenceString:ve,resourceDestinationString:S,resourceTitleString:V,resource:ie,setextHeading:g(q),setextHeadingLineSequence:R,setextHeadingText:I,strong:g(),thematicBreak:g()}};ab(e,(t||{}).mdastExtensions||[]);const n={};return i;function i(Z){let te={type:"root",children:[]};const J={stack:[te],tokenStack:[],config:e,enter:f,exit:h,buffer:u,resume:x,data:n},oe=[];let ge=-1;for(;++ge<Z.length;)if(Z[ge][1].type==="listOrdered"||Z[ge][1].type==="listUnordered")if(Z[ge][0]==="enter")oe.push(ge);else{const Ne=oe.pop();ge=l(Z,Ne,ge)}for(ge=-1;++ge<Z.length;){const Ne=e[Z[ge][0]];sb.call(Ne,Z[ge][1].type)&&Ne[Z[ge][1].type].call(Object.assign({sliceSerialize:Z[ge][2].sliceSerialize},J),Z[ge][1])}if(J.tokenStack.length>0){const Ne=J.tokenStack[J.tokenStack.length-1];(Ne[1]||d1).call(J,void 0,Ne[0])}for(te.position={start:Ji(Z.length>0?Z[0][1].start:{line:1,column:1,offset:0}),end:Ji(Z.length>0?Z[Z.length-2][1].end:{line:1,column:1,offset:0})},ge=-1;++ge<e.transforms.length;)te=e.transforms[ge](te)||te;return te}function l(Z,te,J){let oe=te-1,ge=-1,Ne=!1,Ee,Ke,ot,Vt;for(;++oe<=J;){const Nt=Z[oe];switch(Nt[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Nt[0]==="enter"?ge++:ge--,Vt=void 0;break}case"lineEndingBlank":{Nt[0]==="enter"&&(Ee&&!Vt&&!ge&&!ot&&(ot=oe),Vt=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Vt=void 0}if(!ge&&Nt[0]==="enter"&&Nt[1].type==="listItemPrefix"||ge===-1&&Nt[0]==="exit"&&(Nt[1].type==="listUnordered"||Nt[1].type==="listOrdered")){if(Ee){let Jt=oe;for(Ke=void 0;Jt--;){const _n=Z[Jt];if(_n[1].type==="lineEnding"||_n[1].type==="lineEndingBlank"){if(_n[0]==="exit")continue;Ke&&(Z[Ke][1].type="lineEndingBlank",Ne=!0),_n[1].type="lineEnding",Ke=Jt}else if(!(_n[1].type==="linePrefix"||_n[1].type==="blockQuotePrefix"||_n[1].type==="blockQuotePrefixWhitespace"||_n[1].type==="blockQuoteMarker"||_n[1].type==="listItemIndent"))break}ot&&(!Ke||ot<Ke)&&(Ee._spread=!0),Ee.end=Object.assign({},Ke?Z[Ke][1].start:Nt[1].end),Z.splice(Ke||oe,0,["exit",Ee,Nt[2]]),oe++,J++}if(Nt[1].type==="listItemPrefix"){const Jt={type:"listItem",_spread:!1,start:Object.assign({},Nt[1].start),end:void 0};Ee=Jt,Z.splice(oe,0,["enter",Jt,Nt[2]]),oe++,J++,ot=void 0,Vt=!0}}}return Z[te][1]._spread=Ne,J}function o(Z,te){return J;function J(oe){f.call(this,Z(oe),oe),te&&te.call(this,oe)}}function u(){this.stack.push({type:"fragment",children:[]})}function f(Z,te,J){this.stack[this.stack.length-1].children.push(Z),this.stack.push(Z),this.tokenStack.push([te,J||void 0]),Z.position={start:Ji(te.start),end:void 0}}function g(Z){return te;function te(J){Z&&Z.call(this,J),h.call(this,J)}}function h(Z,te){const J=this.stack.pop(),oe=this.tokenStack.pop();if(oe)oe[0].type!==Z.type&&(te?te.call(this,Z,oe[0]):(oe[1]||d1).call(this,Z,oe[0]));else throw new Error("Cannot close `"+Z.type+"` ("+Ya({start:Z.start,end:Z.end})+"): it’s not open");J.position.end=Ji(Z.end)}function x(){return A_(this.stack.pop())}function v(){this.data.expectingFirstListItemValue=!0}function N(Z){if(this.data.expectingFirstListItemValue){const te=this.stack[this.stack.length-2];te.start=Number.parseInt(this.sliceSerialize(Z),10),this.data.expectingFirstListItemValue=void 0}}function w(){const Z=this.resume(),te=this.stack[this.stack.length-1];te.lang=Z}function C(){const Z=this.resume(),te=this.stack[this.stack.length-1];te.meta=Z}function j(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function k(){const Z=this.resume(),te=this.stack[this.stack.length-1];te.value=Z.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function E(){const Z=this.resume(),te=this.stack[this.stack.length-1];te.value=Z.replace(/(\r?\n|\r)$/g,"")}function L(Z){const te=this.resume(),J=this.stack[this.stack.length-1];J.label=te,J.identifier=Cs(this.sliceSerialize(Z)).toLowerCase()}function D(){const Z=this.resume(),te=this.stack[this.stack.length-1];te.title=Z}function O(){const Z=this.resume(),te=this.stack[this.stack.length-1];te.url=Z}function H(Z){const te=this.stack[this.stack.length-1];if(!te.depth){const J=this.sliceSerialize(Z).length;te.depth=J}}function I(){this.data.setextHeadingSlurpLineEnding=!0}function R(Z){const te=this.stack[this.stack.length-1];te.depth=this.sliceSerialize(Z).codePointAt(0)===61?1:2}function q(){this.data.setextHeadingSlurpLineEnding=void 0}function B(Z){const J=this.stack[this.stack.length-1].children;let oe=J[J.length-1];(!oe||oe.type!=="text")&&(oe=Ni(),oe.position={start:Ji(Z.start),end:void 0},J.push(oe)),this.stack.push(oe)}function ee(Z){const te=this.stack.pop();te.value+=this.sliceSerialize(Z),te.position.end=Ji(Z.end)}function G(Z){const te=this.stack[this.stack.length-1];if(this.data.atHardBreak){const J=te.children[te.children.length-1];J.position.end=Ji(Z.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&e.canContainEols.includes(te.type)&&(B.call(this,Z),ee.call(this,Z))}function Y(){this.data.atHardBreak=!0}function z(){const Z=this.resume(),te=this.stack[this.stack.length-1];te.value=Z}function $(){const Z=this.resume(),te=this.stack[this.stack.length-1];te.value=Z}function Q(){const Z=this.resume(),te=this.stack[this.stack.length-1];te.value=Z}function P(){const Z=this.stack[this.stack.length-1];if(this.data.inReference){const te=this.data.referenceType||"shortcut";Z.type+="Reference",Z.referenceType=te,delete Z.url,delete Z.title}else delete Z.identifier,delete Z.label;this.data.referenceType=void 0}function K(){const Z=this.stack[this.stack.length-1];if(this.data.inReference){const te=this.data.referenceType||"shortcut";Z.type+="Reference",Z.referenceType=te,delete Z.url,delete Z.title}else delete Z.identifier,delete Z.label;this.data.referenceType=void 0}function pe(Z){const te=this.sliceSerialize(Z),J=this.stack[this.stack.length-2];J.label=E7(te),J.identifier=Cs(te).toLowerCase()}function X(){const Z=this.stack[this.stack.length-1],te=this.resume(),J=this.stack[this.stack.length-1];if(this.data.inReference=!0,J.type==="link"){const oe=Z.children;J.children=oe}else J.alt=te}function S(){const Z=this.resume(),te=this.stack[this.stack.length-1];te.url=Z}function V(){const Z=this.resume(),te=this.stack[this.stack.length-1];te.title=Z}function ie(){this.data.inReference=void 0}function _(){this.data.referenceType="collapsed"}function ve(Z){const te=this.resume(),J=this.stack[this.stack.length-1];J.label=te,J.identifier=Cs(this.sliceSerialize(Z)).toLowerCase(),this.data.referenceType="full"}function Se(Z){this.data.characterReferenceType=Z.type}function se(Z){const te=this.sliceSerialize(Z),J=this.data.characterReferenceType;let oe;J?(oe=Zv(te,J==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):oe=Sm(te);const ge=this.stack[this.stack.length-1];ge.value+=oe}function he(Z){const te=this.stack.pop();te.position.end=Ji(Z.end)}function de(Z){ee.call(this,Z);const te=this.stack[this.stack.length-1];te.url=this.sliceSerialize(Z)}function be(Z){ee.call(this,Z);const te=this.stack[this.stack.length-1];te.url="mailto:"+this.sliceSerialize(Z)}function Ve(){return{type:"blockquote",children:[]}}function Ze(){return{type:"code",lang:null,meta:null,value:""}}function ut(){return{type:"inlineCode",value:""}}function gt(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Je(){return{type:"emphasis",children:[]}}function Gt(){return{type:"heading",depth:0,children:[]}}function xn(){return{type:"break"}}function Rt(){return{type:"html",value:""}}function wi(){return{type:"image",title:null,url:"",alt:null}}function $e(){return{type:"link",title:null,url:"",children:[]}}function ei(Z){return{type:"list",ordered:Z.type==="listOrdered",start:null,spread:Z._spread,children:[]}}function Qe(Z){return{type:"listItem",spread:Z._spread,checked:null,children:[]}}function Bn(){return{type:"paragraph",children:[]}}function ln(){return{type:"strong",children:[]}}function Ni(){return{type:"text",value:""}}function fe(){return{type:"thematicBreak"}}}function Ji(t){return{line:t.line,column:t.column,offset:t.offset}}function ab(t,e){let n=-1;for(;++n<e.length;){const i=e[n];Array.isArray(i)?ab(t,i):R7(t,i)}}function R7(t,e){let n;for(n in e)if(sb.call(e,n))switch(n){case"canContainEols":{const i=e[n];i&&t[n].push(...i);break}case"transforms":{const i=e[n];i&&t[n].push(...i);break}case"enter":case"exit":{const i=e[n];i&&Object.assign(t[n],i);break}}}function d1(t,e){throw t?new Error("Cannot close `"+t.type+"` ("+Ya({start:t.start,end:t.end})+"): a different token (`"+e.type+"`, "+Ya({start:e.start,end:e.end})+") is open"):new Error("Cannot close document, a token (`"+e.type+"`, "+Ya({start:e.start,end:e.end})+") is still open")}function I7(t){const e=this;e.parser=n;function n(i){return _7(i,{...e.data("settings"),...t,extensions:e.data("micromarkExtensions")||[],mdastExtensions:e.data("fromMarkdownExtensions")||[]})}}function D7(t,e){const n={type:"element",tagName:"blockquote",properties:{},children:t.wrap(t.all(e),!0)};return t.patch(e,n),t.applyData(e,n)}function L7(t,e){const n={type:"element",tagName:"br",properties:{},children:[]};return t.patch(e,n),[t.applyData(e,n),{type:"text",value:`
`}]}function P7(t,e){const n=e.value?e.value+`
`:"",i={};e.lang&&(i.className=["language-"+e.lang]);let l={type:"element",tagName:"code",properties:i,children:[{type:"text",value:n}]};return e.meta&&(l.data={meta:e.meta}),t.patch(e,l),l=t.applyData(e,l),l={type:"element",tagName:"pre",properties:{},children:[l]},t.patch(e,l),l}function O7(t,e){const n={type:"element",tagName:"del",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function B7(t,e){const n={type:"element",tagName:"em",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function U7(t,e){const n=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",i=String(e.identifier).toUpperCase(),l=Bs(i.toLowerCase()),o=t.footnoteOrder.indexOf(i);let u,f=t.footnoteCounts.get(i);f===void 0?(f=0,t.footnoteOrder.push(i),u=t.footnoteOrder.length):u=o+1,f+=1,t.footnoteCounts.set(i,f);const g={type:"element",tagName:"a",properties:{href:"#"+n+"fn-"+l,id:n+"fnref-"+l+(f>1?"-"+f:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(u)}]};t.patch(e,g);const h={type:"element",tagName:"sup",properties:{},children:[g]};return t.patch(e,h),t.applyData(e,h)}function z7(t,e){const n={type:"element",tagName:"h"+e.depth,properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function V7(t,e){if(t.options.allowDangerousHtml){const n={type:"raw",value:e.value};return t.patch(e,n),t.applyData(e,n)}}function lb(t,e){const n=e.referenceType;let i="]";if(n==="collapsed"?i+="[]":n==="full"&&(i+="["+(e.label||e.identifier)+"]"),e.type==="imageReference")return[{type:"text",value:"!["+e.alt+i}];const l=t.all(e),o=l[0];o&&o.type==="text"?o.value="["+o.value:l.unshift({type:"text",value:"["});const u=l[l.length-1];return u&&u.type==="text"?u.value+=i:l.push({type:"text",value:i}),l}function $7(t,e){const n=String(e.identifier).toUpperCase(),i=t.definitionById.get(n);if(!i)return lb(t,e);const l={src:Bs(i.url||""),alt:e.alt};i.title!==null&&i.title!==void 0&&(l.title=i.title);const o={type:"element",tagName:"img",properties:l,children:[]};return t.patch(e,o),t.applyData(e,o)}function q7(t,e){const n={src:Bs(e.url)};e.alt!==null&&e.alt!==void 0&&(n.alt=e.alt),e.title!==null&&e.title!==void 0&&(n.title=e.title);const i={type:"element",tagName:"img",properties:n,children:[]};return t.patch(e,i),t.applyData(e,i)}function F7(t,e){const n={type:"text",value:e.value.replace(/\r?\n|\r/g," ")};t.patch(e,n);const i={type:"element",tagName:"code",properties:{},children:[n]};return t.patch(e,i),t.applyData(e,i)}function H7(t,e){const n=String(e.identifier).toUpperCase(),i=t.definitionById.get(n);if(!i)return lb(t,e);const l={href:Bs(i.url||"")};i.title!==null&&i.title!==void 0&&(l.title=i.title);const o={type:"element",tagName:"a",properties:l,children:t.all(e)};return t.patch(e,o),t.applyData(e,o)}function G7(t,e){const n={href:Bs(e.url)};e.title!==null&&e.title!==void 0&&(n.title=e.title);const i={type:"element",tagName:"a",properties:n,children:t.all(e)};return t.patch(e,i),t.applyData(e,i)}function J7(t,e,n){const i=t.all(e),l=n?Y7(n):ob(e),o={},u=[];if(typeof e.checked=="boolean"){const x=i[0];let v;x&&x.type==="element"&&x.tagName==="p"?v=x:(v={type:"element",tagName:"p",properties:{},children:[]},i.unshift(v)),v.children.length>0&&v.children.unshift({type:"text",value:" "}),v.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:e.checked,disabled:!0},children:[]}),o.className=["task-list-item"]}let f=-1;for(;++f<i.length;){const x=i[f];(l||f!==0||x.type!=="element"||x.tagName!=="p")&&u.push({type:"text",value:`
`}),x.type==="element"&&x.tagName==="p"&&!l?u.push(...x.children):u.push(x)}const g=i[i.length-1];g&&(l||g.type!=="element"||g.tagName!=="p")&&u.push({type:"text",value:`
`});const h={type:"element",tagName:"li",properties:o,children:u};return t.patch(e,h),t.applyData(e,h)}function Y7(t){let e=!1;if(t.type==="list"){e=t.spread||!1;const n=t.children;let i=-1;for(;!e&&++i<n.length;)e=ob(n[i])}return e}function ob(t){const e=t.spread;return e??t.children.length>1}function Z7(t,e){const n={},i=t.all(e);let l=-1;for(typeof e.start=="number"&&e.start!==1&&(n.start=e.start);++l<i.length;){const u=i[l];if(u.type==="element"&&u.tagName==="li"&&u.properties&&Array.isArray(u.properties.className)&&u.properties.className.includes("task-list-item")){n.className=["contains-task-list"];break}}const o={type:"element",tagName:e.ordered?"ol":"ul",properties:n,children:t.wrap(i,!0)};return t.patch(e,o),t.applyData(e,o)}function Q7(t,e){const n={type:"element",tagName:"p",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function K7(t,e){const n={type:"root",children:t.wrap(t.all(e))};return t.patch(e,n),t.applyData(e,n)}function W7(t,e){const n={type:"element",tagName:"strong",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function X7(t,e){const n=t.all(e),i=n.shift(),l=[];if(i){const u={type:"element",tagName:"thead",properties:{},children:t.wrap([i],!0)};t.patch(e.children[0],u),l.push(u)}if(n.length>0){const u={type:"element",tagName:"tbody",properties:{},children:t.wrap(n,!0)},f=vm(e.children[1]),g=$v(e.children[e.children.length-1]);f&&g&&(u.position={start:f,end:g}),l.push(u)}const o={type:"element",tagName:"table",properties:{},children:t.wrap(l,!0)};return t.patch(e,o),t.applyData(e,o)}function e8(t,e,n){const i=n?n.children:void 0,o=(i?i.indexOf(e):1)===0?"th":"td",u=n&&n.type==="table"?n.align:void 0,f=u?u.length:e.children.length;let g=-1;const h=[];for(;++g<f;){const v=e.children[g],N={},w=u?u[g]:void 0;w&&(N.align=w);let C={type:"element",tagName:o,properties:N,children:[]};v&&(C.children=t.all(v),t.patch(v,C),C=t.applyData(v,C)),h.push(C)}const x={type:"element",tagName:"tr",properties:{},children:t.wrap(h,!0)};return t.patch(e,x),t.applyData(e,x)}function t8(t,e){const n={type:"element",tagName:"td",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}const f1=9,m1=32;function n8(t){const e=String(t),n=/\r?\n|\r/g;let i=n.exec(e),l=0;const o=[];for(;i;)o.push(h1(e.slice(l,i.index),l>0,!0),i[0]),l=i.index+i[0].length,i=n.exec(e);return o.push(h1(e.slice(l),l>0,!1)),o.join("")}function h1(t,e,n){let i=0,l=t.length;if(e){let o=t.codePointAt(i);for(;o===f1||o===m1;)i++,o=t.codePointAt(i)}if(n){let o=t.codePointAt(l-1);for(;o===f1||o===m1;)l--,o=t.codePointAt(l-1)}return l>i?t.slice(i,l):""}function i8(t,e){const n={type:"text",value:n8(String(e.value))};return t.patch(e,n),t.applyData(e,n)}function r8(t,e){const n={type:"element",tagName:"hr",properties:{},children:[]};return t.patch(e,n),t.applyData(e,n)}const s8={blockquote:D7,break:L7,code:P7,delete:O7,emphasis:B7,footnoteReference:U7,heading:z7,html:V7,imageReference:$7,image:q7,inlineCode:F7,linkReference:H7,link:G7,listItem:J7,list:Z7,paragraph:Q7,root:K7,strong:W7,table:X7,tableCell:t8,tableRow:e8,text:i8,thematicBreak:r8,toml:To,yaml:To,definition:To,footnoteDefinition:To};function To(){}const cb=-1,uc=0,Qa=1,Wo=2,jm=3,km=4,Em=5,Am=6,ub=7,db=8,p1=typeof self=="object"?self:globalThis,a8=(t,e)=>{const n=(l,o)=>(t.set(o,l),l),i=l=>{if(t.has(l))return t.get(l);const[o,u]=e[l];switch(o){case uc:case cb:return n(u,l);case Qa:{const f=n([],l);for(const g of u)f.push(i(g));return f}case Wo:{const f=n({},l);for(const[g,h]of u)f[i(g)]=i(h);return f}case jm:return n(new Date(u),l);case km:{const{source:f,flags:g}=u;return n(new RegExp(f,g),l)}case Em:{const f=n(new Map,l);for(const[g,h]of u)f.set(i(g),i(h));return f}case Am:{const f=n(new Set,l);for(const g of u)f.add(i(g));return f}case ub:{const{name:f,message:g}=u;return n(new p1[f](g),l)}case db:return n(BigInt(u),l);case"BigInt":return n(Object(BigInt(u)),l);case"ArrayBuffer":return n(new Uint8Array(u).buffer,u);case"DataView":{const{buffer:f}=new Uint8Array(u);return n(new DataView(f),u)}}return n(new p1[o](u),l)};return i},g1=t=>a8(new Map,t)(0),gs="",{toString:l8}={},{keys:o8}=Object,qa=t=>{const e=typeof t;if(e!=="object"||!t)return[uc,e];const n=l8.call(t).slice(8,-1);switch(n){case"Array":return[Qa,gs];case"Object":return[Wo,gs];case"Date":return[jm,gs];case"RegExp":return[km,gs];case"Map":return[Em,gs];case"Set":return[Am,gs];case"DataView":return[Qa,n]}return n.includes("Array")?[Qa,n]:n.includes("Error")?[ub,n]:[Wo,n]},jo=([t,e])=>t===uc&&(e==="function"||e==="symbol"),c8=(t,e,n,i)=>{const l=(u,f)=>{const g=i.push(u)-1;return n.set(f,g),g},o=u=>{if(n.has(u))return n.get(u);let[f,g]=qa(u);switch(f){case uc:{let x=u;switch(g){case"bigint":f=db,x=u.toString();break;case"function":case"symbol":if(t)throw new TypeError("unable to serialize "+g);x=null;break;case"undefined":return l([cb],u)}return l([f,x],u)}case Qa:{if(g){let N=u;return g==="DataView"?N=new Uint8Array(u.buffer):g==="ArrayBuffer"&&(N=new Uint8Array(u)),l([g,[...N]],u)}const x=[],v=l([f,x],u);for(const N of u)x.push(o(N));return v}case Wo:{if(g)switch(g){case"BigInt":return l([g,u.toString()],u);case"Boolean":case"Number":case"String":return l([g,u.valueOf()],u)}if(e&&"toJSON"in u)return o(u.toJSON());const x=[],v=l([f,x],u);for(const N of o8(u))(t||!jo(qa(u[N])))&&x.push([o(N),o(u[N])]);return v}case jm:return l([f,u.toISOString()],u);case km:{const{source:x,flags:v}=u;return l([f,{source:x,flags:v}],u)}case Em:{const x=[],v=l([f,x],u);for(const[N,w]of u)(t||!(jo(qa(N))||jo(qa(w))))&&x.push([o(N),o(w)]);return v}case Am:{const x=[],v=l([f,x],u);for(const N of u)(t||!jo(qa(N)))&&x.push(o(N));return v}}const{message:h}=u;return l([f,{name:g,message:h}],u)};return o},x1=(t,{json:e,lossy:n}={})=>{const i=[];return c8(!(e||n),!!e,new Map,i)(t),i},Xo=typeof structuredClone=="function"?(t,e)=>e&&("json"in e||"lossy"in e)?g1(x1(t,e)):structuredClone(t):(t,e)=>g1(x1(t,e));function u8(t,e){const n=[{type:"text",value:"↩"}];return e>1&&n.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(e)}]}),n}function d8(t,e){return"Back to reference "+(t+1)+(e>1?"-"+e:"")}function f8(t){const e=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",n=t.options.footnoteBackContent||u8,i=t.options.footnoteBackLabel||d8,l=t.options.footnoteLabel||"Footnotes",o=t.options.footnoteLabelTagName||"h2",u=t.options.footnoteLabelProperties||{className:["sr-only"]},f=[];let g=-1;for(;++g<t.footnoteOrder.length;){const h=t.footnoteById.get(t.footnoteOrder[g]);if(!h)continue;const x=t.all(h),v=String(h.identifier).toUpperCase(),N=Bs(v.toLowerCase());let w=0;const C=[],j=t.footnoteCounts.get(v);for(;j!==void 0&&++w<=j;){C.length>0&&C.push({type:"text",value:" "});let L=typeof n=="string"?n:n(g,w);typeof L=="string"&&(L={type:"text",value:L}),C.push({type:"element",tagName:"a",properties:{href:"#"+e+"fnref-"+N+(w>1?"-"+w:""),dataFootnoteBackref:"",ariaLabel:typeof i=="string"?i:i(g,w),className:["data-footnote-backref"]},children:Array.isArray(L)?L:[L]})}const k=x[x.length-1];if(k&&k.type==="element"&&k.tagName==="p"){const L=k.children[k.children.length-1];L&&L.type==="text"?L.value+=" ":k.children.push({type:"text",value:" "}),k.children.push(...C)}else x.push(...C);const E={type:"element",tagName:"li",properties:{id:e+"fn-"+N},children:t.wrap(x,!0)};t.patch(h,E),f.push(E)}if(f.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:o,properties:{...Xo(u),id:"footnote-label"},children:[{type:"text",value:l}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:t.wrap(f,!0)},{type:"text",value:`
`}]}}const fb=function(t){if(t==null)return g8;if(typeof t=="function")return dc(t);if(typeof t=="object")return Array.isArray(t)?m8(t):h8(t);if(typeof t=="string")return p8(t);throw new Error("Expected function, string, or object as test")};function m8(t){const e=[];let n=-1;for(;++n<t.length;)e[n]=fb(t[n]);return dc(i);function i(...l){let o=-1;for(;++o<e.length;)if(e[o].apply(this,l))return!0;return!1}}function h8(t){const e=t;return dc(n);function n(i){const l=i;let o;for(o in t)if(l[o]!==e[o])return!1;return!0}}function p8(t){return dc(e);function e(n){return n&&n.type===t}}function dc(t){return e;function e(n,i,l){return!!(x8(n)&&t.call(this,n,typeof i=="number"?i:void 0,l||void 0))}}function g8(){return!0}function x8(t){return t!==null&&typeof t=="object"&&"type"in t}const mb=[],y8=!0,y1=!1,v8="skip";function b8(t,e,n,i){let l;typeof e=="function"&&typeof n!="function"?(i=n,n=e):l=e;const o=fb(l),u=i?-1:1;f(t,void 0,[])();function f(g,h,x){const v=g&&typeof g=="object"?g:{};if(typeof v.type=="string"){const w=typeof v.tagName=="string"?v.tagName:typeof v.name=="string"?v.name:void 0;Object.defineProperty(N,"name",{value:"node ("+(g.type+(w?"<"+w+">":""))+")"})}return N;function N(){let w=mb,C,j,k;if((!e||o(g,h,x[x.length-1]||void 0))&&(w=w8(n(g,x)),w[0]===y1))return w;if("children"in g&&g.children){const E=g;if(E.children&&w[0]!==v8)for(j=(i?E.children.length:-1)+u,k=x.concat(E);j>-1&&j<E.children.length;){const L=E.children[j];if(C=f(L,j,k)(),C[0]===y1)return C;j=typeof C[1]=="number"?C[1]:j+u}}return w}}}function w8(t){return Array.isArray(t)?t:typeof t=="number"?[y8,t]:t==null?mb:[t]}function hb(t,e,n,i){let l,o,u;typeof e=="function"&&typeof n!="function"?(o=void 0,u=e,l=n):(o=e,u=n,l=i),b8(t,o,f,l);function f(g,h){const x=h[h.length-1],v=x?x.children.indexOf(g):void 0;return u(g,v,x)}}const Yf={}.hasOwnProperty,N8={};function S8(t,e){const n=e||N8,i=new Map,l=new Map,o=new Map,u={...s8,...n.handlers},f={all:h,applyData:T8,definitionById:i,footnoteById:l,footnoteCounts:o,footnoteOrder:[],handlers:u,one:g,options:n,patch:C8,wrap:k8};return hb(t,function(x){if(x.type==="definition"||x.type==="footnoteDefinition"){const v=x.type==="definition"?i:l,N=String(x.identifier).toUpperCase();v.has(N)||v.set(N,x)}}),f;function g(x,v){const N=x.type,w=f.handlers[N];if(Yf.call(f.handlers,N)&&w)return w(f,x,v);if(f.options.passThrough&&f.options.passThrough.includes(N)){if("children"in x){const{children:j,...k}=x,E=Xo(k);return E.children=f.all(x),E}return Xo(x)}return(f.options.unknownHandler||j8)(f,x,v)}function h(x){const v=[];if("children"in x){const N=x.children;let w=-1;for(;++w<N.length;){const C=f.one(N[w],x);if(C){if(w&&N[w-1].type==="break"&&(!Array.isArray(C)&&C.type==="text"&&(C.value=v1(C.value)),!Array.isArray(C)&&C.type==="element")){const j=C.children[0];j&&j.type==="text"&&(j.value=v1(j.value))}Array.isArray(C)?v.push(...C):v.push(C)}}}return v}}function C8(t,e){t.position&&(e.position=l_(t))}function T8(t,e){let n=e;if(t&&t.data){const i=t.data.hName,l=t.data.hChildren,o=t.data.hProperties;if(typeof i=="string")if(n.type==="element")n.tagName=i;else{const u="children"in n?n.children:[n];n={type:"element",tagName:i,properties:{},children:u}}n.type==="element"&&o&&Object.assign(n.properties,Xo(o)),"children"in n&&n.children&&l!==null&&l!==void 0&&(n.children=l)}return n}function j8(t,e){const n=e.data||{},i="value"in e&&!(Yf.call(n,"hProperties")||Yf.call(n,"hChildren"))?{type:"text",value:e.value}:{type:"element",tagName:"div",properties:{},children:t.all(e)};return t.patch(e,i),t.applyData(e,i)}function k8(t,e){const n=[];let i=-1;for(e&&n.push({type:"text",value:`
`});++i<t.length;)i&&n.push({type:"text",value:`
`}),n.push(t[i]);return e&&t.length>0&&n.push({type:"text",value:`
`}),n}function v1(t){let e=0,n=t.charCodeAt(e);for(;n===9||n===32;)e++,n=t.charCodeAt(e);return t.slice(e)}function b1(t,e){const n=S8(t,e),i=n.one(t,void 0),l=f8(n),o=Array.isArray(i)?{type:"root",children:i}:i||{type:"root",children:[]};return l&&o.children.push({type:"text",value:`
`},l),o}function E8(t,e){return t&&"run"in t?async function(n,i){const l=b1(n,{file:i,...e});await t.run(l,i)}:function(n,i){return b1(n,{file:i,...t||e})}}function w1(t){if(t)throw t}var uf,N1;function A8(){if(N1)return uf;N1=1;var t=Object.prototype.hasOwnProperty,e=Object.prototype.toString,n=Object.defineProperty,i=Object.getOwnPropertyDescriptor,l=function(h){return typeof Array.isArray=="function"?Array.isArray(h):e.call(h)==="[object Array]"},o=function(h){if(!h||e.call(h)!=="[object Object]")return!1;var x=t.call(h,"constructor"),v=h.constructor&&h.constructor.prototype&&t.call(h.constructor.prototype,"isPrototypeOf");if(h.constructor&&!x&&!v)return!1;var N;for(N in h);return typeof N>"u"||t.call(h,N)},u=function(h,x){n&&x.name==="__proto__"?n(h,x.name,{enumerable:!0,configurable:!0,value:x.newValue,writable:!0}):h[x.name]=x.newValue},f=function(h,x){if(x==="__proto__")if(t.call(h,x)){if(i)return i(h,x).value}else return;return h[x]};return uf=function g(){var h,x,v,N,w,C,j=arguments[0],k=1,E=arguments.length,L=!1;for(typeof j=="boolean"&&(L=j,j=arguments[1]||{},k=2),(j==null||typeof j!="object"&&typeof j!="function")&&(j={});k<E;++k)if(h=arguments[k],h!=null)for(x in h)v=f(j,x),N=f(h,x),j!==N&&(L&&N&&(o(N)||(w=l(N)))?(w?(w=!1,C=v&&l(v)?v:[]):C=v&&o(v)?v:{},u(j,{name:x,newValue:g(L,C,N)})):typeof N<"u"&&u(j,{name:x,newValue:N}));return j},uf}var _8=A8();const df=tl(_8);function Zf(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function M8(){const t=[],e={run:n,use:i};return e;function n(...l){let o=-1;const u=l.pop();if(typeof u!="function")throw new TypeError("Expected function as last argument, not "+u);f(null,...l);function f(g,...h){const x=t[++o];let v=-1;if(g){u(g);return}for(;++v<l.length;)(h[v]===null||h[v]===void 0)&&(h[v]=l[v]);l=h,x?R8(x,f)(...h):u(null,...h)}}function i(l){if(typeof l!="function")throw new TypeError("Expected `middelware` to be a function, not "+l);return t.push(l),e}}function R8(t,e){let n;return i;function i(...u){const f=t.length>u.length;let g;f&&u.push(l);try{g=t.apply(this,u)}catch(h){const x=h;if(f&&n)throw x;return l(x)}f||(g&&g.then&&typeof g.then=="function"?g.then(o,l):g instanceof Error?l(g):o(g))}function l(u,...f){n||(n=!0,e(u,...f))}function o(u){l(null,u)}}const Hn={basename:I8,dirname:D8,extname:L8,join:P8,sep:"/"};function I8(t,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');cl(t);let n=0,i=-1,l=t.length,o;if(e===void 0||e.length===0||e.length>t.length){for(;l--;)if(t.codePointAt(l)===47){if(o){n=l+1;break}}else i<0&&(o=!0,i=l+1);return i<0?"":t.slice(n,i)}if(e===t)return"";let u=-1,f=e.length-1;for(;l--;)if(t.codePointAt(l)===47){if(o){n=l+1;break}}else u<0&&(o=!0,u=l+1),f>-1&&(t.codePointAt(l)===e.codePointAt(f--)?f<0&&(i=l):(f=-1,i=u));return n===i?i=u:i<0&&(i=t.length),t.slice(n,i)}function D8(t){if(cl(t),t.length===0)return".";let e=-1,n=t.length,i;for(;--n;)if(t.codePointAt(n)===47){if(i){e=n;break}}else i||(i=!0);return e<0?t.codePointAt(0)===47?"/":".":e===1&&t.codePointAt(0)===47?"//":t.slice(0,e)}function L8(t){cl(t);let e=t.length,n=-1,i=0,l=-1,o=0,u;for(;e--;){const f=t.codePointAt(e);if(f===47){if(u){i=e+1;break}continue}n<0&&(u=!0,n=e+1),f===46?l<0?l=e:o!==1&&(o=1):l>-1&&(o=-1)}return l<0||n<0||o===0||o===1&&l===n-1&&l===i+1?"":t.slice(l,n)}function P8(...t){let e=-1,n;for(;++e<t.length;)cl(t[e]),t[e]&&(n=n===void 0?t[e]:n+"/"+t[e]);return n===void 0?".":O8(n)}function O8(t){cl(t);const e=t.codePointAt(0)===47;let n=B8(t,!e);return n.length===0&&!e&&(n="."),n.length>0&&t.codePointAt(t.length-1)===47&&(n+="/"),e?"/"+n:n}function B8(t,e){let n="",i=0,l=-1,o=0,u=-1,f,g;for(;++u<=t.length;){if(u<t.length)f=t.codePointAt(u);else{if(f===47)break;f=47}if(f===47){if(!(l===u-1||o===1))if(l!==u-1&&o===2){if(n.length<2||i!==2||n.codePointAt(n.length-1)!==46||n.codePointAt(n.length-2)!==46){if(n.length>2){if(g=n.lastIndexOf("/"),g!==n.length-1){g<0?(n="",i=0):(n=n.slice(0,g),i=n.length-1-n.lastIndexOf("/")),l=u,o=0;continue}}else if(n.length>0){n="",i=0,l=u,o=0;continue}}e&&(n=n.length>0?n+"/..":"..",i=2)}else n.length>0?n+="/"+t.slice(l+1,u):n=t.slice(l+1,u),i=u-l-1;l=u,o=0}else f===46&&o>-1?o++:o=-1}return n}function cl(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}const U8={cwd:z8};function z8(){return"/"}function Qf(t){return!!(t!==null&&typeof t=="object"&&"href"in t&&t.href&&"protocol"in t&&t.protocol&&t.auth===void 0)}function V8(t){if(typeof t=="string")t=new URL(t);else if(!Qf(t)){const e=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+t+"`");throw e.code="ERR_INVALID_ARG_TYPE",e}if(t.protocol!=="file:"){const e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return $8(t)}function $8(t){if(t.hostname!==""){const i=new TypeError('File URL host must be "localhost" or empty on darwin');throw i.code="ERR_INVALID_FILE_URL_HOST",i}const e=t.pathname;let n=-1;for(;++n<e.length;)if(e.codePointAt(n)===37&&e.codePointAt(n+1)===50){const i=e.codePointAt(n+2);if(i===70||i===102){const l=new TypeError("File URL path must not include encoded / characters");throw l.code="ERR_INVALID_FILE_URL_PATH",l}}return decodeURIComponent(e)}const ff=["history","path","basename","stem","extname","dirname"];class pb{constructor(e){let n;e?Qf(e)?n={path:e}:typeof e=="string"||q8(e)?n={value:e}:n=e:n={},this.cwd="cwd"in n?"":U8.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let i=-1;for(;++i<ff.length;){const o=ff[i];o in n&&n[o]!==void 0&&n[o]!==null&&(this[o]=o==="history"?[...n[o]]:n[o])}let l;for(l in n)ff.includes(l)||(this[l]=n[l])}get basename(){return typeof this.path=="string"?Hn.basename(this.path):void 0}set basename(e){hf(e,"basename"),mf(e,"basename"),this.path=Hn.join(this.dirname||"",e)}get dirname(){return typeof this.path=="string"?Hn.dirname(this.path):void 0}set dirname(e){S1(this.basename,"dirname"),this.path=Hn.join(e||"",this.basename)}get extname(){return typeof this.path=="string"?Hn.extname(this.path):void 0}set extname(e){if(mf(e,"extname"),S1(this.dirname,"extname"),e){if(e.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Hn.join(this.dirname,this.stem+(e||""))}get path(){return this.history[this.history.length-1]}set path(e){Qf(e)&&(e=V8(e)),hf(e,"path"),this.path!==e&&this.history.push(e)}get stem(){return typeof this.path=="string"?Hn.basename(this.path,this.extname):void 0}set stem(e){hf(e,"stem"),mf(e,"stem"),this.path=Hn.join(this.dirname||"",e+(this.extname||""))}fail(e,n,i){const l=this.message(e,n,i);throw l.fatal=!0,l}info(e,n,i){const l=this.message(e,n,i);return l.fatal=void 0,l}message(e,n,i){const l=new Ht(e,n,i);return this.path&&(l.name=this.path+":"+l.name,l.file=this.path),l.fatal=!1,this.messages.push(l),l}toString(e){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(e||void 0).decode(this.value)}}function mf(t,e){if(t&&t.includes(Hn.sep))throw new Error("`"+e+"` cannot be a path: did not expect `"+Hn.sep+"`")}function hf(t,e){if(!t)throw new Error("`"+e+"` cannot be empty")}function S1(t,e){if(!t)throw new Error("Setting `"+e+"` requires `path` to be set too")}function q8(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const F8=function(t){const i=this.constructor.prototype,l=i[t],o=function(){return l.apply(o,arguments)};return Object.setPrototypeOf(o,i),o},H8={}.hasOwnProperty;class _m extends F8{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=M8()}copy(){const e=new _m;let n=-1;for(;++n<this.attachers.length;){const i=this.attachers[n];e.use(...i)}return e.data(df(!0,{},this.namespace)),e}data(e,n){return typeof e=="string"?arguments.length===2?(xf("data",this.frozen),this.namespace[e]=n,this):H8.call(this.namespace,e)&&this.namespace[e]||void 0:e?(xf("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;const e=this;for(;++this.freezeIndex<this.attachers.length;){const[n,...i]=this.attachers[this.freezeIndex];if(i[0]===!1)continue;i[0]===!0&&(i[0]=void 0);const l=n.call(e,...i);typeof l=="function"&&this.transformers.use(l)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(e){this.freeze();const n=ko(e),i=this.parser||this.Parser;return pf("parse",i),i(String(n),n)}process(e,n){const i=this;return this.freeze(),pf("process",this.parser||this.Parser),gf("process",this.compiler||this.Compiler),n?l(void 0,n):new Promise(l);function l(o,u){const f=ko(e),g=i.parse(f);i.run(g,f,function(x,v,N){if(x||!v||!N)return h(x);const w=v,C=i.stringify(w,N);Y8(C)?N.value=C:N.result=C,h(x,N)});function h(x,v){x||!v?u(x):o?o(v):n(void 0,v)}}}processSync(e){let n=!1,i;return this.freeze(),pf("processSync",this.parser||this.Parser),gf("processSync",this.compiler||this.Compiler),this.process(e,l),T1("processSync","process",n),i;function l(o,u){n=!0,w1(o),i=u}}run(e,n,i){C1(e),this.freeze();const l=this.transformers;return!i&&typeof n=="function"&&(i=n,n=void 0),i?o(void 0,i):new Promise(o);function o(u,f){const g=ko(n);l.run(e,g,h);function h(x,v,N){const w=v||e;x?f(x):u?u(w):i(void 0,w,N)}}}runSync(e,n){let i=!1,l;return this.run(e,n,o),T1("runSync","run",i),l;function o(u,f){w1(u),l=f,i=!0}}stringify(e,n){this.freeze();const i=ko(n),l=this.compiler||this.Compiler;return gf("stringify",l),C1(e),l(e,i)}use(e,...n){const i=this.attachers,l=this.namespace;if(xf("use",this.frozen),e!=null)if(typeof e=="function")g(e,n);else if(typeof e=="object")Array.isArray(e)?f(e):u(e);else throw new TypeError("Expected usable value, not `"+e+"`");return this;function o(h){if(typeof h=="function")g(h,[]);else if(typeof h=="object")if(Array.isArray(h)){const[x,...v]=h;g(x,v)}else u(h);else throw new TypeError("Expected usable value, not `"+h+"`")}function u(h){if(!("plugins"in h)&&!("settings"in h))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");f(h.plugins),h.settings&&(l.settings=df(!0,l.settings,h.settings))}function f(h){let x=-1;if(h!=null)if(Array.isArray(h))for(;++x<h.length;){const v=h[x];o(v)}else throw new TypeError("Expected a list of plugins, not `"+h+"`")}function g(h,x){let v=-1,N=-1;for(;++v<i.length;)if(i[v][0]===h){N=v;break}if(N===-1)i.push([h,...x]);else if(x.length>0){let[w,...C]=x;const j=i[N][1];Zf(j)&&Zf(w)&&(w=df(!0,j,w)),i[N]=[h,w,...C]}}}}const G8=new _m().freeze();function pf(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `parser`")}function gf(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `compiler`")}function xf(t,e){if(e)throw new Error("Cannot call `"+t+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function C1(t){if(!Zf(t)||typeof t.type!="string")throw new TypeError("Expected node, got `"+t+"`")}function T1(t,e,n){if(!n)throw new Error("`"+t+"` finished async. Use `"+e+"` instead")}function ko(t){return J8(t)?t:new pb(t)}function J8(t){return!!(t&&typeof t=="object"&&"message"in t&&"messages"in t)}function Y8(t){return typeof t=="string"||Z8(t)}function Z8(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const Q8="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",j1=[],k1={allowDangerousHtml:!0},K8=/^(https?|ircs?|mailto|xmpp)$/i,W8=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function X8(t){const e=eR(t),n=tR(t);return nR(e.runSync(e.parse(n),n),t)}function eR(t){const e=t.rehypePlugins||j1,n=t.remarkPlugins||j1,i=t.remarkRehypeOptions?{...t.remarkRehypeOptions,...k1}:k1;return G8().use(I7).use(n).use(E8,i).use(e)}function tR(t){const e=t.children||"",n=new pb;return typeof e=="string"&&(n.value=e),n}function nR(t,e){const n=e.allowedElements,i=e.allowElement,l=e.components,o=e.disallowedElements,u=e.skipHtml,f=e.unwrapDisallowed,g=e.urlTransform||iR;for(const x of W8)Object.hasOwn(e,x.from)&&(""+x.from+(x.to?"use `"+x.to+"` instead":"remove it")+Q8+x.id,void 0);return hb(t,h),f_(t,{Fragment:a.Fragment,components:l,ignoreInvalidStyle:!0,jsx:a.jsx,jsxs:a.jsxs,passKeys:!0,passNode:!0});function h(x,v,N){if(x.type==="raw"&&N&&typeof v=="number")return u?N.children.splice(v,1):N.children[v]={type:"text",value:x.value},v;if(x.type==="element"){let w;for(w in lf)if(Object.hasOwn(lf,w)&&Object.hasOwn(x.properties,w)){const C=x.properties[w],j=lf[w];(j===null||j.includes(x.tagName))&&(x.properties[w]=g(String(C||""),w,x))}}if(x.type==="element"){let w=n?!n.includes(x.tagName):o?o.includes(x.tagName):!1;if(!w&&i&&typeof v=="number"&&(w=!i(x,v,N)),w&&N&&typeof v=="number")return f&&x.children?N.children.splice(v,1,...x.children):N.children.splice(v,1),v}}}function iR(t){const e=t.indexOf(":"),n=t.indexOf("?"),i=t.indexOf("#"),l=t.indexOf("/");return e===-1||l!==-1&&e>l||n!==-1&&e>n||i!==-1&&e>i||K8.test(t.slice(0,e))?t:""}const Mm=({content:t,className:e=""})=>a.jsx("div",{className:`prose prose-slate max-w-none ${e}`,children:a.jsx(X8,{components:{h1:({children:n})=>a.jsx("h1",{className:"text-2xl font-bold text-slate-800 mb-4 mt-6 leading-tight",children:n}),h2:({children:n})=>a.jsx("h2",{className:"text-xl font-bold text-slate-800 mb-3 mt-5 leading-tight",children:n}),h3:({children:n})=>a.jsx("h3",{className:"text-lg font-semibold text-slate-700 mb-3 mt-4 leading-tight",children:n}),h4:({children:n})=>a.jsx("h4",{className:"text-base font-semibold text-slate-700 mb-2 mt-3 leading-tight",children:n}),p:({children:n})=>a.jsx("p",{className:"text-base leading-relaxed mb-4 text-slate-700",children:n}),ul:({children:n})=>a.jsx("ul",{className:"list-disc list-inside mb-4 space-y-2 text-slate-700",children:n}),ol:({children:n})=>a.jsx("ol",{className:"list-decimal list-inside mb-4 space-y-2 text-slate-700",children:n}),li:({children:n})=>a.jsx("li",{className:"leading-relaxed ml-4",children:n}),strong:({children:n})=>a.jsx("strong",{className:"font-bold text-slate-800",children:n}),em:({children:n})=>a.jsx("em",{className:"italic text-slate-700",children:n}),code:({className:n,children:i,...l})=>n?a.jsx("code",{className:"block bg-slate-100 text-slate-800 p-4 rounded-lg text-sm font-mono overflow-x-auto mb-4",...l,children:i}):a.jsx("code",{className:"bg-slate-100 text-slate-800 px-2 py-1 rounded text-sm font-mono",...l,children:i}),blockquote:({children:n})=>a.jsx("blockquote",{className:"border-l-4 border-indigo-300 pl-4 my-4 italic text-slate-600 bg-indigo-50 py-2 rounded-r",children:n}),hr:()=>a.jsx("hr",{className:"my-6 border-slate-300"}),a:({href:n,children:i})=>a.jsx("a",{href:n,className:"text-indigo-600 hover:text-indigo-800 underline font-medium",target:"_blank",rel:"noopener noreferrer",children:i}),table:({children:n})=>a.jsx("div",{className:"overflow-x-auto mb-4",children:a.jsx("table",{className:"w-full border-collapse border border-slate-300 rounded-lg",children:n})}),thead:({children:n})=>a.jsx("thead",{className:"bg-slate-100",children:n}),tbody:({children:n})=>a.jsx("tbody",{children:n}),tr:({children:n})=>a.jsx("tr",{className:"border-b border-slate-200",children:n}),th:({children:n})=>a.jsx("th",{className:"border border-slate-300 px-4 py-2 text-left font-semibold text-slate-700",children:n}),td:({children:n})=>a.jsx("td",{className:"border border-slate-300 px-4 py-2 text-slate-700",children:n})},children:t})}),rR=()=>{const[t]=jr(),e=t.get("contentId"),n=t.get("binId"),[i,l]=M.useState(null),[o,u]=M.useState(!0),[f,g]=M.useState(null),[h,x]=M.useState(null),[v,N]=M.useState(0),[w,C]=M.useState([]),[j,k]=M.useState({}),[E,L]=M.useState({});M.useEffect(()=>{D()},[e,n]);const D=async()=>{try{u(!0),g(null);let X;if(n)X=await ac(n);else if(e){await zt.init();const S=await zt.getLessonPlan(e);if(!S)throw new Error("找不到指定的教案");X={topic:S.topic,learningObjectives:S.content.learningObjectives,contentBreakdown:S.content.contentBreakdown,confusingPoints:S.content.confusingPoints,classroomActivities:S.content.classroomActivities,onlineInteractiveQuiz:S.content.quiz,writingPractice:S.content.writingPractice}}else throw new Error("缺少必要參數：contentId 或 binId");l(X),O(X),await H(X)}catch(X){console.error("載入內容失敗:",X),g(X.message||"載入內容時發生錯誤")}finally{u(!1)}},O=X=>{const S=[];X.learningObjectives&&X.learningObjectives.length>0&&X.learningObjectives.forEach((V,ie)=>{S.push({id:`objective_${ie}`,title:`📚 學習目標 ${ie+1}`,type:"objective",icon:"🎯",description:V.objective.length>50?`${V.objective.substring(0,50)}...`:V.objective,data:V,index:ie})}),X.contentBreakdown&&X.contentBreakdown.length>0&&X.contentBreakdown.forEach((V,ie)=>{S.push({id:`breakdown_${ie}`,title:`🔍 深度學習 ${ie+1}`,type:"breakdown",icon:"📖",description:V.topic.length>50?`${V.topic.substring(0,50)}...`:V.topic,data:V,index:ie})}),X.confusingPoints&&X.confusingPoints.length>0&&X.confusingPoints.forEach((V,ie)=>{S.push({id:`confusing_${ie}`,title:`⚡ 易混淆點 ${ie+1}`,type:"confusing",icon:"💡",description:V.point.length>50?`${V.point.substring(0,50)}...`:V.point,data:V,index:ie})}),S.push({id:"summary",title:"🎯 學習成果",type:"summary",icon:"🏆",description:"完成學習並開始下一步挑戰"}),C(S)},H=async X=>{const S=e||n||"unknown",V=`interactive_learning_${S}`;try{const ie=localStorage.getItem(V);if(ie){const _=JSON.parse(ie);x(_)}else{const _={contentId:S,topic:X.topic||"互動學習",progress:{currentObjectiveIndex:0,completedObjectives:[],timeSpent:0,interactionCount:0,startTime:Date.now(),lastUpdateTime:Date.now(),completedActivities:[]},interactions:[],createdAt:Date.now(),updatedAt:Date.now()};x(_),localStorage.setItem(V,JSON.stringify(_))}}catch(ie){console.error("初始化學習會話失敗:",ie);const _={contentId:S,topic:X.topic||"互動學習",progress:{currentObjectiveIndex:0,completedObjectives:[],timeSpent:0,interactionCount:0,startTime:Date.now(),lastUpdateTime:Date.now(),completedActivities:[]},interactions:[],createdAt:Date.now(),updatedAt:Date.now()};x(_)}},I=X=>{const S=`interactive_learning_${h==null?void 0:h.contentId}`;X.updatedAt=Date.now(),X.progress.lastUpdateTime=Date.now(),x(X),localStorage.setItem(S,JSON.stringify(X))},R=X=>{X>=0&&X<w.length&&N(X)},q=()=>{v<w.length-1&&N(v+1)},B=()=>{v>0&&N(v-1)},ee=()=>localStorage.getItem("gemini_api_key")||"",G=async X=>{const S=ee();if(!S)return console.warn("未設定 API 金鑰，無法進行內容轉換"),null;const V=`${X.type}_${X.index||0}`;if(j[V]||E[V])return j[V]||null;try{L(_=>({..._,[V]:!0}));let ie=null;switch(X.type){case"objective":ie=await Mo(X.data,S);break;case"breakdown":ie=await Ro(X.data,S);break;case"confusing":ie=await Io(X.data,S);break;default:return null}return k(_=>({..._,[V]:ie})),ie}catch(ie){return console.error("內容轉換失敗:",ie),null}finally{L(ie=>({...ie,[V]:!1}))}},Y=X=>{const S=`${X.type}_${X.index||0}`;return!!j[S]},z=X=>{const S=`${X.type}_${X.index||0}`;return!!E[S]},$=X=>{const S=`${X.type}_${X.index||0}`;return j[S]||null},Q=X=>X?[/#+\s/,/\*\*.*\*\*/,/\*.*\*/,/`.*`/,/^\s*[-*+]\s/m,/^\s*\d+\.\s/m,/\[.*\]\(.*\)/,/^\s*>/m,/```[\s\S]*?```/,/\n\s*\n/].some(V=>V.test(X)):!1,P=(X,S)=>Q(X)?a.jsx(Mm,{content:X,className:S}):a.jsx("span",{className:S,children:X});if(o)return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-100 via-sky-50 to-indigo-100 py-8 px-4 sm:px-6 lg:px-8",children:a.jsx("div",{className:"flex justify-center items-center min-h-[50vh]",children:a.jsx(sn,{})})});if(f)return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-100 via-sky-50 to-indigo-100 py-8 px-4 sm:px-6 lg:px-8",children:a.jsx("div",{className:"max-w-4xl mx-auto",children:a.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg shadow-md",children:[a.jsx("h3",{className:"font-bold text-lg mb-2",children:"載入錯誤"}),a.jsx("p",{children:f})]})})});if(!i||!h||w.length===0)return null;const K=w[v],pe=()=>{const X=$(K),S=Y(K),V=z(K),ie=!!ee();switch(K.type){case"objective":const _=K.data,ve=K.index||0,Se=X||_;return a.jsxs("div",{className:"max-w-4xl mx-auto",children:[ie&&K.type!=="summary"&&a.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-6 mb-8",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"text-2xl",children:"🔄"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-slate-800",children:S?"已轉換為學生友好內容":"轉換為學生友好內容"}),a.jsx("p",{className:"text-sm text-slate-600",children:S?"內容已轉換為更適合學生學習的語言和格式":"將教師導向的教案內容轉換為學生容易理解的學習材料"})]})]}),!S&&a.jsx("button",{onClick:()=>G(K),disabled:V,className:"px-6 py-3 bg-indigo-500 hover:bg-indigo-600 disabled:opacity-50 disabled:cursor-not-allowed text-white font-medium rounded-lg transition-colors flex items-center gap-2",children:V?a.jsxs(a.Fragment,{children:[a.jsx("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"轉換中..."]}):a.jsxs(a.Fragment,{children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"開始轉換"]})}),S&&a.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),"轉換完成"]})]})}),a.jsxs("div",{className:"bg-gradient-to-br from-indigo-500 to-sky-500 rounded-3xl shadow-2xl p-12 text-white text-center mb-8",children:[a.jsx("div",{className:"text-6xl mb-6",children:"🎯"}),a.jsx("div",{className:"text-4xl font-bold mb-6 leading-tight",children:P(Se.objective,"text-4xl font-bold leading-tight")}),Se.description&&a.jsx("div",{className:"text-xl text-indigo-100 leading-relaxed max-w-3xl mx-auto",children:P(Se.description,"text-xl text-indigo-100 leading-relaxed")})]}),S&&X?a.jsxs("div",{className:"space-y-8 mb-8",children:[X.personalRelevance&&a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[a.jsxs("h4",{className:"text-2xl font-bold text-purple-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"🌟"}),"對你的意義"]}),a.jsx("div",{className:"bg-purple-50 rounded-xl p-6 text-lg leading-relaxed text-purple-900",children:P(X.personalRelevance,"text-lg leading-relaxed text-purple-900")})]}),X.teachingExample&&a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[a.jsxs("h4",{className:"text-2xl font-bold text-green-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"📝"}),"實際應用"]}),a.jsx("div",{className:"bg-green-50 rounded-xl p-6 text-lg leading-relaxed text-green-900",children:P(X.teachingExample,"text-lg leading-relaxed text-green-900")})]}),X.encouragement&&a.jsxs("div",{className:"bg-gradient-to-r from-sky-50 to-indigo-50 rounded-2xl p-8",children:[a.jsxs("h4",{className:"text-2xl font-bold text-sky-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"💪"}),"給你的鼓勵"]}),a.jsx("div",{className:"text-lg leading-relaxed text-sky-900 font-medium",children:P(X.encouragement,"text-lg leading-relaxed text-sky-900 font-medium")})]})]}):Se.teachingExample&&a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 mb-8",children:[a.jsxs("h4",{className:"text-2xl font-bold text-green-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"📝"}),"教學示例"]}),a.jsx("div",{className:"bg-green-50 rounded-xl p-6 text-lg leading-relaxed",children:P(Se.teachingExample,"text-lg leading-relaxed")})]}),a.jsx("div",{className:"text-center",children:h.progress.completedObjectives.includes(`objective_${ve}`)?a.jsxs("div",{className:"bg-green-50 border-2 border-green-200 rounded-2xl p-8",children:[a.jsx("div",{className:"text-5xl mb-4",children:"✅"}),a.jsx("h4",{className:"text-2xl font-bold text-green-700 mb-2",children:"已完成理解"}),a.jsx("p",{className:"text-green-600",children:"你已經掌握了這個學習目標！"})]}):a.jsxs("div",{className:"bg-slate-50 rounded-2xl p-8",children:[a.jsx("h4",{className:"text-xl font-semibold text-slate-700 mb-4",children:"理解了這個學習目標嗎？"}),a.jsxs("button",{onClick:()=>{var Ve;const de=`objective_${ve}`,be={...h};if(!be.progress.completedObjectives.includes(de)){be.progress.completedObjectives.push(de),be.progress.interactionCount+=1;const Ze=(Ve=i.learningObjectives)==null?void 0:Ve.findIndex((ut,gt)=>!be.progress.completedObjectives.includes(`objective_${gt}`)&&gt>ve);Ze!==void 0&&Ze!==-1&&(be.progress.currentObjectiveIndex=Ze)}I(be)},className:"px-8 py-4 bg-green-500 hover:bg-green-600 text-white font-bold text-lg rounded-xl transition-colors flex items-center gap-3 mx-auto",children:[a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),"標記為已理解"]})]})})]});case"breakdown":const se=K.data;return a.jsxs("div",{className:"max-w-5xl mx-auto",children:[ie&&K.type!=="summary"&&a.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-6 mb-8",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"text-2xl",children:"🔄"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-slate-800",children:S?"已轉換為學生友好內容":"轉換為學生友好內容"}),a.jsx("p",{className:"text-sm text-slate-600",children:S?"內容已轉換為更適合學生學習的語言和格式":"將教師導向的教案內容轉換為學生容易理解的學習材料"})]})]}),!S&&a.jsx("button",{onClick:()=>G(K),disabled:V,className:"px-6 py-3 bg-indigo-500 hover:bg-indigo-600 disabled:opacity-50 disabled:cursor-not-allowed text-white font-medium rounded-lg transition-colors flex items-center gap-2",children:V?a.jsxs(a.Fragment,{children:[a.jsx("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"轉換中..."]}):a.jsxs(a.Fragment,{children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"開始轉換"]})}),S&&a.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),"轉換完成"]})]})}),a.jsxs("div",{className:"bg-gradient-to-br from-sky-500 to-blue-500 rounded-3xl shadow-2xl p-12 text-white text-center mb-8",children:[a.jsx("div",{className:"text-6xl mb-6",children:"📖"}),a.jsx("div",{className:"text-4xl font-bold mb-6 leading-tight",children:S&&(X!=null&&X.title)?P(X.title,"text-4xl font-bold leading-tight"):P(se.topic,"text-4xl font-bold leading-tight")}),S&&(X==null?void 0:X.introduction)&&a.jsx("div",{className:"text-xl text-sky-100 leading-relaxed max-w-3xl mx-auto",children:P(X.introduction,"text-xl text-sky-100 leading-relaxed")})]}),S&&X?a.jsxs("div",{className:"space-y-8 mb-8",children:[X.keyPoints&&X.keyPoints.length>0&&a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[a.jsxs("h4",{className:"text-2xl font-bold text-indigo-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"💡"}),"重點概念"]}),a.jsx("div",{className:"bg-indigo-50 rounded-xl p-6",children:a.jsx("div",{className:"space-y-4",children:X.keyPoints.map((de,be)=>a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"flex-shrink-0 w-8 h-8 bg-indigo-500 text-white rounded-full flex items-center justify-center text-sm font-bold mr-4",children:be+1}),a.jsx("div",{className:"text-lg text-indigo-900 leading-relaxed",children:P(de,"text-lg text-indigo-900 leading-relaxed")})]},be))})})]}),X.realLifeExamples&&X.realLifeExamples.length>0&&a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[a.jsxs("h4",{className:"text-2xl font-bold text-green-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"🌟"}),"生活中的例子"]}),a.jsx("div",{className:"bg-green-50 rounded-xl p-6",children:a.jsx("div",{className:"space-y-4",children:X.realLifeExamples.map((de,be)=>a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"flex-shrink-0 w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center text-sm font-bold mr-4",children:be+1}),a.jsx("div",{className:"text-lg text-green-900 leading-relaxed",children:P(de,"text-lg text-green-900 leading-relaxed")})]},be))})})]}),X.learningTips&&a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[a.jsxs("h4",{className:"text-2xl font-bold text-purple-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"🎯"}),"學習技巧"]}),a.jsx("div",{className:"bg-purple-50 rounded-xl p-6 text-lg leading-relaxed text-purple-900",children:P(X.learningTips,"text-lg leading-relaxed text-purple-900")})]}),X.nextSteps&&a.jsxs("div",{className:"bg-gradient-to-r from-cyan-50 to-blue-50 rounded-2xl p-8",children:[a.jsxs("h4",{className:"text-2xl font-bold text-cyan-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"🚀"}),"下一步探索"]}),a.jsx("div",{className:"text-lg leading-relaxed text-cyan-900",children:P(X.nextSteps,"text-lg leading-relaxed text-cyan-900")})]}),X.encouragement&&a.jsxs("div",{className:"bg-gradient-to-r from-sky-50 to-indigo-50 rounded-2xl p-8",children:[a.jsxs("h4",{className:"text-2xl font-bold text-sky-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"💪"}),"給你的鼓勵"]}),a.jsx("div",{className:"text-lg leading-relaxed text-sky-900 font-medium",children:X.encouragement})]})]}):a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 mb-8",children:[a.jsxs("h4",{className:"text-2xl font-bold text-slate-800 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"📋"}),"詳細說明"]}),a.jsx("div",{className:"text-lg leading-relaxed text-slate-700 bg-slate-50 rounded-xl p-6",children:P(se.details,"text-lg leading-relaxed text-slate-700")})]}),!S&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid md:grid-cols-2 gap-8 mb-8",children:[se.coreConcept&&a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[a.jsxs("h4",{className:"text-2xl font-bold text-sky-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"💡"}),"核心概念"]}),a.jsx("div",{className:"bg-sky-50 rounded-xl p-6 text-lg leading-relaxed text-sky-900",children:P(se.coreConcept,"text-lg leading-relaxed text-sky-900")})]}),se.teachingExample&&a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[a.jsxs("h4",{className:"text-2xl font-bold text-green-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"📝"}),"教學示例"]}),a.jsx("div",{className:"bg-green-50 rounded-xl p-6 text-lg leading-relaxed text-green-900",children:P(se.teachingExample,"text-lg leading-relaxed text-green-900")})]})]}),se.teachingSentences&&se.teachingSentences.length>0&&a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 mb-8",children:[a.jsxs("h4",{className:"text-2xl font-bold text-indigo-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"🎯"}),"重點句型"]}),a.jsx("div",{className:"bg-indigo-50 rounded-xl p-6",children:a.jsx("div",{className:"space-y-4",children:se.teachingSentences.map((de,be)=>a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"flex-shrink-0 w-8 h-8 bg-indigo-500 text-white rounded-full flex items-center justify-center text-sm font-bold mr-4",children:be+1}),a.jsx("div",{className:"text-lg text-indigo-900 leading-relaxed",children:P(de,"text-lg text-indigo-900 leading-relaxed")})]},be))})})]}),se.teachingTips&&a.jsxs("div",{className:"bg-amber-50 border-2 border-amber-200 rounded-2xl p-8 mt-8",children:[a.jsxs("h4",{className:"text-xl font-bold text-amber-700 mb-4 flex items-center",children:[a.jsx("span",{className:"text-2xl mr-3",children:"💡"}),"教學提示"]}),a.jsx("div",{className:"text-lg text-amber-800 leading-relaxed",children:P(se.teachingTips,"text-lg text-amber-800 leading-relaxed")})]})]})]});case"confusing":const he=K.data;return a.jsxs("div",{className:"max-w-5xl mx-auto",children:[ie&&K.type!=="summary"&&a.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-6 mb-8",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"text-2xl",children:"🔄"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-slate-800",children:S?"已轉換為學生友好內容":"轉換為學生友好內容"}),a.jsx("p",{className:"text-sm text-slate-600",children:S?"內容已轉換為更適合學生學習的語言和格式":"將教師導向的教案內容轉換為學生容易理解的學習材料"})]})]}),!S&&a.jsx("button",{onClick:()=>G(K),disabled:V,className:"px-6 py-3 bg-indigo-500 hover:bg-indigo-600 disabled:opacity-50 disabled:cursor-not-allowed text-white font-medium rounded-lg transition-colors flex items-center gap-2",children:V?a.jsxs(a.Fragment,{children:[a.jsx("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"轉換中..."]}):a.jsxs(a.Fragment,{children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"開始轉換"]})}),S&&a.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),"轉換完成"]})]})}),a.jsxs("div",{className:"bg-gradient-to-br from-amber-500 to-orange-500 rounded-3xl shadow-2xl p-12 text-white text-center mb-8",children:[a.jsx("div",{className:"text-6xl mb-6",children:"⚡"}),a.jsx("div",{className:"text-4xl font-bold mb-6 leading-tight",children:S&&(X!=null&&X.title)?P(X.title,"text-4xl font-bold leading-tight"):P(he.point,"text-4xl font-bold leading-tight")}),a.jsx("p",{className:"text-xl text-amber-100 leading-relaxed max-w-3xl mx-auto",children:S&&(X!=null&&X.normalizeConfusion)?X.normalizeConfusion:"避免常見錯誤，掌握正確用法"})]}),S&&X?a.jsxs("div",{className:"space-y-8 mb-8",children:[X.whyItHappens&&a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[a.jsxs("h4",{className:"text-2xl font-bold text-amber-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"🤔"}),"為什麼會有這種混淆？"]}),a.jsx("div",{className:"bg-amber-50 rounded-xl p-6 text-lg leading-relaxed text-amber-900",children:P(X.whyItHappens,"text-lg leading-relaxed text-amber-900")})]}),X.clearExplanation&&a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[a.jsxs("h4",{className:"text-2xl font-bold text-green-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"✨"}),"正確理解"]}),a.jsx("div",{className:"bg-green-50 rounded-xl p-6 text-lg leading-relaxed text-green-900",children:P(X.clearExplanation,"text-lg leading-relaxed text-green-900")})]}),X.rememberingTricks&&X.rememberingTricks.length>0&&a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[a.jsxs("h4",{className:"text-2xl font-bold text-purple-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"💡"}),"記憶小技巧"]}),a.jsx("div",{className:"bg-purple-50 rounded-xl p-6",children:a.jsx("div",{className:"space-y-4",children:X.rememberingTricks.map((de,be)=>a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"flex-shrink-0 w-8 h-8 bg-purple-500 text-white rounded-full flex items-center justify-center text-sm font-bold mr-4",children:be+1}),a.jsx("div",{className:"text-lg text-purple-900 leading-relaxed",children:P(de,"text-lg text-purple-900 leading-relaxed")})]},be))})})]}),X.practiceExamples&&X.practiceExamples.length>0&&a.jsx("div",{className:"space-y-6",children:X.practiceExamples.map((de,be)=>a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[a.jsxs("h4",{className:"text-xl font-bold text-slate-800 mb-6 text-center",children:["練習情境 ",be+1]}),a.jsxs("div",{className:"bg-slate-50 rounded-xl p-6 mb-6",children:[a.jsx("h5",{className:"text-lg font-bold text-slate-700 mb-3",children:"情境："}),a.jsx("div",{className:"text-lg text-slate-800",children:P(de.situation,"text-lg text-slate-800")})]}),a.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{className:"bg-red-50 border-3 border-red-300 rounded-2xl p-6",children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx("div",{className:"w-10 h-10 bg-red-500 text-white rounded-full flex items-center justify-center text-lg font-bold mr-3",children:"✗"}),a.jsx("h5",{className:"text-xl font-bold text-red-700",children:"錯誤想法"})]}),a.jsx("div",{className:"text-lg text-red-900 bg-white rounded-lg p-4",children:P(de.wrongThinking,"text-lg text-red-900")})]}),a.jsxs("div",{className:"bg-green-50 border-3 border-green-300 rounded-2xl p-6",children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx("div",{className:"w-10 h-10 bg-green-500 text-white rounded-full flex items-center justify-center text-lg font-bold mr-3",children:"✓"}),a.jsx("h5",{className:"text-xl font-bold text-green-700",children:"正確想法"})]}),a.jsx("div",{className:"text-lg text-green-900 bg-white rounded-lg p-4",children:P(de.rightThinking,"text-lg text-green-900")})]})]}),a.jsxs("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-xl p-6",children:[a.jsx("h5",{className:"text-lg font-bold text-blue-700 mb-3",children:"解釋："}),a.jsx("div",{className:"text-lg text-blue-900 leading-relaxed",children:P(de.explanation,"text-lg text-blue-900 leading-relaxed")})]})]},be))}),X.confidenceBooster&&a.jsxs("div",{className:"bg-gradient-to-r from-sky-50 to-indigo-50 rounded-2xl p-8",children:[a.jsxs("h4",{className:"text-2xl font-bold text-sky-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"💪"}),"給你的鼓勵"]}),a.jsx("div",{className:"text-lg leading-relaxed text-sky-900 font-medium",children:P(X.confidenceBooster,"text-lg leading-relaxed text-sky-900 font-medium")})]})]}):a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 mb-8",children:[a.jsxs("h4",{className:"text-2xl font-bold text-amber-800 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"📝"}),"詳細解釋"]}),a.jsx("div",{className:"text-lg leading-relaxed text-slate-700 bg-amber-50 rounded-xl p-6",children:P(he.clarification,"text-lg leading-relaxed text-slate-700")})]}),he.errorType&&a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 mb-8",children:[a.jsxs("h4",{className:"text-2xl font-bold text-orange-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"🎯"}),"錯誤類型"]}),a.jsx("div",{className:"bg-orange-50 rounded-xl p-6 text-lg leading-relaxed text-orange-900",children:P(he.errorType,"text-lg leading-relaxed text-orange-900")})]}),he.correctVsWrong&&he.correctVsWrong.length>0&&a.jsx("div",{className:"space-y-8 mb-8",children:he.correctVsWrong.map((de,be)=>a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[a.jsxs("h4",{className:"text-xl font-bold text-slate-800 mb-6 text-center",children:["對比例子 ",be+1]}),a.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{className:"bg-green-50 border-3 border-green-300 rounded-2xl p-6",children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx("div",{className:"w-10 h-10 bg-green-500 text-white rounded-full flex items-center justify-center text-lg font-bold mr-3",children:"✓"}),a.jsx("h5",{className:"text-xl font-bold text-green-700",children:"正確用法"})]}),a.jsx("div",{className:"text-xl font-semibold text-green-900 bg-white rounded-lg p-4",children:P(de.correct,"text-xl font-semibold text-green-900")})]}),a.jsxs("div",{className:"bg-red-50 border-3 border-red-300 rounded-2xl p-6",children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx("div",{className:"w-10 h-10 bg-red-500 text-white rounded-full flex items-center justify-center text-lg font-bold mr-3",children:"✗"}),a.jsx("h5",{className:"text-xl font-bold text-red-700",children:"錯誤用法"})]}),a.jsx("div",{className:"text-xl font-semibold text-red-900 bg-white rounded-lg p-4",children:P(de.wrong,"text-xl font-semibold text-red-900")})]})]}),a.jsxs("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-xl p-6",children:[a.jsxs("h5",{className:"text-lg font-bold text-blue-700 mb-3 flex items-center",children:[a.jsx("span",{className:"text-xl mr-2",children:"💡"}),"詳細說明"]}),a.jsx("div",{className:"text-lg text-blue-900 leading-relaxed",children:P(de.explanation,"text-lg text-blue-900 leading-relaxed")})]})]},be))}),he.commonErrors&&he.commonErrors.length>0&&a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 mb-8",children:[a.jsxs("h4",{className:"text-2xl font-bold text-red-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"⚠️"}),"常見錯誤"]}),a.jsx("div",{className:"bg-red-50 rounded-xl p-6",children:a.jsx("div",{className:"space-y-3",children:he.commonErrors.map((de,be)=>a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"flex-shrink-0 w-8 h-8 bg-red-500 text-white rounded-full flex items-center justify-center text-sm font-bold mr-4",children:be+1}),a.jsx("div",{className:"text-lg text-red-900 leading-relaxed",children:P(de,"text-lg text-red-900 leading-relaxed")})]},be))})})]}),a.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[he.preventionStrategy&&a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[a.jsxs("h4",{className:"text-2xl font-bold text-purple-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"🛡️"}),"預防策略"]}),a.jsx("div",{className:"bg-purple-50 rounded-xl p-6 text-lg leading-relaxed text-purple-900",children:P(he.preventionStrategy,"text-lg leading-relaxed text-purple-900")})]}),he.correctionMethod&&a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[a.jsxs("h4",{className:"text-2xl font-bold text-indigo-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"🔧"}),"糾正方法"]}),a.jsx("div",{className:"bg-indigo-50 rounded-xl p-6 text-lg leading-relaxed text-indigo-900",children:P(he.correctionMethod,"text-lg leading-relaxed text-indigo-900")})]})]}),he.practiceActivities&&he.practiceActivities.length>0&&a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 mt-8",children:[a.jsxs("h4",{className:"text-2xl font-bold text-cyan-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"🏃‍♂️"}),"練習建議"]}),a.jsx("div",{className:"bg-cyan-50 rounded-xl p-6",children:a.jsx("div",{className:"space-y-4",children:he.practiceActivities.map((de,be)=>a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"flex-shrink-0 w-8 h-8 bg-cyan-500 text-white rounded-full flex items-center justify-center text-sm font-bold mr-4",children:be+1}),a.jsx("div",{className:"text-lg text-cyan-900 leading-relaxed",children:P(de,"text-lg text-cyan-900 leading-relaxed")})]},be))})})]})]});case"summary":return a.jsxs("div",{className:"text-center space-y-8",children:[a.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-2xl p-12",children:[a.jsx("div",{className:"text-6xl mb-6",children:"🎉"}),a.jsx("h3",{className:"text-3xl font-bold text-green-700 mb-4",children:"恭喜完成學習！"}),a.jsxs("p",{className:"text-lg text-slate-600 mb-8",children:["你已經完成了「",i.topic,"」的互動學習"]}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mb-8",children:[a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-md",children:[a.jsx("div",{className:"text-3xl text-indigo-600 mb-2",children:"📚"}),a.jsx("div",{className:"text-2xl font-bold text-slate-800",children:h.progress.completedObjectives.length}),a.jsx("div",{className:"text-sm text-slate-600",children:"學習目標完成"})]}),a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-md",children:[a.jsx("div",{className:"text-3xl text-sky-600 mb-2",children:"⏱️"}),a.jsx("div",{className:"text-2xl font-bold text-slate-800",children:Math.round((Date.now()-h.progress.startTime)/6e4)}),a.jsx("div",{className:"text-sm text-slate-600",children:"分鐘學習時間"})]}),a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-md",children:[a.jsx("div",{className:"text-3xl text-green-600 mb-2",children:"🎯"}),a.jsx("div",{className:"text-2xl font-bold text-slate-800",children:h.progress.interactionCount}),a.jsx("div",{className:"text-sm text-slate-600",children:"互動次數"})]})]})]}),a.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-indigo-50 rounded-2xl p-8",children:[a.jsx("h4",{className:"text-2xl font-semibold text-purple-700 mb-6",children:"🚀 繼續你的學習旅程"}),a.jsxs("div",{className:"flex flex-wrap justify-center gap-4",children:[i.onlineInteractiveQuiz&&a.jsxs("a",{href:n?`/ai-page-gen/quiz?binId=${n}`:`/ai-page-gen/quiz?contentId=${e}`,className:"px-8 py-4 bg-orange-500 text-white font-medium rounded-xl hover:bg-orange-600 transition-colors flex items-center gap-3 text-lg",target:"_blank",rel:"noopener noreferrer",children:[a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"挑戰互動測驗"]}),i.writingPractice&&a.jsxs("a",{href:n?`/ai-page-gen/writing?binId=${n}`:`/ai-page-gen/writing?contentId=${e}`,className:"px-8 py-4 bg-purple-500 text-white font-medium rounded-xl hover:bg-purple-600 transition-colors flex items-center gap-3 text-lg",target:"_blank",rel:"noopener noreferrer",children:[a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),"練習寫作技能"]})]})]})]});default:return a.jsx("div",{children:"未知步驟類型"})}};return a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-100 via-sky-50 to-indigo-100",children:[a.jsx("div",{className:"sticky top-0 z-10 bg-white/90 backdrop-blur-sm border-b border-slate-200",children:a.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-bold text-slate-800",children:i.topic}),a.jsxs("p",{className:"text-sm text-slate-600",children:["互動學習 • 第 ",v+1," 步，共 ",w.length," 步"]})]}),a.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),Math.round((Date.now()-h.progress.startTime)/6e4)," 分鐘"]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2",children:a.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-sky-500 h-2 rounded-full transition-all duration-500 ease-out",style:{width:`${(v+1)/w.length*100}%`}})}),a.jsx("div",{className:"flex items-center gap-2 overflow-x-auto pb-1",children:w.map((X,S)=>{const V=X.type==="objective",ie=X.type==="breakdown",_=X.type==="confusing",ve=X.type==="summary";return a.jsx("button",{onClick:()=>R(S),className:`
                      flex-shrink-0 w-8 h-8 rounded-full text-xs font-bold transition-all duration-200
                      ${S===v?"bg-indigo-500 text-white shadow-lg scale-110":S<v?"bg-green-400 text-white hover:bg-green-500":"bg-slate-300 text-slate-600 hover:bg-slate-400"}
                    `,title:X.title,children:V?(X.index||0)+1:ie?"📖":_?"⚡":ve?"🏆":S+1},X.id)})}),a.jsx("div",{className:"text-center",children:a.jsxs("span",{className:"text-xs text-slate-500",children:[K.type==="objective"&&"📚 學習目標",K.type==="breakdown"&&"🔍 深度學習",K.type==="confusing"&&"⚡ 易混淆點",K.type==="summary"&&"🎯 學習成果"]})})]})]})}),a.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"text-5xl mb-4",children:K.icon}),a.jsx("h2",{className:"text-3xl font-bold text-slate-800 mb-2",children:K.title}),a.jsx("div",{className:"text-lg text-slate-600",children:P(K.description,"text-lg text-slate-600")})]}),a.jsx("div",{className:"mb-8",children:pe()}),a.jsxs("div",{className:"flex items-center justify-between pt-8 border-t border-slate-200",children:[a.jsxs("button",{onClick:B,disabled:v===0,className:"flex items-center gap-2 px-6 py-3 bg-slate-500 text-white font-medium rounded-lg hover:bg-slate-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})}),"上一步"]}),a.jsx("div",{className:"text-center",children:a.jsxs("p",{className:"text-sm text-slate-600",children:[v+1," / ",w.length]})}),a.jsxs("button",{onClick:q,disabled:v===w.length-1,className:"flex items-center gap-2 px-6 py-3 bg-indigo-500 text-white font-medium rounded-lg hover:bg-indigo-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:["下一步",a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})]})]})]})]})};class sR{constructor(){this.dbName="InteractiveContentDB",this.version=1,this.db=null}async init(){if(!this.db)return new Promise((e,n)=>{const i=indexedDB.open(this.dbName,this.version);i.onerror=()=>{n(new Error("Failed to open InteractiveContent database"))},i.onsuccess=()=>{this.db=i.result,e()},i.onupgradeneeded=l=>{const o=l.target.result;if(!o.objectStoreNames.contains("interactiveContent")){const u=o.createObjectStore("interactiveContent",{keyPath:"lessonPlanId"});u.createIndex("topic","topic",{unique:!1}),u.createIndex("lastAccessedAt","lastAccessedAt",{unique:!1})}}})}ensureDB(){if(!this.db)throw new Error("Database not initialized. Call init() first.");return this.db}async saveVersion(e,n,i,l,o,u){const f=this.ensureDB(),g=`version_${Date.now()}`,h=new Date().toISOString();return new Promise((x,v)=>{const w=f.transaction(["interactiveContent"],"readwrite").objectStore("interactiveContent"),C=w.get(e);C.onsuccess=()=>{const j=C.result,k={id:g,name:o||`版本 ${h.slice(0,19).replace("T"," ")}`,description:u,createdAt:h,lastModifiedAt:h,transformedData:i,selectedSteps:l},E={lessonPlanId:e,topic:n,versions:j?[...j.versions,k]:[k],lastAccessedAt:h},L=w.put(E);L.onsuccess=()=>{x(g)},L.onerror=()=>{v(new Error("Failed to save interactive content version"))}},C.onerror=()=>{v(new Error("Failed to get existing interactive content"))}})}async getVersions(e){const n=this.ensureDB();return new Promise((i,l)=>{const f=n.transaction(["interactiveContent"],"readonly").objectStore("interactiveContent").get(e);f.onsuccess=()=>{const g=f.result;i(g?g.versions:[])},f.onerror=()=>{l(new Error("Failed to get interactive content versions"))}})}async getVersion(e,n){return(await this.getVersions(e)).find(l=>l.id===n)||null}async updateVersion(e,n,i){const l=this.ensureDB();return new Promise((o,u)=>{const g=l.transaction(["interactiveContent"],"readwrite").objectStore("interactiveContent"),h=g.get(e);h.onsuccess=()=>{const x=h.result;if(!x){u(new Error("Interactive content record not found"));return}const v=x.versions.findIndex(w=>w.id===n);if(v===-1){u(new Error("Version not found"));return}x.versions[v]={...x.versions[v],...i,lastModifiedAt:new Date().toISOString()};const N=g.put(x);N.onsuccess=()=>o(),N.onerror=()=>u(new Error("Failed to update version"))},h.onerror=()=>{u(new Error("Failed to get interactive content"))}})}async deleteVersion(e,n){const i=this.ensureDB();return new Promise((l,o)=>{const f=i.transaction(["interactiveContent"],"readwrite").objectStore("interactiveContent"),g=f.get(e);g.onsuccess=()=>{const h=g.result;if(!h){o(new Error("Interactive content record not found"));return}if(h.versions=h.versions.filter(x=>x.id!==n),h.versions.length===0){const x=f.delete(e);x.onsuccess=()=>l(),x.onerror=()=>o(new Error("Failed to delete record"))}else{const x=f.put(h);x.onsuccess=()=>l(),x.onerror=()=>o(new Error("Failed to update record"))}},g.onerror=()=>{o(new Error("Failed to get interactive content"))}})}async getAllRecords(){const e=this.ensureDB();return new Promise((n,i)=>{const u=e.transaction(["interactiveContent"],"readonly").objectStore("interactiveContent").getAll();u.onsuccess=()=>{n(u.result)},u.onerror=()=>{i(new Error("Failed to get all interactive content records"))}})}async updateLastAccessed(e){const n=this.ensureDB();return new Promise((i,l)=>{const u=n.transaction(["interactiveContent"],"readwrite").objectStore("interactiveContent"),f=u.get(e);f.onsuccess=()=>{const g=f.result;if(g){g.lastAccessedAt=new Date().toISOString();const h=u.put(g);h.onsuccess=()=>i(),h.onerror=()=>l(new Error("Failed to update last accessed time"))}else i()},f.onerror=()=>{l(new Error("Failed to get interactive content"))}})}}const gi=new sR,aR=()=>{var Ni;const[t]=jr(),e=t.get("contentId"),n=t.get("binId"),[i,l]=M.useState(null),[o,u]=M.useState(!0),[f,g]=M.useState(null),[h,x]=M.useState(0),[v,N]=M.useState([]),[w,C]=M.useState({}),[j,k]=M.useState("idle"),[E,L]=M.useState(""),[D,O]=M.useState("idle"),[H,I]=M.useState({current:0,total:0}),[R,q]=M.useState(new Set),[B,ee]=M.useState([]),[G,Y]=M.useState(null),[z,$]=M.useState(!1),[Q,P]=M.useState("");M.useEffect(()=>{K()},[e,n]);const K=async()=>{try{u(!0),g(null);let fe;if(n)fe=await ac(n);else if(e){await zt.init();const Z=await zt.getLessonPlan(e);if(!Z)throw new Error("找不到指定的教案");fe={topic:Z.topic,learningObjectives:Z.content.learningObjectives,contentBreakdown:Z.content.contentBreakdown,confusingPoints:Z.content.confusingPoints,classroomActivities:Z.content.classroomActivities,onlineInteractiveQuiz:Z.content.quiz,writingPractice:Z.content.writingPractice}}else throw new Error("缺少必要參數：contentId 或 binId");l(fe),pe(fe),e&&await be(e)}catch(fe){console.error("載入內容失敗:",fe),g(fe.message||"載入內容時發生錯誤")}finally{u(!1)}},pe=fe=>{const Z=[],te={};fe.learningObjectives&&fe.learningObjectives.length>0&&fe.learningObjectives.forEach((J,oe)=>{const ge=`objective_${oe}`;Z.push({id:ge,title:`學習目標 ${oe+1}`,type:"objective",icon:"🎯",data:J,index:oe}),te[ge]={original:J,transformed:null,isTransformed:!1,isTransforming:!1,quiz:null,hasQuiz:!1,isGeneratingQuiz:!1}}),fe.contentBreakdown&&fe.contentBreakdown.length>0&&fe.contentBreakdown.forEach((J,oe)=>{const ge=`breakdown_${oe}`;Z.push({id:ge,title:`深度學習 ${oe+1}`,type:"breakdown",icon:"📖",data:J,index:oe}),te[ge]={original:J,transformed:null,isTransformed:!1,isTransforming:!1,quiz:null,hasQuiz:!1,isGeneratingQuiz:!1}}),fe.confusingPoints&&fe.confusingPoints.length>0&&fe.confusingPoints.forEach((J,oe)=>{const ge=`confusing_${oe}`;Z.push({id:ge,title:`易混淆點 ${oe+1}`,type:"confusing",icon:"⚡",data:J,index:oe}),te[ge]={original:J,transformed:null,isTransformed:!1,isTransforming:!1,quiz:null,hasQuiz:!1,isGeneratingQuiz:!1}}),N(Z),C(te)},X=()=>localStorage.getItem("gemini_api_key")||"",S=async fe=>{const Z=X();if(!Z){alert("請先設定 Gemini API 金鑰");return}const te=v.find(J=>J.id===fe);if(te){C(J=>({...J,[fe]:{...J[fe],isTransforming:!0}}));try{let J=null;switch(te.type){case"objective":J=await Mo(te.data,Z);break;case"breakdown":J=await Ro(te.data,Z);break;case"confusing":J=await Io(te.data,Z);break}C(oe=>({...oe,[fe]:{...oe[fe],transformed:J,isTransformed:!0,isTransforming:!1}}))}catch(J){console.error("轉換失敗:",J),C(oe=>({...oe,[fe]:{...oe[fe],isTransforming:!1}})),alert("轉換失敗，請重試")}}},V=fe=>{C(Z=>({...Z,[fe]:{...Z[fe],transformed:null,isTransformed:!1,quiz:null,hasQuiz:!1}}))},ie=async fe=>{const Z=X();if(!Z){alert("請先設定 Gemini API 金鑰");return}const te=parseInt(fe.replace("step_","")),J=v[te],oe=w[fe];if(console.log("生成測驗 - stepId:",fe,"stepIndex:",te,"step:",J,"transformation:",oe),!J||!(oe!=null&&oe.isTransformed)||!oe.transformed){console.error("測驗生成條件檢查失敗:",{step:!!J,isTransformed:oe==null?void 0:oe.isTransformed,hasTransformed:!!(oe!=null&&oe.transformed)}),alert("請先轉換內容後再生成測驗");return}C(ge=>({...ge,[fe]:{...ge[fe],isGeneratingQuiz:!0}}));try{const ge={trueFalse:3,multipleChoice:3,memoryCardGame:1},Ne=await Qj(oe.transformed,J.type,Z,ge);C(Ee=>({...Ee,[fe]:{...Ee[fe],quiz:Ne,hasQuiz:!0,isGeneratingQuiz:!1}}))}catch(ge){console.error("測驗生成失敗:",ge),C(Ne=>({...Ne,[fe]:{...Ne[fe],isGeneratingQuiz:!1}})),alert("測驗生成失敗，請重試")}},_=fe=>{C(Z=>({...Z,[fe]:{...Z[fe],quiz:null,hasQuiz:!1}}))},ve=async()=>{var te;if(!i)return;const fe=localStorage.getItem("gemini_api_key");if(!fe){alert("請先設定 Gemini API Key");return}O("running");const Z=v.length;I({current:0,total:Z});try{for(let J=0;J<v.length;J++){const oe=v[J],ge=`step_${J}`;if(I({current:J+1,total:Z,currentStep:oe.title}),!((te=w[ge])!=null&&te.isTransformed)){C(Ne=>({...Ne,[ge]:{...Ne[ge],isTransforming:!0}}));try{let Ne;switch(oe.type){case"objective":Ne=await Mo(oe.data,fe);break;case"breakdown":Ne=await Ro(oe.data,fe);break;case"confusing":Ne=await Io(oe.data,fe);break}C(Ee=>({...Ee,[ge]:{...Ee[ge],transformed:Ne,isTransformed:!0,isTransforming:!1}}))}catch(Ne){console.error(`轉換步驟 ${oe.title} 失敗:`,Ne),C(Ee=>({...Ee,[ge]:{...Ee[ge],isTransforming:!1}}))}await new Promise(Ne=>setTimeout(Ne,500))}}O("completed")}catch(J){console.error("批次轉換失敗:",J),O("error")}},Se=fe=>{q(Z=>{const te=new Set(Z);return te.has(fe)?te.delete(fe):te.add(fe),te})},se=()=>{const fe=v.map((Z,te)=>`step_${te}`);q(new Set(fe))},he=()=>{q(new Set)},de=async()=>{var te;if(!i||R.size===0){alert("請先選擇要轉換的步驟");return}const fe=localStorage.getItem("gemini_api_key");if(!fe){alert("請先設定 Gemini API Key");return}O("running");const Z=R.size;I({current:0,total:Z});try{let J=0;for(let oe=0;oe<v.length;oe++){const ge=v[oe],Ne=`step_${oe}`;if(R.has(Ne)&&(J++,I({current:J,total:Z,currentStep:ge.title}),!((te=w[Ne])!=null&&te.isTransformed))){C(Ee=>({...Ee,[Ne]:{...Ee[Ne],isTransforming:!0}}));try{let Ee;switch(ge.type){case"objective":Ee=await Mo(ge.data,fe);break;case"breakdown":Ee=await Ro(ge.data,fe);break;case"confusing":Ee=await Io(ge.data,fe);break}C(Ke=>({...Ke,[Ne]:{...Ke[Ne],transformed:Ee,isTransformed:!0,isTransforming:!1}}))}catch(Ee){console.error(`轉換步驟 ${ge.title} 失敗:`,Ee),C(Ke=>({...Ke,[Ne]:{...Ke[Ne],isTransforming:!1}}))}await new Promise(Ee=>setTimeout(Ee,500))}}O("completed")}catch(J){console.error("批次轉換失敗:",J),O("error")}},be=async fe=>{try{await gi.init();const Z=await gi.getVersions(fe);ee(Z)}catch(Z){console.error("載入現有版本失敗:",Z)}},Ve=async()=>{if(!i||!e)return;const fe={},Z={};if(Object.entries(w).forEach(([te,J])=>{J.isTransformed&&J.transformed&&(fe[te]=J.transformed),J.hasQuiz&&J.quiz&&(Z[te]=J.quiz)}),Object.keys(fe).length===0){alert("請先轉換一些內容再保存版本");return}try{await gi.init();const te=Q||`版本 ${new Date().toLocaleString("zh-TW")}`,J={transformedData:fe,quizData:Z},oe=await gi.saveVersion(e,i.topic||"無標題教案",J,Array.from(R),te,`包含 ${Object.keys(fe).length} 個已轉換步驟，${Object.keys(Z).length} 個測驗`);P(""),await be(e),alert("版本保存成功！")}catch(te){console.error("保存版本失敗:",te),alert("保存版本失敗，請重試")}},Ze=async fe=>{var Z,te;if(e)try{await gi.init();const J=await gi.getVersion(e,fe);if(J){C({});const oe={};v.forEach((Ee,Ke)=>{const ot=`step_${Ke}`;oe[ot]={original:Ee.data,transformed:null,isTransformed:!1,isTransforming:!1,quiz:null,hasQuiz:!1,isGeneratingQuiz:!1}});const ge=((Z=J.transformedData)==null?void 0:Z.transformedData)||J.transformedData,Ne=((te=J.transformedData)==null?void 0:te.quizData)||{};Object.entries(ge||{}).forEach(([Ee,Ke])=>{oe[Ee]&&(oe[Ee]={...oe[Ee],transformed:Ke,isTransformed:!0})}),Object.entries(Ne||{}).forEach(([Ee,Ke])=>{oe[Ee]&&(oe[Ee]={...oe[Ee],quiz:Ke,hasQuiz:!0})}),C(oe),q(new Set(J.selectedSteps)),Y(fe),$(!1),await gi.updateLastAccessed(e)}}catch(J){console.error("載入版本失敗:",J),alert("載入版本失敗，請重試")}},ut=async fe=>{if(!e)return;const Z=B.find(te=>te.id===fe);if(Z&&confirm(`確定要刪除版本「${Z.name}」嗎？此操作無法復原。`))try{await gi.init(),await gi.deleteVersion(e,fe),await be(e),G===fe&&Y(null)}catch(te){console.error("刪除版本失敗:",te),alert("刪除版本失敗，請重試")}},gt=fe=>fe?[/#+\s/,/\*\*.*\*\*/,/\*.*\*/,/`.*`/,/^\s*[-*+]\s/m,/^\s*\d+\.\s/m,/\[.*\]\(.*\)/,/^\s*>/m,/```[\s\S]*?```/,/\n\s*\n/].some(te=>te.test(fe)):!1,Je=(fe,Z)=>gt(fe)?a.jsx(Mm,{content:fe,className:Z}):a.jsx("span",{className:Z,children:fe}),Gt=async()=>{if(i){k("publishing");try{const fe={},Z={},te={};if(Object.entries(w).forEach(([Ne,Ee])=>{if(Ee.isTransformed&&Ee.transformed){fe[Ne]=Ee.transformed,Ee.hasQuiz&&Ee.quiz&&(Z[Ne]=Ee.quiz);const Ke=parseInt(Ne.replace("step_","")),ot=v[Ke];if(ot)switch(ot.type){case"objective":te.learningObjectives||(te.learningObjectives=[]),te.learningObjectives.push(ot.data);break;case"breakdown":te.contentBreakdown||(te.contentBreakdown=[]),te.contentBreakdown.push(ot.data);break;case"confusing":te.confusingPoints||(te.confusingPoints=[]),te.confusingPoints.push(ot.data);break}}}),Object.keys(fe).length===0){alert("請先轉換一些內容再發布"),k("idle");return}const J={...te,topic:i.topic,isInteractive:!0,transformedData:fe,stepQuizData:Z,includedSteps:Object.keys(fe)},oe=await Qo(J),ge=`${window.location.origin}/ai-page-gen/student-interactive?binId=${oe}`;L(ge),k("published")}catch(fe){console.error("發布失敗:",fe),k("error")}}},xn=fe=>{x(fe)},Rt=()=>{h<v.length-1&&x(h+1)},wi=()=>{h>0&&x(h-1)};if(o)return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-100 via-sky-50 to-indigo-100 py-8 px-4 sm:px-6 lg:px-8",children:a.jsx("div",{className:"flex justify-center items-center min-h-[50vh]",children:a.jsx(sn,{})})});if(f)return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-100 via-sky-50 to-indigo-100 py-8 px-4 sm:px-6 lg:px-8",children:a.jsx("div",{className:"max-w-4xl mx-auto",children:a.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg shadow-md",children:[a.jsx("h3",{className:"font-bold text-lg mb-2",children:"載入錯誤"}),a.jsx("p",{children:f})]})})});if(!i||v.length===0)return null;const $e=v[h],ei=`step_${h}`,Qe=w[ei]||{original:$e==null?void 0:$e.data,transformed:null,isTransformed:!1},Bn=Object.values(w).filter(fe=>fe.isTransformed).length,ln=v.length;return a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-100 via-sky-50 to-indigo-100",children:[a.jsx("div",{className:"sticky top-0 z-10 bg-white/90 backdrop-blur-sm border-b border-slate-200",children:a.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-bold text-slate-800",children:"互動教材準備"}),a.jsx("h2",{className:"text-lg font-semibold text-indigo-600",children:i.topic}),a.jsxs("p",{className:"text-sm text-slate-600",children:["第 ",h+1," 步，共 ",ln," 步 • 已轉換：",Bn,"/",ln]})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[D==="running"&&a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("svg",{className:"w-4 h-4 text-blue-600 animate-spin",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),a.jsx("span",{className:"text-blue-800 font-medium",children:"批次轉換進行中..."})]}),a.jsx("div",{className:"text-xs text-blue-700",children:H.currentStep&&`正在轉換：${H.currentStep}`}),a.jsx("div",{className:"mt-1 bg-blue-200 rounded-full h-1",children:a.jsx("div",{className:"bg-blue-600 h-1 rounded-full transition-all duration-300",style:{width:`${H.current/H.total*100}%`}})})]}),D==="completed"&&a.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),a.jsx("span",{className:"text-green-800 font-medium text-sm",children:"批次轉換完成！"})]})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:de,disabled:D==="running"||R.size===0,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-medium rounded-lg transition-colors flex items-center gap-2",children:D==="running"?a.jsxs(a.Fragment,{children:[a.jsx("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"轉換中..."]}):a.jsxs(a.Fragment,{children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"轉換選中項目 (",R.size,")"]})}),a.jsx("button",{onClick:ve,disabled:D==="running"||Bn===ln,className:"px-3 py-2 bg-indigo-600 hover:bg-indigo-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-medium rounded-lg transition-colors flex items-center gap-2 text-sm",children:Bn===ln?"全部已轉換":"全部轉換"})]}),j==="published"&&a.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),a.jsx("span",{className:"text-green-800 font-medium",children:"已發布成功！"})]}),a.jsx("div",{className:"text-xs text-green-700",children:a.jsx("a",{href:E,target:"_blank",rel:"noopener noreferrer",className:"underline hover:no-underline",children:"查看學生學習頁面"})})]}),a.jsx("button",{onClick:Gt,disabled:j==="publishing"||Bn===0,className:"px-6 py-3 bg-green-600 hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-medium rounded-lg transition-colors flex items-center gap-2",children:j==="publishing"?a.jsxs(a.Fragment,{children:[a.jsx("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"發布中..."]}):a.jsxs(a.Fragment,{children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})}),"發布互動教材"]})})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2",children:a.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-sky-500 h-2 rounded-full transition-all duration-500 ease-out",style:{width:`${(h+1)/ln*100}%`}})}),a.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:se,className:"text-xs text-indigo-600 hover:text-indigo-800 font-medium",children:"全選"}),a.jsx("span",{className:"text-slate-300",children:"|"}),a.jsx("button",{onClick:he,className:"text-xs text-slate-600 hover:text-slate-800 font-medium",children:"全不選"})]}),a.jsxs("div",{className:"text-xs text-slate-500",children:["已選擇 ",R.size," / ",v.length," 個步驟"]}),a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[B.length>0&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"text-slate-500",children:"版本:"}),a.jsx("button",{onClick:()=>$(!z),className:"text-indigo-600 hover:text-indigo-800 font-medium",children:G?((Ni=B.find(fe=>fe.id===G))==null?void 0:Ni.name)||"選擇版本":`${B.length} 個可用`})]}),a.jsx("input",{type:"text",placeholder:"版本名稱",value:Q,onChange:fe=>P(fe.target.value),className:"px-2 py-1 text-xs border border-slate-300 rounded w-20"}),a.jsx("button",{onClick:Ve,className:"text-green-600 hover:text-green-800 font-medium",children:"保存版本"})]})]}),a.jsx("div",{className:"flex items-center gap-2 overflow-x-auto pb-1",children:v.map((fe,Z)=>{var J,oe,ge,Ne,Ee,Ke,ot,Vt,Nt,Jt;const te=`step_${Z}`;return a.jsx("div",{className:`
                      flex-shrink-0 p-2 rounded-lg border transition-all duration-200 bg-white
                      ${Z===h?"border-indigo-500 bg-indigo-50":(J=w[te])!=null&&J.isTransformed?"border-green-200 bg-green-50":"border-slate-200"}
                    `,children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:R.has(te),onChange:()=>Se(te),className:"w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),a.jsxs("button",{onClick:()=>xn(Z),className:"flex items-center gap-1 text-xs font-medium hover:text-indigo-600 transition-colors",children:[a.jsx("span",{children:fe.icon}),a.jsx("span",{children:fe.title}),((oe=w[te])==null?void 0:oe.isTransformed)&&a.jsx("svg",{className:"w-3 h-3 text-green-600",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})]}),(ge=w[te])!=null&&ge.isTransformed?a.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[a.jsx("button",{onClick:()=>S(te),className:"text-xs text-blue-600 hover:text-blue-800 font-medium px-1 py-0.5 rounded hover:bg-blue-50",title:"重新轉換",children:"🔄"}),a.jsx("button",{onClick:()=>V(te),className:"text-xs text-red-600 hover:text-red-800 font-medium px-1 py-0.5 rounded hover:bg-red-50",title:"重置",children:"🗑️"}),(Ne=w[te])!=null&&Ne.hasQuiz?a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"text-xs text-orange-600",title:"已生成測驗",children:"🧠"}),a.jsx("button",{onClick:()=>ie(te),disabled:(Ee=w[te])==null?void 0:Ee.isGeneratingQuiz,className:"text-xs text-orange-600 hover:text-orange-800 font-medium px-1 py-0.5 rounded hover:bg-orange-50",title:"重新生成測驗",children:(Ke=w[te])!=null&&Ke.isGeneratingQuiz?"⏳":"🔄"}),a.jsx("button",{onClick:()=>_(te),className:"text-xs text-red-600 hover:text-red-800 font-medium px-1 py-0.5 rounded hover:bg-red-50",title:"刪除測驗",children:"🗑️"})]}):a.jsx("button",{onClick:()=>ie(te),disabled:(ot=w[te])==null?void 0:ot.isGeneratingQuiz,className:"text-xs text-orange-600 hover:text-orange-800 font-medium px-1 py-0.5 rounded hover:bg-orange-50 disabled:opacity-50",title:"生成測驗",children:(Vt=w[te])!=null&&Vt.isGeneratingQuiz?"⏳":"🧠"})]}):a.jsx("button",{onClick:()=>S(te),disabled:(Nt=w[te])==null?void 0:Nt.isTransforming,className:"text-xs text-green-600 hover:text-green-800 font-medium px-2 py-0.5 rounded hover:bg-green-50 disabled:opacity-50 ml-2",children:(Jt=w[te])!=null&&Jt.isTransforming?"⏳":"▶️"})]})},fe.id)})}),z&&B.length>0&&a.jsxs("div",{className:"mt-4 p-4 bg-slate-50 rounded-lg border",children:[a.jsx("h3",{className:"text-sm font-medium text-slate-800 mb-3",children:"選擇版本載入"}),a.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:B.map(fe=>a.jsxs("div",{className:"flex items-center justify-between p-2 bg-white rounded border hover:bg-slate-50",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-medium",children:fe.name}),G===fe.id&&a.jsx("span",{className:"px-2 py-1 bg-indigo-100 text-indigo-800 text-xs rounded",children:"當前"})]}),a.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:[fe.description," • ",new Date(fe.createdAt).toLocaleString("zh-TW")]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>Ze(fe.id),className:"text-xs text-indigo-600 hover:text-indigo-800 font-medium",children:"載入"}),a.jsx("button",{onClick:()=>ut(fe.id),className:"text-xs text-red-600 hover:text-red-800 font-medium",children:"刪除"})]})]},fe.id))}),a.jsx("button",{onClick:()=>$(!1),className:"mt-3 text-xs text-slate-600 hover:text-slate-800",children:"關閉"})]})]})]})}),a.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"text-5xl mb-4",children:$e.icon}),a.jsx("h2",{className:"text-3xl font-bold text-slate-800 mb-2",children:$e.title}),a.jsxs("p",{className:"text-lg text-slate-600",children:[$e.type==="objective"&&"將學習目標轉換為學生友好的語言",$e.type==="breakdown"&&"將內容分解轉換為易懂的學習材料",$e.type==="confusing"&&"將易混淆點轉換為支持性指導"]})]}),a.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-6 mb-8",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"text-2xl",children:Qe.isTransformed?"✅":"🔄"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-slate-800",children:Qe.isTransformed?"已完成轉換":"準備轉換內容"}),a.jsx("p",{className:"text-sm text-slate-600",children:Qe.isTransformed?"內容已轉換為學生友好格式，可以進行預覽或重新轉換":"點擊轉換按鈕將教師導向內容轉換為學生友好格式"})]})]}),a.jsx("div",{className:"text-sm text-slate-500",children:"使用上方導航欄中的控制按鈕進行轉換操作"})]})}),a.jsxs("div",{className:"grid lg:grid-cols-2 gap-8 mb-8",children:[a.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[a.jsxs("h3",{className:"text-lg font-bold text-slate-800 mb-4 flex items-center gap-2",children:[a.jsx("span",{children:"📄"}),"原始內容（教師導向）"]}),a.jsxs("div",{className:"bg-slate-50 rounded-xl p-4 text-sm text-slate-700 max-h-96 overflow-y-auto",children:[$e.type==="objective"&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("strong",{children:"目標："})," ",Je($e.data.objective)]}),$e.data.description&&a.jsxs("div",{children:[a.jsx("strong",{children:"描述："})," ",Je($e.data.description)]}),$e.data.teachingExample&&a.jsxs("div",{children:[a.jsx("strong",{children:"教學範例："})," ",Je($e.data.teachingExample)]})]}),$e.type==="breakdown"&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("strong",{children:"主題："})," ",Je($e.data.topic)]}),$e.data.details&&a.jsxs("div",{children:[a.jsx("strong",{children:"詳細說明："})," ",Je($e.data.details)]}),$e.data.teachingExample&&a.jsxs("div",{children:[a.jsx("strong",{children:"教學範例："})," ",Je($e.data.teachingExample)]})]}),$e.type==="confusing"&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("strong",{children:"易混淆點："})," ",Je($e.data.point)]}),$e.data.clarification&&a.jsxs("div",{children:[a.jsx("strong",{children:"澄清說明："})," ",Je($e.data.clarification)]}),$e.data.teachingExample&&a.jsxs("div",{children:[a.jsx("strong",{children:"教學範例："})," ",Je($e.data.teachingExample)]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[a.jsxs("h3",{className:"text-lg font-bold text-slate-800 mb-4 flex items-center gap-2",children:[a.jsx("span",{children:"✨"}),"轉換後內容（學生友好）"]}),a.jsx("div",{className:"bg-gradient-to-br from-green-50 to-blue-50 rounded-xl p-4 text-sm max-h-96 overflow-y-auto",children:Qe.isTransformed&&Qe.transformed?a.jsxs("div",{className:"space-y-4",children:[$e.type==="objective"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"text-green-800",children:[a.jsx("strong",{children:"學習目標："}),a.jsx("div",{className:"mt-1",children:Je(Qe.transformed.objective)})]}),Qe.transformed.description&&a.jsxs("div",{className:"text-blue-800",children:[a.jsx("strong",{children:"為什麼要學："}),a.jsx("div",{className:"mt-1",children:Je(Qe.transformed.description)})]}),Qe.transformed.personalRelevance&&a.jsxs("div",{className:"text-purple-800",children:[a.jsx("strong",{children:"對你的意義："}),a.jsx("div",{className:"mt-1",children:Je(Qe.transformed.personalRelevance)})]}),Qe.transformed.encouragement&&a.jsxs("div",{className:"text-sky-800",children:[a.jsx("strong",{children:"給你的鼓勵："}),a.jsx("div",{className:"mt-1",children:Je(Qe.transformed.encouragement)})]})]}),$e.type==="breakdown"&&a.jsxs(a.Fragment,{children:[Qe.transformed.title&&a.jsxs("div",{className:"text-green-800",children:[a.jsx("strong",{children:"學習主題："}),a.jsx("div",{className:"mt-1",children:Je(Qe.transformed.title)})]}),Qe.transformed.introduction&&a.jsxs("div",{className:"text-blue-800",children:[a.jsx("strong",{children:"開始學習："}),a.jsx("div",{className:"mt-1",children:Je(Qe.transformed.introduction)})]}),Qe.transformed.keyPoints&&a.jsxs("div",{className:"text-indigo-800",children:[a.jsx("strong",{children:"重點概念："}),a.jsx("div",{className:"mt-1 space-y-1",children:Qe.transformed.keyPoints.map((fe,Z)=>a.jsxs("div",{children:["• ",Je(fe)]},Z))})]})]}),$e.type==="confusing"&&a.jsxs(a.Fragment,{children:[Qe.transformed.title&&a.jsxs("div",{className:"text-amber-800",children:[a.jsx("strong",{children:"容易困惑的地方："}),a.jsx("div",{className:"mt-1",children:Je(Qe.transformed.title)})]}),Qe.transformed.normalizeConfusion&&a.jsxs("div",{className:"text-green-800",children:[a.jsx("strong",{children:"別擔心："}),a.jsx("div",{className:"mt-1",children:Je(Qe.transformed.normalizeConfusion)})]}),Qe.transformed.clearExplanation&&a.jsxs("div",{className:"text-blue-800",children:[a.jsx("strong",{children:"正確理解："}),a.jsx("div",{className:"mt-1",children:Je(Qe.transformed.clearExplanation)})]})]})]}):a.jsxs("div",{className:"text-slate-500 text-center py-8",children:[a.jsx("div",{className:"text-4xl mb-4",children:"🔄"}),a.jsx("p",{children:"使用上方導航欄中的 ▶️ 按鈕來生成學生友好的內容"})]})})]})]}),a.jsxs("div",{className:"flex items-center justify-between pt-8 border-t border-slate-200",children:[a.jsxs("button",{onClick:wi,disabled:h===0,className:"flex items-center gap-2 px-6 py-3 bg-slate-500 text-white font-medium rounded-lg hover:bg-slate-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})}),"上一步"]}),a.jsx("div",{className:"text-center",children:a.jsxs("p",{className:"text-sm text-slate-600",children:[h+1," / ",ln]})}),a.jsxs("button",{onClick:Rt,disabled:h===v.length-1,className:"flex items-center gap-2 px-6 py-3 bg-indigo-500 text-white font-medium rounded-lg hover:bg-indigo-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:["下一步",a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})]})]})]})]})},lR=()=>{const[t]=jr(),e=t.get("binId"),[n,i]=M.useState(null),[l,o]=M.useState(!0),[u,f]=M.useState(null),[g,h]=M.useState(null),[x,v]=M.useState(0),[N,w]=M.useState([]),[C,j]=M.useState(!1),[k,E]=M.useState(null);M.useEffect(()=>{e?L():(f("缺少必要參數：binId"),o(!1))},[e]),M.useEffect(()=>{n&&N.length>0&&O(n)},[n,N,e]);const L=async()=>{try{o(!0),f(null);const S=await ac(e);if(!S.isInteractive)throw new Error("此內容尚未準備為互動教材");i(S),D(S)}catch(S){console.error("載入互動內容失敗:",S),f(S.message||"載入互動內容時發生錯誤")}finally{o(!1)}},D=S=>{const V=[],ie=S.transformedData||{};console.log("Initial content:",S),console.log("Transformed data keys:",Object.keys(ie)),console.log("Transformed data:",ie),S.originalContent&&console.log("Original content from JSON:",S.originalContent);const _=Object.keys(ie).sort((se,he)=>{const de=parseInt(se.replace("step_","")),be=parseInt(he.replace("step_",""));return de-be});console.log("Sorted step IDs:",_);const ve=S.includedSteps||Object.keys(ie);console.log("Included steps:",ve);const Se={};if(S.originalContent)console.log("Using originalContent from JSON for mapping"),Object.keys(S.originalContent).forEach(se=>{const he=S.originalContent[se];he&&ve.includes(se)&&(Se[se]={content:he.content,type:he.type,index:he.index||0})});else{console.log("Using fallback method to build original content mapping");const se=[];S.learningObjectives&&S.learningObjectives.forEach((he,de)=>{se.push({content:he,type:"objective",typeIndex:de})}),S.contentBreakdown&&S.contentBreakdown.forEach((he,de)=>{se.push({content:he,type:"breakdown",typeIndex:de})}),S.confusingPoints&&S.confusingPoints.forEach((he,de)=>{se.push({content:he,type:"confusing",typeIndex:de})}),console.log("All original content (fallback):",se),ve.forEach((he,de)=>{if(de<se.length){const be=se[de];Se[he]={content:be.content,type:be.type,index:be.typeIndex},console.log(`Mapping ${he} to original content at index ${de}:`,be)}})}console.log("Original lookup:",Se),_.forEach(se=>{var be,Ve,Ze;const he=ie[se],de=Se[se];if(he&&de){let ut="",gt="",Je="";switch(de.type){case"objective":ut=`📚 學習目標 ${de.index+1}`,gt="🎯",Je=((be=he.objective)==null?void 0:be.length)>50?`${he.objective.substring(0,50)}...`:he.objective||de.content.objective;break;case"breakdown":ut=`🔍 深度學習 ${de.index+1}`,gt="📖",Je=((Ve=he.title)==null?void 0:Ve.length)>50?`${he.title.substring(0,50)}...`:he.title||de.content.topic;break;case"confusing":ut=`⚡ 重要提醒 ${de.index+1}`,gt="💡",Je=((Ze=he.title)==null?void 0:Ze.length)>50?`${he.title.substring(0,50)}...`:he.title||de.content.point;break}console.log(`Creating step: ${se}, type: ${de.type}, title: ${ut}`),V.push({id:se,title:ut,type:de.type,icon:gt,description:Je,content:he,originalIndex:de.index})}}),V.length>0&&V.push({id:"summary",title:"🎯 學習完成",type:"summary",icon:"🏆",description:"恭喜完成學習，開始實踐應用！",content:null}),console.log("Final steps:",V),w(V)},O=S=>{const V=`student_interactive_${e}`;try{const ie=localStorage.getItem(V);if(ie){const _=JSON.parse(ie);h(_);const ve=_.progress.currentObjectiveIndex||0,Se=Math.min(Math.max(0,ve),N.length-1);v(Se)}else{const _={contentId:e||"unknown",topic:S.topic||"互動學習",progress:{currentObjectiveIndex:0,completedObjectives:[],timeSpent:0,interactionCount:0,startTime:Date.now(),lastUpdateTime:Date.now(),completedActivities:[]},interactions:[],createdAt:Date.now(),updatedAt:Date.now()};h(_),localStorage.setItem(V,JSON.stringify(_))}}catch(ie){console.error("初始化學習會話失敗:",ie)}},H=S=>{const V=`student_interactive_${e}`;S.updatedAt=Date.now(),S.progress.lastUpdateTime=Date.now(),h(S),localStorage.setItem(V,JSON.stringify(S))},I=S=>{if(!g)return;const V={...g};V.progress.completedObjectives.includes(S)||(V.progress.completedObjectives.push(S),V.progress.interactionCount+=1),H(V)},R=S=>{if(S>=0&&S<N.length&&N[S]&&(v(S),window.scrollTo({top:0,behavior:"smooth"}),g)){const V={...g};V.progress.currentObjectiveIndex=S,H(V)}},q=()=>{x<N.length-1&&R(x+1)},B=()=>{x>0&&R(x-1)},ee=()=>{const S=N[x];if(!S||!(n!=null&&n.stepQuizData))return;const V=n.stepQuizData[S.id];V&&(E(V),j(!0))},G=()=>{j(!1),E(null)},Y=()=>{const S=N[x];return S&&(n==null?void 0:n.stepQuizData)&&n.stepQuizData[S.id]},z=S=>S?[/#+\s/,/\*\*.*\*\*/,/\*.*\*/,/`.*`/,/^\s*[-*+]\s/m,/^\s*\d+\.\s/m,/\[.*\]\(.*\)/,/^\s*>/m,/```[\s\S]*?```/,/\n\s*\n/].some(ie=>ie.test(S)):!1,$=(S,V)=>z(S)?a.jsx(Mm,{content:S,className:V}):a.jsx("span",{className:V,children:S});if(l)return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-100 via-sky-50 to-indigo-100 py-8 px-4 sm:px-6 lg:px-8",children:a.jsx("div",{className:"flex justify-center items-center min-h-[50vh]",children:a.jsx(sn,{})})});if(u)return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-100 via-sky-50 to-indigo-100 py-8 px-4 sm:px-6 lg:px-8",children:a.jsx("div",{className:"max-w-4xl mx-auto",children:a.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg shadow-md",children:[a.jsx("h3",{className:"font-bold text-lg mb-2",children:"載入錯誤"}),a.jsx("p",{children:u})]})})});if(!n||!g||N.length===0)return null;const Q=N[x];if(!Q)return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-100 via-sky-50 to-indigo-100 py-8 px-4 sm:px-6 lg:px-8",children:a.jsx("div",{className:"max-w-4xl mx-auto",children:a.jsxs("div",{className:"bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded-lg shadow-md",children:[a.jsx("h3",{className:"font-bold text-lg mb-2",children:"沒有可用的學習步驟"}),a.jsx("p",{children:"此互動教材可能還沒有轉換任何內容，或者內容載入有問題。"}),a.jsx("p",{className:"mt-2 text-sm",children:"請確認教師已經轉換並發布了學習內容。"})]})})});const P=g.progress.completedObjectives.length,K=N.length-1,pe=K>0?P/K*100:0,X=()=>{const S=g.progress.completedObjectives.includes(Q.id);switch(Q.type){case"objective":return a.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[a.jsxs("div",{className:"bg-gradient-to-br from-indigo-500 to-sky-500 rounded-3xl shadow-2xl p-12 text-white text-center",children:[a.jsx("div",{className:"text-6xl mb-6",children:"🎯"}),a.jsx("div",{className:"text-4xl font-bold mb-6 leading-tight",children:$(Q.content.objective,"text-4xl font-bold leading-tight text-white")}),Q.content.description&&a.jsx("div",{className:"text-xl text-indigo-100 leading-relaxed max-w-3xl mx-auto",children:$(Q.content.description,"text-xl text-indigo-100 leading-relaxed")})]}),a.jsxs("div",{className:"space-y-6",children:[Q.content.personalRelevance&&a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[a.jsxs("h3",{className:"text-2xl font-bold text-purple-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"🌟"}),"這對你很重要"]}),a.jsx("div",{className:"bg-purple-50 rounded-xl p-6 text-lg leading-relaxed text-purple-900",children:$(Q.content.personalRelevance,"text-lg leading-relaxed text-purple-900")})]}),Q.content.teachingExample&&a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[a.jsxs("h3",{className:"text-2xl font-bold text-green-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"📝"}),"實際應用"]}),a.jsx("div",{className:"bg-green-50 rounded-xl p-6 text-lg leading-relaxed text-green-900",children:$(Q.content.teachingExample,"text-lg leading-relaxed text-green-900")})]}),Q.content.encouragement&&a.jsxs("div",{className:"bg-gradient-to-r from-sky-50 to-indigo-50 rounded-2xl p-8",children:[a.jsxs("h3",{className:"text-2xl font-bold text-sky-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"💪"}),"為你加油"]}),a.jsx("div",{className:"text-lg leading-relaxed text-sky-900 font-medium",children:$(Q.content.encouragement,"text-lg leading-relaxed text-sky-900 font-medium")})]})]}),a.jsxs("div",{className:"text-center space-y-4",children:[S?a.jsxs("div",{className:"bg-green-50 border-2 border-green-200 rounded-2xl p-8",children:[a.jsx("div",{className:"text-5xl mb-4",children:"✅"}),a.jsx("h4",{className:"text-2xl font-bold text-green-700 mb-2",children:"太棒了！"}),a.jsx("p",{className:"text-green-600",children:"你已經掌握了這個學習目標！"})]}):a.jsxs("div",{className:"bg-slate-50 rounded-2xl p-8",children:[a.jsx("h4",{className:"text-xl font-semibold text-slate-700 mb-4",children:"理解了嗎？"}),a.jsxs("button",{onClick:()=>I(Q.id),className:"px-8 py-4 bg-green-500 hover:bg-green-600 text-white font-bold text-lg rounded-xl transition-colors flex items-center gap-3 mx-auto",children:[a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),"我理解了！"]})]}),Y()&&a.jsxs("div",{className:"bg-orange-50 border-2 border-orange-200 rounded-2xl p-6",children:[a.jsx("h4",{className:"text-lg font-semibold text-orange-700 mb-3",children:"想測試一下你的理解嗎？"}),a.jsxs("button",{onClick:ee,className:"px-6 py-3 bg-orange-500 hover:bg-orange-600 text-white font-medium text-lg rounded-xl transition-colors flex items-center gap-2 mx-auto",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"開始練習測驗"]})]})]})]});case"breakdown":return a.jsxs("div",{className:"max-w-5xl mx-auto space-y-8",children:[a.jsxs("div",{className:"bg-gradient-to-br from-sky-500 to-blue-500 rounded-3xl shadow-2xl p-12 text-white text-center",children:[a.jsx("div",{className:"text-6xl mb-6",children:"📖"}),a.jsx("div",{className:"text-4xl font-bold mb-6 leading-tight",children:$(Q.content.title||Q.content.topic,"text-4xl font-bold leading-tight text-white")}),Q.content.introduction&&a.jsx("div",{className:"text-xl text-sky-100 leading-relaxed max-w-3xl mx-auto",children:$(Q.content.introduction,"text-xl text-sky-100 leading-relaxed")})]}),a.jsxs("div",{className:"space-y-6",children:[Q.content.keyPoints&&Q.content.keyPoints.length>0&&a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[a.jsxs("h3",{className:"text-2xl font-bold text-indigo-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"💡"}),"重點概念"]}),a.jsx("div",{className:"bg-indigo-50 rounded-xl p-6",children:a.jsx("div",{className:"space-y-4",children:Q.content.keyPoints.map((V,ie)=>a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"flex-shrink-0 w-8 h-8 bg-indigo-500 text-white rounded-full flex items-center justify-center text-sm font-bold mr-4",children:ie+1}),a.jsx("div",{className:"text-lg text-indigo-900 leading-relaxed",children:$(V,"text-lg text-indigo-900 leading-relaxed")})]},ie))})})]}),Q.content.realLifeExamples&&Q.content.realLifeExamples.length>0&&a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[a.jsxs("h3",{className:"text-2xl font-bold text-green-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"🌟"}),"生活中的例子"]}),a.jsx("div",{className:"bg-green-50 rounded-xl p-6",children:a.jsx("div",{className:"space-y-4",children:Q.content.realLifeExamples.map((V,ie)=>a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"flex-shrink-0 w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center text-sm font-bold mr-4",children:ie+1}),a.jsx("div",{className:"text-lg text-green-900 leading-relaxed",children:$(V,"text-lg text-green-900 leading-relaxed")})]},ie))})})]}),Q.content.learningTips&&a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[a.jsxs("h3",{className:"text-2xl font-bold text-purple-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"🎯"}),"學習小技巧"]}),a.jsx("div",{className:"bg-purple-50 rounded-xl p-6 text-lg leading-relaxed text-purple-900",children:$(Q.content.learningTips,"text-lg leading-relaxed text-purple-900")})]}),Q.content.nextSteps&&a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[a.jsxs("h3",{className:"text-2xl font-bold text-orange-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"🚀"}),"下一步挑戰"]}),a.jsx("div",{className:"bg-orange-50 rounded-xl p-6 text-lg leading-relaxed text-orange-900",children:$(Q.content.nextSteps,"text-lg leading-relaxed text-orange-900")})]}),Q.content.encouragement&&a.jsxs("div",{className:"bg-gradient-to-r from-pink-50 to-rose-50 rounded-2xl p-8",children:[a.jsxs("h3",{className:"text-2xl font-bold text-pink-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"💪"}),"給你的鼓勵"]}),a.jsx("div",{className:"text-lg leading-relaxed text-pink-900 font-medium",children:$(Q.content.encouragement,"text-lg leading-relaxed text-pink-900 font-medium")})]})]}),a.jsxs("div",{className:"text-center space-y-4",children:[S?a.jsxs("div",{className:"bg-green-50 border-2 border-green-200 rounded-2xl p-8",children:[a.jsx("div",{className:"text-5xl mb-4",children:"✅"}),a.jsx("h4",{className:"text-2xl font-bold text-green-700 mb-2",children:"學會了！"}),a.jsx("p",{className:"text-green-600",children:"你已經理解了這個概念！"})]}):a.jsxs("div",{className:"bg-slate-50 rounded-2xl p-8",children:[a.jsx("h4",{className:"text-xl font-semibold text-slate-700 mb-4",children:"掌握了這些概念嗎？"}),a.jsxs("button",{onClick:()=>I(Q.id),className:"px-8 py-4 bg-blue-500 hover:bg-blue-600 text-white font-bold text-lg rounded-xl transition-colors flex items-center gap-3 mx-auto",children:[a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),"我學會了！"]})]}),Y()&&a.jsxs("div",{className:"bg-orange-50 border-2 border-orange-200 rounded-2xl p-6",children:[a.jsx("h4",{className:"text-lg font-semibold text-orange-700 mb-3",children:"想測試一下你的理解嗎？"}),a.jsxs("button",{onClick:ee,className:"px-6 py-3 bg-orange-500 hover:bg-orange-600 text-white font-medium text-lg rounded-xl transition-colors flex items-center gap-2 mx-auto",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"開始練習測驗"]})]})]})]});case"confusing":return a.jsxs("div",{className:"max-w-5xl mx-auto space-y-8",children:[a.jsxs("div",{className:"bg-gradient-to-br from-amber-500 to-orange-500 rounded-3xl shadow-2xl p-12 text-white text-center",children:[a.jsx("div",{className:"text-6xl mb-6",children:"💡"}),a.jsx("div",{className:"text-4xl font-bold mb-6 leading-tight",children:$(Q.content.title||Q.content.point,"text-4xl font-bold leading-tight text-white")}),Q.content.normalizeConfusion&&a.jsx("div",{className:"text-xl text-amber-100 leading-relaxed max-w-3xl mx-auto",children:$(Q.content.normalizeConfusion,"text-xl text-amber-100 leading-relaxed")})]}),a.jsxs("div",{className:"space-y-6",children:[Q.content.commonMistake&&a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[a.jsxs("h3",{className:"text-2xl font-bold text-red-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"⚠️"}),"常見錯誤"]}),a.jsx("div",{className:"bg-red-50 rounded-xl p-6 text-lg leading-relaxed text-red-900",children:$(Q.content.commonMistake,"text-lg leading-relaxed text-red-900")})]}),Q.content.whyItHappens&&a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[a.jsxs("h3",{className:"text-2xl font-bold text-amber-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"🤔"}),"為什麼會搞混？"]}),a.jsx("div",{className:"bg-amber-50 rounded-xl p-6 text-lg leading-relaxed text-amber-900",children:$(Q.content.whyItHappens,"text-lg leading-relaxed text-amber-900")})]}),Q.content.clearExplanation&&a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[a.jsxs("h3",{className:"text-2xl font-bold text-green-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"✨"}),"正確的理解"]}),a.jsx("div",{className:"bg-green-50 rounded-xl p-6 text-lg leading-relaxed text-green-900",children:$(Q.content.clearExplanation,"text-lg leading-relaxed text-green-900")})]}),Q.content.practiceExamples&&Q.content.practiceExamples.length>0&&a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[a.jsxs("h3",{className:"text-2xl font-bold text-blue-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"📝"}),"練習範例"]}),a.jsx("div",{className:"bg-blue-50 rounded-xl p-6",children:a.jsx("div",{className:"space-y-6",children:Q.content.practiceExamples.map((V,ie)=>a.jsx("div",{className:"border-l-4 border-blue-400 pl-4",children:a.jsxs("div",{className:"flex items-start mb-3",children:[a.jsx("span",{className:"flex-shrink-0 w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-bold mr-4",children:ie+1}),a.jsx("div",{className:"flex-1",children:typeof V=="string"?a.jsx("div",{className:"text-lg text-blue-900 leading-relaxed",children:$(V,"text-lg text-blue-900 leading-relaxed")}):a.jsxs("div",{className:"space-y-3",children:[V.situation&&a.jsxs("div",{children:[a.jsx("strong",{className:"text-blue-800",children:"情境："}),a.jsx("span",{className:"text-blue-900 ml-2",children:$(V.situation,"text-blue-900")})]}),V.wrongThinking&&a.jsxs("div",{children:[a.jsx("strong",{className:"text-red-600",children:"❌ 錯誤想法："}),a.jsx("span",{className:"text-red-700 ml-2",children:$(V.wrongThinking,"text-red-700")})]}),V.rightThinking&&a.jsxs("div",{children:[a.jsx("strong",{className:"text-green-600",children:"✅ 正確想法："}),a.jsx("span",{className:"text-green-700 ml-2",children:$(V.rightThinking,"text-green-700")})]}),V.explanation&&a.jsxs("div",{children:[a.jsx("strong",{className:"text-purple-600",children:"💡 解釋："}),a.jsx("span",{className:"text-purple-700 ml-2",children:$(V.explanation,"text-purple-700")})]})]})})]})},ie))})})]}),Q.content.rememberingTricks&&Q.content.rememberingTricks.length>0&&a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[a.jsxs("h3",{className:"text-2xl font-bold text-purple-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"🎯"}),"記憶小技巧"]}),a.jsx("div",{className:"bg-purple-50 rounded-xl p-6",children:a.jsx("div",{className:"space-y-4",children:Q.content.rememberingTricks.map((V,ie)=>a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"flex-shrink-0 w-8 h-8 bg-purple-500 text-white rounded-full flex items-center justify-center text-sm font-bold mr-4",children:ie+1}),a.jsx("div",{className:"text-lg text-purple-900 leading-relaxed",children:$(V,"text-lg text-purple-900 leading-relaxed")})]},ie))})})]}),Q.content.confidenceBooster&&a.jsxs("div",{className:"bg-gradient-to-r from-sky-50 to-indigo-50 rounded-2xl p-8",children:[a.jsxs("h3",{className:"text-2xl font-bold text-sky-700 mb-6 flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:"💪"}),"你可以的！"]}),a.jsx("div",{className:"text-lg leading-relaxed text-sky-900 font-medium",children:$(Q.content.confidenceBooster,"text-lg leading-relaxed text-sky-900 font-medium")})]})]}),a.jsxs("div",{className:"text-center space-y-4",children:[S?a.jsxs("div",{className:"bg-green-50 border-2 border-green-200 rounded-2xl p-8",children:[a.jsx("div",{className:"text-5xl mb-4",children:"✅"}),a.jsx("h4",{className:"text-2xl font-bold text-green-700 mb-2",children:"記住了！"}),a.jsx("p",{className:"text-green-600",children:"你已經掌握了這個重點！"})]}):a.jsxs("div",{className:"bg-slate-50 rounded-2xl p-8",children:[a.jsx("h4",{className:"text-xl font-semibold text-slate-700 mb-4",children:"記住這些重點了嗎？"}),a.jsxs("button",{onClick:()=>I(Q.id),className:"px-8 py-4 bg-amber-500 hover:bg-amber-600 text-white font-bold text-lg rounded-xl transition-colors flex items-center gap-3 mx-auto",children:[a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),"我記住了！"]})]}),Y()&&a.jsxs("div",{className:"bg-orange-50 border-2 border-orange-200 rounded-2xl p-6",children:[a.jsx("h4",{className:"text-lg font-semibold text-orange-700 mb-3",children:"想測試一下你的記憶嗎？"}),a.jsxs("button",{onClick:ee,className:"px-6 py-3 bg-orange-500 hover:bg-orange-600 text-white font-medium text-lg rounded-xl transition-colors flex items-center gap-2 mx-auto",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"開始練習測驗"]})]})]})]});case"summary":return a.jsxs("div",{className:"text-center space-y-8",children:[a.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-2xl p-12",children:[a.jsx("div",{className:"text-6xl mb-6",children:"🎉"}),a.jsx("h3",{className:"text-3xl font-bold text-green-700 mb-4",children:"恭喜完成學習！"}),a.jsxs("p",{className:"text-lg text-slate-600 mb-8",children:["你已經完成了「",n.topic,"」的學習旅程"]}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mb-8",children:[a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-md",children:[a.jsx("div",{className:"text-3xl text-indigo-600 mb-2",children:"📚"}),a.jsx("div",{className:"text-2xl font-bold text-slate-800",children:P}),a.jsx("div",{className:"text-sm text-slate-600",children:"學習步驟完成"})]}),a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-md",children:[a.jsx("div",{className:"text-3xl text-sky-600 mb-2",children:"⏱️"}),a.jsx("div",{className:"text-2xl font-bold text-slate-800",children:Math.round((Date.now()-g.progress.startTime)/6e4)}),a.jsx("div",{className:"text-sm text-slate-600",children:"分鐘學習時間"})]}),a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-md",children:[a.jsx("div",{className:"text-3xl text-green-600 mb-2",children:"🎯"}),a.jsxs("div",{className:"text-2xl font-bold text-slate-800",children:[Math.round(pe),"%"]}),a.jsx("div",{className:"text-sm text-slate-600",children:"學習完成度"})]})]})]}),a.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-indigo-50 rounded-2xl p-8",children:[a.jsx("h4",{className:"text-2xl font-semibold text-purple-700 mb-6",children:"🚀 繼續挑戰自己"}),a.jsxs("div",{className:"flex flex-wrap justify-center gap-4",children:[n.onlineInteractiveQuiz&&a.jsxs("a",{href:`/ai-page-gen/quiz?binId=${e}`,className:"px-8 py-4 bg-orange-500 text-white font-medium rounded-xl hover:bg-orange-600 transition-colors flex items-center gap-3 text-lg",target:"_blank",rel:"noopener noreferrer",children:[a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"挑戰互動測驗"]}),n.writingPractice&&a.jsxs("a",{href:`/ai-page-gen/writing?binId=${e}`,className:"px-8 py-4 bg-purple-500 text-white font-medium rounded-xl hover:bg-purple-600 transition-colors flex items-center gap-3 text-lg",target:"_blank",rel:"noopener noreferrer",children:[a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),"練習寫作技能"]})]})]})]});default:return a.jsx("div",{children:"未知步驟類型"})}};return a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-100 via-sky-50 to-indigo-100",children:[a.jsx("div",{className:"sticky top-0 z-10 bg-white/95 backdrop-blur-sm border-b border-slate-200 shadow-sm",children:a.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-2",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-semibold text-slate-800",children:n.topic}),a.jsxs("p",{className:"text-xs text-slate-500",children:["第 ",x+1," 步，共 ",N.length," 步"]})]}),a.jsxs("div",{className:"flex items-center gap-1 text-xs text-slate-500",children:[a.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),Math.round((Date.now()-g.progress.startTime)/6e4)," 分鐘"]})]}),a.jsx("div",{className:"w-full bg-slate-200 rounded-full h-1.5 mb-1",children:a.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-sky-500 h-1.5 rounded-full transition-all duration-500 ease-out",style:{width:`${(x+1)/N.length*100}%`}})}),a.jsx("div",{className:"text-center",children:a.jsxs("span",{className:"text-xs text-slate-400",children:["完成 ",P,"/",K," • ",Math.round(pe),"%"]})})]})}),a.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"text-5xl mb-4",children:Q.icon}),a.jsx("h2",{className:"text-3xl font-bold text-slate-800 mb-2",children:Q.title}),a.jsx("div",{className:"text-lg text-slate-600",children:$(Q.description,"text-lg text-slate-600")})]}),a.jsx("div",{className:"mb-8",children:X()}),a.jsxs("div",{className:"flex items-center justify-between pt-8 border-t border-slate-200",children:[a.jsxs("button",{onClick:B,disabled:x===0,className:"flex items-center gap-2 px-6 py-3 bg-slate-500 text-white font-medium rounded-lg hover:bg-slate-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})}),"上一步"]}),a.jsx("div",{className:"text-center",children:a.jsxs("p",{className:"text-sm text-slate-600",children:[x+1," / ",N.length]})}),a.jsxs("button",{onClick:q,disabled:x===N.length-1,className:"flex items-center gap-2 px-6 py-3 bg-indigo-500 text-white font-medium rounded-lg hover:bg-indigo-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:["下一步",a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})]})]})]}),C&&k&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"sticky top-0 bg-white border-b p-6 flex items-center justify-between rounded-t-2xl",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"📝 步驟練習測驗"}),a.jsx("button",{onClick:G,className:"p-2 hover:bg-slate-100 rounded-full transition-colors",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsxs("div",{className:"p-6 space-y-8",children:[k.trueFalse&&k.trueFalse.length>0&&a.jsxs("div",{children:[a.jsxs("h3",{className:"text-xl font-semibold text-slate-700 mb-4 flex items-center gap-2",children:[a.jsx("span",{children:"✓"})," 是非判斷題"]}),a.jsx("div",{className:"space-y-4",children:k.trueFalse.map((S,V)=>a.jsx(rm,{question:S,questionIndex:V,showExplanations:!0},`tf-${V}`))})]}),k.multipleChoice&&k.multipleChoice.length>0&&a.jsxs("div",{children:[a.jsxs("h3",{className:"text-xl font-semibold text-slate-700 mb-4 flex items-center gap-2",children:[a.jsx("span",{children:"📝"})," 選擇題"]}),a.jsx("div",{className:"space-y-4",children:k.multipleChoice.map((S,V)=>a.jsx(sm,{question:S,questionIndex:V,showExplanations:!0},`mc-${V}`))})]}),k.memoryCardGame&&k.memoryCardGame.length>0&&a.jsxs("div",{children:[a.jsxs("h3",{className:"text-xl font-semibold text-slate-700 mb-4 flex items-center gap-2",children:[a.jsx("span",{children:"🧠"})," 記憶卡配對"]}),a.jsx("div",{className:"space-y-4",children:k.memoryCardGame.map((S,V)=>a.jsx(am,{question:S,questionIndex:V,showExplanations:!0},`mcg-${V}`))})]})]}),a.jsx("div",{className:"sticky bottom-0 bg-slate-50 p-6 border-t rounded-b-2xl",children:a.jsx("div",{className:"text-center",children:a.jsx("button",{onClick:G,className:"px-8 py-3 bg-indigo-500 hover:bg-indigo-600 text-white font-medium rounded-xl transition-colors",children:"完成練習"})})})]})})]})};class oR{constructor(){this.synthesis=null,this.recognition=null,this.isRecording=!1,this.initializeSpeechSynthesis(),this.initializeSpeechRecognition()}initializeSpeechSynthesis(){"speechSynthesis"in window&&(this.synthesis=window.speechSynthesis)}isTTSSupported(){return this.synthesis!==null}getAvailableVoices(){return this.synthesis?this.synthesis.getVoices().filter(e=>e.lang.startsWith("en")):[]}speak(e,n={},i,l,o){return new Promise((u,f)=>{if(!this.synthesis){f(new Error("Text-to-Speech not supported in this browser"));return}this.synthesis.cancel();const g=new SpeechSynthesisUtterance(e),x={...{lang:"en-US",rate:1,pitch:1,volume:1},...n};g.lang=x.lang,g.rate=x.rate,g.pitch=x.pitch,g.volume=x.volume;const v=this.getAvailableVoices(),N=v.find(w=>w.lang===x.lang&&!w.name.includes("Google"))||v.find(w=>w.lang===x.lang)||v[0];N&&(g.voice=N),g.onstart=()=>{i==null||i()},g.onend=()=>{l==null||l(),u()},g.onerror=w=>{o==null||o(w),f(w)},this.synthesis.speak(g)})}stopSpeaking(){this.synthesis&&this.synthesis.cancel()}pauseSpeaking(){this.synthesis&&this.synthesis.pause()}resumeSpeaking(){this.synthesis&&this.synthesis.resume()}isSpeaking(){var e;return((e=this.synthesis)==null?void 0:e.speaking)||!1}initializeSpeechRecognition(){const e=window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition;e&&(this.recognition=new e)}isSTTSupported(){return this.recognition!==null}startRecording(e={},n,i,l,o){return new Promise((u,f)=>{if(!this.recognition){f(new Error("Speech recognition not supported in this browser"));return}if(this.isRecording){f(new Error("Already recording"));return}const h={...{lang:"en-US",continuous:!1,interimResults:!0,maxAlternatives:3},...e};this.recognition.lang=h.lang,this.recognition.continuous=h.continuous,this.recognition.interimResults=h.interimResults,this.recognition.maxAlternatives=h.maxAlternatives,this.recognition.onstart=()=>{this.isRecording=!0,l==null||l()},this.recognition.onresult=x=>{for(let v=x.resultIndex;v<x.results.length;v++){const N=x.results[v][0].transcript,w=x.results[v][0].confidence;x.results[v].isFinal,n==null||n({text:N,confidence:w||.8,isFinal:x.results[v].isFinal})}},this.recognition.onerror=x=>{this.isRecording=!1,i==null||i(x),f(x)},this.recognition.onend=()=>{this.isRecording=!1,o==null||o(),u()};try{this.recognition.start()}catch(x){this.isRecording=!1,f(x)}})}stopRecording(){this.recognition&&this.isRecording&&this.recognition.stop()}isCurrentlyRecording(){return this.isRecording}analyzePronunciation(e,n){const i=e.toLowerCase().split(/\s+/),l=n.toLowerCase().split(/\s+/),o=[],u=[];i.forEach(h=>{const x=h.replace(/[.,!?;:]/g,"");l.some(v=>v.replace(/[.,!?;:]/g,"").includes(x)||x.includes(v.replace(/[.,!?;:]/g,"")))?o.push(h):u.push(h)});const f=i.length>0?o.length/i.length*100:0,g=[];return f<70&&g.push("Try speaking more slowly and clearly"),u.length>0&&g.push(`Practice these words: ${u.slice(0,3).join(", ")}`),n.length<e.length*.5&&g.push("Speak louder and closer to the microphone"),{accuracy:Math.round(f),suggestions:g,matchedWords:o,missedWords:u}}getSupportStatus(){const e=navigator.userAgent;let n="Unknown browser";return e.includes("Chrome")?n="Chrome":e.includes("Firefox")?n="Firefox":e.includes("Safari")?n="Safari":e.includes("Edge")&&(n="Edge"),{ttsSupported:this.isTTSSupported(),sttSupported:this.isSTTSupported(),browserInfo:n}}}const Ts=new oR,gb=({turn:t,isCurrentTurn:e,isStudentTurn:n,studentRole:i,onPlayComplete:l,showTranslation:o=!1,showHints:u=!1,voiceSettings:f={}})=>{const[g,h]=M.useState(!1),[x,v]=M.useState(!1),[N,w]=M.useState(o),[C,j]=M.useState(u),k=M.useCallback(async()=>{if(g){Ts.stopSpeaking();return}try{h(!0),await Ts.speak(t.text,{lang:"en-US",rate:.9,...f},void 0,()=>{h(!1),l==null||l()},D=>{console.error("Speech playback error:",D),h(!1)})}catch(D){console.error("Failed to play speech:",D),h(!1)}},[t.text,g,f,l]),E=D=>{switch(D){case"easy":return"text-green-600 bg-green-50 border-green-200";case"normal":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"hard":return"text-red-600 bg-red-50 border-red-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},L=(D,O)=>{let H=D;return O.forEach(I=>{const R=new RegExp(`\\b(${I.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})\\b`,"gi");H=H.replace(R,'<mark class="bg-yellow-200 px-1 rounded">$1</mark>')}),H};return a.jsxs("div",{className:`
      relative rounded-lg border-2 transition-all duration-300 mb-4
      ${e?"border-blue-400 shadow-lg bg-blue-50":"border-gray-200 bg-white"}
      ${n&&e?"border-green-400 bg-green-50":""}
    `,children:[a.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:`
            w-10 h-10 rounded-full flex items-center justify-center text-white font-medium
            ${n?"bg-green-500":t.speaker==="Teacher"||t.speaker==="老師"?"bg-blue-500":"bg-gray-500"}
          `,children:t.speaker.charAt(0).toUpperCase()}),a.jsxs("div",{children:[a.jsxs("div",{className:"font-medium text-gray-900",children:[t.speaker,n&&a.jsx("span",{className:"ml-2 text-sm text-green-600 font-normal",children:"(Your turn)"})]}),e&&a.jsx("div",{className:"text-sm text-blue-600",children:"Current conversation turn"})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:`
            px-2 py-1 text-xs font-medium rounded-full border
            ${E(t.difficulty)}
          `,children:t.difficulty}),a.jsx("button",{onClick:k,disabled:n,className:`
              p-2 rounded-full transition-colors
              ${n?"bg-gray-100 text-gray-400 cursor-not-allowed":g?"bg-red-500 text-white hover:bg-red-600":"bg-blue-500 text-white hover:bg-blue-600"}
            `,title:n?"It's your turn to speak":g?"Stop":"Play audio",children:g?a.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M6 19h4V5H6v14zm8-14v14h4V5h-4z"})}):a.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M8 5v14l11-7z"})})}),a.jsx("button",{onClick:()=>v(!x),className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-full",title:"Show/hide details",children:a.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})})})]})]}),a.jsxs("div",{className:"p-4",children:[a.jsx("div",{className:"text-lg text-gray-900 leading-relaxed mb-3",children:t.keyWords.length>0?a.jsx("div",{dangerouslySetInnerHTML:{__html:L(t.text,t.keyWords)}}):t.text}),a.jsx("div",{className:"flex items-center space-x-2 mb-3",children:a.jsx("button",{onClick:()=>w(!N),className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:N?"隱藏翻譯":"顯示翻譯"})}),N&&a.jsx("div",{className:"text-gray-600 bg-gray-50 p-3 rounded-lg mb-3 border border-gray-200",children:t.translation}),n&&t.expectedResponseHints&&t.expectedResponseHints.length>0&&a.jsxs("div",{className:"mb-3",children:[a.jsx("button",{onClick:()=>j(!C),className:"text-sm text-green-600 hover:text-green-800 font-medium mb-2",children:C?"隱藏提示":"需要提示？"}),C&&a.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[a.jsx("div",{className:"text-sm font-medium text-green-800 mb-2",children:"💡 Response hints:"}),a.jsx("ul",{className:"text-sm text-green-700 space-y-1",children:t.expectedResponseHints.map((D,O)=>a.jsxs("li",{className:"flex items-start",children:[a.jsx("span",{className:"text-green-500 mr-2",children:"•"}),a.jsx("span",{children:D})]},O))})]})]}),x&&a.jsxs("div",{className:"border-t border-gray-200 pt-3 mt-3 space-y-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"📚 Practice Point:"}),a.jsx("div",{className:"text-sm text-gray-600 bg-blue-50 p-2 rounded border border-blue-200",children:t.practicePoint})]}),t.keyWords.length>0&&a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"🔑 Key Words:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:t.keyWords.map((D,O)=>a.jsx("span",{className:"px-2 py-1 text-sm bg-yellow-100 text-yellow-800 rounded-full border border-yellow-300",children:D},O))})]}),t.pronunciation&&a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"🔊 Pronunciation:"}),a.jsx("div",{className:"text-sm text-gray-600 font-mono bg-gray-50 p-2 rounded border border-gray-200",children:t.pronunciation})]})]})]}),e&&a.jsx("div",{className:"absolute -left-1 top-1/2 transform -translate-y-1/2",children:a.jsx("div",{className:"w-2 h-8 bg-blue-400 rounded-r"})}),n&&e&&a.jsx("div",{className:"absolute top-2 right-2",children:a.jsx("div",{className:"w-3 h-3 bg-green-400 rounded-full animate-pulse"})})]})},cR=()=>{var I;const[t,e]=M.useState({topic:"",scenario:"",difficulty:"normal",participantCount:2,duration:10,focusAreas:[],culturalContext:""}),[n,i]=M.useState(""),[l,o]=M.useState(!1),[u,f]=M.useState(null),[g,h]=M.useState(null),[x,v]=M.useState(!1),[N,w]=M.useState(""),[C,j]=M.useState(0),k=Lo.getConversationTemplates(),E=Lo.getDifficultyLevels();M.useEffect(()=>{const R=localStorage.getItem("gemini-api-key");R&&i(R)},[]);const L=R=>{e({...t,topic:R.title,scenario:R.scenario,difficulty:R.suggestedDifficulty,participantCount:R.participants.length})},D=async()=>{if(!n.trim()){f("Please enter your Gemini API key");return}if(!t.topic.trim()||!t.scenario.trim()){f("Please provide both topic and scenario");return}o(!0),f(null);try{localStorage.setItem("gemini-api-key",n);const R=await Lo.generateConversationPractice(t,n);h(R),j(0)}catch(R){console.error("Failed to generate conversation:",R),f("Failed to generate conversation. Please check your API key and try again.")}finally{o(!1)}},O=async()=>{if(g){v(!0),f(null);try{const R={practice:g,metadata:{createdBy:"AI Page Gen",generatedAt:new Date().toISOString()}},q=await ov(R),B=`${window.location.origin}/ai-page-gen/conversation-practice/${q}`;w(B)}catch(R){console.error("Failed to share conversation:",R),f("Failed to create shareable link")}finally{v(!1)}}},H=()=>{navigator.clipboard.writeText(N)};return a.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:a.jsxs("div",{className:"max-w-6xl mx-auto px-4",children:[a.jsxs("div",{className:"mb-8 text-center",children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"英文對話練習生成器"}),a.jsx("p",{className:"text-gray-600",children:"Create interactive English conversation practices for your students"})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"API Configuration"}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Gemini API Key"}),a.jsx("input",{type:"password",value:n,onChange:R=>i(R.target.value),placeholder:"Enter your Gemini API key",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Templates"}),a.jsx("div",{className:"space-y-4",children:k.map(R=>a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:R.category}),a.jsx("div",{className:"grid grid-cols-1 gap-2",children:R.scenarios.slice(0,2).map((q,B)=>a.jsxs("button",{onClick:()=>L(q),className:"text-left p-3 bg-gray-50 hover:bg-gray-100 rounded-lg border border-gray-200 transition-colors",children:[a.jsx("div",{className:"font-medium text-gray-900 text-sm",children:q.title}),a.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[q.scenario.substring(0,60),"..."]})]},B))})]},R.category))})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Conversation Settings"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Topic *"}),a.jsx("input",{type:"text",value:t.topic,onChange:R=>e({...t,topic:R.target.value}),placeholder:"e.g., Ordering food at a restaurant",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Scenario *"}),a.jsx("textarea",{value:t.scenario,onChange:R=>e({...t,scenario:R.target.value}),placeholder:"Detailed description of the conversation context",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Difficulty Level"}),a.jsx("div",{className:"grid grid-cols-3 gap-2",children:E.map(R=>a.jsxs("button",{onClick:()=>e({...t,difficulty:R.level}),className:`p-3 rounded-lg border text-sm transition-colors ${t.difficulty===R.level?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 bg-white hover:bg-gray-50"}`,children:[a.jsx("div",{className:"font-medium",children:R.level}),a.jsx("div",{className:"text-xs opacity-75 mt-1",children:R.description.split(" - ")[0]})]},R.level))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Number of Participants"}),a.jsxs("div",{className:"flex space-x-4",children:[a.jsx("button",{onClick:()=>e({...t,participantCount:2}),className:`px-4 py-2 rounded-lg border transition-colors ${t.participantCount===2?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 bg-white hover:bg-gray-50"}`,children:"2 People"}),a.jsx("button",{onClick:()=>e({...t,participantCount:3}),className:`px-4 py-2 rounded-lg border transition-colors ${t.participantCount===3?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 bg-white hover:bg-gray-50"}`,children:"3 People"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Target Duration (minutes)"}),a.jsx("input",{type:"number",min:"5",max:"30",value:t.duration,onChange:R=>e({...t,duration:parseInt(R.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Focus Areas (optional)"}),a.jsx("input",{type:"text",value:((I=t.focusAreas)==null?void 0:I.join(", "))||"",onChange:R=>e({...t,focusAreas:R.target.value.split(",").map(q=>q.trim()).filter(q=>q)}),placeholder:"e.g., pronunciation, grammar, vocabulary",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),a.jsx("div",{className:"mt-6",children:a.jsx("button",{onClick:D,disabled:l||!n.trim(),className:"w-full px-4 py-3 bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed text-white font-medium rounded-lg transition-colors flex items-center justify-center space-x-2",children:l?a.jsxs(a.Fragment,{children:[a.jsx(sn,{size:"sm"}),a.jsx("span",{children:"Generating..."})]}):a.jsxs(a.Fragment,{children:[a.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),a.jsx("span",{children:"Generate Conversation"})]})})})]}),u&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex",children:[a.jsx("svg",{className:"w-5 h-5 text-red-400 mt-0.5",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("div",{className:"text-sm font-medium text-red-800",children:"Error"}),a.jsx("div",{className:"text-sm text-red-700 mt-1",children:u})]})]})})]}),a.jsx("div",{className:"space-y-6",children:g?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Generated Conversation"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[a.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-200",children:[a.jsx("div",{className:"text-sm font-medium text-blue-800",children:"Title"}),a.jsx("div",{className:"text-blue-700",children:g.title})]}),a.jsxs("div",{className:"bg-green-50 p-3 rounded-lg border border-green-200",children:[a.jsx("div",{className:"text-sm font-medium text-green-800",children:"Difficulty"}),a.jsx("div",{className:"text-green-700",children:g.difficulty})]}),a.jsxs("div",{className:"bg-purple-50 p-3 rounded-lg border border-purple-200",children:[a.jsx("div",{className:"text-sm font-medium text-purple-800",children:"Duration"}),a.jsxs("div",{className:"text-purple-700",children:[g.duration," min"]})]}),a.jsxs("div",{className:"bg-orange-50 p-3 rounded-lg border border-orange-200",children:[a.jsx("div",{className:"text-sm font-medium text-orange-800",children:"Turns"}),a.jsx("div",{className:"text-orange-700",children:g.dialogue.length})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Participants"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:g.participants.map((R,q)=>a.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-800 rounded-full text-sm",children:R},q))})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Description"}),a.jsx("div",{className:"text-gray-600 text-sm",children:g.description})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Preview"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:()=>j(Math.max(0,C-1)),disabled:C===0,className:"p-2 text-gray-500 hover:text-gray-700 disabled:text-gray-300 disabled:cursor-not-allowed",children:a.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),a.jsxs("span",{className:"text-sm text-gray-600",children:[C+1," / ",g.dialogue.length]}),a.jsx("button",{onClick:()=>j(Math.min(g.dialogue.length-1,C+1)),disabled:C===g.dialogue.length-1,className:"p-2 text-gray-500 hover:text-gray-700 disabled:text-gray-300 disabled:cursor-not-allowed",children:a.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"})})})]})]}),a.jsx(gb,{turn:g.dialogue[C],isCurrentTurn:!0,isStudentTurn:!1,studentRole:"",showTranslation:!0,showHints:!0})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Share with Students"}),N?a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Shareable Link"}),a.jsxs("div",{className:"flex",children:[a.jsx("input",{type:"text",value:N,readOnly:!0,className:"flex-1 px-3 py-2 border border-gray-300 rounded-l-lg bg-gray-50"}),a.jsx("button",{onClick:H,className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white font-medium rounded-r-lg",children:"Copy"})]}),a.jsx("div",{className:"text-sm text-gray-600 mt-2",children:"Students can use this link to practice the conversation"})]}):a.jsx("button",{onClick:O,disabled:x,className:"w-full px-4 py-3 bg-green-500 hover:bg-green-600 disabled:bg-gray-300 text-white font-medium rounded-lg transition-colors flex items-center justify-center space-x-2",children:x?a.jsxs(a.Fragment,{children:[a.jsx(sn,{size:"sm"}),a.jsx("span",{children:"Creating Share Link..."})]}):a.jsxs(a.Fragment,{children:[a.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.50-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92S19.61 16.08 18 16.08z"})}),a.jsx("span",{children:"Create Share Link"})]})})]})]}):a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[a.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:"💬"}),a.jsx("div",{className:"text-gray-600",children:"Generate a conversation to see the preview"})]})})]})]})})},uR=({targetText:t,onRecordingComplete:e,onRecordingStart:n,onRecordingStop:i,disabled:l=!1,language:o="en-US",placeholder:u="Click to start recording..."})=>{const[f,g]=M.useState(!1),[h,x]=M.useState(""),[v,N]=M.useState(0),[w,C]=M.useState(!0),[j,k]=M.useState(null),[E,L]=M.useState(0),D=M.useRef(null),O=M.useRef([]),H=M.useRef(),I=M.useRef({text:"",confidence:0});M.useEffect(()=>{const G=Ts.getSupportStatus();return C(G.sttSupported),G.sttSupported||k("Your browser does not support speech recognition"),()=>{H.current&&cancelAnimationFrame(H.current)}},[]);const R=async()=>{if(!(!w||l))try{k(null),x(""),N(0),O.current=[];const G=await navigator.mediaDevices.getUserMedia({audio:!0}),Y=new MediaRecorder(G);D.current=Y,Y.ondataavailable=z=>{z.data.size>0&&O.current.push(z.data)},Y.start(),await Ts.startRecording({lang:o,continuous:!1,interimResults:!0},z=>{x(z.text),N(z.confidence),I.current={text:z.text,confidence:z.confidence},console.log("VoiceRecorder: Speech recognition result:",z)},z=>{console.error("Speech recognition error:",z),k("Speech recognition failed. Please try again."),q()},()=>{n==null||n(),g(!0)},()=>{g(!1),i==null||i(),setTimeout(()=>{const z=I.current.text,$=I.current.confidence;console.log("🔴 VoiceRecorder: Preparing callback with:",{finalText:z,finalConfidence:$}),console.log("🔴 VoiceRecorder: About to call onRecordingComplete"),console.log("🔴 VoiceRecorder: Triggering onRecordingComplete NOW"),e({text:z,confidence:$,audioBlob:void 0}),D.current&&D.current.state!=="inactive"&&(D.current.stop(),D.current.onstop=()=>{const Q=O.current.length>0?new Blob(O.current,{type:"audio/wav"}):void 0;Q&&(console.log("VoiceRecorder: Updating with audio blob"),e({text:z,confidence:$,audioBlob:Q}))})},200)}),B(G)}catch(G){console.error("Failed to start recording:",G),k("Failed to access microphone. Please check permissions.")}},q=()=>{f&&(Ts.stopRecording(),L(0),H.current&&cancelAnimationFrame(H.current))},B=G=>{const Y=new AudioContext,z=Y.createAnalyser();Y.createMediaStreamSource(G).connect(z),z.fftSize=256;const Q=z.frequencyBinCount,P=new Uint8Array(Q),K=()=>{if(!f)return;z.getByteFrequencyData(P);const pe=P.reduce((X,S)=>X+S,0)/Q;L(pe/255),H.current=requestAnimationFrame(K)};K()},ee=()=>{const G="relative flex items-center justify-center w-16 h-16 rounded-full transition-all duration-200 focus:outline-none focus:ring-4 focus:ring-offset-2";return l?a.jsx("button",{className:`${G} bg-gray-300 cursor-not-allowed`,disabled:!0,children:a.jsx("svg",{className:"w-6 h-6 text-gray-500",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z"})})}):f?a.jsxs("button",{onClick:q,className:`${G} bg-red-500 hover:bg-red-600 text-white focus:ring-red-300 animate-pulse`,style:{transform:`scale(${1+E*.3})`},children:[a.jsx("div",{className:"w-4 h-4 bg-white rounded-sm"}),a.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-red-300",style:{transform:`scale(${1.2+E*.5})`,opacity:E*.7}})]}):a.jsx("button",{onClick:R,className:`${G} bg-blue-500 hover:bg-blue-600 text-white focus:ring-blue-300`,children:a.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z"})})})};return w?a.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[a.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[ee(),a.jsx("div",{className:"text-sm text-gray-600 text-center",children:f?a.jsx("span",{className:"text-red-600 font-medium",children:"Recording..."}):u})]}),h&&a.jsx("div",{className:"w-full max-w-md",children:a.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 border",children:[a.jsx("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"You said:"}),a.jsxs("div",{className:"text-gray-900",children:['"',h,'"']}),v>0&&a.jsxs("div",{className:"mt-2 flex items-center space-x-2",children:[a.jsx("span",{className:"text-xs text-gray-500",children:"Confidence:"}),a.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${v>.8?"bg-green-500":v>.6?"bg-yellow-500":"bg-red-500"}`,style:{width:`${v*100}%`}})}),a.jsxs("span",{className:"text-xs text-gray-500",children:[Math.round(v*100),"%"]})]})]})}),j&&a.jsx("div",{className:"text-red-600 text-sm bg-red-50 px-3 py-2 rounded-lg border border-red-200",children:j}),t&&h&&a.jsxs("div",{className:"w-full max-w-md text-xs text-gray-500 bg-blue-50 p-3 rounded-lg border border-blue-200",children:[a.jsx("div",{className:"font-medium mb-1",children:"Expected:"}),a.jsxs("div",{className:"text-blue-700",children:['"',t,'"']})]})]}):a.jsxs("div",{className:"flex flex-col items-center space-y-2 p-4 bg-red-50 rounded-lg border border-red-200",children:[a.jsx("div",{className:"text-red-600 text-sm font-medium",children:"Speech recognition not supported"}),a.jsx("div",{className:"text-red-500 text-xs text-center",children:"Please use Chrome, Edge, or Safari for voice recording"})]})},dR=()=>{const{binId:t}=IE(),e=fm(),[n,i]=M.useState(null),[l,o]=M.useState(null),[u,f]=M.useState(!0),[g,h]=M.useState(null),[x,v]=M.useState(0),[N,w]=M.useState(!1),[C,j]=M.useState(null),[k,E]=M.useState(!1),[L,D]=M.useState(""),[O,H]=M.useState(""),[I,R]=M.useState(null),[q,B]=M.useState([]),[ee,G]=M.useState(0),Y=(se,he)=>{const de=Gt=>Gt.toLowerCase().replace(/[^\w\s]/g,"").trim(),be=de(se).split(/\s+/),Ve=de(he).split(/\s+/);if(be.length===0||Ve.length===0)return 0;let Ze=0;const ut=new Set(be);Ve.forEach(Gt=>{ut.has(Gt)?Ze++:be.forEach(xn=>{xn.length>=3&&Gt.length>=3&&(xn.includes(Gt)||Gt.includes(xn))&&(Ze+=.5)})});const gt=Math.max(be.length,Ve.length);return Math.min(Ze/gt,1)},z=async se=>{try{await Ts.speak(se,{lang:"en-US",rate:.8,pitch:1,volume:1})}catch(he){console.error("Failed to play demonstration:",he)}},$=()=>{I!=null&&I.audioBlob&&new Audio(URL.createObjectURL(I.audioBlob)).play().catch(he=>{console.error("Failed to play recording:",he)})},Q=se=>se>=.8?"text-green-600":se>=.6?"text-yellow-600":"text-red-600",P=se=>{const he=se.split(/[.!?]+/).filter(Ve=>Ve.trim().length>0),de=[];for(let Ve of he){const Ze=Ve.trim();if(Ze.length>50){const ut=Ze.split(",").filter(gt=>gt.trim().length>0);ut.length>1?de.push(...ut.map(gt=>gt.trim())):de.push(Ze)}else Ze.length>0&&de.push(Ze)}return de.length>0?de:[se.trim()]},K=se=>{if(!n||!l)return;const he=n.dialogue[se];if(!he||he.speaker!==l.studentRole)return;const de=P(he.text),be=q.length===0||JSON.stringify(de)!==JSON.stringify(q);B(de),be&&(G(0),de.length>0&&H(de[0]))},pe=M.useCallback(async()=>{if(!t){h("No practice ID provided"),f(!1);return}try{const se=await yk(t);if(se.type!=="conversation-practice"){h("This is not a conversation practice link"),f(!1);return}i(se.practice),se.practice.participants.length>0&&D(se.practice.participants[0]),f(!1)}catch(se){console.error("Failed to load conversation practice:",se),h("Failed to load conversation practice"),f(!1)}},[t]);M.useEffect(()=>{pe()},[pe]),M.useEffect(()=>{if(l&&n&&n.dialogue.length>0){const se=n.dialogue[x];se&&se.speaker===l.studentRole?K(x):(B([]),G(0),H(""))}},[l,n,x]),M.useEffect(()=>{},[O,ee,q]);const X=()=>{if(!n||!L)return;const se={practiceId:n.id,startTime:Date.now(),currentTurnIndex:0,studentRole:L,responses:[],completed:!1};o(se),v(0),w(!1)},S=se=>{if(!n||!l)return!1;const he=n.dialogue[se];return(he==null?void 0:he.speaker)===l.studentRole},V=async se=>{const he=q.length>0?q[ee]:O;if(!(!n||!l||!he)){E(!0);try{const de=Y(he,se.text),be={text:se.text,audioBlob:se.audioBlob,similarity:de};R(be);const Ze={turnId:n.dialogue[x].id,text:se.text,confidence:se.confidence,audioBlob:se.audioBlob,timestamp:Date.now()},ut={...l,responses:[...l.responses,Ze]};o(ut)}catch(de){console.error("Failed to process student response:",de)}finally{E(!1)}}},ie=()=>{if(!(!n||!l)){if(w(!1),j(null),ee<q.length-1){const se=ee+1,he=q[se];R(null),G(se),H(he);return}if(x<n.dialogue.length-1){const se=x+1;R(null),B([]),G(0),H(""),v(se)}else _()}},_=()=>{if(!l)return;const se={...l,completed:!0};o(se)};if(u)return a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(sn,{}),a.jsx("div",{className:"mt-4 text-gray-600",children:"Loading conversation practice..."})]})});if(g)return a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:a.jsxs("div",{className:"text-center max-w-md mx-auto p-6",children:[a.jsx("div",{className:"text-red-600 text-lg font-medium mb-2",children:"Error"}),a.jsx("div",{className:"text-gray-600 mb-4",children:g}),a.jsx("button",{onClick:()=>e("/"),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:"Back to Home"})]})});if(!n)return a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:a.jsx("div",{className:"text-center",children:a.jsx("div",{className:"text-gray-600",children:"No conversation found"})})});if(!l)return a.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:n.title}),a.jsxs("div",{className:"flex items-center justify-center space-x-4 text-sm text-gray-600",children:[a.jsxs("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full",children:["難度：",n.difficulty==="easy"?"簡單":n.difficulty==="normal"?"普通":"困難"]}),a.jsxs("span",{children:[n.duration," 分鐘"]}),a.jsxs("span",{children:[n.dialogue.length," 個對話輪次"]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-3",children:"📖 情境說明"}),a.jsx("p",{className:"text-gray-700 mb-4",children:n.scenario}),a.jsx("p",{className:"text-gray-600",children:n.description})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-3",children:"🎭 選擇您的角色"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n.participants.map(se=>a.jsxs("button",{onClick:()=>D(se),className:`p-4 border rounded-lg text-left transition-all ${L===se?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[a.jsx("div",{className:"font-medium text-gray-900",children:se}),a.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:["您將扮演 ",se," 的角色"]})]},se))})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-3",children:"🎯 學習目標"}),a.jsx("ul",{className:"space-y-2",children:n.practiceGoals.map((se,he)=>a.jsxs("li",{className:"flex items-start",children:[a.jsx("span",{className:"text-green-500 mr-2 mt-0.5",children:"✓"}),a.jsx("span",{className:"text-gray-700",children:se})]},he))})]}),a.jsx("div",{className:"text-center",children:a.jsx("button",{onClick:X,disabled:!L,className:`px-8 py-3 rounded-lg font-medium transition-colors ${L?"bg-blue-500 hover:bg-blue-600 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:"開始練習"})})]})});if(l.completed)return a.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:a.jsx("div",{className:"max-w-4xl mx-auto px-4 text-center",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:[a.jsx("div",{className:"text-green-600 text-6xl mb-4",children:"🎉"}),a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"恭喜完成！"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"您已經完成了英文對話練習，表現很棒！"}),a.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:l.responses.length}),a.jsx("div",{className:"text-sm text-gray-600",children:"回答次數"})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:Math.round((Date.now()-l.startTime)/1e3/60)}),a.jsx("div",{className:"text-sm text-gray-600",children:"練習分鐘"})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-purple-600",children:n.difficulty==="easy"?"簡單":n.difficulty==="normal"?"普通":"困難"}),a.jsx("div",{className:"text-sm text-gray-600",children:"難度等級"})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-orange-600",children:l.studentRole}),a.jsx("div",{className:"text-sm text-gray-600",children:"扮演角色"})]})]})}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-center space-y-2 sm:space-y-0 sm:space-x-4",children:[a.jsx("button",{onClick:()=>{o(null),v(0)},className:"px-6 py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-medium",children:"再練習一次"}),a.jsx("button",{onClick:()=>e("/"),className:"px-6 py-3 bg-gray-500 hover:bg-gray-600 text-white rounded-lg font-medium",children:"返回首頁"})]})]})})});const ve=n.dialogue[x],Se=S(x);return a.jsx("div",{className:"min-h-screen bg-gray-50 py-4",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h1",{className:"font-semibold text-gray-900",children:n.title}),a.jsxs("span",{className:"text-sm text-gray-600",children:[x+1," / ",n.dialogue.length]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:`${(x+1)/n.dialogue.length*100}%`}})})]}),a.jsx(gb,{turn:ve,isCurrentTurn:!0,isStudentTurn:Se,studentRole:l.studentRole,showTranslation:!1,showHints:Se}),Se?a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"🎤 輪到您開口說話了"}),q.length>1&&a.jsxs("p",{className:"text-blue-600 text-sm mb-2",children:["第 ",ee+1," 段 / 共 ",q.length," 段"]}),a.jsx("p",{className:"text-gray-600",children:"點擊下方句子練習發音，然後錄音"})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h4",{className:"text-md font-medium text-gray-800 mb-3",children:"📝 請練習這個句子："}),q.length>1&&a.jsxs("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx("div",{className:"text-sm text-blue-700 mb-1",children:"完整句子："}),a.jsx("div",{className:"text-blue-900",children:ve.text})]}),O?a.jsx("div",{className:"p-4 border-2 border-green-500 bg-green-50 rounded-lg cursor-pointer transition-colors",onClick:()=>H(O),children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-gray-900 text-lg font-medium",children:O}),a.jsx("div",{className:"flex gap-2",children:a.jsx("button",{onClick:se=>{se.stopPropagation(),z(O)},className:"p-2 text-blue-500 hover:bg-blue-100 rounded-full transition-colors",title:"播放示範發音",children:a.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M8 5v14l11-7z"})})})})]})}):a.jsx("div",{className:"p-4 border-2 border-gray-300 bg-gray-50 rounded-lg",children:a.jsx("div",{className:"text-gray-500 text-center",children:"正在載入句子..."})}),ve.translation&&a.jsxs("div",{className:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[a.jsx("div",{className:"text-sm text-yellow-700 mb-1",children:"💡 中文意思："}),a.jsx("div",{className:"text-yellow-900",children:ve.translation})]})]}),O&&a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-3",children:"🎙️ 開始錄音練習"}),a.jsx(uR,{targetText:q.length>0?q[ee]:O,onRecordingComplete:V,onRecordingStart:()=>{},onRecordingStop:()=>{},disabled:k,language:"en-US",placeholder:"點擊錄音按鈕開始練習"})]}),I&&a.jsxs("div",{className:"mt-4 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"📝 您說的內容："}),I.audioBlob&&a.jsxs("button",{onClick:$,className:"px-3 py-1 bg-blue-500 text-white text-sm rounded hover:bg-blue-600 flex items-center gap-1",children:[a.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M8 5v14l11-7z"})}),"播放錄音"]})]}),a.jsxs("div",{className:"text-gray-800 mb-3 p-2 bg-white rounded border",children:['"',I.text,'"']}),a.jsxs("div",{className:"text-sm",children:[a.jsx("span",{className:"text-gray-600 mr-2",children:"發音準確度："}),a.jsxs("span",{className:`font-medium ${Q(I.similarity||0)}`,children:[Math.round((I.similarity||0)*100),"%"]}),(I.similarity||0)>=.8&&a.jsx("span",{className:"ml-2",children:"🎉 很棒！"}),(I.similarity||0)>=.6&&(I.similarity||0)<.8&&a.jsx("span",{className:"ml-2",children:"👍 不錯！"}),(I.similarity||0)<.6&&a.jsx("span",{className:"ml-2",children:"💪 再加油！"})]}),!I.audioBlob&&a.jsx("div",{className:"text-xs text-red-500 mt-2",children:"錄音音頻不可用"})]}),I&&(I.similarity||0)>=.6&&a.jsx("div",{className:"mt-4",children:a.jsxs("button",{onClick:ie,className:"px-6 py-3 bg-green-500 hover:bg-green-600 text-white font-medium rounded-lg transition-colors flex items-center gap-2 mx-auto",children:[a.jsx("span",{children:"✅ 很好！"}),a.jsx("span",{children:(()=>{const se=ee>=q.length-1,he=x>=((n==null?void 0:n.dialogue.length)||0)-1;return se?he?"完成所有練習":"完成這輪，繼續下一輪對話":`練習下一段 (${ee+2}/${q.length})`})()})]})}),I&&(I.similarity||0)<.6&&a.jsxs("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[a.jsx("div",{className:"text-sm text-yellow-800 mb-3",children:"🎯 建議：請再次聽取示範發音，並嘗試更清楚地說出句子"}),a.jsx("button",{onClick:()=>R(null),className:"px-4 py-2 bg-yellow-500 hover:bg-yellow-600 text-white text-sm rounded transition-colors",children:"🔄 重新錄音"})]})]})]}):a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 text-center",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:["🎧 聆聽 ",ve.speaker," 說話"]}),a.jsx("p",{className:"text-gray-600 mb-4",children:"請仔細聽對方的發音和語調，為下次練習做準備"}),a.jsxs("button",{onClick:ie,className:"px-6 py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-medium flex items-center gap-2 mx-auto",children:[a.jsx("span",{children:"👂 我聽清楚了"}),a.jsx("span",{children:"→"}),a.jsx("span",{children:"繼續"})]})]}),k&&a.jsxs("div",{className:"text-center mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx(sn,{}),a.jsx("div",{className:"text-sm text-blue-600 mt-2",children:"🔄 正在分析您的發音..."})]})]})})},Ka="gemini_api_key",fR=()=>{const[t]=jr(),e=t.get("binId"),[n,i]=Be.useState(null),[l,o]=Be.useState(!1),[u,f]=Be.useState(""),[g,h]=Be.useState(null),[x,v]=Be.useState(!1);Be.useEffect(()=>{if(!e){f("缺少 binId");return}o(!0),ac(e).then(C=>{i(C),N(C,e)}).catch(C=>f(C.message||"讀取失敗")).finally(()=>o(!1))},[e]);const N=async(C,j)=>{try{if(await zt.init(),await zt.getLessonPlan(`shared_${j}`)){await zt.updateLastAccessed(`shared_${j}`);return}const E={id:`shared_${j}`,topic:C.topic||"分享的教案",createdAt:new Date().toISOString(),lastAccessedAt:new Date().toISOString(),content:{learningObjectives:C.learningObjectives,contentBreakdown:C.contentBreakdown,confusingPoints:C.confusingPoints,classroomActivities:C.classroomActivities,quiz:C.onlineInteractiveQuiz,writingPractice:C.writingPractice},metadata:{totalSections:[C.learningObjectives,C.contentBreakdown,C.confusingPoints,C.classroomActivities,C.onlineInteractiveQuiz,C.writingPractice].filter(Boolean).length,hasQuiz:!!C.onlineInteractiveQuiz,hasWriting:!!C.writingPractice,isShared:!0,sharedBinId:j}};await zt.saveLessonPlan(E),console.log(`分享教案已儲存到本地: ${C.topic||"分享的教案"} (${j})`)}catch(k){console.error("儲存分享教案到本地存儲失敗:",k)}};Be.useEffect(()=>{const C=localStorage.getItem(Ka);C?h(C):v(!0)},[]);const w=C=>{localStorage.setItem(Ka,C),h(C),v(!1)};return l?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-100 via-sky-50 to-indigo-100 py-8 px-4 sm:px-6 lg:px-8",children:a.jsx("div",{className:"flex justify-center my-10",children:a.jsx(sn,{})})}):u?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-100 via-sky-50 to-indigo-100 py-8 px-4 sm:px-6 lg:px-8",children:a.jsx("div",{className:"max-w-4xl mx-auto",children:a.jsx("div",{className:"my-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg shadow-md",children:u})})}):n?a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-100 via-sky-50 to-indigo-100 py-8 px-4 sm:px-6 lg:px-8",children:[a.jsx(xv,{isOpen:x,onSave:w}),a.jsxs("div",{className:"max-w-4xl mx-auto",children:[!g&&!x&&a.jsx("div",{className:"mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6 text-yellow-600 mt-0.5 flex-shrink-0",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m0 0c.652-.286 1.323-.443 2.25-.443 1.38 0 2.652.24 3.75.697v-6a6 6 0 0 0-6 2.243M12 15.75V21m0-5.25c1.38 0 2.652-.24 3.75-.697v6a6 6 0 0 1-3.75-2.243M12 15.75L9 12"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-yellow-800 font-medium text-sm",children:"需要設定 API Key 以使用分享功能"}),a.jsx("p",{className:"text-yellow-700 text-xs mt-1",children:"設定後可分享測驗和寫作練習給學生，包含 AI 功能"})]})]}),a.jsx("button",{onClick:()=>v(!0),className:"px-3 py-1 bg-yellow-600 text-white rounded hover:bg-yellow-700 text-sm",children:"設定 API Key"})]})}),a.jsx(um,{content:n,topic:n.topic||"",selectedLevel:n.selectedLevel||null,selectedVocabularyLevel:n.selectedVocabularyLevel||null,apiKey:g||void 0,onContentUpdate:i})]})]}):null},mR=()=>{const[t,e]=M.useState(""),[n,i]=M.useState(null),[l,o]=M.useState(!1),[u,f]=M.useState(null),[g,h]=M.useState(null),[x,v]=M.useState(!1),[N,w]=M.useState(null),[C,j]=M.useState(null),[k,E]=M.useState(null),[L,D]=M.useState(!1),[O,H]=M.useState(null),[I,R]=M.useState(!1),[q,B]=M.useState(!1);Be.useEffect(()=>{const K=new URLSearchParams(window.location.search).get("apikey");if(K){localStorage.setItem(Ka,K),h(K),v(!1);const X=window.location.origin+window.location.pathname;window.history.replaceState({},document.title,X);return}const pe=localStorage.getItem(Ka);pe?h(pe):v(!0)},[]);const ee=P=>{localStorage.setItem(Ka,P),h(P),v(!1)},G=async(P,K)=>{try{await zt.init();const pe=MA(K,P);await zt.saveLessonPlan(pe)}catch(pe){console.error("保存教案到本地存儲失敗:",pe)}},Y=M.useCallback(async()=>{if(!t.trim()){f("請輸入學習主題。");return}if(!g){f("尚未設定 Gemini API 金鑰。"),v(!0);return}o(!0),f(null),j(null),i(null),E(null),H(null),R(!1);const P=Lj(t);B(P);try{const K=await Pj(t,g);j(K),D(!0),P&&R(!0)}catch(K){console.error(K),f(K.message||"產生學習程度建議時發生未知錯誤。")}finally{o(!1)}},[t,g]),z=M.useCallback(async P=>{if(!g){f("尚未設定 Gemini API 金鑰。"),v(!0);return}if(q&&!O){f("請先選擇英語單字程度。");return}o(!0),f(null),E(P),i(null);try{let K;q&&O?K=await Bj(t,P,O,g):K=await Oj(t,P,g),i(K),D(!1),R(!1),await G(K,t)}catch(K){console.error(K),f(K.message||"產生學習內容時發生未知錯誤。")}finally{o(!1)}},[t,g,q,O]),$=M.useCallback(async()=>{if(!t.trim()){f("請輸入學習主題。");return}if(!g){f("尚未設定 Gemini API 金鑰。"),v(!0);return}o(!0),f(null),i(null),D(!1),R(!1),B(!1);try{const P=await Hj(t,g);i(P),await G(P,t)}catch(P){console.error(P),f(P.message||"產生內容時發生未知錯誤。"),i(null)}finally{o(!1)}},[t,g]),Q=async()=>{if(!g){w("請先設定 API 金鑰");return}const P=`${window.location.origin}/ai-page-gen/?apikey=${encodeURIComponent(g)}`;try{await navigator.clipboard.writeText(P),w("已複製分享連結！")}catch{w("複製失敗，請手動複製")}setTimeout(()=>w(null),2e3)};return a.jsx(vA,{basename:"/ai-page-gen/",children:a.jsxs(YE,{children:[a.jsx(kn,{path:"share",element:a.jsx(fR,{})}),a.jsx(kn,{path:"quiz",element:a.jsx(IA,{})}),a.jsx(kn,{path:"writing",element:a.jsx(DA,{})}),a.jsx(kn,{path:"student-results",element:a.jsx(PA,{})}),a.jsx(kn,{path:"lesson-plans",element:a.jsx(OA,{})}),a.jsx(kn,{path:"interactive-learning",element:a.jsx(rR,{})}),a.jsx(kn,{path:"teacher-interactive-prep",element:a.jsx(aR,{})}),a.jsx(kn,{path:"student-interactive",element:a.jsx(lR,{})}),a.jsx(kn,{path:"conversation-prep",element:a.jsx(cR,{})}),a.jsx(kn,{path:"conversation-practice/:binId",element:a.jsx(dR,{})}),a.jsx(kn,{path:"/",element:a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-100 via-sky-50 to-indigo-100 py-8 px-4 sm:px-6 lg:px-8",children:[a.jsx(xv,{isOpen:x,onSave:ee}),a.jsxs("header",{className:"text-center mb-10",children:[a.jsxs("h1",{className:"text-4xl sm:text-5xl font-extrabold text-sky-700 tracking-tight",children:["AI 學習頁面 ",a.jsx("span",{className:"text-indigo-600",children:"產生器"})]}),a.jsx("p",{className:"mt-3 text-lg text-slate-600 max-w-2xl mx-auto",children:"輸入一個主題，讓 AI 為您打造包含互動測驗的結構化學習計劃！"}),a.jsxs("div",{className:"mt-6 max-w-2xl mx-auto bg-yellow-50 border-l-4 border-yellow-400 rounded-lg p-4 text-left shadow-sm",children:[a.jsxs("div",{className:"flex items-start mb-2",children:[a.jsx("svg",{className:"w-6 h-6 text-yellow-500 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 16h-1v-4h-1m1-4h.01M12 20a8 8 0 100-16 8 8 0 000 16z"})}),a.jsx("span",{className:"font-semibold text-yellow-800 text-base",children:"使用注意事項"})]}),a.jsxs("ul",{className:"list-disc pl-8 text-yellow-900 text-sm space-y-1",children:[a.jsx("li",{children:"內容審查：請在分享AI生成內容給學生前仔細檢查，確保內容適合且無誤"}),a.jsx("li",{children:"隱私保護：請勿輸入學生個人識別資訊"})]})]})]}),a.jsxs("div",{className:"max-w-6xl mx-auto mb-8",children:[a.jsxs("div",{className:"flex justify-center gap-3 flex-wrap",children:[a.jsxs("a",{href:"/ai-page-gen/lesson-plans",className:"flex items-center gap-2 px-4 py-3 bg-indigo-600 text-white font-medium rounded-lg hover:bg-indigo-700 transition-colors shadow-lg",children:[a.jsx(Pn,{className:"w-5 h-5"}),"我的教案庫"]}),a.jsxs("a",{href:"/ai-page-gen/conversation-prep",className:"flex items-center gap-2 px-4 py-3 bg-emerald-600 text-white font-medium rounded-lg hover:bg-emerald-700 transition-colors shadow-lg",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18.75a6 6 0 0 0 6-6v-1.5m-6 7.5a6 6 0 0 1-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 0 1-3-3V4.5a3 3 0 1 1 6 0v8.25a3 3 0 0 1-3 3Z"})}),"英文對話練習"]}),a.jsxs("button",{onClick:Q,className:"flex items-center gap-2 px-4 py-3 bg-purple-600 text-white font-medium rounded-lg hover:bg-purple-700 transition-colors shadow-lg",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.217 10.907a2.25 2.25 0 1 0 0 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186 9.566-5.314m-9.566 7.5 9.566 5.314m0 0a2.25 2.25 0 1 0 3.935 2.186 2.25 2.25 0 0 0-3.935-2.186Zm0-11.314a2.25 2.25 0 1 0 3.935-2.186 2.25 2.25 0 0 0-3.935 2.186Z"})}),"分享應用程式"]})]}),N&&a.jsx("div",{className:"mt-3 text-center",children:a.jsx("p",{className:`text-sm ${N.includes("請先")?"text-red-600":"text-green-600"}`,children:N})})]}),a.jsxs("main",{className:"max-w-4xl mx-auto",children:[a.jsx(Kj,{topic:t,setTopic:e,onGenerate:$,onGenerateWithLevels:Y,isLoading:l}),u&&!l&&a.jsxs("div",{className:"my-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg shadow-md",children:[a.jsxs("h3",{className:"font-bold text-lg mb-2 flex items-center",children:[a.jsx(Df,{className:"w-6 h-6 mr-2 text-red-600"}),"產生內容時發生錯誤"]}),a.jsx("p",{children:u}),a.jsx("p",{className:"mt-2 text-sm",children:"請嘗試修改您的主題或重試。如果問題持續存在，AI 模型可能暫時不可用，或者 API 金鑰可能存在問題。"})]}),l&&a.jsx("div",{className:"flex justify-center my-10",children:a.jsx(sn,{})}),L&&C&&!l&&!u&&a.jsx(tE,{learningLevels:C,onLevelSelect:E,onGenerateWithLevel:z,selectedLevelId:k==null?void 0:k.id,isLoading:l}),I&&q&&!l&&!u&&a.jsx(nE,{onVocabularyLevelSelect:H,selectedLevel:O,isVisible:!0}),n&&!l&&!u&&!L&&!I&&a.jsx(um,{content:n,topic:t,selectedLevel:k,selectedVocabularyLevel:O,apiKey:g||void 0,onContentUpdate:i})]}),a.jsxs("footer",{className:"text-center mt-12 py-6 border-t border-slate-300",children:[a.jsx("p",{className:"text-sm text-slate-500",children:"由 Gemini API 驅動。AI 設計，為學習而生。"}),a.jsx("button",{className:"mt-4 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded shadow transition",onClick:Q,disabled:!g,children:"產生分享連結並複製"}),N&&a.jsx("div",{className:"mt-2 text-green-600 text-sm",children:N})]})]})})]})})},xb=document.getElementById("root");if(!xb)throw new Error("Could not find root element to mount to");const hR=zw.createRoot(xb);hR.render(a.jsx(Be.StrictMode,{children:a.jsx(mR,{})}));
